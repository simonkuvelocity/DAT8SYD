/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/registry",[],function(){function t(t,e){var n,i,r,a=e.length;return"function"==typeof e[a-1]&&(a-=1,r=e[a]),"object"==typeof e[a-1]&&(a-=1),2==a?(n=e[0],i=e[1]):(n=t.node,i=e[0]),{element:n,type:i,callback:r}}function e(t,e){return t.element==e.element&&t.type==e.type&&(null==e.callback||t.callback==e.callback)}function n(){function n(t){this.component=t,this.attachedTo=[],this.instances={},this.addInstance=function(t){var e=new i(t);return this.instances[t.identity]=e,this.attachedTo.push(t.node),e},this.removeInstance=function(t){delete this.instances[t.identity];var e=this.attachedTo.indexOf(t.node);e>-1&&this.attachedTo.splice(e,1),Object.keys(this.instances).length||r.removeComponentInfo(this)},this.isAttachedTo=function(t){return this.attachedTo.indexOf(t)>-1}}function i(t){this.instance=t,this.events=[],this.addBind=function(t){this.events.push(t),r.events.push(t)},this.removeBind=function(t){for(var n,i=0;n=this.events[i];i++)e(n,t)&&this.events.splice(i,1)}}var r=this;(this.reset=function(){this.components=[],this.allInstances={},this.events=[]}).call(this),this.addInstance=function(t){var e=this.findComponentInfo(t);e||(e=new n(t.constructor),this.components.push(e));var i=e.addInstance(t);return this.allInstances[t.identity]=i,e},this.removeInstance=function(t){var e=this.findComponentInfo(t);e&&e.removeInstance(t),delete this.allInstances[t.identity]},this.removeComponentInfo=function(t){var e=this.components.indexOf(t);e>-1&&this.components.splice(e,1)},this.findComponentInfo=function(t){for(var e,n=t.attachTo?t:t.constructor,i=0;e=this.components[i];i++)if(e.component===n)return e;return null},this.findInstanceInfo=function(t){return this.allInstances[t.identity]||null},this.getBoundEventNames=function(t){return this.findInstanceInfo(t).events.map(function(t){return t.type})},this.findInstanceInfoByNode=function(t){var e=[];return Object.keys(this.allInstances).forEach(function(n){var i=this.allInstances[n];i.instance.node===t&&e.push(i)},this),e},this.on=function(e){for(var n,i=r.findInstanceInfo(this),a=arguments.length,s=1,o=new Array(a-1);a>s;s++)o[s-1]=arguments[s];if(i){n=e.apply(null,o),n&&(o[o.length-1]=n);var l=t(this,o);i.addBind(l)}},this.off=function(){var n=t(this,arguments),i=r.findInstanceInfo(this);i&&i.removeBind(n);for(var a,s=0;a=r.events[s];s++)e(a,n)&&r.events.splice(s,1)},r.trigger=function(){},this.teardown=function(){r.removeInstance(this)},this.withRegistration=function(){this.after("initialize",function(){r.addInstance(this)}),this.around("on",r.on),this.after("off",r.off),window.DEBUG&&DEBUG.enabled&&this.after("trigger",r.trigger),this.after("teardown",{obj:r,fnName:"teardown"})}}return new n}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/debug",["./registry"],function(t){function e(t,n,i){i=i||{};var r=i.obj||window,a=i.path||(r==window?"window":""),s=Object.keys(r);s.forEach(function(i){(m[t]||t)(n,r,i)&&console.log([a,".",i].join(""),"->",["(",typeof r[i],")"].join(""),r[i]),"[object Object]"==Object.prototype.toString.call(r[i])&&r[i]!=r&&-1==a.split(".").indexOf(i)&&e(t,n,{obj:r[i],path:[a,i].join(".")})})}function n(t,n,i,r){n&&typeof i!=n?console.error([i,"must be",n].join(" ")):e(t,i,r)}function i(t,e){n("name","string",t,e)}function r(t,e){n("nameContains","string",t,e)}function a(t,e){n("type","function",t,e)}function s(t,e){n("value",null,t,e)}function o(t,e){n("valueCoerced",null,t,e)}function l(t,n){e(t,null,n)}function u(){var t=[].slice.call(arguments);y.eventNames.length||(y.eventNames=g),y.actions=t.length?t:g,p()}function c(){var t=[].slice.call(arguments);y.actions.length||(y.actions=g),y.eventNames=t.length?t:g,p()}function h(){y.actions=[],y.eventNames=[],p()}function d(){y.actions=g,y.eventNames=g,p()}function p(){try{window.localStorage&&(localStorage.setItem("logFilter_eventNames",y.eventNames),localStorage.setItem("logFilter_actions",y.actions))}catch(t){}}function f(){var t,e;try{t=window.localStorage&&localStorage.getItem("logFilter_eventNames"),e=window.localStorage&&localStorage.getItem("logFilter_actions")}catch(n){return}t&&(y.eventNames=t),e&&(y.actions=e),Object.keys(y).forEach(function(t){var e=y[t];"string"==typeof e&&e!==g&&(y[t]=e?e.split(","):[])})}var m={name:function(t,e,n){return t==n},nameContains:function(t,e,n){return n.indexOf(t)>-1},type:function(t,e,n){return e[n]instanceof t},value:function(t,e,n){return e[n]===t},valueCoerced:function(t,e,n){return e[n]==t}},g="all",y={eventNames:[],actions:[]};return{enable:function(t){this.enabled=!!t,t&&window.console&&(console.info("Booting in DEBUG mode"),console.info("You can configure event logging with DEBUG.events.logAll()/logNone()/logByName()/logByAction()")),f(),window.DEBUG=this},warn:function(){if(window.console){var t=console.warn||console.log,e=[].slice.call(arguments);e.unshift(this.toString()+":"),t.apply(console,e)}},registry:t,find:{byName:i,byNameContains:r,byType:a,byValue:s,byValueCoerced:o,custom:l},events:{logFilter:y,logByAction:u,logByName:c,logAll:d,logNone:h}}}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/utils",["./debug"],function(t){function e(){var e=t.enabled&&!Object.propertyIsEnumerable("getOwnPropertyDescriptor");if(e)try{Object.getOwnPropertyDescriptor(Object,"keys")}catch(n){return!1}return e}var n=100,i={isDomObj:function(t){return!(!t.nodeType&&t!==window)},toArray:function(t,e){e=e||0;for(var n=t.length,i=new Array(n-e),r=e;n>r;r++)i[r-e]=t[r];return i},merge:function(){var t=arguments.length,e=new Array(t+1);if(0===t)return{};for(var n=0;t>n;n++)e[n+1]=arguments[n];return e[0]={},e[e.length-1]===!0&&(e.pop(),e.unshift(!0)),$.extend.apply(void 0,e)},push:function(t,e,n){return t&&Object.keys(e||{}).forEach(function(i){if(t[i]&&n)throw new Error('utils.push attempted to overwrite "'+i+'" while running in protected mode');"object"==typeof t[i]&&"object"==typeof e[i]?this.push(t[i],e[i]):t[i]=e[i]},this),t},getEnumerableProperty:function(t,e){return t.propertyIsEnumerable(e)?t[e]:void 0},compose:function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},uniqueArray:function(t){for(var e={},n=[],i=0,r=t.length;r>i;++i)e.hasOwnProperty(t[i])||(n.push(t[i]),e[t[i]]=1);return n},debounce:function(t,e,i){"number"!=typeof e&&(e=n);var r,a;return function(){var n=this,s=arguments,o=function(){r=null,i||(a=t.apply(n,s))},l=i&&!r;return r&&clearTimeout(r),r=setTimeout(o,e),l&&(a=t.apply(n,s)),a}},throttle:function(t,e){"number"!=typeof e&&(e=n);var i,r,a,s,o,l,u=this.debounce(function(){o=s=!1},e);return function(){i=this,r=arguments;var n=function(){a=null,o&&(l=t.apply(i,r)),u()};return a||(a=setTimeout(n,e)),s?o=!0:(s=!0,l=t.apply(i,r)),u(),l}},countThen:function(t,e){return function(){return--t?void 0:e.apply(this,arguments)}},delegate:function(t){return function(e,n){var i,r=$(e.target);Object.keys(t).forEach(function(a){return!e.isPropagationStopped()&&(i=r.closest(a)).length?(n=n||{},e.currentTarget=n.el=i[0],t[a].apply(this,[e,n])):void 0},this)}},once:function(t){var e,n;return function(){return e?n:(e=!0,n=t.apply(this,arguments))}},propertyWritability:function(t,n,i){e()&&t.hasOwnProperty(n)&&Object.defineProperty(t,n,{writable:i})},mutateProperty:function(t,n,i){var r;return e()&&t.hasOwnProperty(n)?(r=Object.getOwnPropertyDescriptor(t,n).writable,Object.defineProperty(t,n,{writable:!0}),i.call(t),void Object.defineProperty(t,n,{writable:r})):void i.call(t)}};return i}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/advice",["./utils"],function(t){var e={around:function(t,e){return function(){var n=0,i=arguments.length,r=new Array(i+1);for(r[0]=t.bind(this);i>n;n++)r[n+1]=arguments[n];return e.apply(this,r)}},before:function(t,e){var n="function"==typeof e?e:e.obj[e.fnName];return function(){return n.apply(this,arguments),t.apply(this,arguments)}},after:function(t,e){var n="function"==typeof e?e:e.obj[e.fnName];return function(){var e=(t.unbound||t).apply(this,arguments);return n.apply(this,arguments),e}},withAdvice:function(){["before","after","around"].forEach(function(n){this[n]=function(i,r){var a=i.trim().split(" ");a.forEach(function(i){t.mutateProperty(this,i,function(){return"function"==typeof this[i]?this[i]=e[n](this[i],r):this[i]=r,this[i]})},this)}},this)}};return e}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/compose",["./utils"],function(t){function e(e,n){Object.keys(e).forEach(function(r){i.indexOf(r)<0&&t.propertyWritability(e,r,n)})}function n(t,n){t.mixedIn=Object.prototype.hasOwnProperty.call(t,"mixedIn")?t.mixedIn:[];for(var i=0;i<n.length;i++)-1==t.mixedIn.indexOf(n[i])&&(e(t,!1),n[i].call(t),t.mixedIn.push(n[i]));e(t,!0)}var i=["mixedIn","attrDef"];return{mixin:n}}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/base",["./utils","./registry","./debug"],function(t,e,n){function i(t){t.events.slice().forEach(function(t){var e=[t.type];t.element&&e.unshift(t.element),"function"==typeof t.callback&&e.push(t.callback),this.off.apply(this,e)},t.instance)}function r(t,e){try{window.postMessage(e,"*")}catch(i){n.warn.call(this,['Event "',t,'" was triggered with non-serializable data. ',"Flight recommends you avoid passing non-serializable data in events."].join(""))}}function a(t){n.warn.call(this,['Attribute "',t,'" defaults to an array or object. ',"Enclose this in a function to avoid sharing between component instances."].join(""))}function s(t){var e,i=[];if(this.attr=new this.attrDef,n.enabled&&window.console){for(var r in this.attrDef.prototype)i.push(r);e=Object.keys(t);for(var s=e.length-1;s>=0;s--)if(-1==i.indexOf(e[s])){n.warn.call(this,'Passed unused attribute "'+e[s]+'".');break}}for(var r in this.attrDef.prototype){if("undefined"==typeof t[r]){if(null===this.attr[r])throw new Error('Required attribute "'+r+'" not specified in attachTo for component "'+this.toString()+'".');n.enabled&&"object"==typeof this.attr[r]&&a.call(this,r)}else this.attr[r]=t[r];"function"==typeof this.attr[r]&&(this.attr[r]=this.attr[r].call(this))}}function o(t){n.enabled&&n.warn.call(this,"defaultAttrs will be removed in a future version. Please use attributes.");var e=Object.create(t);for(var i in this.defaults)t.hasOwnProperty(i)||(e[i]=this.defaults[i],n.enabled&&"object"==typeof this.defaults[i]&&a.call(this,i));this.attr=e,Object.keys(this.defaults||{}).forEach(function(t){if(null===this.defaults[t]&&null===this.attr[t])throw new Error('Required attribute "'+t+'" not specified in attachTo for component "'+this.toString()+'".')},this)}function l(t){return function(e,n){$(e.target).trigger(t,n)}}function u(){this.trigger=function(){var t,e,i,a,s,o=arguments.length-1,l=arguments[o];return"string"==typeof l||l&&l.defaultBehavior||(o--,i=l),1==o?(t=$(arguments[0]),a=arguments[1]):(t=this.$node,a=arguments[0]),a.defaultBehavior&&(s=a.defaultBehavior,a=$.Event(a.type)),e=a.type||a,n.enabled&&window.postMessage&&r.call(this,e,i),"object"==typeof this.attr.eventData&&(i=$.extend(!0,{},this.attr.eventData,i)),t.trigger(a||e,i),s&&!a.isDefaultPrevented()&&(this[s]||s).call(this,a,i),t},this.on=function(){var e,n,i,r,a=arguments.length-1,s=arguments[a];if(r="object"==typeof s?t.delegate(this.resolveDelegateRules(s)):"string"==typeof s?l(s):s,2==a?(e=$(arguments[0]),n=arguments[1]):(e=this.$node,n=arguments[0]),"function"!=typeof r&&"object"!=typeof r)throw new Error('Unable to bind to "'+n+'" because the given callback is not a function or an object');return i=r.bind(this),i.target=r,i.context=this,e.on(n,i),r.bound||(r.bound=[]),r.bound.push(i),i},this.off=function(){var t,n,i,r=arguments.length-1;if("function"==typeof arguments[r]&&(i=arguments[r],r-=1),1==r?(t=$(arguments[0]),n=arguments[1]):(t=this.$node,n=arguments[0]),i){var a=i.target?i.target.bound:i.bound||[];a&&a.some(function(t,e,n){return t.context&&this.identity==t.context.identity?(n.splice(e,1),i=t,!0):void 0},this),t.off(n,i)}else e.findInstanceInfo(this).events.forEach(function(e){n==e.type&&t.off(n,e.callback)});return t},this.resolveDelegateRules=function(t){var e={};return Object.keys(t).forEach(function(n){if(!(n in this.attr))throw new Error('Component "'+this.toString()+'" wants to listen on "'+n+'" but no such attribute was defined.');e[this.attr[n]]="string"==typeof t[n]?l(t[n]):t[n]},this),e},this.select=function(t){return this.$node.find(this.attr[t])},this.attributes=function(t){var e=function(){};this.attrDef&&(e.prototype=new this.attrDef);for(var n in t)e.prototype[n]=t[n];this.attrDef=e},this.defaultAttrs=function(e){t.push(this.defaults,e,!0)||(this.defaults=e)},this.initialize=function(t,e){if(e=e||{},this.identity||(this.identity=c++),!t)throw new Error("Component needs a node");return t.jquery?(this.node=t[0],this.$node=t):(this.node=t,this.$node=$(t)),this.attrDef?s.call(this,e):o.call(this,e),this},this.teardown=function(){i(e.findInstanceInfo(this))}}var c=0;return u}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/logger",["./utils"],function(t){function e(t){var e=t.tagName?t.tagName.toLowerCase():t.toString(),n=t.className?"."+t.className:"",i=e+n;return t.tagName?["'","'"].join(i):i}function n(t,n,i){if(window.DEBUG&&window.DEBUG.enabled){var a,s,o,l,u,c,h,d,p,f;"function"==typeof i[i.length-1]&&(l=i.pop(),l=l.unbound||l),1==i.length?(o=n.$node[0],s=i[0]):2!=i.length||"object"!=typeof i[1]||i[1].type?(o=i[0],s=i[1],"trigger"==t&&(u=i[2])):(o=n.$node[0],s=i[0],"trigger"==t&&(u=i[1])),a="object"==typeof s?s.type:s,c=window.DEBUG.events.logFilter,d="all"==c.actions||c.actions.indexOf(t)>-1,h=function(t){return t.test?t:new RegExp("^"+t.replace(/\*/g,".*")+"$")},p="all"==c.eventNames||c.eventNames.some(function(t){return h(t).test(a)}),d&&p&&(f=[r[t],t,"["+a+"]"],u&&f.push(u),f.push(e(o)),f.push(n.constructor.describe.split(" ").slice(0,3).join(" ")),console.groupCollapsed&&"trigger"==t&&console.groupCollapsed(t,a),Function.prototype.apply.call(console.info,console,f))}}function i(){this.before("trigger",function(){n("trigger",this,t.toArray(arguments))}),console.groupCollapsed&&this.after("trigger",function(){console.groupEnd()}),this.before("on",function(){n("on",this,t.toArray(arguments))}),this.before("off",function(){n("off",this,t.toArray(arguments))})}var r={on:"<-",trigger:"->",off:"x "};return i}),/* Copyright 2013 Twitter, Inc. Licensed under The MIT License. http://opensource.org/licenses/MIT */
define("flight/lib/component",["./advice","./utils","./compose","./base","./registry","./logger","./debug"],function(t,e,n,i,r,a,s){function o(){var t=r.findComponentInfo(this);t&&Object.keys(t.instances).forEach(function(e){var n=t.instances[e];n&&n.instance&&n.instance.teardown()})}function l(t){for(var n=arguments.length,i=new Array(n-1),a=1;n>a;a++)i[a-1]=arguments[a];if(!t)throw new Error("Component needs to be attachTo'd a jQuery object, native node or selector string");var s=e.merge.apply(e,i),o=r.findComponentInfo(this);$(t).each(function(t,e){o&&o.isAttachedTo(e)||(new this).initialize(e,s)}.bind(this))}function u(){var t=this.mixedIn||this.prototype.mixedIn||[];return t.map(function(t){if(null==t.name){var e=t.toString().match(h);return e&&e[1]?e[1]:""}return d[t.name]?"":t.name}).filter(Boolean).join(", ")}function c(){for(var h=arguments.length,d=new Array(h),p=0;h>p;p++)d[p]=arguments[p];var f=function(){};return f.toString=f.prototype.toString=u,s.enabled&&(f.describe=f.prototype.describe=f.toString()),f.attachTo=l,f.mixin=function(){var t=c(),i=Object.create(f.prototype);return i.mixedIn=[].concat(f.prototype.mixedIn),i.defaults=e.merge(f.prototype.defaults),i.attrDef=f.prototype.attrDef,n.mixin(i,arguments),t.prototype=i,t.prototype.constructor=t,t},f.teardownAll=o,s.enabled&&d.unshift(a),d.unshift(i,t.withAdvice,r.withRegistration),n.mixin(f.prototype,d),f}var h=/function (.*?)\s?\(/,d={withBase:!0,withLogging:!0};return c.teardownAll=function(){r.components.slice().forEach(function(t){t.component.teardownAll()}),r.reset()},c}),define("$app/ui/shared/flash_message",["flight/lib/component"],function(t){function e(){this.defaultAttrs({messageSelector:".js-message"}),this.showFlashMessage=function(t,e){this.select("messageSelector").text(e.message),this.$node.addClass("showing"),setTimeout(function(){this.hideFlashMessage()}.bind(this),e.delay?e.delay:5e3)},this.initializeFlashMessage=function(){var t=this.select("messageSelector");t.text().length>0&&this.trigger("uiShowFlashMessage",{message:t.text()})},this.hideFlashMessage=function(){this.$node.removeClass("showing")},this.after("initialize",function(){this.on(document,"uiShowFlashMessage",this.showFlashMessage),this.initializeFlashMessage(),this.on("click",{messageSelector:this.hideFlashMessage})})}return t(e)}),define("$app/ui/shared/link_with_event_tracking",["flight/lib/component"],function(t){function e(){this.trackUserClick=function(t){this.trigger("uiNeedsToTrackUserActionEvent",{name:$(t.target).data("event-name")})},this.after("initialize",function(){this.on("click",this.trackUserClick)})}return t(e)}),define("$app/ui/shared/click_to_select",["flight/lib/component"],function(t){function e(){this.selectAll=function(t){return this.$node.select(),!1},this.after("initialize",function(){this.on("click",this.selectAll)})}return t(e)}),define("$app/ui/shared/tippable_elements",["flight/lib/component"],function(t){function e(){this.defaultAttrs({tipsyElementsSelector:".tippable",tipsysSelector:".tipsy"}),this.tipsyElements=function(){this.select("tipsyElementsSelector").each(function(){var t=$(this);t.tipsy({trigger:t.data("tipsy-trigger")||"hover",gravity:t.data("tipsy-gravity")||"w",html:"true"})})},this.hideTipsyElements=function(){this.select("tipsysSelector").hide()},this.after("initialize",function(){this.tipsyElements(),this.on(document,"uiShouldTipsyElements",this.tipsyElements),this.on(document,"uiShouldHideTipsys",this.hideTipsyElements)})}return t(e)}),define("$app/ui/shared/upgrade_gate_triggers",["flight/lib/component"],function(t){function e(){function t(t){return t.data("gated")}this.defaultAttrs({upgradeGateTriggerSelector:".js-upgrade-gate-trigger",upgradeGatePopoverSelector:".js-upgrade-gate-popover",upgradeMessageSelector:".js-upgrade-message"}),this.disableGateTriggers=function(){this.select("upgradeGateTriggerSelector").each(function(){var e=$(this);t(e)&&e.attr("disabled",!0)})},this.shakeTrigger=function(e){var n=$(e.target||e.srcElement);t(n)?(e.preventDefault(),e.stopPropagation(),$target.hasClass("button")&&(n.removeClass("shake"),setTimeout(function(){n.addClass("shake")},0))):this.hidePopover()},this.showPopover=function(t){var e=$(t.target||t.srcElement),n=this.select("upgradeGatePopoverSelector");e.data("gate-message")&&e.data("gate-message").length>0&&(this.select("upgradeMessageSelector").text(e.data("gate-message")),n.css({top:e.offset().top+e.outerHeight()+15,left:e.offset().left-n.outerWidth()/2+e.outerWidth()/2}),n.addClass("showing"),clearTimeout(this.attr.hidePopoverTimeout))},this.hidePopover=function(){this.attr.hidePopoverTimeout=setTimeout(function(){var t=this.select("upgradeGatePopoverSelector");t.is(":hover")||this.select("upgradeGatePopoverSelector").removeClass("showing")}.bind(this),400)},this.after("initialize",function(){this.disableGateTriggers(),this.on(document,"uiShouldDisableGateTriggers",this.disableGateTriggers),this.on("click",{upgradeGateTriggerSelector:this.shakeTrigger}),this.on("mouseover",{upgradeGateTriggerSelector:this.showPopover}),this.on("mouseout",{upgradeGateTriggerSelector:this.hidePopover,upgradeGatePopoverSelector:this.hidePopover})})}return t(e)}),define("$app/ui/shared/input_placeholders",["flight/lib/component"],function(t){function e(){this.after("initialize",function(){this.$node.placeholder()})}return t(e)}),define("$app/ui/shared/input_prefixes",["flight/lib/component"],function(t){function e(){this.after("initialize",function(){var t=this.$node,e=t.next();!e.is("input")&&t.prev().is("input")&&(e=$(this).prev()),e.on("focus",function(){t.addClass("focused")}),e.on("focusout",function(){t.removeClass("focused")})})}return t(e)}),define("$app/ui/shared/javascript_loader",["flight/lib/component"],function(t){function e(){this.after("initialize",function(){this.$node.fadeOut()})}return t(e)}),define("$app/ui/shared/with_navigation",["flight/lib/component"],function(t){function e(){this.defaultAttrs({showMobileNavigationTriggerSelector:".js-show-navigation-links",hideMobileNavigationTriggerSelector:".js-hide-navigation-links",navigationLinksHolderSelector:".js-navigation-links",navigationHolderSelector:".js-navigation",accountLinksTriggerSelector:".js-account-dropdown-trigger",accountLinksDropdownSelector:".js-account-dropdown",learnLinksTriggerSelector:".js-learn-dropdown-trigger",learnLinksDropdownSelector:".js-learn-dropdown",unreadMessageCounterSelector:".js-unread-counter"}),this.showMobileNavigation=function(t){return t.preventDefault(),this.select("navigationLinksHolderSelector").show(),this.select("hideMobileNavigationTriggerSelector").show(),this.select("showMobileNavigationTriggerSelector").hide(),this.select("navigationHolderSelector").addClass("showing-links"),!1},this.hideMobileNavigation=function(t){return t.preventDefault(),this.select("navigationLinksHolderSelector").hide(),this.select("hideMobileNavigationTriggerSelector").hide(),this.select("showMobileNavigationTriggerSelector").show(),this.select("navigationHolderSelector").removeClass("showing-links"),!1},this.toggleAccountDropdown=function(t){return t.preventDefault(),this.select("accountLinksDropdownSelector").toggleClass("open"),!1},this.toggleLearnDropdown=function(t){return t.preventDefault(),this.select("learnLinksDropdownSelector").toggleClass("open"),!1},this.hideDropdownsWhenUnfocused=function(t){var e=this.select("accountLinksDropdownSelector"),n=this.select("learnLinksDropdownSelector");0==$(t.target).closest(e).length&&e.removeClass("open"),0==$(t.target).closest(n).length&&n.removeClass("open")},this.updateMessageCount=function(t,e){this.select("unreadMessageCounterSelector").text(e.count).toggle(e.count>0)},this.after("initialize",function(){this.on("html","click",this.hideDropdownsWhenUnfocused),this.on("uiNeedsToHideOtherDropdowns",this.hideDropdownsWhenUnfocused),this.on(document,"uiNeedsToUpdateMessageCount",this.updateMessageCount),this.on("click",{showMobileNavigationTriggerSelector:this.showMobileNavigation,hideMobileNavigationTriggerSelector:this.hideMobileNavigation,accountLinksTriggerSelector:this.toggleAccountDropdown,learnLinksTriggerSelector:this.toggleLearnDropdown})})}return t(e)}),function(){define("$app/ui/shared/facebook_share",["flight/lib/component"],function(t){function e(){this.facebookShare=function(t){t.preventDefault();var e=this.$node;FB&&FB.ui({href:e.data("url"),method:"share",name:e.data("name"),picture:e.data("preview")},function(t){void 0!==t&&e.find(".gi-facebook").removeClass("gi-facebook").addClass("gi-check")})},this.after("initialize",function(){this.on("click",this.facebookShare)})}return t(e)})}(),define("$app/utils/with_url",[],function(){function t(){this.getUrlParams=function(){if("undefined"==typeof this.urlParams){var t=" ",e=this.getQueryString(),n=/([^&=]+)=?([^&]*)/g;for(this.urlParams={};t=n.exec(e);)this.urlParams[decodeURIComponent(t[1])]=decodeURIComponent(t[2])}return this.urlParams},this.getQueryString=function(){return window.location.search.substring(1)}}return t}),function(){define("$app/ui/discover/search",["flight/lib/component","$app/utils/with_url"],function(t,e){function n(){this.defaultAttrs({searchFilterDropdownTriggerSelector:".js-discover-search-filter-dropdown-trigger",searchFilterDropdownSelector:".js-discover-search-filter-dropdown",searchFieldSelector:".js-discover-search-field",searchFilterOptionSelector:".js-discover-search-filter-option",selectedCategory:"everything",enterKeyCode:13,minSearchLength:3}),this.searchKeyListener=function(t,e){if(t&&(t.preventDefault(),t.keyCode===this.attr.enterKeyCode)){var n=this.select("searchFieldSelector").val();if(n.length<this.attr.minSearchLength)return;this.attr.isOnDiscoverPage?(this.trigger("uiNeedsToSearch",{query:n,from:1,category:this.attr.selectedCategory}),this.select("searchFieldSelector").select()):window.location.href=Routes.discover_path({query:n})}},this.toggleSearchFilterDropbown=function(t){t.preventDefault(),this.select("searchFilterDropdownSelector").toggleClass("showing")},this.updateSearchFilter=function(t){this.attr.selectedCategory!==$(t.target||t.srcElement).attr("data-value")&&(this.attr.selectedCategory=$(t.target||t.srcElement).attr("data-value"),this.select("searchFilterDropdownTriggerSelector").html($(t.target||t.srcElement).text()+" &nbsp; \u25be"),this.select("searchFieldSelector").css("padding-left",this.select("searchFilterDropdownTriggerSelector").outerWidth()+10),this.trigger("uiToClearTags"),this.trigger("uiNeedsToFilterResultsOrProducts",{category:this.attr.selectedCategory})),this.select("searchFilterDropdownSelector").removeClass("showing")},this.setCategory=function(t,e){this.select("searchFilterDropdownTriggerSelector").html($("[data-value='"+e.category+"']").text()+" &nbsp; \u25be"),this.select("searchFieldSelector").css("padding-left",this.select("searchFilterDropdownTriggerSelector").outerWidth()+10)},this.after("initialize",function(){this.attr.isOnDiscoverPage="discover-page"===this.$node.parents("body").attr("id"),this.getUrlParams().query&&this.select("searchFieldSelector").select(),this.on(document,"uiToUpdateCategory",this.setCategory),this.on("keyup",{searchFieldSelector:this.searchKeyListener}),this.on("click",{searchFilterDropdownTriggerSelector:this.toggleSearchFilterDropbown,searchFilterOptionSelector:this.updateSearchFilter})})}return t(n,e)})}(),function(){define("$app/ui/discover/prompt",["flight/lib/component"],function(t){function e(){this.after("initialize",function(){this.$node.is(":visible")&&!this.attr.hasBeenTracked&&(this.trigger("uiNeedsToTrackUserActionEvent",{name:"discover_prompt_view"}),this.attr.hasBeenTracked=!0)})}return t(e)})}(),define("$app/ui/shared/with_form_base",[],function(){function t(){this.defaultAttrs({inputSelector:"input",textareaSelector:"textarea",selectSelector:"select",requiredInputSelector:"input.required",requiredSelectSelector:"select.required",numericalInputSelector:"input.numerical",emailInputSelector:"input.email",minLengthInputSelector:"input[minlength]",emailValidationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/}),this.validateRequiredInput=function(t){return 0!=t.length&&t.is(":visible")&&0==t.val().length?(t.hasClass("proxy")&&t.data("proxy")&&(t=$("."+t.data("proxy"))),this.showError(t),t.focus(),!1):!0},this.validateSelectInput=function(t){return t.is(":visible")&&null==t.val()?(this.showError(t),t.focus(),!1):!0},this.validateNumericalInput=function(t){return 0!=t.length&&t.is(":visible")&&0!=t.val().length&&isNaN(parseFloat(t.val()))?(this.showError(t),t.focus(),!1):!0},this.validateMinLengthInput=function(t){if(0==t.length||!t.is(":visible")||0==t.val().length)return!0;var e=parseInt(t.attr("minlength")),n=t.val();return n.length>0&&n.length<e?(this.showError(t),t.focus(),!1):!0},this.validateEmails=function(t){var e=!0,n=this;return t.each(function(){var t=$(this);return!t.is(":visible")||!t.hasClass("required")&&""==t.val()||n.attr.emailValidationRegex.test(t.val())?void 0:(n.showError(t),t.focus(),e=!1)}),e},this.validateForm=function(t){var e=!0,n=this;return t.find(this.attr.numericalInputSelector).each(function(){return n.validateNumericalInput($(this))}),e?(t.find(this.attr.requiredInputSelector).each(function(){e=e&&n.validateRequiredInput($(this))}),e?(t.find(this.attr.requiredSelectSelector).each(function(){e=e&&n.validateSelectInput($(this))}),e?(t.find(this.attr.minLengthInputSelector).each(function(){e=e&&n.validateMinLengthInput($(this))}),e=e&&this.validateEmails(t.find(this.attr.emailInputSelector))):e):e):e},this.showError=function(t){t.addClass("error")},this.hideError=function(t){t.removeClass("error")},this.hideErrorIfNotEnterKey=function(t){13!=t.which&&this.hideError($(t.target))},this.after("initialize",function(){this.on("keyup",{inputSelector:this.hideErrorIfNotEnterKey,textareaSelector:this.hideErrorIfNotEnterKey}),this.on("change",{selectSelector:this.hideErrorIfNotEnterKey})})}return t}),define("$app/ui/shared/auth_modal",["flight/lib/component","$app/ui/shared/with_form_base"],function(t,e){function n(){this.defaultAttrs({authModalSelector:"#hp-auth-modal",loginModalSelector:"#hp-login",signupModalSelector:"#hp-signup",forgotPasswordFormSelector:"#forgot-password-form",switchToSignupSelector:"#hp-login .switch-to a",switchToLoginSelector:"#hp-signup .switch-to a",signupEmailSelector:"#hp-signup #user_email",loginEmailSelector:"#hp-login #user_login",forgotPasswordEmailSelector:"#forgot-password-form .email",forgotPasswordSelector:"#hp-auth-modal .js-show-forgot-password-form-trigger",closeModalButtonSelector:"#hp-auth-modal .js-close-modal-trigger",cancelForgotPasswordButtonSelector:"#forgot-password-form .js-hide-forgot-password-form-trigger",loginButtonSelector:".js-login-button",signupButtonSelector:".js-signup-button",forgotPasswordButtonSelector:".js-forgot-password-button",errorIndicatorSelector:".error-indicator",socialAuthButtonSelector:".social-auth .button",nextSelector:"#next",modalShowing:!1}),this.showLoginModal=function(t,e){var n=this.extractNextUrlFromHashLocation();e.setNext&&n&&(this.select("nextSelector").val(n),this.select("socialAuthButtonSelector").each(function(){this.href.match(/\?referer/)||(this.href+="?referer="+n),this.href+="&origin="+n})),this.showModal(!1)},this.extractNextUrlFromHashLocation=function(){return window.location.hash.match(/next/)?window.location.hash.split("?")[1].split("=")[1]:null},this.showSignupModal=function(t,e){this.showModal(!0)},this.showModal=function(t){if(!this.attr.modalShowing){var t="undefined"==typeof t?!0:t,e=this.select("authModalSelector"),n=this.select("loginModalSelector"),i=this.select("signupModalSelector");n.hide(),i.hide(),t?i.show():(n.show(),this.select("loginEmailSelector").focus()),e.removeClass("cancelled-element"),this.$node.addClass("showing"),e.addClass("showing"),this.attr.modalShowing=!0}},this.hideModal=function(t){if(this.attr.modalShowing){var e=this.select("authModalSelector");e.addClass("cancelled-element"),this.$node.removeClass("showing"),this.attr.modalShowing=!1}return t&&t.preventDefault(),!1},this.switchToSignup=function(t){return this.trigger("uiNeedsToTrackUserActionEvent",{name:"modal_switch_to_signup"}),this.select("loginModalSelector").hide(),this.select("signupEmailSelector").val(this.select("loginEmailSelector").val()),this.select("signupModalSelector").show(),t.preventDefault(),!1},this.switchToLogin=function(t){var e=this.select("loginEmailSelector");return this.trigger("uiNeedsToTrackUserActionEvent",{name:"modal_switch_to_login"}),e.val(this.select("signupEmailSelector").val()),this.select("loginModalSelector").show(),e.focus(),this.select("signupModalSelector").hide(),t.preventDefault(),!1},this.showForgotPasswordForm=function(t){return this.select("loginModalSelector").addClass("faded"),this.select("forgotPasswordEmailSelector").val(this.select("loginEmailSelector").val()).focus(),this.select("forgotPasswordFormSelector").show(),t.preventDefault(),!1},this.hideForgotPasswordForm=function(t){return this.select("loginModalSelector").removeClass("faded"),this.select("forgotPasswordFormSelector").hide(),t.preventDefault(),!1},this.hideModalIfEscapeIsPressed=function(t){27==t.keyCode&&this.hideModal()},this.hideModalIfClickedOutsideModal=function(t){0==this.select("authModalSelector").has(t.target).length&&this.hideModal()},this.login=function(t){return this.submitForm("loginButtonSelector",I18n.t("js.logging_in"),"uiNeedsToLogin"),t.preventDefault(),!1},this.signup=function(t){return this.submitForm("signupButtonSelector",I18n.t("js.creating"),"uiNeedsToSignup"),t.preventDefault(),!1},this.renewPassword=function(t){return this.submitForm("forgotPasswordButtonSelector",I18n.t("js.sending"),"uiNeedsToRenewPassword"),t.preventDefault(),!1},this.submitForm=function(t,e,n){var i=this.select(t),r=i.closest("form");this.validateForm(r)&&(r.find(this.attr.errorIndicatorSelector).hide(),i.data("default",i.text()),i.text(e),this.trigger(n,{serializedForm:r.serialize()}))},this.getSubmitFormSuccessHandler=function(t){var e=t+"ButtonSelector";return function(t,n){var i=this.select(e);n.redirect_location&&(window.location=n.redirect_location),n.success_message&&(this.trigger("uiShowFlashMessage",{message:n.success_message}),i.text(i.data("default")))}},this.getSubmitFormErrorHandler=function(t){var e=t+"ButtonSelector";return function(t,n){var i=this.select(e),r=i.closest("form").find(this.attr.errorIndicatorSelector);r.text(n.error_message).show(),i.text(i.data("default"))}.bind(this)},this.autoShowAuthModal=function(t){"/#login"==t||"#login"==t?this.trigger("uiShowLoginModal",{setNext:!0}):("/#signup"==t||"#signup"==t)&&this.trigger("uiShowSignupModal")},this.after("initialize",function(){this.on(document,"uiShowLoginModal",this.showLoginModal),this.on(document,"uiShowSignupModal",this.showSignupModal),this.on(document,"dataLoginSucceeded",this.getSubmitFormSuccessHandler("login")),this.on(document,"dataSignupSucceeded",this.getSubmitFormSuccessHandler("signup")),this.on(document,"dataRenewPasswordSucceeded",this.getSubmitFormSuccessHandler("forgotPassword")),this.on(document,"dataFailedToLogin",this.getSubmitFormErrorHandler("login")),this.on(document,"dataFailedToSignup",this.getSubmitFormErrorHandler("signup")),this.on(document,"dataFailedToRenewPassword",this.getSubmitFormErrorHandler("forgotPassword")),this.on("click",{switchToSignupSelector:this.switchToSignup,switchToLoginSelector:this.switchToLogin,forgotPasswordSelector:this.showForgotPasswordForm,cancelForgotPasswordButtonSelector:this.hideForgotPasswordForm,closeModalButtonSelector:this.hideModal,loginButtonSelector:this.login,signupButtonSelector:this.signup,forgotPasswordButtonSelector:this.renewPassword}),this.on(document,"keydown",this.hideModalIfEscapeIsPressed),this.on(document,"mouseup",this.hideModalIfClickedOutsideModal),this.on(document,"touchend",this.hideModalIfClickedOutsideModal),window.location.hash.replace("#","")&&this.autoShowAuthModal(window.location.hash.split("?")[0])})}return t(e,n)}),define("$app/ui/shared/signup_trigger",["flight/lib/component"],function(t){function e(){this.showSignupModal=function(){return this.trigger("uiShowSignupModal"),!1},this.after("initialize",function(){this.on("click",this.showSignupModal)})}return t(e)}),define("$app/ui/shared/login_trigger",["flight/lib/component"],function(t){function e(){this.showLoginModal=function(t){return t&&t.preventDefault(),this.trigger("uiShowLoginModal",{setNext:!1}),!1},this.after("initialize",function(){this.on("click",this.showLoginModal)})}return t(e)}),define("$app/data/authentication",["flight/lib/component"],function(t){function e(){this.login=function(t,e){this.sendRequest(Routes.login_path({format:"json"}),e.serializedForm,"dataLoginSucceeded","dataFailedToLogin")},this.signup=function(t,e){this.sendRequest(Routes.signup_path({format:"json"}),e.serializedForm,"dataSignupSucceeded","dataFailedToSignup")},this.renewPassword=function(t,e){this.sendRequest(Routes.forgot_password_path({format:"json"}),e.serializedForm,"dataRenewPasswordSucceeded","dataFailedToRenewPassword")},this.sendRequest=function(t,e,n,i){$.ajax({type:"POST",url:t,dataType:"json",data:e}).done(function(t){t.success?this.trigger(n,t):this.trigger(i,t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToLogin",this.login),this.on(document,"uiNeedsToSignup",this.signup),this.on(document,"uiNeedsToRenewPassword",this.renewPassword)})}return t(e)}),define("$app/utils/auth_modal_setup",["$app/ui/shared/auth_modal","$app/ui/shared/signup_trigger","$app/ui/shared/login_trigger","$app/data/authentication"],function(t,e,n,i){function r(){i.attachTo(document),t.attachTo(".modals-container"),e.attachTo(".js-signup-trigger"),n.attachTo(".js-login-trigger")}return r}),/*!

 handlebars v3.0.3

 Copyright (C) 2011-2014 by Yehuda Katz

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

 @license
 */
function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("hbs/handlebars",e):"object"==typeof exports?exports.Handlebars=e():t.Handlebars=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function i(){var t=y();return t.compile=function(e,n){return c.compile(e,n,t)},t.precompile=function(e,n){return c.precompile(e,n,t)},t.AST=l["default"],t.Compiler=c.Compiler,t.JavaScriptCompiler=d["default"],t.Parser=u.parser,t.parse=u.parse,t}var r=n(8)["default"];e.__esModule=!0;var a=n(1),s=r(a),o=n(2),l=r(o),u=n(3),c=n(4),h=n(5),d=r(h),p=n(6),f=r(p),m=n(7),g=r(m),y=s["default"].create,v=i();v.create=i,g["default"](v),v.Visitor=f["default"],v["default"]=v,e["default"]=v,t.exports=e["default"]},function(t,e,n){function i(){var t=new o.HandlebarsEnvironment;return p.extend(t,o),t.SafeString=u["default"],t.Exception=h["default"],t.Utils=p,t.escapeExpression=p.escapeExpression,t.VM=m,t.template=function(e){return m.template(e,t)},t}var r=n(9)["default"],a=n(8)["default"];e.__esModule=!0;var s=n(10),o=r(s),l=n(11),u=a(l),c=n(12),h=a(c),d=n(13),p=r(d),f=n(14),m=r(f),g=n(7),y=a(g),v=i();v.create=i,y["default"](v),v["default"]=v,e["default"]=v,t.exports=e["default"]},function(t,e,n){e.__esModule=!0;var i={Program:function(t,e,n,i){this.loc=i,this.type="Program",this.body=t,this.blockParams=e,this.strip=n},MustacheStatement:function(t,e,n,i,r,a){this.loc=a,this.type="MustacheStatement",this.path=t,this.params=e||[],this.hash=n,this.escaped=i,this.strip=r},BlockStatement:function(t,e,n,i,r,a,s,o,l){this.loc=l,this.type="BlockStatement",this.path=t,this.params=e||[],this.hash=n,this.program=i,this.inverse=r,this.openStrip=a,this.inverseStrip=s,this.closeStrip=o},PartialStatement:function(t,e,n,i,r){this.loc=r,this.type="PartialStatement",this.name=t,this.params=e||[],this.hash=n,this.indent="",this.strip=i},ContentStatement:function(t,e){this.loc=e,this.type="ContentStatement",this.original=this.value=t},CommentStatement:function(t,e,n){this.loc=n,this.type="CommentStatement",this.value=t,this.strip=e},SubExpression:function(t,e,n,i){this.loc=i,this.type="SubExpression",this.path=t,this.params=e||[],this.hash=n},PathExpression:function(t,e,n,i,r){this.loc=r,this.type="PathExpression",this.data=t,this.original=i,this.parts=n,this.depth=e},StringLiteral:function(t,e){this.loc=e,this.type="StringLiteral",this.original=this.value=t},NumberLiteral:function(t,e){this.loc=e,this.type="NumberLiteral",this.original=this.value=Number(t)},BooleanLiteral:function(t,e){this.loc=e,this.type="BooleanLiteral",this.original=this.value="true"===t},UndefinedLiteral:function(t){this.loc=t,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(t){this.loc=t,this.type="NullLiteral",this.original=this.value=null},Hash:function(t,e){this.loc=e,this.type="Hash",this.pairs=t},HashPair:function(t,e,n){this.loc=n,this.type="HashPair",this.key=t,this.value=e},helpers:{helperExpression:function(t){return!("SubExpression"!==t.type&&!t.params.length&&!t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!i.helpers.scopedId(t)&&!t.depth}}};e["default"]=i,t.exports=e["default"]},function(t,e,n){function i(t,e){if("Program"===t.type)return t;o["default"].yy=m,m.locInfo=function(t){return new m.SourceLocation(e&&e.srcName,t)};var n=new h["default"];return n.accept(o["default"].parse(t))}var r=n(8)["default"],a=n(9)["default"];e.__esModule=!0,e.parse=i;var s=n(15),o=r(s),l=n(2),u=r(l),c=n(16),h=r(c),d=n(17),p=a(d),f=n(13);e.parser=o["default"];var m={};f.extend(m,p,u["default"])},function(t,e,n){function i(){}function r(t,e,n){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new c["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var i=n.parse(t,e),r=(new n.Compiler).compile(i,e);return(new n.JavaScriptCompiler).compile(r,e)}function a(t,e,n){function i(){var e=n.parse(t,a),i=(new n.Compiler).compile(e,a),r=(new n.JavaScriptCompiler).compile(i,a,void 0,!0);return n.template(r)}function r(t,e){return s||(s=i()),s.call(this,t,e)}var a=void 0===arguments[1]?{}:arguments[1];if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new c["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in a||(a.data=!0),a.compat&&(a.useDepths=!0);var s=void 0;return r._setup=function(t){return s||(s=i()),s._setup(t)},r._child=function(t,e,n,r){return s||(s=i()),s._child(t,e,n,r)},r}function s(t,e){if(t===e)return!0;if(h.isArray(t)&&h.isArray(e)&&t.length===e.length){for(var n=0;n<t.length;n++)if(!s(t[n],e[n]))return!1;return!0}}function o(t){if(!t.path.parts){var e=t.path;t.path=new p["default"].PathExpression(!1,0,[e.original+""],e.original+"",e.loc)}}var l=n(8)["default"];e.__esModule=!0,e.Compiler=i,e.precompile=r,e.compile=a;var u=n(12),c=l(u),h=n(13),d=n(2),p=l(d),f=[].slice;i.prototype={compiler:i,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var n=0;e>n;n++){var i=this.opcodes[n],r=t.opcodes[n];if(i.opcode!==r.opcode||!s(i.args,r.args))return!1}e=this.children.length;for(var n=0;e>n;n++)if(!this.children[n].equals(t.children[n]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var n=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},n)for(var i in n)i in n&&(e.knownHelpers[i]=n[i]);return this.accept(t)},compileProgram:function(t){var e=new this.compiler,n=e.compile(t,this.options),i=this.guid++;return this.usePartial=this.usePartial||n.usePartial,this.children[i]=n,this.useDepths=this.useDepths||n.useDepths,i},accept:function(t){this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,n=e.length,i=0;n>i;i++)this.accept(e[i]);return this.options.blockParams.shift(),this.isSimple=1===n,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){o(t);var e=t.program,n=t.inverse;e=e&&this.compileProgram(e),n=n&&this.compileProgram(n);var i=this.classifySexpr(t);"helper"===i?this.helperSexpr(t,e,n):"simple"===i?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,n),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(t){this.usePartial=!0;var e=t.params;if(e.length>1)throw new c["default"]("Unsupported number of partial arguments: "+e.length,t);e.length||e.push({type:"PathExpression",parts:[],depth:0});var n=t.name.original,i="SubExpression"===t.name.type;i&&this.accept(t.name),this.setupFullMustacheParams(t,void 0,void 0,!0);var r=t.indent||"";this.options.preventIndent&&r&&(this.opcode("appendContent",r),r=""),this.opcode("invokePartial",i,n,r),this.opcode("append")},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){o(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,n){var i=t.path,r=i.parts[0],a=null!=e||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.accept(i),this.opcode("invokeAmbiguous",r,a)},simpleSexpr:function(t){this.accept(t.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,n){var i=this.setupFullMustacheParams(t,e,n),r=t.path,a=r.parts[0];if(this.options.knownHelpers[a])this.opcode("invokeKnownHelper",i.length,a);else{if(this.options.knownHelpersOnly)throw new c["default"]("You specified knownHelpersOnly, but used the unknown helper "+a,t);r.falsy=!0,this.accept(r),this.opcode("invokeHelper",i.length,r.original,p["default"].helpers.simpleId(r))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],n=p["default"].helpers.scopedId(t),i=!t.depth&&!n&&this.blockParamIndex(e);i?this.opcode("lookupBlockParam",i,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts)):this.opcode("lookupOnContext",t.parts,t.falsy,n):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,n=0,i=e.length;for(this.opcode("pushHash");i>n;n++)this.pushParam(e[n].value);for(;n--;)this.opcode("assignToHash",e[n].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=p["default"].helpers.simpleId(t.path),n=e&&!!this.blockParamIndex(t.path.parts[0]),i=!n&&p["default"].helpers.helperExpression(t),r=!n&&(i||e);if(r&&!i){var a=t.path.parts[0],s=this.options;s.knownHelpers[a]?i=!0:s.knownHelpersOnly&&(r=!1)}return i?"helper":r?"ambiguous":"simple"},pushParams:function(t){for(var e=0,n=t.length;n>e;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var n=void 0;if(!t.parts||p["default"].helpers.scopedId(t)||t.depth||(n=this.blockParamIndex(t.parts[0])),n){var i=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,i)}else e=t.original||e,e.replace&&(e=e.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,n,i){var r=t.params;return this.pushParams(r),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.accept(t.hash):this.opcode("emptyHash",i),r},blockParamIndex:function(t){for(var e=0,n=this.options.blockParams.length;n>e;e++){var i=this.options.blockParams[e],r=i&&h.indexOf(i,t);if(i&&r>=0)return[e,r]}}}},function(t,e,n){function i(t){this.value=t}function r(){}function a(t,e,n,i){var r=e.popStack(),a=0,s=n.length;for(t&&s--;s>a;a++)r=e.nameLookup(r,n[a],i);return t?[e.aliasable("this.strict"),"(",r,", ",e.quotedString(n[a]),")"]:r}var s=n(8)["default"];e.__esModule=!0;var o=n(10),l=n(12),u=s(l),c=n(13),h=n(18),d=s(h);r.prototype={nameLookup:function(t,e){return r.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"['",e,"']"]},depthedLookup:function(t){return[this.aliasable("this.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=o.COMPILER_REVISION,e=o.REVISION_CHANGES[t];return[t,e]},appendToBuffer:function(t,e,n){return c.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:n?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,n,i){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var r=t.opcodes,a=void 0,s=void 0,o=void 0,l=void 0;for(o=0,l=r.length;l>o;o++)a=r[o],this.source.currentLocation=a.loc,s=s||a.loc,this[a.opcode].apply(this,a.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new u["default"]("Compile completed with content left on stack");var c=this.createFunctionContext(i);if(this.isChild)return c;var h={compiler:this.compilerInfo(),main:c},d=this.context.programs;for(o=0,l=d.length;l>o;o++)d[o]&&(h[o]=d[o]);return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),i?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new d["default"](this.options.srcName)},createFunctionContext:function(t){var e="",n=this.stackVars.concat(this.registers.list);n.length>0&&(e+=", "+n.join(", "));var i=0;for(var r in this.aliases){var a=this.aliases[r];this.aliases.hasOwnProperty(r)&&a.children&&a.referenceCount>1&&(e+=", alias"+ ++i+"="+r,a.children[0]="alias"+i)}var s=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var o=this.mergeSource(e);return t?(s.push(o),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",o,"}"])},mergeSource:function(t){var e=this.environment.isSimple,n=!this.forceBuffer,i=void 0,r=void 0,a=void 0,s=void 0;return this.source.each(function(t){t.appendToBuffer?(a?t.prepend("  + "):a=t,s=t):(a&&(r?a.prepend("buffer += "):i=!0,s.add(";"),a=s=void 0),r=!0,e||(n=!1))}),n?a?(a.prepend("return "),s.add(";")):r||this.source.push('return "";'):(t+=", buffer = "+(i?"":this.initializeBuffer()),a?(a.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(i?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(t,0,n);var i=this.popStack();n.splice(1,0,i),this.push(this.source.functionCall(e,"call",n))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var n=this.topStack();e.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,n){var i=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[i++])),this.resolvePath("context",t,i,e)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e){t?this.pushStackLiteral("this.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0)},resolvePath:function(t,e,n,i){var r=this;if(this.options.strict||this.options.assumeObjects)return void this.push(a(this.options.strict,this,e,t));for(var s=e.length;s>n;n++)this.replaceStack(function(a){var s=r.nameLookup(a,e[n],t);return i?[" && ",s]:[" != null ? ",s," : ",a]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e,n){var i=this.popStack(),r=this.setupHelper(t,e),a=n?[r.name," || "]:"",s=["("].concat(a,i);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",r.callParams))},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,t,e),r=this.lastHelper=this.nameLookup("helpers",t,"helper"),a=["(","(helper = ",r," || ",n,")"];this.options.strict||(a[0]="(helper = ",a.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",a,i.paramsInit?["),(",i.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",i.callParams)," : helper))"])},invokePartial:function(t,e,n){var i=[],r=this.setupParams(e,1,i,!1);t&&(e=this.popStack(),delete r.name),n&&(r.indent=JSON.stringify(n)),r.helpers="helpers",r.partials="partials",t?i.unshift(e):i.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(r.depths="depths"),r=this.objectLiteral(r),i.push(r),this.push(this.source.functionCall("this.invokePartial","",i))},assignToHash:function(t){var e=this.popStack(),n=void 0,i=void 0,r=void 0;this.trackIds&&(r=this.popStack()),this.stringParams&&(i=this.popStack(),n=this.popStack());var a=this.hash;n&&(a.contexts[t]=n),i&&(a.types[t]=i),r&&(a.ids[t]=r),a.values[t]=e},pushId:function(t,e,n){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:r,compileChildren:function(t,e){for(var n=t.children,i=void 0,r=void 0,a=0,s=n.length;s>a;a++){i=n[a],r=new this.compiler;var o=this.matchExistingProgram(i);null==o?(this.context.programs.push(""),o=this.context.programs.length,i.index=o,i.name="program"+o,this.context.programs[o]=r.compile(i,e,this.context,!this.precompile),this.context.environments[o]=i,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams):(i.index=o,i.name="program"+o,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams)}},matchExistingProgram:function(t){for(var e=0,n=this.context.environments.length;n>e;e++){var i=this.context.environments[e];if(i&&i.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],n=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"this.program("+n.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof i||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new i(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],n=void 0,r=void 0,a=void 0;if(!this.isInline())throw new u["default"]("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof i)n=[s.value],e=["(",n],a=!0;else{r=!0;var o=this.incrStack();e=["((",this.push(o)," = ",s,")"],n=this.topStack()}var l=t.call(this,n);a||this.popStack(),r&&this.stackSlot--,this.push(e.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,n=t.length;n>e;e++){var r=t[e];if(r instanceof i)this.compileStack.push(r);else{var a=this.incrStack();this.pushSource([a," = ",r,";"]),this.compileStack.push(a)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),n=(e?this.inlineStack:this.compileStack).pop();if(!t&&n instanceof i)return n.value;if(!e){if(!this.stackSlot)throw new u["default"]("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof i?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):(e=this.aliases[t]=this.source.wrap(t),e.aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,n){var i=[],r=this.setupHelperArgs(e,t,i,n),a=this.nameLookup("helpers",e,"helper");return{params:i,paramsInit:r,name:a,callParams:[this.contextName(0)].concat(i)}},setupParams:function(t,e,n){var i={},r=[],a=[],s=[],o=void 0;i.name=this.quotedString(t),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var l=this.popStack(),u=this.popStack();(u||l)&&(i.fn=u||"this.noop",i.inverse=l||"this.noop");for(var c=e;c--;)o=this.popStack(),n[c]=o,this.trackIds&&(s[c]=this.popStack()),this.stringParams&&(a[c]=this.popStack(),r[c]=this.popStack());return this.trackIds&&(i.ids=this.source.generateArray(s)),this.stringParams&&(i.types=this.source.generateArray(a),i.contexts=this.source.generateArray(r)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(t,e,n,i){var r=this.setupParams(t,e,n,!0);return r=this.objectLiteral(r),i?(this.useRegister("options"),n.push("options"),["options=",r]):(n.push(r),"")}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=r.RESERVED_WORDS={},n=0,i=t.length;i>n;n++)e[t[n]]=!0}(),r.isValidJavaScriptVariableName=function(t){return!r.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e["default"]=r,t.exports=e["default"]},function(t,e,n){function i(){this.parents=[]}var r=n(8)["default"];e.__esModule=!0;var a=n(12),s=r(a),o=n(2),l=r(o);i.prototype={constructor:i,mutating:!1,acceptKey:function(t,e){var n=this.accept(t[e]);if(this.mutating){if(n&&(!n.type||!l["default"][n.type]))throw new s["default"]('Unexpected node type "'+n.type+'" found when accepting '+e+" on "+t.type);t[e]=n}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new s["default"](t.type+" requires "+e)},acceptArray:function(t){for(var e=0,n=t.length;n>e;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,n--)},accept:function(t){if(t){this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:e!==!1?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")},BlockStatement:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash"),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")},PartialStatement:function(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e["default"]=i,t.exports=e["default"]},function(t,e,n){(function(n){e.__esModule=!0,e["default"]=function(t){var e="undefined"!=typeof n?n:window,i=e.Handlebars;t.noConflict=function(){e.Handlebars===t&&(e.Handlebars=i)}},t.exports=e["default"]}).call(e,function(){return this}())},function(t,e,n){e["default"]=function(t){return t&&t.__esModule?t:{"default":t}},e.__esModule=!0},function(t,e,n){e["default"]=function(t){if(t&&t.__esModule)return t;var e={};if("object"==typeof t&&null!==t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e},e.__esModule=!0},function(t,e,n){function i(t,e){this.helpers=t||{},this.partials=e||{},r(this)}function r(t){t.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new h["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),t.registerHelper("blockHelperMissing",function(e,n){var i=n.inverse,r=n.fn;if(e===!0)return r(this);if(e===!1||null==e)return i(this);if(m(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):i(this);if(n.data&&n.ids){var s=a(n.data);s.contextPath=u.appendContextPath(n.data.contextPath,n.name),n={data:s}}return r(e,n)}),t.registerHelper("each",function(t,e){function n(e,n,r){l&&(l.key=e,l.index=n,l.first=0===n,l.last=!!r,c&&(l.contextPath=c+e)),o+=i(t[e],{data:l,blockParams:u.blockParams([t[e],e],[c+e,null])})}if(!e)throw new h["default"]("Must pass iterator to #each");var i=e.fn,r=e.inverse,s=0,o="",l=void 0,c=void 0;if(e.data&&e.ids&&(c=u.appendContextPath(e.data.contextPath,e.ids[0])+"."),g(t)&&(t=t.call(this)),e.data&&(l=a(e.data)),t&&"object"==typeof t)if(m(t))for(var d=t.length;d>s;s++)n(s,s,s===t.length-1);else{var p=void 0;for(var f in t)t.hasOwnProperty(f)&&(p&&n(p,s-1),p=f,s++);p&&n(p,s-1,!0)}return 0===s&&(o=r(this)),o}),t.registerHelper("if",function(t,e){return g(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||u.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){g(t)&&(t=t.call(this));var n=e.fn;if(u.isEmpty(t))return e.inverse(this);if(e.data&&e.ids){var i=a(e.data);i.contextPath=u.appendContextPath(e.data.contextPath,e.ids[0]),e={data:i}}return n(t,e)}),t.registerHelper("log",function(e,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(i,e)}),t.registerHelper("lookup",function(t,e){return t&&t[e]})}function a(t){var e=u.extend({},t);return e._parent=t,e}var s=n(9)["default"],o=n(8)["default"];e.__esModule=!0,e.HandlebarsEnvironment=i,e.createFrame=a;var l=n(13),u=s(l),c=n(12),h=o(c),d="3.0.1";e.VERSION=d;var p=6;e.COMPILER_REVISION=p;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};e.REVISION_CHANGES=f;var m=u.isArray,g=u.isFunction,y=u.toString,v="[object Object]";i.prototype={constructor:i,logger:_,log:S,registerHelper:function(t,e){if(y.call(t)===v){if(e)throw new h["default"]("Arg not supported with multiple helpers");u.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(y.call(t)===v)u.extend(this.partials,t);else{if("undefined"==typeof e)throw new h["default"]("Attempting to register a partial as undefined");this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]}};var _={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(t,e){if("undefined"!=typeof console&&_.level<=t){var n=_.methodMap[t];(console[n]||console.log).call(console,e)}}};e.logger=_;var S=_.log;e.log=S},function(t,e,n){function i(t){this.string=t}e.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},e["default"]=i,t.exports=e["default"]},function(t,e,n){function i(t,e){var n=e&&e.loc,a=void 0,s=void 0;n&&(a=n.start.line,s=n.start.column,t+=" - "+a+":"+s);for(var o=Error.prototype.constructor.call(this,t),l=0;l<r.length;l++)this[r[l]]=o[r[l]];Error.captureStackTrace&&Error.captureStackTrace(this,i),n&&(this.lineNumber=a,this.column=s)}e.__esModule=!0;var r=["description","fileName","lineNumber","message","name","number","stack"];i.prototype=new Error,e["default"]=i,t.exports=e["default"]},function(t,e,n){function i(t){return c[t]}function r(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function a(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1}function s(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return d.test(t)?t.replace(h,i):t}function o(t){return t||0===t?m(t)&&0===t.length?!0:!1:!0}function l(t,e){return t.path=e,t}function u(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=r,e.indexOf=a,e.escapeExpression=s,e.isEmpty=o,e.blockParams=l,e.appendContextPath=u;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},h=/[&<>"'`]/g,d=/[&<>"'`]/,p=Object.prototype.toString;e.toString=p;var f=function(t){return"function"==typeof t};f(/x/)&&(e.isFunction=f=function(t){return"function"==typeof t&&"[object Function]"===p.call(t)});var f;e.isFunction=f;var m=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===p.call(t):!1};e.isArray=m},function(t,e,n){function i(t){var e=t&&t[0]||1,n=g.COMPILER_REVISION;if(e!==n){if(n>e){var i=g.REVISION_CHANGES[n],r=g.REVISION_CHANGES[e];throw new m["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+r+").")}throw new m["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){function n(n,i,r){r.hash&&(i=p.extend({},i,r.hash)),n=e.VM.resolvePartial.call(this,n,i,r);var a=e.VM.invokePartial.call(this,n,i,r);if(null==a&&e.compile&&(r.partials[r.name]=e.compile(n,t.compilerOptions,e),a=r.partials[r.name](i,r)),null!=a){if(r.indent){for(var s=a.split("\n"),o=0,l=s.length;l>o&&(s[o]||o+1!==l);o++)s[o]=r.indent+s[o];a=s.join("\n")}return a}throw new m["default"]("The partial "+r.name+" could not be compiled when running in runtime-only mode")}function i(e){var n=void 0===arguments[1]?{}:arguments[1],a=n.data;i._setup(n),!n.partial&&t.useData&&(a=u(e,a));var s=void 0,o=t.useBlockParams?[]:void 0;return t.useDepths&&(s=n.depths?[e].concat(n.depths):[e]),t.main.call(r,e,r.helpers,r.partials,a,o,s)}if(!e)throw new m["default"]("No environment passed to template");if(!t||!t.main)throw new m["default"]("Unknown template object: "+typeof t);e.VM.checkRevision(t.compiler);var r={strict:function(t,e){if(!(e in t))throw new m["default"]('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,i=0;n>i;i++)if(t[i]&&null!=t[i][e])return t[i][e];
},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:p.escapeExpression,invokePartial:n,fn:function(e){return t[e]},programs:[],program:function(t,e,n,i,r){var s=this.programs[t],o=this.fn(t);return e||r||i||n?s=a(this,t,o,e,n,i,r):s||(s=this.programs[t]=a(this,t,o)),s},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=p.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler};return i.isTop=!0,i._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,e.helpers),t.usePartial&&(r.partials=r.merge(n.partials,e.partials)))},i._child=function(e,n,i,s){if(t.useBlockParams&&!i)throw new m["default"]("must pass block params");if(t.useDepths&&!s)throw new m["default"]("must pass parent depths");return a(r,e,t[e],n,0,i,s)},i}function a(t,e,n,i,r,a,s){function o(e){var r=void 0===arguments[1]?{}:arguments[1];return n.call(t,e,t.helpers,t.partials,r.data||i,a&&[r.blockParams].concat(a),s&&[e].concat(s))}return o.program=e,o.depth=s?s.length:0,o.blockParams=r||0,o}function s(t,e,n){return t?t.call||n.name||(n.name=t,t=n.partials[t]):t=n.partials[n.name],t}function o(t,e,n){if(n.partial=!0,void 0===t)throw new m["default"]("The partial "+n.name+" could not be found");return t instanceof Function?t(e,n):void 0}function l(){return""}function u(t,e){return e&&"root"in e||(e=e?g.createFrame(e):{},e.root=t),e}var c=n(9)["default"],h=n(8)["default"];e.__esModule=!0,e.checkRevision=i,e.template=r,e.wrapProgram=a,e.resolvePartial=s,e.invokePartial=o,e.noop=l;var d=n(13),p=c(d),f=n(12),m=h(f),g=n(10)},function(t,e,n){e.__esModule=!0;var i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(t,e,n,i,r,a,s){var o=a.length-1;switch(r){case 1:return a[o-1];case 2:this.$=new i.Program(a[o],null,{},i.locInfo(this._$));break;case 3:this.$=a[o];break;case 4:this.$=a[o];break;case 5:this.$=a[o];break;case 6:this.$=a[o];break;case 7:this.$=a[o];break;case 8:this.$=new i.CommentStatement(i.stripComment(a[o]),i.stripFlags(a[o],a[o]),i.locInfo(this._$));break;case 9:this.$=new i.ContentStatement(a[o],i.locInfo(this._$));break;case 10:this.$=i.prepareRawBlock(a[o-2],a[o-1],a[o],this._$);break;case 11:this.$={path:a[o-3],params:a[o-2],hash:a[o-1]};break;case 12:this.$=i.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!1,this._$);break;case 13:this.$=i.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!0,this._$);break;case 14:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:i.stripFlags(a[o-5],a[o])};break;case 15:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:i.stripFlags(a[o-5],a[o])};break;case 16:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:i.stripFlags(a[o-5],a[o])};break;case 17:this.$={strip:i.stripFlags(a[o-1],a[o-1]),program:a[o]};break;case 18:var l=i.prepareBlock(a[o-2],a[o-1],a[o],a[o],!1,this._$),u=new i.Program([l],null,{},i.locInfo(this._$));u.chained=!0,this.$={strip:a[o-2].strip,program:u,chain:!0};break;case 19:this.$=a[o];break;case 20:this.$={path:a[o-1],strip:i.stripFlags(a[o-2],a[o])};break;case 21:this.$=i.prepareMustache(a[o-3],a[o-2],a[o-1],a[o-4],i.stripFlags(a[o-4],a[o]),this._$);break;case 22:this.$=i.prepareMustache(a[o-3],a[o-2],a[o-1],a[o-4],i.stripFlags(a[o-4],a[o]),this._$);break;case 23:this.$=new i.PartialStatement(a[o-3],a[o-2],a[o-1],i.stripFlags(a[o-4],a[o]),i.locInfo(this._$));break;case 24:this.$=a[o];break;case 25:this.$=a[o];break;case 26:this.$=new i.SubExpression(a[o-3],a[o-2],a[o-1],i.locInfo(this._$));break;case 27:this.$=new i.Hash(a[o],i.locInfo(this._$));break;case 28:this.$=new i.HashPair(i.id(a[o-2]),a[o],i.locInfo(this._$));break;case 29:this.$=i.id(a[o-1]);break;case 30:this.$=a[o];break;case 31:this.$=a[o];break;case 32:this.$=new i.StringLiteral(a[o],i.locInfo(this._$));break;case 33:this.$=new i.NumberLiteral(a[o],i.locInfo(this._$));break;case 34:this.$=new i.BooleanLiteral(a[o],i.locInfo(this._$));break;case 35:this.$=new i.UndefinedLiteral(i.locInfo(this._$));break;case 36:this.$=new i.NullLiteral(i.locInfo(this._$));break;case 37:this.$=a[o];break;case 38:this.$=a[o];break;case 39:this.$=i.preparePath(!0,a[o],this._$);break;case 40:this.$=i.preparePath(!1,a[o],this._$);break;case 41:a[o-2].push({part:i.id(a[o]),original:a[o],separator:a[o-1]}),this.$=a[o-2];break;case 42:this.$=[{part:i.id(a[o]),original:a[o]}];break;case 43:this.$=[];break;case 44:a[o-1].push(a[o]);break;case 45:this.$=[];break;case 46:a[o-1].push(a[o]);break;case 53:this.$=[];break;case 54:a[o-1].push(a[o]);break;case 59:this.$=[];break;case 60:a[o-1].push(a[o]);break;case 65:this.$=[];break;case 66:a[o-1].push(a[o]);break;case 73:this.$=[];break;case 74:a[o-1].push(a[o]);break;case 77:this.$=[];break;case 78:a[o-1].push(a[o]);break;case 81:this.$=[];break;case 82:a[o-1].push(a[o]);break;case 85:this.$=[];break;case 86:a[o-1].push(a[o]);break;case 89:this.$=[a[o]];break;case 90:a[o-1].push(a[o]);break;case 91:this.$=[a[o]];break;case 92:a[o-1].push(a[o])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,i=[0],r=[null],a=[],s=this.table,o="",l=0,u=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;a.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,y,v,_,S,b,w={};;){if(m=i[i.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=e()),g=s[m]&&s[m][p]),"undefined"==typeof g||!g.length||!g[0]){var P="";if(!c){b=[];for(v in s[m])this.terminals_[v]&&v>2&&b.push("'"+this.terminals_[v]+"'");P=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+b.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(P,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:b})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:i.push(p),r.push(this.lexer.yytext),a.push(this.lexer.yylloc),i.push(g[1]),p=null,f?(p=f,f=null):(u=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,c>0&&c--);break;case 2:if(_=this.productions_[g[1]][1],w.$=r[r.length-_],w._$={first_line:a[a.length-(_||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(_||1)].first_column,last_column:a[a.length-1].last_column},d&&(w._$.range=[a[a.length-(_||1)].range[0],a[a.length-1].range[1]]),y=this.performAction.call(w,o,u,l,this.yy,g[1],r,a),"undefined"!=typeof y)return y;_&&(i=i.slice(0,-1*_*2),r=r.slice(0,-1*_),a=a.slice(0,-1*_)),i.push(this.productions_[g[1]][0]),r.push(w.$),a.push(w._$),S=s[i[i.length-2]][i[i.length-1]],i.push(S);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,r;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),s=0;s<a.length&&(n=this._input.match(this.rules[a[s]]),!n||e&&!(n[0].length>e[0].length)||(e=n,i=s,this.options.flex));s++);return e?(r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,a[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,i){function r(t,n){return e.yytext=e.yytext.substr(t,e.yyleng-n)}switch(n){case 0:if("\\\\"===e.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return e.yytext=e.yytext.substr(5,e.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(e.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return e.yytext=r(1,2).replace(/\\"/g,'"'),74;case 30:return e.yytext=r(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:return 76;case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:return 66;case 40:return 66;case 41:return"INVALID";case 42:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}},t}();return e.lexer=n,t.prototype=e,e.Parser=t,new t}();e["default"]=i,t.exports=e["default"]},function(t,e,n){function i(){}function r(t,e,n){void 0===e&&(e=t.length);var i=t[e-1],r=t[e-2];return i?"ContentStatement"===i.type?(r||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original):void 0:n}function a(t,e,n){void 0===e&&(e=-1);var i=t[e+1],r=t[e+2];return i?"ContentStatement"===i.type?(r||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original):void 0:n}function s(t,e,n){var i=t[null==e?0:e+1];if(i&&"ContentStatement"===i.type&&(n||!i.rightStripped)){var r=i.value;i.value=i.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.value!==r}}function o(t,e,n){var i=t[null==e?t.length-1:e-1];if(i&&"ContentStatement"===i.type&&(n||!i.leftStripped)){var r=i.value;return i.value=i.value.replace(n?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.value!==r,i.leftStripped}}var l=n(8)["default"];e.__esModule=!0;var u=n(6),c=l(u);i.prototype=new c["default"],i.prototype.Program=function(t){var e=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,i=0,l=n.length;l>i;i++){var u=n[i],c=this.accept(u);if(c){var h=r(n,i,e),d=a(n,i,e),p=c.openStandalone&&h,f=c.closeStandalone&&d,m=c.inlineStandalone&&h&&d;c.close&&s(n,i,!0),c.open&&o(n,i,!0),m&&(s(n,i),o(n,i)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(n[i-1].original)[1])),p&&(s((u.program||u.inverse).body),o(n,i)),f&&(s(n,i),o((u.inverse||u.program).body))}}return t},i.prototype.BlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,n=t.program&&t.inverse,i=n,l=n;if(n&&n.chained)for(i=n.body[0].program;l.chained;)l=l.body[l.body.length-1].program;var u={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:a(e.body),closeStandalone:r((i||e).body)};if(t.openStrip.close&&s(e.body,null,!0),n){var c=t.inverseStrip;c.open&&o(e.body,null,!0),c.close&&s(i.body,null,!0),t.closeStrip.open&&o(l.body,null,!0),r(e.body)&&a(i.body)&&(o(e.body),s(i.body))}else t.closeStrip.open&&o(e.body,null,!0);return u},i.prototype.MustacheStatement=function(t){return t.strip},i.prototype.PartialStatement=i.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e["default"]=i,t.exports=e["default"]},function(t,e,n){function i(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function r(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t}function a(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function s(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function o(t,e,n){n=this.locInfo(n);for(var i=t?"@":"",r=[],a=0,s="",o=0,l=e.length;l>o;o++){var u=e[o].part,c=e[o].original!==u;if(i+=(e[o].separator||"")+u,c||".."!==u&&"."!==u&&"this"!==u)r.push(u);else{if(r.length>0)throw new p["default"]("Invalid path: "+i,{loc:n});".."===u&&(a++,s+="../")}}return new this.PathExpression(t,a,r,i,n)}function l(t,e,n,i,r,a){var s=i.charAt(3)||i.charAt(2),o="{"!==s&&"&"!==s;return new this.MustacheStatement(t,e,n,o,r,this.locInfo(a))}function u(t,e,n,i){if(t.path.original!==n){var r={loc:t.path.loc};throw new p["default"](t.path.original+" doesn't match "+n,r)}i=this.locInfo(i);var a=new this.Program([e],null,{},i);return new this.BlockStatement(t.path,t.params,t.hash,a,void 0,{},{},{},i)}function c(t,e,n,i,r,a){if(i&&i.path&&t.path.original!==i.path.original){var s={loc:t.path.loc};throw new p["default"](t.path.original+" doesn't match "+i.path.original,s)}e.blockParams=t.blockParams;var o=void 0,l=void 0;return n&&(n.chain&&(n.program.body[0].closeStrip=i.strip),l=n.strip,o=n.program),r&&(r=o,o=e,e=r),new this.BlockStatement(t.path,t.params,t.hash,e,o,t.strip,l,i&&i.strip,this.locInfo(a))}var h=n(8)["default"];e.__esModule=!0,e.SourceLocation=i,e.id=r,e.stripFlags=a,e.stripComment=s,e.preparePath=o,e.prepareMustache=l,e.prepareRawBlock=u,e.prepareBlock=c;var d=n(12),p=h(d)},function(t,e,n){function i(t,e,n){if(a.isArray(t)){for(var i=[],r=0,s=t.length;s>r;r++)i.push(e.wrap(t[r],n));return i}return"boolean"==typeof t||"number"==typeof t?t+"":t}function r(t){this.srcFile=t,this.source=[]}e.__esModule=!0;var a=n(13),s=void 0;try{}catch(o){}s||(s=function(t,e,n,i){this.src="",i&&this.add(i)},s.prototype={add:function(t){a.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){a.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),r.prototype={prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(t){for(var e=0,n=this.source.length;n>e;e++)t(this.source[e])},empty:function(){var t=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new s(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof s?t:(t=i(t,this,e),new s(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,n){return n=this.generateList(n),this.wrap([t,e?"."+e+"(":"(",n,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){var r=i(t[n],this);"undefined"!==r&&e.push([this.quotedString(n),":",r])}var a=this.generateList(e);return a.prepend("{"),a.add("}"),a},generateList:function(t,e){for(var n=this.empty(e),r=0,a=t.length;a>r;r++)r&&n.add(","),n.add(i(t[r],this,e));return n},generateArray:function(t,e){var n=this.generateList(t,e);return n.prepend("["),n.add("]"),n}},e["default"]=r,t.exports=e["default"]}])}),define("hbs/underscore",[],function(){function t(e,n,i){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;if(e._chain&&(e=e._wrapped),n._chain&&(n=n._wrapped),e.isEqual&&b.isFunction(e.isEqual))return e.isEqual(n);if(n.isEqual&&b.isFunction(n.isEqual))return n.isEqual(e);var r=o.call(e);if(r!=o.call(n))return!1;switch(r){case"[object String]":return e==String(n);case"[object Number]":return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if("object"!=typeof e||"object"!=typeof n)return!1;for(var a=i.length;a--;)if(i[a]==e)return!0;i.push(e);var s=0,l=!0;if("[object Array]"==r){if(s=e.length,l=s==n.length)for(;s--&&(l=s in e==s in n&&t(e[s],n[s],i)););}else{if("constructor"in e!="constructor"in n||e.constructor!=n.constructor)return!1;for(var u in e)if(b.has(e,u)&&(s++,!(l=b.has(n,u)&&t(e[u],n[u],i))))break;if(l){for(u in n)if(b.has(n,u)&&!s--)break;
l=!s}}return i.pop(),l}var e={},n=Array.prototype,i=Object.prototype,r=Function.prototype,a=n.slice,s=n.unshift,o=i.toString,l=i.hasOwnProperty,u=n.forEach,c=n.map,h=n.reduce,d=n.reduceRight,p=n.filter,f=n.every,m=n.some,g=n.indexOf,y=n.lastIndexOf,v=Array.isArray,_=Object.keys,S=r.bind,b=function(t){return new I(t)};b.VERSION="1.3.3";var w=b.each=b.forEach=function(t,n,i){if(null!=t)if(u&&t.forEach===u)t.forEach(n,i);else if(t.length===+t.length){for(var r=0,a=t.length;a>r;r++)if(r in t&&n.call(i,t[r],r,t)===e)return}else for(var s in t)if(b.has(t,s)&&n.call(i,t[s],s,t)===e)return};b.map=b.collect=function(t,e,n){var i=[];return null==t?i:c&&t.map===c?t.map(e,n):(w(t,function(t,r,a){i[i.length]=e.call(n,t,r,a)}),t.length===+t.length&&(i.length=t.length),i)},b.reduce=b.foldl=b.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),h&&t.reduce===h)return i&&(e=b.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(w(t,function(t,a,s){r?n=e.call(i,n,t,a,s):(n=t,r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},b.reduceRight=b.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduceRight===d)return i&&(e=b.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var a=b.toArray(t).reverse();return i&&!r&&(e=b.bind(e,i)),r?b.reduce(a,e,n,i):b.reduce(a,e)},b.find=b.detect=function(t,e,n){var i;return P(t,function(t,r,a){return e.call(n,t,r,a)?(i=t,!0):void 0}),i},b.filter=b.select=function(t,e,n){var i=[];return null==t?i:p&&t.filter===p?t.filter(e,n):(w(t,function(t,r,a){e.call(n,t,r,a)&&(i[i.length]=t)}),i)},b.reject=function(t,e,n){var i=[];return null==t?i:(w(t,function(t,r,a){e.call(n,t,r,a)||(i[i.length]=t)}),i)},b.every=b.all=function(t,n,i){var r=!0;return null==t?r:f&&t.every===f?t.every(n,i):(w(t,function(t,a,s){return(r=r&&n.call(i,t,a,s))?void 0:e}),!!r)};var P=b.some=b.any=function(t,n,i){n||(n=b.identity);var r=!1;return null==t?r:m&&t.some===m?t.some(n,i):(w(t,function(t,a,s){return r||(r=n.call(i,t,a,s))?e:void 0}),!!r)};b.include=b.contains=function(t,e){var n=!1;return null==t?n:g&&t.indexOf===g?-1!=t.indexOf(e):n=P(t,function(t){return t===e})},b.invoke=function(t,e){var n=a.call(arguments,2);return b.map(t,function(t){return(b.isFunction(e)?e||t:t[e]).apply(t,n)})},b.pluck=function(t,e){return b.map(t,function(t){return t[e]})},b.max=function(t,e,n){if(!e&&b.isArray(t)&&t[0]===+t[0])return Math.max.apply(Math,t);if(!e&&b.isEmpty(t))return-(1/0);var i={computed:-(1/0)};return w(t,function(t,r,a){var s=e?e.call(n,t,r,a):t;s>=i.computed&&(i={value:t,computed:s})}),i.value},b.min=function(t,e,n){if(!e&&b.isArray(t)&&t[0]===+t[0])return Math.min.apply(Math,t);if(!e&&b.isEmpty(t))return 1/0;var i={computed:1/0};return w(t,function(t,r,a){var s=e?e.call(n,t,r,a):t;s<i.computed&&(i={value:t,computed:s})}),i.value},b.shuffle=function(t){var e,n=[];return w(t,function(t,i,r){e=Math.floor(Math.random()*(i+1)),n[i]=n[e],n[e]=t}),n},b.sortBy=function(t,e,n){var i=b.isFunction(e)?e:function(t){return t[e]};return b.pluck(b.map(t,function(t,e,r){return{value:t,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;return void 0===n?1:void 0===i?-1:i>n?-1:n>i?1:0}),"value")},b.groupBy=function(t,e){var n={},i=b.isFunction(e)?e:function(t){return t[e]};return w(t,function(t,e){var r=i(t,e);(n[r]||(n[r]=[])).push(t)}),n},b.sortedIndex=function(t,e,n){n||(n=b.identity);for(var i=0,r=t.length;r>i;){var a=i+r>>1;n(t[a])<n(e)?i=a+1:r=a}return i},b.toArray=function(t){return t?b.isArray(t)?a.call(t):b.isArguments(t)?a.call(t):t.toArray&&b.isFunction(t.toArray)?t.toArray():b.values(t):[]},b.size=function(t){return b.isArray(t)?t.length:b.keys(t).length},b.first=b.head=b.take=function(t,e,n){return null==e||n?t[0]:a.call(t,0,e)},b.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},b.last=function(t,e,n){return null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},b.rest=b.tail=function(t,e,n){return a.call(t,null==e||n?1:e)},b.compact=function(t){return b.filter(t,function(t){return!!t})},b.flatten=function(t,e){return b.reduce(t,function(t,n){return b.isArray(n)?t.concat(e?n:b.flatten(n)):(t[t.length]=n,t)},[])},b.without=function(t){return b.difference(t,a.call(arguments,1))},b.uniq=b.unique=function(t,e,n){var i=n?b.map(t,n):t,r=[];return t.length<3&&(e=!0),b.reduce(i,function(n,i,a){return(e?b.last(n)===i&&n.length:b.include(n,i))||(n.push(i),r.push(t[a])),n},[]),r},b.union=function(){return b.uniq(b.flatten(arguments,!0))},b.intersection=b.intersect=function(t){var e=a.call(arguments,1);return b.filter(b.uniq(t),function(t){return b.every(e,function(e){return b.indexOf(e,t)>=0})})},b.difference=function(t){var e=b.flatten(a.call(arguments,1),!0);return b.filter(t,function(t){return!b.include(e,t)})},b.zip=function(){for(var t=a.call(arguments),e=b.max(b.pluck(t,"length")),n=new Array(e),i=0;e>i;i++)n[i]=b.pluck(t,""+i);return n},b.indexOf=function(t,e,n){if(null==t)return-1;var i,r;if(n)return i=b.sortedIndex(t,e),t[i]===e?i:-1;if(g&&t.indexOf===g)return t.indexOf(e);for(i=0,r=t.length;r>i;i++)if(i in t&&t[i]===e)return i;return-1},b.lastIndexOf=function(t,e){if(null==t)return-1;if(y&&t.lastIndexOf===y)return t.lastIndexOf(e);for(var n=t.length;n--;)if(n in t&&t[n]===e)return n;return-1},b.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,a=new Array(i);i>r;)a[r++]=t,t+=n;return a};var C=function(){};b.bind=function(t,e){var n,i;if(t.bind===S&&S)return S.apply(t,a.call(arguments,1));if(!b.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));C.prototype=t.prototype;var r=new C,s=t.apply(r,i.concat(a.call(arguments)));return Object(s)===s?s:r}},b.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=b.functions(t)),w(e,function(e){t[e]=b.bind(t[e],t)}),t},b.memoize=function(t,e){var n={};return e||(e=b.identity),function(){var i=e.apply(this,arguments);return b.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},b.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},b.defer=function(t){return b.delay.apply(b,[t,1].concat(a.call(arguments,1)))},b.throttle=function(t,e){var n,i,r,a,s,o,l=b.debounce(function(){s=a=!1},e);return function(){n=this,i=arguments;var u=function(){r=null,s&&t.apply(n,i),l()};return r||(r=setTimeout(u,e)),a?s=!0:o=t.apply(n,i),l(),a=!0,o}},b.debounce=function(t,e,n){var i;return function(){var r=this,a=arguments,s=function(){i=null,n||t.apply(r,a)};n&&!i&&t.apply(r,a),clearTimeout(i),i=setTimeout(s,e)}},b.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments))}},b.wrap=function(t,e){return function(){var n=[t].concat(a.call(arguments,0));return e.apply(this,n)}},b.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},b.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},b.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)b.has(t,n)&&(e[e.length]=n);return e},b.values=function(t){return b.map(t,b.identity)},b.functions=b.methods=function(t){var e=[];for(var n in t)b.isFunction(t[n])&&e.push(n);return e.sort()},b.extend=function(t){return w(a.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},b.pick=function(t){var e={};return w(b.flatten(a.call(arguments,1)),function(n){n in t&&(e[n]=t[n])}),e},b.defaults=function(t){return w(a.call(arguments,1),function(e){for(var n in e)null==t[n]&&(t[n]=e[n])}),t},b.clone=function(t){return b.isObject(t)?b.isArray(t)?t.slice():b.extend({},t):t},b.tap=function(t,e){return e(t),t},b.isEqual=function(e,n){return t(e,n,[])},b.isEmpty=function(t){if(null==t)return!0;if(b.isArray(t)||b.isString(t))return 0===t.length;for(var e in t)if(b.has(t,e))return!1;return!0},b.isElement=function(t){return!(!t||1!=t.nodeType)},b.isArray=v||function(t){return"[object Array]"==o.call(t)},b.isObject=function(t){return t===Object(t)},b.isArguments=function(t){return"[object Arguments]"==o.call(t)},b.isArguments(arguments)||(b.isArguments=function(t){return!(!t||!b.has(t,"callee"))}),b.isFunction=function(t){return"[object Function]"==o.call(t)},b.isString=function(t){return"[object String]"==o.call(t)},b.isNumber=function(t){return"[object Number]"==o.call(t)},b.isFinite=function(t){return b.isNumber(t)&&isFinite(t)},b.isNaN=function(t){return t!==t},b.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==o.call(t)},b.isDate=function(t){return"[object Date]"==o.call(t)},b.isRegExp=function(t){return"[object RegExp]"==o.call(t)},b.isNull=function(t){return null===t},b.isUndefined=function(t){return void 0===t},b.has=function(t,e){return l.call(t,e)},b.noConflict=function(){return root._=previousUnderscore,this},b.identity=function(t){return t},b.times=function(t,e,n){for(var i=0;t>i;i++)e.call(n,i)},b.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},b.result=function(t,e){if(null==t)return null;var n=t[e];return b.isFunction(n)?n.call(t):n},b.mixin=function(t){w(b.functions(t),function(e){F(e,b[e]=t[e])})};var k=0;b.uniqueId=function(t){var e=k++;return t?t+e:e},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,E={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var T in E)E[E[T]]=T;var A=/\\|'|\r|\n|\t|\u2028|\u2029/g,M=/\\(\\|'|r|n|t|u2028|u2029)/g,j=function(t){return t.replace(M,function(t,e){return E[e]})};b.template=function(t,e,n){n=b.defaults(n||{},b.templateSettings);var i="__p+='"+t.replace(A,function(t){return"\\"+E[t]}).replace(n.escape||x,function(t,e){return"'+\n_.escape("+j(e)+")+\n'"}).replace(n.interpolate||x,function(t,e){return"'+\n("+j(e)+")+\n'"}).replace(n.evaluate||x,function(t,e){return"';\n"+j(e)+"\n;__p+='"})+"';\n";n.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+i+"return __p;\n";var r=new Function(n.variable||"obj","_",i);if(e)return r(e,b);var a=function(t){return r.call(this,t,b)};return a.source="function("+(n.variable||"obj")+"){\n"+i+"}",a},b.chain=function(t){return b(t).chain()};var I=function(t){this._wrapped=t};b.prototype=I.prototype;var N=function(t,e){return e?b(t).chain():t},F=function(t,e){I.prototype[t]=function(){var t=a.call(arguments);return s.call(t,this._wrapped),N(e.apply(b,t),this._chain)}};return b.mixin(b),w(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];I.prototype[t]=function(){var n=this._wrapped;e.apply(n,arguments);var i=n.length;return"shift"!=t&&"splice"!=t||0!==i||delete n[0],N(n,this._chain)}}),w(["concat","join","slice"],function(t){var e=n[t];I.prototype[t]=function(){return N(e.apply(this._wrapped,arguments),this._chain)}}),I.prototype.chain=function(){return this._chain=!0,this},I.prototype.value=function(){return this._wrapped},b}),function(window){var JSON=window.JSON||{};!function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,r,a,s,o=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,n=0;a>n;n+=1)s[n]=str(n,l)||"null";return r=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,r}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],r=str(i,l),r&&s.push(quote(i)+(gap?": ":":")+r));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(r=str(i,l),r&&s.push(quote(i)+(gap?": ":":")+r));return r=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,i,r=t[e];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i=walk(r,n),void 0!==i?r[n]=i:delete r[n]);return reviver.call(t,e,r)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",["hbs/handlebars","hbs/underscore","hbs/json2"],function(t,e,n){function i(e,n,i){var r,a;return i=i||{},"data"in i||(i.data=!0),i.compat&&(i.useDepths=!0),r=t.parse(e),a=(new t.Compiler).compile(r,i),(new t.JavaScriptCompiler).compile(a,i)}var r,a,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=function(){throw new Error("Environment unsupported.")},l=[],u="w+",c="hbs",h="@hbs",d="/styles/",p="/demo-build/styles/",f="templates/helpers/",m="screen.build.css",g="onHbsRead";t.registerHelper("$",function(){}),"undefined"!=typeof window&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(a=function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return arguments[0]===!0?new XDomainRequest:new XMLHttpRequest;for(e=0;3>e;e++){n=s[e];try{t=new ActiveXObject(n)}catch(i){}if(t){s=[n];break}}if(!t)throw new Error("getXhr(): XMLHttpRequest not available");return t},getIEVersion=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(e)&&(t=parseFloat(RegExp.$1))}return t},o=function(t,e){var n=!1;if(0!=t.indexOf("http"))n=!1;else{var i="https"===t.substr(0,5)?8:7,r="https"===window.location.href.substr(0,5)?8:7,s=t.substr(i).split("/").shift(),o=getIEVersion();n=s!=window.location.href.substr(r).split("/").shift()&&o>=7}if(n){var l=a(!0);l.open("GET",t),l.onload=function(){e(l.responseText,t)},l.onprogress=function(){},l.ontimeout=function(){},l.onerror=function(){},setTimeout(function(){l.send()},0)}else{var u=a();u.open("GET",t,!0),u.onreadystatechange=function(n){4===u.readyState&&e(u.responseText,t)},u.send(null)}}):"undefined"!=typeof process&&process.versions&&process.versions.node?(r=require.nodeRequire("fs"),o=function(t,e){var n=r.readFileSync(t,"utf8")||"";n=n.replace(/^\uFEFF/,""),e(n,t)}):"undefined"!=typeof java&&"undefined"!=typeof java.io&&(o=function(t,e){for(var n,i=new java.io.FileInputStream(t),r=new java.io.InputStreamReader(i,"UTF-8"),a=new java.io.BufferedReader(r),s="";null!==(n=a.readLine());)s+=new String(n)+"\n";a.close(),e(s,t)});var y,v=[],_={},S=[];return{get:function(){return t},write:function(t,e,n){if(e+h in l){var i=l[e+h];n.asModule(t+"!"+e,i)}},version:"3.0.3",load:function(r,a,s,b){function w(t,n){return e(t).forEach(function(t){t&&t.type&&"PartialStatement"===t.type&&"SubExpression"!==t.name.type&&n.push(t.name.original),t&&t.program&&t.program.body&&w(t.program.body,n),t&&t.inverse&&t.inverse.body&&w(t.inverse.body,n)}),n}function P(t,n){var i=[];return t&&t.body&&(i=w(t.body,[])),n&&n.partials&&n.partials.length&&e(n.partials).forEach(function(t){i.push(t)}),e.unique(i)}function C(t){var e,i,r;if(t&&t.body&&(e=t.body[0],e&&"CommentStatement"===e.type))try{return i=e.value.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),r=n.parse(i),i}catch(a){return n.stringify({description:i})}return"{}"}function k(t){return!!("SubExpression"===t.type||t.params&&t.params.length||t.hash)}function x(t,n){k(t)&&"undefined"!=typeof t.path&&E(t.path.original,n),t&&t.params&&t.params.forEach(function(t){x(t,n)}),t&&t.hash&&t.hash.pairs&&e(t.hash.pairs).forEach(function(t){x(t.value,n)})}function E(e,n){"undefined"==typeof t.helpers[e]&&n.push(e)}function T(t,n,i,r){i=i?i+".":"";var a="";return e(t).forEach(function(t){var e;(k(t)||"MustacheStatement"===t.type)&&x(t,r),t&&t.mustache&&T([t.mustache],n,i+a,r),t&&t.program&&t.program.body&&(e=T([t.path],[],"",r)[0]||"",t.inverse&&t.inverse.body&&T(t.inverse.body,n,i+a+(e?i+a?"."+e:e:""),r),T(t.program.body,n,i+a+(e?i+a?"."+e:e:""),r))}),n}function A(t){var n=[],i=[];t&&t.body&&(n=T(t.body,[],void 0,i));var r=["helperMissing","blockHelperMissing","each","if","unless","with","log","lookup"];return{vars:e(n).chain().unique().map(function(t){return""===t?".":t.length&&"."===t[t.length-1]?t.substr(0,t.length-1)+"[]":t}).value(),helpers:e(i).chain().unique().map(function(t){return e(r).contains(t)?void 0:t}).compact().value()}}function M(t){for(var e=t.split("/"),n=0;n<e.length;n++)".."===e[n]?(delete e[n-1],delete e[n]):"."===e[n]&&delete e[n];return e.join("/").replace(/\/\/+/g,"/")}function j(h){o(R,function(o,h){var b,w,k,x,E,T=y.isBuild&&y[g]?y[g]:function(t,e,n){return n},j=t.parse(T(r,h,o)),R=C(j),B=A(j),O=B.vars,D=B.helpers||[],$="",q="",U="",z=[],H=r.substr(0,r.lastIndexOf("/")+1);if("{}"!==R)try{k=n.parse(R)}catch(W){console.log("couldn't parse meta for %s",h)}var V=P(j,k);y.hbs=y.hbs||{},y.hbs._partials=y.hbs._partials||{};for(var Y in V)if(V.hasOwnProperty(Y)&&"string"==typeof V[Y]){var J,G=V[Y];if(J=M(G.match(/^(\.|\/)+/)?H+G:F+G),L){if(h===a.toUrl(J))continue}else if(h===a.toUrl(J+"."+(y.hbs&&y.hbs.templateExtension?y.hbs.templateExtension:c)))continue;y.hbs._partials[J]=y.hbs._partials[J]||[],y.hbs._partials[J].references=y.hbs._partials[J].references||[],y.hbs._partials[J].references.push(G),y.hbs._loadedDeps=y.hbs._loadedDeps||{},z[Y]="hbs!"+J}if(b=z.join("', '"),D=D.concat(k&&k.helpers?k.helpers:[]),w=N?"":function(){var t,e=[],n=y.hbs&&y.hbs.helperPathCallback?y.hbs.helperPathCallback:function(t){return(y.hbs&&y.hbs.helperDirectory?y.hbs.helperDirectory:f)+t};for(t=0;t<D.length;t++)e[t]="'"+n(D[t],h)+"'";return e}().join(","),w&&(w=","+w),k)try{k.styles&&(v=e.union(v,k.styles),require.isBrowser&&!y.isBuild?(x=document.head||document.getElementsByTagName("head")[0],e(k.styles).forEach(function(t){_[t]||(E=document.createElement("link"),E.href=y.baseUrl+d+t+".css",E.media="all",E.rel="stylesheet",E.type="text/css",x.appendChild(E),_[t]=E)})):y.isBuild&&!function(){var t=require.nodeRequire("fs"),n=e(k.styles).map(function(t){return _[t]?"":(_[t]=!0,"@import url("+t+".css);\n")}).join("\n");t.open(__dirname+p+m,u,"0666",function(e,i){t.writeSync(i,n,null,encoding="utf8"),t.close(i)}),u="a"}())}catch(W){console.log("error injecting styles")}y.isBuild||y.serverRender||($="<!-- START - "+r+" -->",q="<!-- END - "+r+" -->",U="t.meta = "+R+";\nt.helpers = "+n.stringify(D)+";\nt.deps = "+n.stringify(z)+";\nt.vars = "+n.stringify(O)+";\n");var K=!1,Q=y.hbs||{},Z=e.extend(Q.compileOptions||{},{originalKeyFallback:Q.originalKeyFallback}),X=i(o,K,Z),tt="'hbs!"+r+"',";b&&(b=", '"+b+"'");var et=[];y.hbs._partials[r]&&(et=y.hbs._partials[r].references);var nt=y.hbs&&y.hbs.handlebarsPath?y.hbs.handlebarsPath:"hbs/handlebars";o="/* START_TEMPLATE */\ndefine("+tt+"['hbs','"+nt+"'"+b+w+"], function( hbs, Handlebars ){ \nvar t = Handlebars.template("+X+");\nHandlebars.registerPartial('"+r+"', t);\n";for(var Y=0;Y<et.length;Y++)o+="Handlebars.registerPartial('"+et[Y]+"', t);\n";o+=U+"return t;\n});\n/* END_TEMPLATE */\n",y.isBuild&&(l[I]=o),y.isBuild||(o+="\r\n//# sourceURL="+h),y.isBuild?(s.fromText(r,o),a([r],function(t){s(t)})):a(z,function(){s.fromText(o),a([r],function(t){s(t)})}),y.removeCombined&&h&&S.push(h)})}y=y||b;var I=r+h;y.hbs=y.hbs||{};var N=0==y.hbs.helpers,F="";y.hbs.partialsUrl&&(F=y.hbs.partialsUrl,F.match(/\/$/)||(F+="/")),y.hbs.fetchText&&(o=y.hbs.fetchText);var R,L=y.hbs&&y.hbs.templateExtension===!1;R=L?a.toUrl(r):a.toUrl(r+"."+(y.hbs&&y.hbs.templateExtension?y.hbs.templateExtension:c)),j(!1)},onLayerEnd:function(){y.removeCombined&&r&&S.forEach(function(t){r.existsSync(t)&&r.unlinkSync(t)})}}}),define("hbs!$app/templates/megaphone_tasks_holder",["hbs","hbs/handlebars"],function(t,e){var n=e.template({1:function(t,e,n,i){var r,a;return'  <li class="js-megaphone-task megaphone-task" data-megaphone-task="'+this.escapeExpression((a=null!=(a=e.task||(null!=t?t.task:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"task",hash:{},data:i}):a))+'">\n    <a href="#" class="megaphone-task-dismiss js-megaphone-task-dismiss"><i class="gi gi-close"></i></a>\n    '+(null!=(a=null!=(a=e.html||(null!=t?t.html:t))?a:e.helperMissing,r="function"==typeof a?a.call(t,{name:"html",hash:{},data:i}):a)?r:"")+"\n  </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return null!=(r=e.each.call(t,null!=t?t.tasks:t,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:""},useData:!0});return e.registerPartial("$app/templates/megaphone_tasks_holder",n),n}),function(t){function e(e,n){this.$element=t(e),this.options=n,this.enabled=!0,this.fixTitle()}e.prototype={show:function(){var e=this.getTitle();if(e&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](e),n[0].className="tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var i,r=t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),a=n[0].offsetWidth,s=n[0].offsetHeight,o="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity;switch(o.charAt(0)){case"n":i={top:r.top+r.height+this.options.offset,left:r.left+r.width/2-a/2};break;case"s":i={top:r.top-s-this.options.offset,left:r.left+r.width/2-a/2};break;case"e":i={top:r.top+r.height/2-s/2,left:r.left-a-this.options.offset};break;case"w":i={top:r.top+r.height/2-s/2,left:r.left+r.width+this.options.offset}}2==o.length&&("w"==o.charAt(1)?i.left=r.left+r.width/2-15:i.left=r.left+r.width/2-a+15),n.css(i).addClass("tipsy-"+o),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):n.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){t(this).remove()}):this.tip().remove()},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("original-title"))&&t.attr("original-title",t.attr("title")||"").removeAttr("title")},getTitle:function(){var t,e=this.$element,n=this.options;this.fixTitle();var t,n=this.options;return"string"==typeof n.title?t=e.attr("title"==n.title?"original-title":n.title):"function"==typeof n.title&&(t=n.title.call(e[0])),t=(""+t).replace(/(^\s*|\s*$)/,""),t||n.fallback},tip:function(){return this.$tip||(this.$tip=t('<div class="tipsy"></div>').html('<div class="tipsy-inner"></div><div class="tipsy-arrow"></div>')),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},t.fn.tipsy=function(n){function i(i){var r=t.data(i,"tipsy");return r||(r=new e(i,t.fn.tipsy.elementOptions(i,n)),t.data(i,"tipsy",r)),r}function r(){var t=i(this);t.hoverState="in",0==n.delayIn?t.show():(t.fixTitle(),setTimeout(function(){"in"==t.hoverState&&t.show()},n.delayIn))}function a(){var t=i(this);t.hoverState="out",0==n.delayOut?t.hide():setTimeout(function(){"out"==t.hoverState&&t.hide()},n.delayOut)}if(n===!0)return this.data("tipsy");if("string"==typeof n){var s=this.data("tipsy");return s&&s[n](),this}if(n=t.extend({},t.fn.tipsy.defaults,n),n.live||this.each(function(){i(this)}),"manual"!=n.trigger){var o=n.live?"live":"bind",l="hover"==n.trigger?"mouseenter":"focus",u="hover"==n.trigger?"mouseleave":"blur";this[o](l,r)[o](u,a)}return this},t.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:1,title:"title",trigger:"hover"},t.fn.tipsy.elementOptions=function(e,n){return t.metadata?t.extend({},n,t(e).metadata()):n},t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"},t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"}}(jQuery),define("$vendor/jquery.tipsy",function(){}),define("$app/ui/megaphone/dropdown",["flight/lib/component","hbs!$app/templates/megaphone_tasks_holder","$vendor/jquery.tipsy"],function(t,e){function n(){this.defaultAttrs({taskSelector:".js-megaphone-task",actionSelector:".js-megaphone-action",trackingSelector:".js-megaphone-task a:not(.js-megaphone-task-dismiss)",taskListSelector:".js-megaphone-tasks",defaultMessageSelector:".js-megaphone-default-message",viewMoreGuidesSelector:'.js-megaphone-default-message a[data-megaphone-action="uiNeedsToGoToGuides"]',taskDismissSelector:".js-megaphone-task-dismiss",megaphoneDropdownSelector:".js-megaphone-dropdown",taskCounterSelector:".js-megaphone-task-counter",taskCountSelector:".js-megaphone-task-count",actionDataField:"megaphone-action",taskDataField:"megaphone-task",megaphoneDropdownTriggerSelector:".js-megaphone-dropdown-trigger",greeterDismissedTooltipSelector:".js-greeter-dismissed-tooltip"}),this.getCurrentTaskCount=function(){return parseInt(this.select("taskCountSelector").html())},this.setCurrentTaskCount=function(t){this.select("taskCountSelector").html(t)},this.enableDropdown=function(){this.select("megaphoneDropdownTriggerSelector").removeClass("disabled")},this.parentHasChild=function(t,e){return-1!=e.parents().index(t)},this.toggleDropdown=function(t){var e=this.select("megaphoneDropdownSelector"),n=$(this.attr.greeterDismissedTooltipSelector);return this.select("megaphoneDropdownTriggerSelector").hasClass("disabled")?!1:(n.is(":visible")&&n.hide(),this.parentHasChild(e,$(t.target))?void 0:(this.select("megaphoneDropdownTriggerSelector").tipsy("hide"),this.$node.toggleClass("open"),this.$node.hasClass("open")&&this.trigger("uiNeedsToTrackUserActionEvent",{name:"megaphone_dropdown_open"}),this.trigger("uiNeedsToHideOtherDropdowns"),!1))},this.hideDropdown=function(){this.$node.removeClass("open")},this.hideDropdownWhenUnfocused=function(t){var e=this.select("megaphoneDropdownSelector");this.parentHasChild(e,$(t.target))||this.$node.removeClass("open")},this.toggleNoTasksDisplay=function(){this.select("taskCounterSelector").toggleClass("no-tasks"),this.select("defaultMessageSelector").fadeToggle(600),this.select("taskListSelector").fadeToggle(600)},this.selectMegaphoneTask=function(t){return this.select("taskSelector").filter("[data-"+this.attr.taskDataField+"="+t+"]")},this.dismissMegaphoneTask=function(t){t.preventDefault();var e=$(t.target).closest(this.attr.taskSelector).data(this.attr.taskDataField);return this.trigger("uiNeedsToDismissMegaphoneTask",{megaphone_task:e}),this.trigger("uiNeedsToTrackUserActionEvent",{name:"megaphone_dropdown_dismiss_task_"+e}),!1},this.hideDismissedMegaphoneTask=function(t,e){var n=this.selectMegaphoneTask(e.megaphone_task);n.css({opacity:0}),setTimeout(function(){n.hide(),this.trigger("uiNeedsToGetMegaphoneTasks")}.bind(this),300)},this.completeMegaphoneTask=function(t,e){var n=this.selectMegaphoneTask(e.megaphone_task);n.addClass("completed"),this.setCurrentTaskCount(this.getCurrentTaskCount()-1),this.trigger("uiNeedsToTrackUserActionEvent",{name:"megaphone_complete_task_"+e.megaphone_task})},this.dispatchMegaphoneAction=function(t){t.preventDefault();var e=$(t.target).data(this.attr.actionDataField),n=e+"WithMegaphone";return"undefined"!=typeof e&&this.trigger(n),!1},this.trackMegaphoneAction=function(t){var e=$(t.target).data(this.attr.actionDataField);"undefined"!=typeof e&&this.trigger("uiNeedsToTrackUserActionEvent",{name:"megaphone_dropdown_action_"+e})},this.resetMegaphoneTasks=function(t,n){this.setCurrentTaskCount(n.tasks.length),0==n.tasks.length?this.toggleNoTasksDisplay():this.select("taskListSelector").html(e(n))},this.after("initialize",function(){this.on("click",this.toggleDropdown),this.on("html","click",this.hideDropdownWhenUnfocused),this.on("click",{actionSelector:this.dispatchMegaphoneAction,trackingSelector:this.trackMegaphoneAction,viewMoreGuidesSelector:this.trackMegaphoneAction,taskDismissSelector:this.dismissMegaphoneTask}),this.on(document,"dataDismissedMegaphoneTask",this.hideDismissedMegaphoneTask),this.on(document,"dataCompletedMegaphoneTask",this.completeMegaphoneTask),this.on(document,"uiNeedsToEnableDropdown",this.enableDropdown),this.on(document,"uiHideMegaphone",this.hideDropdown),this.on(document,"dataMegaphoneTasks",this.resetMegaphoneTasks)})}return t(n)}),define("$app/ui/megaphone/tasks/add_a_product",["flight/lib/component"],function(t){function e(){this.maybeGoToDashboard=function(){this.$node.attr("href")!=window.location.pathname?window.location.pathname=this.$node.attr("href"):(this.trigger("uiFocusNewProductNameField"),this.trigger("uiHideMegaphone"))},this.after("initialize",function(){this.on(document,"uiAddAProductWithMegaphone",this.maybeGoToDashboard)})}return t(e)}),define("$app/ui/megaphone/tasks/confirm_email_address",["flight/lib/component"],function(t){function e(){this.defaultAttrs({loadingTextField:"loading",defaultTextField:"default"}),this.setLoadingText=function(){var t=this.$node;t.data(this.attr.defaultTextField,t.text()),t.text(t.data(this.attr.loadingTextField))},this.setDefaultText=function(){this.$node.text(this.$node.data(this.attr.defaultTextField))},this.resendConfirmationEmail=function(){this.setLoadingText(),this.trigger("uiNeedsToResendConfirmationEmailWithMegaphone")},this.finishSendingConfirmationEmail=function(t,e){this.setDefaultText(),e.success?this.trigger("uiShowFlashMessage",{message:I18n.t("js.resend_confirmation_done")}):this.trigger("uiShowFlashMessage",{message:I18n.t("js.resend_confirmation_failure")})},this.after("initialize",function(){this.on(document,"uiResendConfirmationEmailWithMegaphone",this.resendConfirmationEmail),this.on(document,"dataResentConfirmationEmailWithMegaphone",this.finishSendingConfirmationEmail)})}return t(e)}),define("$app/data/megaphone/main",["flight/lib/component"],function(t){function e(){this.dismissMegaphoneTask=function(t,e){$.ajax({type:"POST",dataType:"JSON",url:Routes.megaphone_dismiss_path(),data:e}).done(function(t){t.success?this.trigger("dataDismissedMegaphoneTask",e):this.trigger("uiShowFlashMessage",{message:I18n.t("js.something_went_wrong")})}.bind(this))},this.getMegaphoneTasks=function(){$.ajax({type:"GET",dataType:"JSON",url:Routes.megaphone_tasks_path()}).done(function(t){t.success&&this.trigger("dataMegaphoneTasks",t)}.bind(this))},this.after("initialize",function(){this.on("uiNeedsToDismissMegaphoneTask",this.dismissMegaphoneTask),this.on("uiNeedsToGetMegaphoneTasks",this.getMegaphoneTasks)})}return t(e)}),/*!
 * jQuery OAuth via popup window plugin
 *
 * @author  Nobu Funaki @zuzara
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
function(t){t.oauthpopup=function(e){if(!e||!e.path)throw new Error("options.path must not be empty");e=t.extend({windowName:"ConnectWithOAuth",windowOptions:"location=0,status=0,width=800,height=400",callback:function(){window.location.reload()}},e);var n=window.open(e.path,e.windowName,e.windowOptions),i=window.setInterval(function(){n.closed&&(window.clearInterval(i),e.callback())},1e3)}}(jQuery),define("$vendor/jquery.oauthpopup",function(){}),define("$app/utils/with_social_connect",["$vendor/jquery.oauthpopup"],function(){function t(){this.defaultAttrs({twitterPath:"/users/auth/twitter?state=async_link_twitter_account"}),this.getPermissionStatusFromFBResponse=function(t,e){return"undefined"==typeof t.error&&"undefined"!=typeof t.data&&"undefined"!=typeof t.data[0]?!!t.data[0][e]:void 0},this.persistFacebookAccessToken=function(t){return $.ajax({type:"POST",dataType:"JSON",url:Routes.ajax_facebook_access_token_path(),data:{accessToken:t}}),!1},this.connectFacebook=function(t){var e=this;FB.login(function(n){var i,r=!0;n&&n.authResponse?(i=n.authResponse.accessToken,FB.api("me/permissions",function(n){n&&"undefined"==typeof n.error?($.each(t.verifyPermissions||[],function(t,i){r=r&&e.getPermissionStatusFromFBResponse(n,i)}),r?(e.persistFacebookAccessToken(i),t.success()):t.failure()):t.failure()})):t.failure()},t.facebookOptions||{})},this.connectTwitter=function(t){var e={path:this.attr.twitterPath,callback:function(){$.ajax({type:"GET",url:Routes.check_twitter_link_path(),dataType:"JSON"}).done(function(e){e.success?t.success():t.failure()})}};$.oauthpopup(e)}}return t}),define("$app/data/megaphone/tasks/connect_social_account",["flight/lib/component","$app/utils/with_social_connect"],function(t,e){function n(){this.authWithFacebook=function(){var t=this,e={success:function(){t.trigger(document,"dataCompletedMegaphoneTask",{megaphone_task:"connect_social_account"})},failure:function(){t.trigger("uiShowFlashMessage",{message:I18n.t("js.something_went_wrong")})},facebookOptions:{scope:"email,manage_pages"}};this.connectFacebook(e)},this.authWithTwitter=function(){var t=this,e={success:function(){t.trigger(document,"dataCompletedMegaphoneTask",{megaphone_task:"connect_social_account"})},failure:function(){t.trigger("uiShowFlashMessage",{message:I18n.t("js.something_went_wrong")})}};this.connectTwitter(e)},this.after("initialize",function(){this.on(document,"uiNeedsToConnectFacebookWithMegaphone",this.authWithFacebook),this.on(document,"uiNeedsToConnectTwitterWithMegaphone",this.authWithTwitter)})}return t(n,e)}),define("$app/data/megaphone/tasks/confirm_email_address",["flight/lib/component"],function(t){function e(){this.resendConfirmationEmail=function(){$.ajax({type:"POST",dataType:"JSON",url:Routes.resend_confirmation_settings_path()}).done(function(t){this.trigger("dataResentConfirmationEmailWithMegaphone",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToResendConfirmationEmailWithMegaphone",this.resendConfirmationEmail)})}return t(e)}),define("$app/utils/megaphone_setup",["$app/ui/megaphone/dropdown","$app/ui/megaphone/tasks/add_a_product","$app/ui/megaphone/tasks/confirm_email_address","$app/data/megaphone/main","$app/data/megaphone/tasks/connect_social_account","$app/data/megaphone/tasks/confirm_email_address"],function(t,e,n,i,r,a){function s(){t.attachTo(".js-megaphone-group"),i.attachTo(document),e.attachTo('.js-megaphone-action[data-megaphone-action="uiAddAProduct"]'),n.attachTo('.js-megaphone-action[data-megaphone-action="uiResendConfirmationEmail"]'),r.attachTo(document),a.attachTo(document)}return s}),define("$app/utils/with_event",["$app/utils/with_url","flight/lib/compose"],function(t,e){function n(){e.mixin(this,[t]),this.getPluginNames=function(){for(var t=[],e=0;e<navigator.plugins.length;e++)t.push(navigator.plugins[e].name);return t.join()},this.getReferrer=function(){var t=this.getUrlParams().referrer&&this.getUrlParams().referrer.length>0?this.getUrlParams().referrer:void 0;return t||document.referrer||"direct"},this.getSource=function(){return this.getUrlParams().src?this.getUrlParams().src:void 0}}return n}),define("$app/data/event",["flight/lib/component","$app/utils/with_event"],function(t,e){function n(){this.trackProductSpecificEvent=function(t,e){$.ajax({type:"POST",data:{event_name:e.name,referrer:this.attr.referrer,plugins:this.attr.pluginNames,is_modal:this.attr.isModal,from_profile:this.attr.fromProfile,from_multi_overlay:this.attr.fromMultiOverlay,source:this.attr.source,was_product_recommended:!!e.wasProductRecommended,view_url:window.location.pathname},url:Routes.track_user_action_link_path(e.permalink),dataType:"json"})},this.trackViewEvent=function(t,e){$.ajax({type:"POST",url:Routes.increment_views_link_path(e.permalink),data:{is_modal:this.attr.isModal,plugins:this.attr.pluginNames,referrer:this.attr.referrer,got_cookies:navigator.cookieEnabled,from_profile:this.attr.fromProfile,from_multi_overlay:this.attr.fromMultiOverlay,source:this.attr.source,was_product_recommended:!!e.wasProductRecommended,recommended_by:e.recommendedBy,window_location:window.location.toString(),view_url:window.location.pathname},dataType:"json"})},this.trackUserActionEvent=function(t,e){$.ajax({type:"POST",data:{event_name:e.name,referrer:this.attr.referrer,plugins:this.attr.pluginNames,is_modal:this.attr.isModal,from_multi_overlay:this.attr.fromMultiOverlay,from_profile:this.attr.fromProfile,source:this.attr.source,view_url:window.location.pathname},url:Routes.events_track_user_action_path(),dataType:"json"})},this.after("initialize",function(){this.attr.pluginNames=this.getPluginNames(),this.attr.referrer=this.getReferrer(),this.attr.source=this.getSource(),this.attr.isModal=!!window.location.search.match(/as_modal/)&&top!=self,this.attr.fromProfile="user_page"===$("body").attr("id"),this.attr.fromMultiOverlay="overlay-page"===$("body").attr("id"),this.on(document,"uiNeedsToTrackProductSpecificEvent",this.trackProductSpecificEvent),this.on(document,"uiNeedsToTrackViewEvent",this.trackViewEvent),this.on(document,"uiNeedsToTrackUserActionEvent",this.trackUserActionEvent)})}return t(n,e)}),define("$app/utils/base_page",["$app/ui/shared/flash_message","$app/ui/shared/link_with_event_tracking","$app/ui/shared/click_to_select","$app/ui/shared/tippable_elements","$app/ui/shared/upgrade_gate_triggers","$app/ui/shared/input_placeholders","$app/ui/shared/input_prefixes","$app/ui/shared/javascript_loader","$app/ui/shared/with_navigation","$app/ui/shared/facebook_share","$app/ui/discover/search","$app/ui/discover/prompt","$app/utils/auth_modal_setup","$app/utils/megaphone_setup","$app/data/event"],function(t,e,n,i,r,a,s,o,l,u,c,h,d,p,f){var m={initialize:function(){$(document).ajaxSend(function(t,e,n){e.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}),f.attachTo(document),t.attachTo(".js-flash-message"),e.attachTo(".js-track-click-event"),n.attachTo(".click_to_select"),i.attachTo("body"),r.attachTo("body"),a.attachTo(":input[placeholder]"),s.attachTo(".input-prefix"),o.attachTo(".js-javascript-loader-indicator"),l.attachTo(".js-navigation"),c.attachTo(".js-discover-search"),h.attachTo(".js-discover-prompt"),u.attachTo(".js-facebook-share-trigger"),d(),p()}};return m}),define("$app/data/boostable_retargeting",["flight/lib/component"],function(t){function e(){this.defaultAttrs({cart:[],enabled:!1,boostableIdSelector:'meta[property="gr:boostable_id"]'}),this.initializeBoostJS=function(t){window.bst||(window.bst=t=function(){t.event?t.event.apply(t,arguments):t.q.push(arguments)},t.q=[],t.v="2.0",t.document=Date.now());var e=document.createElement("script");e.src="https://cdn.boostable.com/tr.js",e.async=!0,document.head.appendChild(e),bst("init",$(this.attr.boostableIdSelector).attr("value"))},this.enableRetargeting=function(){this.attr.enabled||(this.attr.enabled=!0,this.initializeBoostJS())},this.ecommerceItem=function(t){return{sku:t.externalId,name:t.name,category:t.vertical,cost:t.price,currency:t.currency,quantity:t.quantity||1}},this.removeFromCart=function(t){if(1==this.attr.cart.length)this.attr.cart=[];else for(var e=0;e<this.attr.cart.length;e++)this.attr.cart[e].sku==t.externalId&&this.attr.cart.splice(e,1)},this.addToCart=function(t){this.attr.cart.push(t)},this.getItemFromCart=function(t){if(1==this.attr.cart.length)return this.attr.cart[0];for(var e=0;e<this.attr.cart.length;e++)if(this.attr.cart[e].sku==t)return this.attr.cart[e];return{}},this.trackECommerceView=function(t,e){"undefined"!=typeof bst&&this.attr.enabled&&bst("view",this.ecommerceItem(e))},this.trackECommerceCart=function(t,e){"undefined"!=typeof bst&&this.attr.enabled&&("add"==e.cartAction?this.addToCart(this.ecommerceItem(e)):this.removeFromCart(e),bst("cart",this.attr.cart))},this.trackECommerceOrder=function(t,e){if("undefined"!=typeof bst&&this.attr.enabled){var n=this.getItemFromCart(e.productExternalId),i={id:e.externalId,total:e.total,subTotal:e.total-e.shipping-e.tax,tax:e.tax,shipping:e.shipping,currency:e.currency,cart:n};bst("purchase",i)}},this.after("initialize",function(){this.on(document,"uiNeedsToEnableRetargeting",this.enableRetargeting),this.on(document,"uiNeedsToTrackECommerceView",this.trackECommerceView),this.on(document,"uiNeedsToTrackECommerceCartUpdate",this.trackECommerceCart),this.on(document,"uiNeedsToTrackECommerceOrder",this.trackECommerceOrder)})}return t(e)}),define("hbs!$app/templates/bundled_product_list_entry",["hbs","hbs/handlebars"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return'      <span class="quantity">\xd7 '+this.escapeExpression((r=null!=(r=e.quantity||(null!=t?t.quantity:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"quantity",hash:{},data:i}):r))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r,a;return'<li data-unique-permalink="'+this.escapeExpression((a=null!=(a=e.permalink||(null!=t?t.permalink:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"permalink",hash:{},data:i}):a))+'" data-price="'+this.escapeExpression((a=null!=(a=e.formattedPrice||(null!=t?t.formattedPrice:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"formattedPrice",hash:{},data:i}):a))+'" data-sha="'+this.escapeExpression((a=null!=(a=e.sha||(null!=t?t.sha:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"sha",hash:{},data:i}):a))+'">\n  <a href="#" class="button button-close"><i class="icn close small"></i></a>\n  <span class="name">\n    '+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+"\n\n"+(null!=(r=e["if"].call(t,null!=t?t.showQuantity:t,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'  </span>\n  <span class="price-tag"><strong>'+this.escapeExpression((a=null!=(a=e.currency||(null!=t?t.currency:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"currency",hash:{},data:i}):a))+this.escapeExpression((a=null!=(a=e.formattedPrice||(null!=t?t.formattedPrice:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"formattedPrice",hash:{},data:i}):a))+"</strong></span>\n</li>\n"},useData:!0});return e.registerPartial("$app/templates/bundled_product_list_entry",n),n}),function(){define("$app/utils/with_sha",[],function(){function t(){this.convertHex=function(t){for(var e="",n=7;n>=0;n--){var i=t>>>4*n&15;e+=i.toString(16)}return e},this.rotateLeft=function(t,e){return t<<e|t>>>32-e},this.stringToSha=function(t){t=unescape(encodeURIComponent(t));var e,n,i,r,a,s,o,l,u=new Array(80),c=1732584193,h=4023233417,d=2562383102,p=271733878,f=3285377520,m=t.length,g=[];for(e=0;m-3>e;e+=4)n=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),g.push(n);switch(m%4){case 0:g.push(2147483648);break;case 1:g.push(t.charCodeAt(m-1)<<24|8388608);break;case 2:g.push(t.charCodeAt(m-2)<<24|t.charCodeAt(m-1)<<16|32768);break;case 3:g.push(t.charCodeAt(m-3)<<24|t.charCodeAt(m-2)<<16|t.charCodeAt(m-1)<<8|128)}for(;g.length%16!=14;)g.push(0);for(g.push(m>>>29),g.push(m<<3&4294967295),e=0;e<g.length;e+=16){for(n=0;16>n;n++)u[n]=g[e+n];for(n=16;79>=n;n++)u[n]=this.rotateLeft(u[n-3]^u[n-8]^u[n-14]^u[n-16],1);for(i=c,r=h,a=d,s=p,o=f,n=0;19>=n;n++)l=this.rotateLeft(i,5)+(r&a|~r&s)+o+u[n]+1518500249&4294967295,o=s,s=a,a=this.rotateLeft(r,30),r=i,i=l;for(n=20;39>=n;n++)l=this.rotateLeft(i,5)+(r^a^s)+o+u[n]+1859775393&4294967295,o=s,s=a,a=this.rotateLeft(r,30),r=i,i=l;for(n=40;59>=n;n++)l=this.rotateLeft(i,5)+(r&a|r&s|a&s)+o+u[n]+2400959708&4294967295,o=s,s=a,a=this.rotateLeft(r,30),r=i,i=l;for(n=60;79>=n;n++)l=this.rotateLeft(i,5)+(r^a^s)+o+u[n]+3395469782&4294967295,o=s,s=a,a=this.rotateLeft(r,30),r=i,i=l;c=c+i&4294967295,h=h+r&4294967295,d=d+a&4294967295,p=p+s&4294967295,f=f+o&4294967295}return(this.convertHex(c)+this.convertHex(h)+this.convertHex(d)+this.convertHex(p)+this.convertHex(f)).toLowerCase()}}return t})}(),define("$app/ui/shared/with_bundled_product_list",["flight/lib/compose","hbs!$app/templates/bundled_product_list_entry","$app/utils/with_sha"],function(t,e,n){function i(){t.mixin(this,[n]),this.defaultAttrs({bundledProductListSelector:".js-bundled-product-list",bundledProductListEntrySelector:".js-bundled-product-list li",bundledProductListCloseSelector:".js-bundled-product-list .button-close"}),this.appendBundledProductListEntry=function(t,n){delete n.sha,n.sha=this.stringToSha(JSON.stringify(n)),this.select("bundledProductListSelector").append(e(n)),this.trigger("uiNeedsToAddProductToPersistentBundle",n)},this.removeSelectedProductListEntry=function(t){var e=$(t.target).closest("li");this.removeBundledProductListEntry(e),this.trigger(document,"uiResizeCheckoutArea"),this.trigger("uiNeedsToRemoveProductFromPersistentBundle",{sha:e.data("sha")})},this.removeBundledProductListEntry=function(t){t.length>0&&(this.trigger("removeProductFromBundle",{index:t.index()}),t.remove())},this.resetBundledProductList=function(){this.select("bundledProductListSelector").empty(),this.trigger("uiNeedsToPopulateBundledListFromActiveList")},this.after("initialize",function(){this.on(document,"uiAddProductToBundledList",this.appendBundledProductListEntry),this.on(document,"uiNeedsToResetBundledList",this.resetBundledProductList),this.on("click",{bundledProductListCloseSelector:this.removeSelectedProductListEntry})})}return i}),function(){define("$app/utils/with_cookies",[],function(){function t(){this.readCookie=function(t){for(var e=document.cookie.split(";"),n=0;n<e.length;n++){var i=e[n].split("="),r=i[0].trim(),a=i[1];if(r===t&&"undefined"!=typeof a)try{return JSON.parse(decodeURIComponent(a))}catch(s){this.writeCookie(t,"")}}return!1},this.writeCookie=function(t,e){document.cookie=t+"="+encodeURIComponent(JSON.stringify(e))}}return t})}(),function(){define("$app/ui/shared/with_persistent_bundle",["flight/lib/compose","$app/utils/with_cookies","$app/utils/with_sha"],function(t,e,n){function i(){t.mixin(this,[e,n]),this.defaultAttrs({cookieName:"gumroad-bundle",activeProducts:{}}),this.addEntryToBundle=function(t,e){this.attr.activeProducts[e.sha]||(this.attr.activeProducts[e.sha]=[]),this.attr.activeProducts[e.sha].push(e),this.updateBundle()},this.addProductsFromActiveList=function(){var t=$.extend({},this.attr.activeProducts);this.attr.activeProducts={};for(var e in t)this.addProductsFromList(t[e])},this.addProductsFromList=function(t){$.each(t,function(t,e){e.externalId&&(this.trigger("uiAddProductToBundledList",e),this.trigger("addProductToBundle",e))}.bind(this))},this.findBundle=function(){var t=this.readCookie(this.attr.cookieName);t&&t.products&&this.addProductsFromList(t.products)},this.removeEntryFromBundle=function(t,e){this.attr.activeProducts[e.sha]&&(this.attr.activeProducts[e.sha].splice(-1,1),0===this.attr.activeProducts[e.sha].length&&delete this.attr.activeProducts[e.sha]),this.updateBundle()},this.updatePurchasedProduct=function(t,e){e.success&&this.removeEntryFromBundle(null,e)},this.updateBundle=function(t,e){var n=[];for(var i in this.attr.activeProducts)n=n.concat(this.attr.activeProducts[i]);this.writeBundleCookie(null,{products:n})},this.writeBundleCookie=function(t,e){$.each(e.products,function(t,e){e.serializedForm=null}),this.writeCookie(this.attr.cookieName,e)},this.after("initialize",function(){this.on(document,"uiNeedsToSetPersistentBundle",this.writeBundleCookie),this.on(document,"uiNeedsToGetPersistentBundle",this.findBundle),this.on(document,"uiNeedsToRemoveProductFromPersistentBundle",this.removeEntryFromBundle),this.on(document,"uiNeedsToAddProductToPersistentBundle",this.addEntryToBundle),this.on(document,"uiBundledProductPaymentCompleted",this.updatePurchasedProduct),this.on(document,"uiNeedsToPopulateBundledListFromActiveList",this.addProductsFromActiveList)})}return i})}(),define("$app/ui/product/third_party_analytics",["flight/lib/component"],function(t){function e(){this.defaultAttrs({metaAnalyticsURLSelector:'meta[property="gr:third_party_analytics_url"]'}),this.addIFrameWithAnalytics=function(t,e){if(Modernizr.sandbox){var n=document.createElement("IFRAME");n.setAttribute("hidden",!0),n.setAttribute("sandbox","allow-scripts"),n.setAttribute("id","third-party-analytics-iframe"),n.setAttribute("src",$(this.attr.metaAnalyticsURLSelector).attr("value")+Routes.third_party_analytics_path({link_id:e.permalink,purchase_id:e.purchase_id})),document.body.appendChild(n)}},this.after("initialize",function(){this.on(this.$node,"uiToAddThirdPartyAnalytics",this.addIFrameWithAnalytics)})}return t(e)}),define("$app/ui/shared/with_shipping_form",[],function(){function t(){this.defaultAttrs({statePlaceholder:[I18n.t("js.state"),I18n.t("js.county")],zipCodePlaceholder:[I18n.t("js.zip_code"),I18n.t("js.postal")],multiColumnHolderSelector:".js-multi-column-holder"}),this.currentStateField=function(){return this.attr.usingStateDropdown?this.select("stateSelectorDropDown"):this.select("stateSelectorText")},this.updateStateAndZipCode=function(){var t=this.select("countrySelector").val(),e="United States"==t||"Philippines"==t?0:1,n=this.currentStateField(),i=this.select("zipCodeSelector");n.attr({placeholder:this.attr.statePlaceholder[e]}),i.attr({placeholder:this.attr.zipCodePlaceholder[e]}),"United States"==t?this.useStateDropdown():this.useStateTextBox()},this.useStateDropdown=function(){this.usingStateDropdown=!0,this.select("stateSelectorDropDown").show().attr("name",this.attr.stateInputName).addClass("required"),this.select("stateSelectorText").hide().attr("name","").removeClass("required"),this.select("multiColumnHolderSelector").removeClass("no-dropdown")},this.useStateTextBox=function(){this.usingStateDropdown=!1,this.select("stateSelectorDropDown").hide().attr("name","").removeClass("required"),this.select("stateSelectorText").show().attr("name",this.attr.shippingFormNoun+"[state]").addClass("required"),this.select("multiColumnHolderSelector").addClass("no-dropdown"),"purchase"==this.attr.shippingFormNoun&&this.select("stateSelectorText").val("")},this.after("initialize",function(){this.on(document,"uiNeedsToUpdateStateAndZipCode",this.updateStateAndZipCode)})}return t}),define("$app/ui/product/with_envelope",["$app/utils/with_url","$app/ui/shared/with_form_base","$app/ui/shared/with_shipping_form","flight/lib/compose"],function(t,e,n,i){function r(){i.mixin(this,[t,e,n]),this.defaultAttrs({envelopeSelector:".envelope",emailFieldsSelector:".envelope input[type=email]",emailSelector:".envelope input[name=email]",emailConfirmContainerSelector:".js-email-confirm-tool-tip",emailConfirmTriggerSelector:".js-confirm-email-trigger",emailDenyTriggerSelector:".js-deny-email-trigger",giftTriggerSelector:".gift-trigger",giftElementSelector:".gift-element",gifteeEmailSelector:".envelope input[name=giftee_email]",shippingInfoSelector:".shipping_information",shippingInformationSelector:".js-shipping-information-container",keepOnFileHolderSelector:".js-keep-on-file-holder",countrySelector:".purchase_country",streetSelector:".purchase_street_address",citySelector:".purchase_city",stateSelectorDropDown:"select.purchase_state",stateSelectorText:"input.purchase_state",zipCodeSelector:".purchase_zip_code",shippingFields:["street_address","zip_code","state","city","country"],stateInputName:"purchase[state]",shippingAddressVerifySelector:".js-shipping-address-tool-tip",streetAddressUpdateTriggerSelector:".js-street-address-update-trigger",shippingAddressConfirmTriggerSelector:".js-shipping-address-confirm-trigger",shippingRateHolderSelector:".js-shipping-rate-holder",shippingAddressMessageSelector:".js-shipping-address-message",shippingRateSelector:".js-shipping-rate-info",shippingFormNoun:"purchase",usingStateDropdown:!1,hasVerifiedShippingAddress:!1,addressSuggestion:"",addressFieldForSuggestionSelector:""}),this.checkEmailForTypos=function(){var t=this.select("emailSelector"),e=this,n=["aaa","abb","abbott","abogado","ac","academy","accenture","accountant","accountants","aco","active","actor","ad","ads","adult","ae","aeg","aero","af","afl","ag","agency","ai","aig","airforce","airtel","al","allfinanz","alsace","am","amica","amsterdam","android","ao","apartments","app","aq","aquarelle","ar","archi","army","arpa","as","asia","associates","at","attorney","au","auction","audio","auto","autos","aw","ax","axa","az","azure","ba","band","bank","bar","barcelona","barclaycard","barclays","bargains","bauhaus","bayern","bb","bbc","bbva","bcn","bd","be","beer","bentley","berlin","best","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","bloomberg","blue","bm","bmw","bn","bnl","bnpparibas","bo","boats","bond","boo","boots","boutique","br","bradesco","bridgestone","broker","brother","brussels","bs","bt","budapest","build","builders","business","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","camera","camp","cancerresearch","canon","capetown","capital","caravan","cards","care","career","careers","cars","cartier","casa","cash","casino","cat","catering","cba","cc","cd","ceb","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","chat","cheap","chloe","christmas","chrome","church","ci","cisco","citic","city","ck","cl","claims","cleaning","click","clinic","clothing","cloud","club","cm","cn","coach","codes","coffee","college","cologne","com","commbank","community","company","computer","condos","construction","consulting","contractors","cooking","cool","coop","corsica","country","coupons","courses","cr","credit","creditcard","cricket","crown","crs","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","date","dating","datsun","day","dclk","de","deals","degree","delivery","delta","democrat","dental","dentist","desi","design","dev","diamonds","diet","digital","direct","directory","discount","dj","dk","dm","dnp","do","docs","dog","doha","domains","doosan","download","drive","durban","dvag","dz","earth","eat","ec","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","erni","es","esq","estate","et","eu","eurovision","eus","events","everbank","exchange","expert","exposed","express","fage","fail","faith","family","fan","fans","farm","fashion","feedback","fi","film","finance","financial","firmdale","fish","fishing","fit","fitness","fj","fk","flights","florist","flowers","flsmidth","fly","fm","fo","foo","football","forex","forsale","forum","foundation","fr","frl","frogans","fund","furniture","futbol","fyi","ga","gal","gallery","game","garden","gb","gbiz","gd","gdn","ge","gea","gent","genting","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmo","gmx","gn","gold","goldpoint","golf","goo","goog","google","gop","gov","gp","gq","gr","graphics","gratis","green","gripe","group","gs","gt","gu","guge","guide","guitars","guru","gw","gy","hamburg","hangout","haus","healthcare","help","here","hermes","hiphop","hitachi","hiv","hk","hm","hn","hockey","holdings","holiday","homedepot","homes","honda","horse","host","hosting","hoteles","hotmail","house","how","hr","hsbc","ht","hu","ibm","icbc","ice","icu","id","ie","ifm","iinet","il","im","immo","immobilien","in","industries","infiniti","info","ing","ink","institute","insure","int","international","investments","io","ipiranga","iq","ir","irish","is","ist","istanbul","it","itau","iwc","java","jcb","je","jetzt","jewelry","jlc","jll","jm","jo","jobs","joburg","jp","jprs","juegos","kaufen","kddi","ke","kg","kh","ki","kim","kitchen","kiwi","km","kn","koeln","komatsu","kp","kr","krd","kred","kw","ky","kyoto","kz","la","lacaixa","lancaster","land","lasalle","lat","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","legal","lexus","lgbt","li","liaison","lidl","life","lighting","limited","limo","link","live","lixil","lk","loan","loans","lol","london","lotte","lotto","love","lr","ls","lt","ltda","lu","lupin","luxe","luxury","lv","ly","ma","madrid","maif","maison","man","management","mango","market","marketing","markets","marriott","mba","mc","md","me","media","meet","melbourne","meme","memorial","men","menu","mg","mh","miami","microsoft","mil","mini","mk","ml","mm","mma","mn","mo","mobi","moda","moe","mom","monash","money","montblanc","mormon","mortgage","moscow","motorcycles","mov","movie","movistar","mp","mq","mr","ms","mt","mtn","mtpc","mu","museum","mv","mw","mx","my","mz","na","nadex","nagoya","name","navy","nc","ne","nec","net","netbank","network","neustar","new","news","nexus","nf","ng","ngo","nhk","ni","nico","ninja","nissan","nl","no","nokia","np","nr","nra","nrw","ntt","nu","nyc","nz","office","okinawa","om","omega","one","ong","onl","online","ooo","oracle","orange","org","organic","osaka","otsuka","ovh","pa","page","panerai","paris","partners","parts","party","pe","pet","pf","pg","ph","pharmacy","philips","photo","photography","photos","physio","piaget","pics","pictet","pictures","pink","pizza","pk","pl","place","play","plumbing","plus","pm","pn","pohl","poker","porn","post","pr","praxi","press","pro","prod","productions","prof","properties","property","ps","pt","pub","pw","py","qa","qpon","quebec","racing","re","realtor","realty","recipes","red","redstone","rehab","reise","reisen","reit","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rich","ricoh","rio","rip","ro","rocks","rodeo","rs","rsvp","ru","ruhr","run","rw","ryukyu","sa","saarland","sakura","sale","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","saxo","sb","sc","sca","scb","schmidt","scholarships","school","schule","schwarz","science","scor","scot","sd","se","seat","seek","sener","services","sew","sex","sexy","sg","sh","shiksha","shoes","show","shriram","si","singles","site","sj","sk","ski","sky","skype","sl","sm","sn","sncf","so","soccer","social","software","sohu","solar","solutions","sony","soy","space","spiegel","spreadbetting","sr","srl","st","starhub","statoil","stc","stcgroup","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","taipei","tatamotors","tatar","tattoo","tax","taxi","tc","td","team","tech","technology","tel","telefonica","temasek","tennis","tf","tg","th","thd","theater","tickets","tienda","tips","tires","tirol","tj","tk","tl","tm","tn","to","today","tokyo","tools","top","toray","toshiba","tours","town","toyota","toys","tr","trade","trading","training","travel","trust","tt","tui","tv","tw","tz","ua","ubs","ug","uk","university","uno","uol","us","uy","uz","va","vacations","vc","ve","vegas","ventures","versicherung","vet","vg","vi","viajes","video","villas","vin","vision","vista","vistaprint","viva","vlaanderen","vn","vodka","vote","voting","voto","voyage","vu","wales","walter","wang","watch","webcam","website","wed","wedding","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","wme","work","works","world","ws","wtc","wtf","xbox","xerox","xin","xn","xperia","xxx","xyz","yachts","yandex","ye","yodobashi","yoga","yokohama","youtube","yt","za","zip","zm","zone","zuerich","zw","com.vn","net.au"];Mailcheck.run({email:t.val(),topLevelDomains:n,suggested:function(t){void 0!==t&&(e.select("emailConfirmContainerSelector").find("span").text(I18n.t("js.email_confirm_paragraph",{email:t.full})),e.select("emailConfirmTriggerSelector").data("suggestion",t.full),e.select("emailConfirmContainerSelector").addClass("showing"))}})},this.confirmEmail=function(t){t.preventDefault(),this.select("emailSelector").val(this.select("emailConfirmTriggerSelector").data("suggestion")),this.select("emailConfirmContainerSelector").removeClass("showing")},this.denyEmail=function(t){t.preventDefault(),this.select("emailConfirmContainerSelector").removeClass("showing")},this.setEmail=function(){var t=this.select("emailSelector");t.val(t.val()||this.getUrlParams().email||this.attr.user.purchase&&this.attr.user.purchase.email||this.attr.user.email||"")},this.validateEmailsIfNotAutoFill=function(){return this.validateEmails(this.select("emailFieldsSelector"))},this.showAddressVerify=function(){this.select("shippingAddressVerifySelector").show(),this.trigger("uiAnimatePaymentFormHeight",{animate:!1})},this.hideAddressVerify=function(){this.select("shippingAddressVerifySelector").hide(),this.resetAddressUpdateAndConfirmButtons(),this.attr.addressFieldForSuggestionSelector&&this.select("addressFieldForSuggestionSelector").removeClass("error"),this.trigger("uiAnimatePaymentFormHeight",{animate:!1})},this.resetAddressUpdateAndConfirmButtons=function(){this.select("shippingAddressConfirmTriggerSelector").addClass("button-primary").removeClass("button-default").text(I18n.t("js.yes_it_is")),this.select("streetAddressUpdateTriggerSelector").hide()},this.verifyShippingAddress=function(){if(this.hideAddressVerify(),!this.attr.hasVerifiedShippingAddress&&0!=this.select("streetSelector").length&&this.select("streetSelector").is(":visible")&&this.select("streetSelector").hasClass("required")){var t={street_address:this.select("streetSelector").val(),city:this.select("citySelector").val(),state:this.select("stateSelectorText").val(),zip_code:this.select("zipCodeSelector").val(),country:this.select("countrySelector").val()};this.trigger("uiNeedsToVerifyShippingAddress",{shipping_data:t})}else this.continueWithPayment()},this.verifiedShippingAddress=function(t,e){this.select("streetSelector").val(e.street_address),this.select("citySelector").val(e.city),this.select("stateSelectorText").val(e.state),this.select("zipCodeSelector").val(e.zip_code),this.continueWithPayment()},this.unverifiedShippingAddress=function(t,e){this.select("shippingAddressMessageSelector").text(e.error_message),e.suggestion&&(this.setAddressFieldErrorAndSuggestion(e),this.select("streetAddressUpdateTriggerSelector").show(),this.select("shippingAddressConfirmTriggerSelector").addClass("button-default").removeClass("button-primary").text(I18n.t("js.no_and_continue"))),this.showAddressVerify(),this.trigger("uiShouldResetPayButton")},this.setAddressFieldErrorAndSuggestion=function(t){switch(this.attr.addressSuggestion=t.suggestion,t.error_field){case"street":this.attr.addressFieldForSuggestionSelector=this.attr.streetSelector;break;case"city":this.attr.addressFieldForSuggestionSelector=this.attr.citySelector;break;case"state":this.attr.addressFieldForSuggestionSelector=this.attr.stateSelector;break;case"zip_code":this.attr.addressFieldForSuggestionSelector=this.attr.zipCodeSelector;break;case"country":this.attr.addressFieldForSuggestionSelector=this.attr.countrySelector}this.select("addressFieldForSuggestionSelector").addClass("error")},this.updateStreetAddress=function(t){return t.preventDefault(),this.select("addressFieldForSuggestionSelector").val(this.attr.addressSuggestion),this.hideAddressVerify(),!1},this.confirmShippingAddress=function(t){return t.preventDefault(),this.attr.hasVerifiedShippingAddress=!0,this.attr.productsInBundle?this.initiateValidationForProductBundle():this.payIfAllowed(),!1},this.continueWithPayment=function(){this.attr.productsInBundle?this.initiatePaymentForProductBundle():this.attr.onUserProfile||this.makePayment()},this.setShippingInfo=function(){if(this.attr.user.detected_country&&(this.select("countrySelector").val(this.attr.user.detected_country),null!=this.attr.user.detected_state&&this.currentStateField().val(this.attr.user.detected_state)),this.attr.user.shipping_information)for(var t=0;t<this.attr.shippingFields.length;t++){var e=this.attr.shippingFields[t];$(".purchase_"+e).val(this.attr.user.shipping_information[e])}this.attr.user.is_logged_in||this.select("keepOnFileHolderSelector").remove(),this.updateStateAndZipCode()},this.unsetShippingInfo=function(){this.select("countrySelector").val("");for(var t=0;t<this.attr.shippingFields.length;t++){
var e=this.attr.shippingFields[t];$(".purchase_"+e).val("")}},this.showShippingInputs=function(){this.select("shippingInformationSelector").show()},this.hideShippingInputs=function(){this.select("shippingInformationSelector").hide()},this.showGiftInputs=function(){this.select("giftTriggerSelector").addClass("active"),this.select("giftSignifierSelector").val(!0),this.select("envelopeSelector").show(),this.select("giftElementSelector").show(),this.unsetShippingInfo()},this.hideGiftInputs=function(){this.select("giftTriggerSelector").removeClass("active"),this.select("giftSignifierSelector").val(!1),this.select("giftElementSelector").hide(),this.setShippingInfo()},this.updateShippingRate=function(t,e){var n,i;this.attr.productsInBundle?(n=this.totalBundleShippingRateDisplayCurrencyCents(),i=this.formattedUSDShippingRate(n)):(n=e.shipping_rate_cents,i=e.formatted_shipping_rate),this.attr.shippingCents=n,n>0?(this.select("shippingRateHolderSelector").addClass("has-shipping-rate"),this.select("shippingRateSelector").text("+ "+i)):this.select("shippingRateHolderSelector").removeClass("has-shipping-rate"),this.trigger("uiNeedsToEvaluateCreditCardFormVisibility")},this.formattedUSDShippingRate=function(t){return"US$"+this.cleanedPrice(t/100)},this.changeCountry=function(){this.updateStateAndZipCode(),this.scheduleUpdateCustomerSurcharge()},this.scheduleUpdateCustomerSurcharge=function(){this.trigger("uiShouldDisablePayButton"),this.delay(function(){this.trigger("uiNeedsCustomerSurcharge")}.bind(this),1e3)},this.delay=function(){var t=0;return function(e,n){clearTimeout(t),t=setTimeout(e,n)}}(),this.after("initialize",function(){this.updateStateAndZipCode(),this.on(this.$node,"dataCustomerSurcharge",this.updateShippingRate),this.attr.isMobile&&this.select("envelopeSelector").addClass("small"),this.on("change",{countrySelector:this.changeCountry}),this.on("paste keyup",{zipCodeSelector:this.scheduleUpdateCustomerSurcharge}),this.on("focusout",{emailSelector:this.checkEmailForTypos}),this.on("click",{giftTriggerSelector:this.toggleGiftPaymentForm,shippingAddressConfirmTriggerSelector:this.confirmShippingAddress,streetAddressUpdateTriggerSelector:this.updateStreetAddress,emailConfirmTriggerSelector:this.confirmEmail,emailDenyTriggerSelector:this.denyEmail}),this.on(document,"dataVerifyShippingAddressSuccessful",this.verifiedShippingAddress),this.on(document,"dataVerifyShippingAddressFail",this.unverifiedShippingAddress),this.on(document,"dataVerifyShippingAddressTimeout",this.continueWithPayment)})}return r}),define("hbs!$app/templates/zipcode_field",["hbs","hbs/handlebars"],function(t,e){var n=e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){return'<p class="js-cc_zipcode_p cc-zipcode-p">\n  <input type=\'hidden\' value=\'true\' name=\'cc_zipcode_required\' class=\'js-cc-zipcode-required\'>\n  <label for="cc_zipcode" class=\'js-cc_zipcode_label\'></label>\n  <input type="text" x-autocompletetype="cc-zip" name="cc_zipcode" class="js-cc_zipcode cc-zipcode" />\n</p>'},useData:!0});return e.registerPartial("$app/templates/zipcode_field",n),n}),/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
function(){function t(t){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,t.apply(e,arguments)}}var e,n,i={};e=this,null!=e&&(n=e.async),i.noConflict=function(){return e.async=n,i};var r=Object.prototype.toString,a=Array.isArray||function(t){return"[object Array]"===r.call(t)},s=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},o=function(t,e){if(t.map)return t.map(e);var n=[];return s(t,function(t,i,r){n.push(e(t,i,r))}),n},l=function(t,e,n){return t.reduce?t.reduce(e,n):(s(t,function(t,i,r){n=e(n,t,i,r)}),n)},u=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};"undefined"!=typeof process&&process.nextTick?(i.nextTick=process.nextTick,"undefined"!=typeof setImmediate?i.setImmediate=function(t){setImmediate(t)}:i.setImmediate=i.nextTick):"function"==typeof setImmediate?(i.nextTick=function(t){setImmediate(t)},i.setImmediate=i.nextTick):(i.nextTick=function(t){setTimeout(t,0)},i.setImmediate=i.nextTick),i.each=function(e,n,i){function r(t){t?(i(t),i=function(){}):(a+=1,a>=e.length&&i())}if(i=i||function(){},!e.length)return i();var a=0;s(e,function(e){n(e,t(r))})},i.forEach=i.each,i.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var i=0,r=function(){e(t[i],function(e){e?(n(e),n=function(){}):(i+=1,i>=t.length?n():r())})};r()},i.forEachSeries=i.eachSeries,i.eachLimit=function(t,e,n,i){var r=c(e);r.apply(null,[t,n,i])},i.forEachLimit=i.eachLimit;var c=function(t){return function(e,n,i){if(i=i||function(){},!e.length||0>=t)return i();var r=0,a=0,s=0;!function o(){if(r>=e.length)return i();for(;t>s&&a<e.length;)a+=1,s+=1,n(e[a-1],function(t){t?(i(t),i=function(){}):(r+=1,s-=1,r>=e.length?i():o())})}()}},h=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.each].concat(e))}},d=function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[c(t)].concat(n))}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.eachSeries].concat(e))}},f=function(t,e,n,i){if(e=o(e,function(t,e){return{index:e,value:t}}),i){var r=[];t(e,function(t,e){n(t.value,function(n,i){r[t.index]=i,e(n)})},function(t){i(t,r)})}else t(e,function(t,e){n(t.value,function(t){e(t)})})};i.map=h(f),i.mapSeries=p(f),i.mapLimit=function(t,e,n,i){return m(e)(t,n,i)};var m=function(t){return d(t,f)};i.reduce=function(t,e,n,r){i.eachSeries(t,function(t,i){n(e,t,function(t,n){e=n,i(t)})},function(t){r(t,e)})},i.inject=i.reduce,i.foldl=i.reduce,i.reduceRight=function(t,e,n,r){var a=o(t,function(t){return t}).reverse();i.reduce(a,e,n,r)},i.foldr=i.reduceRight;var g=function(t,e,n,i){var r=[];e=o(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n&&r.push(t),e()})},function(t){i(o(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.filter=h(g),i.filterSeries=p(g),i.select=i.filter,i.selectSeries=i.filterSeries;var y=function(t,e,n,i){var r=[];e=o(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n||r.push(t),e()})},function(t){i(o(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.reject=h(y),i.rejectSeries=p(y);var v=function(t,e,n,i){t(e,function(t,e){n(t,function(n){n?(i(t),i=function(){}):e()})},function(t){i()})};i.detect=h(v),i.detectSeries=p(v),i.some=function(t,e,n){i.each(t,function(t,i){e(t,function(t){t&&(n(!0),n=function(){}),i()})},function(t){n(!1)})},i.any=i.some,i.every=function(t,e,n){i.each(t,function(t,i){e(t,function(t){t||(n(!1),n=function(){}),i()})},function(t){n(!0)})},i.all=i.every,i.sortBy=function(t,e,n){i.map(t,function(t,n){e(t,function(e,i){e?n(e):n(null,{value:t,criteria:i})})},function(t,e){if(t)return n(t);var i=function(t,e){var n=t.criteria,i=e.criteria;return i>n?-1:n>i?1:0};n(null,o(e.sort(i),function(t){return t.value}))})},i.auto=function(t,e){e=e||function(){};var n=u(t),r=n.length;if(!r)return e();var o={},c=[],h=function(t){c.unshift(t)},d=function(t){for(var e=0;e<c.length;e+=1)if(c[e]===t)return void c.splice(e,1)},p=function(){r--,s(c.slice(0),function(t){t()})};h(function(){if(!r){var t=e;e=function(){},t(null,o)}}),s(n,function(n){var r=a(t[n])?t[n]:[t[n]],c=function(t){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),t){var a={};s(u(o),function(t){a[t]=o[t]}),a[n]=r,e(t,a),e=function(){}}else o[n]=r,i.setImmediate(p)},f=r.slice(0,Math.abs(r.length-1))||[],m=function(){return l(f,function(t,e){return t&&o.hasOwnProperty(e)},!0)&&!o.hasOwnProperty(n)};if(m())r[r.length-1](c,o);else{var g=function(){m()&&(d(g),r[r.length-1](c,o))};h(g)}})},i.retry=function(t,e,n){var r=5,a=[];"function"==typeof t&&(n=e,e=t,t=r),t=parseInt(t,10)||r;var s=function(r,s){for(var o=function(t,e){return function(n){t(function(t,i){n(!t||e,{err:t,result:i})},s)}};t;)a.push(o(e,!(t-=1)));i.series(a,function(t,e){e=e[e.length-1],(r||n)(e.err,e.result)})};return n?s():s},i.waterfall=function(t,e){if(e=e||function(){},!a(t)){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();var r=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var a=Array.prototype.slice.call(arguments,1),s=t.next();s?a.push(r(s)):a.push(e),i.setImmediate(function(){t.apply(null,a)})}}};r(i.iterator(t))()};var _=function(t,e,n){if(n=n||function(){},a(e))t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var i={};t.each(u(e),function(t,n){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[t]=r,n(e)})},function(t){n(t,i)})}};i.parallel=function(t,e){_({map:i.map,each:i.each},t,e)},i.parallelLimit=function(t,e,n){_({map:m(e),each:c(e)},t,n)},i.series=function(t,e){if(e=e||function(){},a(t))i.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};i.eachSeries(u(t),function(e,i){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[e]=r,i(t)})},function(t){e(t,n)})}},i.iterator=function(t){var e=function(n){var i=function(){return t.length&&t[n].apply(null,arguments),i.next()};return i.next=function(){return n<t.length-1?e(n+1):null},i};return e(0)},i.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var S=function(t,e,n,i){var r=[];t(e,function(t,e){n(t,function(t,n){r=r.concat(n||[]),e(t)})},function(t){i(t,r)})};i.concat=h(S),i.concatSeries=p(S),i.whilst=function(t,e,n){t()?e(function(r){return r?n(r):void i.whilst(t,e,n)}):n()},i.doWhilst=function(t,e,n){t(function(r){if(r)return n(r);var a=Array.prototype.slice.call(arguments,1);e.apply(null,a)?i.doWhilst(t,e,n):n()})},i.until=function(t,e,n){t()?n():e(function(r){return r?n(r):void i.until(t,e,n)})},i.doUntil=function(t,e,n){t(function(r){if(r)return n(r);var a=Array.prototype.slice.call(arguments,1);e.apply(null,a)?n():i.doUntil(t,e,n)})},i.queue=function(e,n){function r(t,e,n,r){return t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?i.setImmediate(function(){t.drain&&t.drain()}):void s(e,function(e){var a={data:e,callback:"function"==typeof r?r:null};n?t.tasks.unshift(a):t.tasks.push(a),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),i.setImmediate(t.process)})}void 0===n&&(n=1);var o=0,l={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){r(l,t,!1,e)},kill:function(){l.drain=null,l.tasks=[]},unshift:function(t,e){r(l,t,!0,e)},process:function(){if(!l.paused&&o<l.concurrency&&l.tasks.length){var n=l.tasks.shift();l.empty&&0===l.tasks.length&&l.empty(),o+=1;var i=function(){o-=1,n.callback&&n.callback.apply(n,arguments),l.drain&&l.tasks.length+o===0&&l.drain(),l.process()},r=t(i);e(n.data,r)}},length:function(){return l.tasks.length},running:function(){return o},idle:function(){return l.tasks.length+o===0},pause:function(){l.paused!==!0&&(l.paused=!0,l.process())},resume:function(){l.paused!==!1&&(l.paused=!1,l.process())}};return l},i.priorityQueue=function(t,e){function n(t,e){return t.priority-e.priority}function r(t,e,n){for(var i=-1,r=t.length-1;r>i;){var a=i+(r-i+1>>>1);n(e,t[a])>=0?i=a:r=a-1}return i}function o(t,e,o,l){return t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?i.setImmediate(function(){t.drain&&t.drain()}):void s(e,function(e){var a={data:e,priority:o,callback:"function"==typeof l?l:null};t.tasks.splice(r(t.tasks,a,n)+1,0,a),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),i.setImmediate(t.process)})}var l=i.queue(t,e);return l.push=function(t,e,n){o(l,t,e,n)},delete l.unshift,l},i.cargo=function(t,e){var n=!1,r=[],l={tasks:r,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,n){a(t)||(t=[t]),s(t,function(t){r.push({data:t,callback:"function"==typeof n?n:null}),l.drained=!1,l.saturated&&r.length===e&&l.saturated()}),i.setImmediate(l.process)},process:function u(){if(!n){if(0===r.length)return l.drain&&!l.drained&&l.drain(),void(l.drained=!0);var i="number"==typeof e?r.splice(0,e):r.splice(0,r.length),a=o(i,function(t){return t.data});l.empty&&l.empty(),n=!0,t(a,function(){n=!1;var t=arguments;s(i,function(e){e.callback&&e.callback.apply(null,t)}),u()})}},length:function(){return r.length},running:function(){return n}};return l};var b=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&s(n,function(e){console[t](e)}))}]))}};i.log=b("log"),i.dir=b("dir"),i.memoize=function(t,e){var n={},r={};e=e||function(t){return t};var a=function(){var a=Array.prototype.slice.call(arguments),s=a.pop(),o=e.apply(null,a);o in n?i.nextTick(function(){s.apply(null,n[o])}):o in r?r[o].push(s):(r[o]=[s],t.apply(null,a.concat([function(){n[o]=arguments;var t=r[o];delete r[o];for(var e=0,i=t.length;i>e;e++)t[e].apply(null,arguments)}])))};return a.memo=n,a.unmemoized=t,a},i.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},i.times=function(t,e,n){for(var r=[],a=0;t>a;a++)r.push(a);return i.map(r,e,n)},i.timesSeries=function(t,e,n){for(var r=[],a=0;t>a;a++)r.push(a);return i.mapSeries(r,e,n)},i.seq=function(){var t=arguments;return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();i.reduce(t,n,function(t,n,i){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);i(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}},i.compose=function(){return i.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(t,e){var n=function(){var n=this,i=Array.prototype.slice.call(arguments),r=i.pop();return t(e,function(t,e){t.apply(n,i.concat([e]))},r)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return n.apply(this,i)}return n};i.applyEach=h(w),i.applyEachSeries=p(w),i.forever=function(t,e){function n(i){if(i){if(e)return e(i);throw i}t(n)}n()},"undefined"!=typeof module&&module.exports?module.exports=i:"undefined"!=typeof define&&define.amd?define("$vendor/async-0.9.0",[],function(){return i}):e.async=i}(),define("$app/data/card_data",["flight/lib/component","$vendor/async-0.9.0"],function(t,e){function n(){this.defaultAttrs({cardDataHandlingMode:null,stripePk:null}),this.prepareCardData=function(t,n){var i={cardParams:{card_data_handling_mode:this.attr.cardDataHandlingMode}};"undefined"!=typeof n.associatedData&&(i.associatedData=n.associatedData);var r={"stripejs.0":this.prepareCardDataStripeJs_0},a=this.attr.cardDataHandlingMode.split(","),s=$.map(a,function(t){return function(e){r[t].call(this,n,i,function(){e()})}.bind(this)}.bind(this));return e.parallel(s,function(){this.trigger("dataCardPrepared",i)}.bind(this)),!1},this.prepareCardDataStripeJs_0=function(t,e,n){var i=t.cardData.expiryDate.replace(/\s+/g,""),r=i.split("/")[0],a=i.split("/")[1];Stripe.setPublishableKey(this.attr.stripePk),Stripe.card.createToken({number:t.cardData.number,exp_month:r,exp_year:a,cvc:t.cardData.cvc,address_zip:"undefined"==typeof t.cardData.zipCode?null:t.cardData.zipCode,currency:"usd"},function(i,r){r.error?e.cardParams.stripe_error=r.error:(e.cardParams.stripe_token=r.id,e.cardParams.cc_bin=t.cardData.number.replace(/\s+/g,"").substring(0,6)),n()}.bind(this))},this.after("initialize",function(){this.on("uiNeedsCardPrepared",this.prepareCardData)})}return t(n)}),define("$app/data/braintree_client_token_data",["flight/lib/component"],function(t){function e(){this.fetchBraintreeClientToken=function(t,e){window.grBraintreeClientSetup||(window.grBraintreeClientSetup=!0,$.ajax({type:"GET",url:Routes.braintree_client_token_path(),dataType:"json"}).done(function(t){this.trigger("dataBraintreeClientToken",t)}.bind(this)))},this.after("initialize",function(){this.on("uiNeedsBraintreeClientTokenFetched",this.fetchBraintreeClientToken)})}return t(e)}),define("$app/data/braintree_transient_customer_data",["flight/lib/component"],function(t){function e(){this.tokenizeNonceForUserProfilePurchase=function(t,e){$.ajax({type:"POST",url:Routes.generate_braintree_transient_customer_token_path(),data:{braintree_nonce:e.braintreeNonce},dataType:"json"}).done(function(t){this.trigger(this.node,"dataBraintreeTransientCustomerToken",{transient_customer_store_key:t.transient_customer_store_key,callback:e.callback})}.bind(this))},this.after("initialize",function(){this.on("uiNeedsBraintreeTransientCustomerTokenFetched",this.tokenizeNonceForUserProfilePurchase)})}return t(e)}),define("$app/utils/environment",[],function(){var t={ENVIRONMENTS:{PRODUCTION:"production",TEST:"test"},isProduction:function(){return this.current==this.ENVIRONMENTS.PRODUCTION}};return t.current=$('meta[property="gr:environment"]').attr("value"),t}),define("$app/ui/shared/with_paypal_braintree",["braintree","braintree_data","$app/data/braintree_client_token_data","$app/data/braintree_transient_customer_data","$app/utils/environment"],function(t,e,n,i,r){function a(){this.defaultAttrs({metaBraintreeMerchantIdSelector:'meta[property="braintree:merchant_id"]'}),this.setupPayPalBraintreeImplementation=function(e){t.setup(e,"paypal",{container:this.select("actualBraintreePayPalContainerSelector"),paymentMethodNonceInputField:this.select("braintreeNonceFieldSelector"),singleUse:!1,onPaymentMethodReceived:function(t){this.handlePayPalNonce(t.nonce)}.bind(this)});var n=r.isProduction()?BraintreeData.environments.production:BraintreeData.environments.sandbox;BraintreeData.setup($(this.attr.metaBraintreeMerchantIdSelector).attr("value"),this.select("actualPayPalContainerSelector").attr("id"),n)},this.initiateBraintreePayPalPayment=function(){null!=this.attr.braintreeTransientCustomerStoreKey?this.trigger(this.node,"uiHasAuthorizedPayPalBuyer"):this.attr.braintreePaymentNonce?this.handlePayPalNonce(this.attr.braintreePaymentNonce):(this.select("actualPayPalButton").click(),this.trigger("uiNeedsToHideVatCountrySelector"))},this.handlePayPalNonce=function(t){this.attr.braintreePaymentNonce=t,this.trigger(this.node,"uiHasAuthorizedPayPalBuyer",{paypalBuyerEmail:this.select("actualPayPalDataEmailSelector").text()})},this.handleTransientClientToken=function(t,e){this.attr.braintreeTransientCustomerStoreKey=e.transient_customer_store_key,e.callback&&e.callback(this.getBraintreePayPalCardParams())},this.prepareBraintreePayPalPayment=function(t){var e=this.attr.braintreePaymentNonce||$(this.attr.braintreeNonceFieldSelector).val();e&&this.trigger("uiNeedsBraintreeTransientCustomerTokenFetched",{braintreeNonce:e,callback:t})},this.getBraintreePayPalCardParams=function(){return{cardParams:{braintree_transient_customer_store_key:this.attr.braintreeTransientCustomerStoreKey,braintree_device_data:BraintreeData._getDeviceData()}}},this.resetBraintreePayPalPayment=function(){this.attr.braintreePaymentNonce=null,this.attr.braintreeTransientCustomerStoreKey=null},this.after("initialize",function(){n.attachTo(this.$node),i.attachTo(this.$node),this.on(this.node,"dataBraintreeTransientCustomerToken",this.handleTransientClientToken)})}return a}),define("$app/data/paypal_express_checkout",["flight/lib/component"],function(t){function e(){this.createPayPalExpressCheckoutToken=function(t,e){e.window_location=window.location.origin+window.location.pathname+window.location.search,$.ajax({type:"POST",url:Routes.create_paypal_express_checkout_token_path(),dataType:"json",data:e}).done(function(t){this.trigger(this.node,"dataPayPalExpressCheckoutToken",{paypalExpressCheckoutToken:t.paypal_express_checkout_token})}.bind(this))},this.fetchPayPalBuyerDetails=function(t,e){$.ajax({type:"POST",url:Routes.fetch_paypal_email_for_express_checkout_token_path(),dataType:"json",data:{paypal_express_checkout_token:e.paypalExpressCheckoutToken}}).done(function(t){this.trigger(this.node,"dataPayPalBuyerDetails",{paypalBuyerEmail:t.paypal_email})}.bind(this))},this.tokenizePayPalExpressCheckoutOrder=function(t,e){$.ajax({type:"POST",url:Routes.tokenize_paypal_express_checkout_order_path(),dataType:"json",data:{authorized_amount_cents:e.authorizedAmountCents,paypal_express_checkout_token:e.paypalExpressCheckoutToken}}).done(function(t){this.trigger(this.node,"dataHandleTransientPayPalAuthToken",{paypalTransientOrderAuthStoreKey:t.paypal_transient_order_auth_store_key,callback:e.callback})}.bind(this))},this.after("initialize",function(){this.on(this.node,"uiNeedsPayPalExpressCheckoutToken",this.createPayPalExpressCheckoutToken),this.on(this.node,"uiNeedsPayPalBuyerDetails",this.fetchPayPalBuyerDetails),this.on(this.node,"uiNeedsTokenizedPayPalExpressCheckoutOrderAuth",this.tokenizePayPalExpressCheckoutOrder)})}return t(e)}),define("$app/utils/mobile",[],function(){var t={isOnMobile:function(){return window.innerWidth<=480},isOnTablet:function(){return navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i)},isOnMobileiOSDevice:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&-1==document.cookie.indexOf("iphone_redirect=false")},isOnAndroidDevice:function(){return navigator.userAgent.match(/Android/i)}};return t}),define("$app/utils/gumroad_utils",[],function(){var t={isOverlay:function(){return"overlay-page"===$("body").attr("id")},isModal:function(){return!!window.location.search.match(/as_modal/)&&top!=self},isEmbed:function(){return!!window.location.search.match(/as_embed/)&&top!=self},isOutboundEmbed:function(){return!!window.location.search.match(/outbound_embed/)&&top!=self},isRecommended:function(){return!!window.location.search.match(/recommended_by/)},isExternalPresentation:function(){return this.isOutboundEmbed()||this.isEmbed()||this.isModal()||this.isOverlay()}};return t}),define("$app/ui/shared/with_paypal_native",["paypal","$app/data/paypal_express_checkout","$app/utils/mobile","$app/utils/gumroad_utils"],function(t,e,n,i){function r(){this.defaultAttrs({metaPayPalClientIDSelector:'meta[property="paypal:client_id"]',metaPayPalModeSelector:'meta[property="paypal:mode"]',metaNativePayPalPaymentDisabledSelector:'meta[property="gr:paypal:native_paypal_payment_disabled"]',nativePayPalCompatible:!0}),this.setupPayPalNativeImplementation=function(){paypal.checkout.setup($(this.attr.metaPayPalClientIDSelector).attr("value"),{environment:$(this.attr.metaPayPalModeSelector).attr("value"),button:[this.select("grPaypalButtonSelector").attr("id")],click:function(t){t&&t.preventDefault(),this.clickPayPalButton()}.bind(this),condition:function(){return!1}.bind(this)}),this.attr.paypalExpressCheckoutUrlPrefix=paypal.checkout.urlPrefix},this.initiateNativePayPalPayment=function(){return this.attr.paypalPayerId&&this.attr.paypalPayerId?(this.hideAndUncheckPayPalSelector(),void this.trigger(this.node,"uiHasAuthorizedPayPalBuyer")):(paypal.checkout.initXO(),void this.trigger(this.node,"uiNeedsTotalTransactionCents"))},this.authorizeNativePayPalPayment=function(t,e){this.attr.implementationInUse==this.attr.PayPalImplementations.NATIVE&&(this.trigger(this.node,"uiNeedsPayPalExpressCheckoutToken",{amount_cents:e.totalPriceCents}),this.attr.authorizedAmountCents=e.totalPriceCents)},this.processNativePayPalExpressCheckoutToken=function(t,e){return this.attr.paypalExpressCheckoutToken=e.paypalExpressCheckoutToken,this.attr.paypalExpressCheckoutToken?void paypal.checkout.startFlow(this.attr.paypalExpressCheckoutUrlPrefix+this.attr.paypalExpressCheckoutToken):(this.trigger("uiNeedsToShowCreditCardError",{error_message:I18n.t("js.something_went_wrong_not_charged_notice")}),paypal.checkout.closeFlow(),void this.resetPayPalPayment())},this.configureNativePayPalCheckout=function(t,e){this.trigger(this.node,"uiHasAuthorizedPayPalBuyer",{paypalBuyerEmail:e.paypalBuyerEmail})},this.evaluateHashParamsForPayPalExpressCheckout=function(){var t=window.location.hash;window.location.hash="";var e=/[?&]paypal_success=([^?&]*)/.exec(t),n=/[?&]paypal_cancel=([^?&]*)/.exec(t);if(e||n){if(this.attr.implementationInUse!=this.attr.PayPalImplementations.NATIVE)return this.attr.nativePayPalCompatible=!1,void this.trigger("uiShowFlashMessage",{message:I18n.t("js.native_paypal_incompatibility_detected_retry_purchase")});var i=/[?&]token=([^?&]*)/.exec(t)[1];if(this.attr.paypalExpressCheckoutToken==i){try{$('iframe[name="PayPalBridge"]',window.parent.document).remove(),$("div[id^=PPFrame]").remove()}catch(r){}if(e){var a=/[?&]PayerID=([^?&]*)/.exec(t)[1];this.attr.paypalPayerId=a,this.disablePayPalButton(),this.hideAndUncheckPayPalSelector(),this.trigger(this.node,"uiNeedsPayPalBuyerDetails",{paypalExpressCheckoutToken:this.attr.paypalExpressCheckoutToken})}n&&(paypal.checkout.closeFlow(),this.resetPayPalPayment())}}},this.handleTransientPayPalAuthToken=function(t,e){return this.attr.paypalTransientOrderAuthStoreKey=e.paypalTransientOrderAuthStoreKey,this.attr.paypalTransientOrderAuthStoreKey?void(e.callback&&e.callback(this.getNativePayPalCardParams())):(this.trigger("uiNeedsToShowCreditCardError",{error_message:I18n.t("js.something_went_wrong_not_charged_notice")}),this.trigger(this.$node,"uiShouldResetPayButton"),this.trigger("uiHideReceiptWithoutAnimation"),void this.resetPayPalPayment())},this.prepareNativePayPalPayment=function(t){this.attr.paypalPayerId&&this.attr.paypalExpressCheckoutToken&&this.trigger(this.node,"uiNeedsTokenizedPayPalExpressCheckoutOrderAuth",{authorizedAmountCents:this.attr.authorizedAmountCents,paypalExpressCheckoutToken:this.attr.paypalExpressCheckoutToken,callback:t})},this.getNativePayPalCardParams=function(){return{cardParams:{paypal_transient_order_auth_store_key:this.attr.paypalTransientOrderAuthStoreKey}}},this.resetNativePayPalPayment=function(){this.attr.implementationInUse=null,this.attr.paypalExpressCheckoutToken=null,this.attr.paypalPayerId=null,this.attr.authorizedAmountCents=null},this.isNativePayPalPaymentEnabled=function(){var t=!n.isOnMobile()&&!n.isOnTablet()&&!i.isExternalPresentation();return!this.attr.nativePayPalPaymentDisabled&&t&&this.attr.nativePayPalCompatible},this.after("initialize",function(){e.attachTo(this.$node),this.attr.nativePayPalPaymentDisabled="true"===$(this.attr.metaNativePayPalPaymentDisabledSelector).attr("value"),this.on(window,"dataPayPalBuyerDetails",this.configureNativePayPalCheckout),this.on(this.node,"dataPayPalExpressCheckoutToken",this.processNativePayPalExpressCheckoutToken),this.on(this.node,"dataHandleTransientPayPalAuthToken",this.handleTransientPayPalAuthToken),this.on(this.node,"uiHasTotalTransactionCents",this.authorizeNativePayPalPayment),this.on(window,"hashchange",this.evaluateHashParamsForPayPalExpressCheckout)})}return r}),define("$app/utils/checkout",[],function(){var t={isUsingCheckout:function(){return"true"==$('meta[property="gr:uses_checkout"]').attr("content")},isOnCheckoutPage:function(){return void 0!=$(".js-checkout-data").data("checkout-page")}};return t}),define("$app/ui/shared/with_paypal",["$app/ui/shared/with_paypal_braintree","$app/ui/shared/with_paypal_native","$app/utils/checkout","flight/lib/compose"],function(t,e,n,i){function r(){i.mixin(this,[t,e]),this.setupPayPalImplementations=function(t,e){e.clientToken&&(this.setupPayPalBraintreeImplementation(e.clientToken),this.setupPayPalNativeImplementation(),this.attr.paypalInitialized=!0,this.enablePayPalButton())},this.clickPayPalButton=function(t){return t&&t.preventDefault(),this.attr.savedPayPalCardInUse?(this.setupPaymentFormForPayPalPayment(),!1):(!this.isNativePayPalPaymentEnabled()||this.shouldSaveCard()?(this.attr.implementationInUse=this.attr.PayPalImplementations.BRAINTREE,this.initiateBraintreePayPalPayment()):(this.attr.implementationInUse=this.attr.PayPalImplementations.NATIVE,this.initiateNativePayPalPayment()),!1)},this.preparePayPalPayment=function(t){if(this.attr.savedPayPalCardInUse)return void t({});switch(this.attr.implementationInUse){case this.attr.PayPalImplementations.NATIVE:this.prepareNativePayPalPayment(t);break;case this.attr.PayPalImplementations.BRAINTREE:this.prepareBraintreePayPalPayment(t)}},this.setupPaymentFormForPayPalPayment=function(t,e){if(this.attr.payingWithPayPal=!0,e&&e.paypalBuyerEmail&&this.setPayPalEmail(e.paypalBuyerEmail),this.enablePayPalButton(),!this.select("showPaypalCardSelector").hasClass("showing-paypal")){this.select("showPaypalCardSelector").addClass("showing-paypal"),this.attr.savedPayPalCardInUse&&this.setCreditCardFormState("saved"),this.setRequiredFromCardFields(!1),this.select("rememberedSelector").hide();var n=this.attr.paypalBuyerEmail;this.select("customerPayPalEmailContainerSelector").text(n),this.select("showPaypalCardSelector").addClass("showing-paypal"),this.select("paymentFormSelector").length&&(this.setPaymentFormHeight(this.select("paymentFormSelector").outerHeight()-58),setTimeout(function(){this.trigger("uiAnimatePaymentFormHeight",{animate:!0})}.bind(this),500))}},this.resetPayPalPayment=function(t,e){this.resetBraintreePayPalPayment(),this.resetNativePayPalPayment(),this.cancelPayWithPaypal()},this.resetPayPalPaymentForPriceChange=function(){this.attr.implementationInUse==this.attr.PayPalImplementations.NATIVE&&this.resetPayPalPayment()},this.cancelPayWithPaypal=function(t){t&&t.preventDefault(),this.attr.paypalCancelButtonDisabled||(this.attr.payingWithPayPal=!1,this.attr.savedPayPalCardInUse&&this.setCreditCardFormState("new"),this.trigger("uiShouldResetPayButton"),this.select("actualPayPalDataCancelButtonSelector").click(),this.setRequiredFromCardFields(!0),this.select("showPaypalCardSelector").removeClass("showing-paypal"),this.select("paymentFormSelector").length&&(this.setPaymentFormHeight(this.select("paymentFormSelector").outerHeight()+58),this.trigger("uiAnimatePaymentFormHeight",{animate:!0})))},this.enablePayPalButton=function(){this.attr.paypalInitialized&&(this.select("placeholderCardIconSelector").hide(),this.select("grPaypalButtonSelector").show(),this.select("payWithPayPalPromptSelector").show(),this.select("defaultCreditCardIconSelector").show(),this.select("orPayWithSelector").show(),this.select("payPalLoadingIndicatorSelector").hide())},this.disablePayPalButton=function(){this.select("grPaypalButtonSelector").hide(),this.select("orPayWithSelector").hide(),this.select("payPalLoadingIndicatorSelector").show()},this.payingWithPayPal=function(){return this.attr.payingWithPayPal},this.setPayPalEmail=function(t){this.attr.paypalBuyerEmail=t,this.select("customerPayPalEmailContainerSelector").text(this.attr.paypalBuyerEmail)},this.setSavedPayPalCardInUse=function(t){this.attr.payingWithPayPal=!0,this.attr.savedPayPalCardInUse=!0,this.setPayPalEmail(t),this.select("showPaypalCardSelector").addClass("showing-paypal")},this.after("initialize",function(){return"true"!=$('meta[property="gr:paypal:pay_with_paypal_enabled"]').attr("value")?(this.select("payPalLoadingIndicatorSelector").remove(),void this.select("defaultCreditCardIconSelector").show()):(this.attr.PayPalImplementations={NATIVE:"native",BRAINTREE:"braintree"},this.on("click",{grPaypalButtonSelector:this.clickPayPalButton,cancelPayWithPaypalTrigger:this.cancelPayWithPaypal}),this.on(document,"dataPurchaseFail",this.resetPayPalPayment),this.on(document,"dataBraintreeClientToken",this.setupPayPalImplementations),this.on(this.node,"uiTotalPriceCentsChanged",this.resetPayPalPaymentForPriceChange),this.on(this.node,"uiHasAuthorizedPayPalBuyer",this.setupPaymentFormForPayPalPayment),n.isUsingCheckout()||this.trigger("uiNeedsBraintreeClientTokenFetched"),void this.evaluateHashParamsForPayPalExpressCheckout())})}return r}),function(){var t,e,n,i,r,a,s,o,l,u,c,h,d,p,f,m,g,y,v,_=[].slice,S=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=jQuery,t.payment={},t.payment.fn={},t.fn.payment=function(){var e,n;return n=arguments[0],e=2<=arguments.length?_.call(arguments,1):[],t.payment.fn[n].apply(this,e)},r=/(\d{1,4})/g,i=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:r,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:r,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:r,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:r,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:r,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:r,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:r,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:r,length:[13,14,15,16],cvcLength:[3],luhn:!0}],e=function(t){var e,n,r;for(t=(t+"").replace(/\D/g,""),n=0,r=i.length;r>n;n++)if(e=i[n],e.pattern.test(t))return e},n=function(t){var e,n,r;for(n=0,r=i.length;r>n;n++)if(e=i[n],e.type===t)return e},d=function(t){var e,n,i,r,a,s;for(i=!0,r=0,n=(t+"").split("").reverse(),a=0,s=n.length;s>a;a++)e=n[a],e=parseInt(e,10),(i=!i)&&(e*=2),e>9&&(e-=9),r+=e;return r%10===0},h=function(t){var e;return null!=t.prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(e=document.selection)&&"function"==typeof e.createRange?e.createRange().text:void 0)?!0:!1},p=function(e){return setTimeout(function(){var n,i;return n=t(e.currentTarget),i=n.val(),i=t.payment.formatCardNumber(i),n.val(i)})},o=function(n){var i,r,a,s,o,l,u;return a=String.fromCharCode(n.which),!/^\d+$/.test(a)||(i=t(n.currentTarget),u=i.val(),r=e(u+a),s=(u.replace(/\D/g,"")+a).length,l=16,r&&(l=r.length[r.length.length-1]),s>=l||null!=i.prop("selectionStart")&&i.prop("selectionStart")!==u.length)?void 0:(o=r&&"amex"===r.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,o.test(u)?(n.preventDefault(),i.val(u+" "+a)):o.test(u+a)?(n.preventDefault(),i.val(u+a+" ")):void 0)},a=function(e){var n,i;return n=t(e.currentTarget),i=n.val(),e.meta||8!==e.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==i.length?void 0:/\d\s$/.test(i)?(e.preventDefault(),n.val(i.replace(/\d\s$/,""))):/\s\d?$/.test(i)?(e.preventDefault(),n.val(i.replace(/\s\d?$/,""))):void 0},l=function(e){var n,i,r;return i=String.fromCharCode(e.which),/^\d+$/.test(i)?(n=t(e.currentTarget),r=n.val()+i,/^\d$/.test(r)&&"0"!==r&&"1"!==r?(e.preventDefault(),n.val("0"+r+" / ")):/^\d\d$/.test(r)?(e.preventDefault(),n.val(""+r+" / ")):void 0):void 0},u=function(e){var n,i,r;return i=String.fromCharCode(e.which),/^\d+$/.test(i)?(n=t(e.currentTarget),r=n.val(),/^\d\d$/.test(r)?n.val(""+r+" / "):void 0):void 0},c=function(e){var n,i,r;return i=String.fromCharCode(e.which),"/"===i?(n=t(e.currentTarget),r=n.val(),/^\d$/.test(r)&&"0"!==r?n.val("0"+r+" / "):void 0):void 0},s=function(e){var n,i;if(!e.meta&&(n=t(e.currentTarget),i=n.val(),8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===i.length)))return/\d(\s|\/)+$/.test(i)?(e.preventDefault(),n.val(i.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(i)?(e.preventDefault(),n.val(i.replace(/\s\/\s?\d?$/,""))):void 0},y=function(t){var e;return t.metaKey||t.ctrlKey?!0:32===t.which?!1:0===t.which?!0:t.which<33?!0:(e=String.fromCharCode(t.which),!!/[\d\s]/.test(e))},m=function(n){var i,r,a,s;return i=t(n.currentTarget),a=String.fromCharCode(n.which),/^\d+$/.test(a)&&!h(i)?(s=(i.val()+a).replace(/\D/g,""),r=e(s),r?s.length<=r.length[r.length.length-1]:s.length<=16):void 0},g=function(e){var n,i,r;
return n=t(e.currentTarget),i=String.fromCharCode(e.which),/^\d+$/.test(i)&&!h(n)?(r=n.val()+i,r=r.replace(/\D/g,""),r.length>6?!1:void 0):void 0},f=function(e){var n,i,r;return n=t(e.currentTarget),i=String.fromCharCode(e.which),/^\d+$/.test(i)?(r=n.val()+i,r.length<=4):void 0},v=function(e){var n,r,a,s,o;return n=t(e.currentTarget),o=n.val(),s=t.payment.cardType(o)||"unknown",n.hasClass(s)?void 0:(r=function(){var t,e,n;for(n=[],t=0,e=i.length;e>t;t++)a=i[t],n.push(a.type);return n}(),n.removeClass("unknown"),n.removeClass(r.join(" ")),n.addClass(s),n.toggleClass("identified","unknown"!==s),n.trigger("payment.cardType",s))},t.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",f),this},t.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this.on("keypress",l),this.on("keypress",c),this.on("keypress",u),this.on("keydown",s),this},t.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this.on("keypress",o),this.on("keydown",a),this.on("keyup",v),this.on("paste",p),this},t.payment.fn.restrictNumeric=function(){return this.on("keypress",y),this},t.payment.fn.cardExpiryVal=function(){return t.payment.cardExpiryVal(t(this).val())},t.payment.cardExpiryVal=function(t){var e,n,i,r;return t=t.replace(/\s/g,""),r=t.split("/",2),e=r[0],i=r[1],2===(null!=i?i.length:void 0)&&/^\d+$/.test(i)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),i=n+i),e=parseInt(e,10),i=parseInt(i,10),{month:e,year:i}},t.payment.validateCardNumber=function(t){var n,i;return t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)?(n=e(t),n?(i=t.length,S.call(n.length,i)>=0&&(n.luhn===!1||d(t))):!1):!1},t.payment.validateCardExpiry=function(e,n){var i,r,a,s;return"object"==typeof e&&"month"in e&&(s=e,e=s.month,n=s.year),e&&n?(e=t.trim(e),n=t.trim(n),/^\d+$/.test(e)&&/^\d+$/.test(n)&&parseInt(e,10)<=12?(2===n.length&&(a=(new Date).getFullYear(),a=a.toString().slice(0,2),n=a+n),r=new Date(n,e),i=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>i):!1):!1},t.payment.validateCardCVC=function(e,i){var r,a;return e=t.trim(e),/^\d+$/.test(e)?i?(r=e.length,S.call(null!=(a=n(i))?a.cvcLength:void 0,r)>=0):e.length>=3&&e.length<=4:!1},t.payment.cardType=function(t){var n;return t?(null!=(n=e(t))?n.type:void 0)||null:null},t.payment.formatCardNumber=function(t){var n,i,r,a;return(n=e(t))?(r=n.length[n.length.length-1],t=t.replace(/\D/g,""),t=t.slice(0,+r+1||9e9),n.format.global?null!=(a=t.match(n.format))?a.join(" "):void 0:(i=n.format.exec(t),null!=i&&i.shift(),null!=i?i.join(" "):void 0)):t}}.call(this),define("$vendor/jquery.payment",function(){}),define("$app/ui/shared/with_credit_card",["$app/ui/shared/with_form_base","hbs!$app/templates/zipcode_field","$app/data/card_data","$app/ui/shared/with_paypal","flight/lib/compose","$vendor/jquery.payment"],function(t,e,n,i,r){function a(){r.mixin(this,[t,e,i]),this.defaultAttrs({creditCardHolder:".credit_card_holder",rememberedSelector:".credit_card_holder .credit_card.remembered",newCardSelector:".credit_card_holder .credit_card.new-card",testCardSelector:".credit_card_holder .credit_card.test_card",savedCardSelector:".credit_card_holder .credit_card.saved_card",ccNumberSelector:".credit_card_holder .cc_number",ccIconSelector:".js-cc-icon",cvCodeSelector:".credit_card_holder .cv_code",expiryDateSelector:".credit_card_holder .expiry_date",ccZipcodeFieldSelector:".credit_card_holder .js-cc_zipcode",ccZipcodeFieldContainerSelector:".credit_card_holder .js-cc_zipcode_p",ccZipcodeLabelSelector:".js-cc_zipcode_label",ccZipcodeRequiredSelector:".js-cc_zipcode_p .js-cc-zipcode-required",expiryDateContainerSelector:".credit_card_holder .js-expiry_date_p",securityIndicatorSelector:".credit_card_holder .cc_number_security_indicator",securityBlurbSelector:".credit_card_holder .cc_security_blurb",useDifferentCardSelector:".credit_card_holder .use_different_card",supportedCardImageTypes:["generic_card","visa","mastercard","amex","discover","jcb","cvc_card","cvc_amex"],hasTriggeredCallForUserRiskAnalysis:!1,creditCardFormState:"new",grPaypalButtonSelector:".credit_card_holder .paypal",payWithPaypalHolderSelector:".js-pay-with-paypal-holder",payWithCreditCardHolderSelector:".js-pay-with-credit-card-holder",actualBraintreePayPalContainerSelector:".paypal-braintree-actual",actualPayPalContainerSelector:".credit_card_holder .paypal-actual",actualPayPalButton:".credit_card_holder .paypal-braintree-actual #braintree-paypal-button img",actualPayPalDataEmailSelector:".credit_card_holder .paypal-braintree-actual #bt-pp-email",actualPayPalDataCancelButtonSelector:".credit_card_holder .paypal-braintree-actual #bt-pp-cancel",payWithPayPalPromptSelector:".credit_card_holder .or-pay-with",braintreeNonceFieldSelector:".js-braintree-paypal-nonce",payPalLoadingIndicatorSelector:".js-paypal-loading-indicator",payWithPaypalTrigger:".js-pay-with-paypal-trigger",cancelPayWithPaypalTrigger:".js-cancel-pay-with-paypal-trigger",showPaypalCardSelector:".credit_card_holder",customerPayPalEmailContainerSelector:".js-paypal-customer-email",defaultCreditCardIconSelector:".js-credit-card-icon",orPayWithSelector:".js-pay-with-paypal-indicator",fullNameFieldSelector:".js-full-name-p",fullNameInputSelector:".js-full-name-input",fullNameRequestedVisible:!0,fullNameTrackingCreditCardFormState:"new",cardSaveRequired:!1,metaCardDataHandlingModeSelector:'meta[property="gr:card_data_handling_mode"]',metaStripePublicKeySelector:'meta[property="stripe:pk"]',metaPayPalOverrideSelector:'meta[property="gr:payment:show_paypal_override"]'}),this.setCreditCardFormState=function(t){var e=this.attr.creditCardFormState,n=t;this.attr.creditCardFormState=t,this.trigger("uiChangedCreditCardFormState",{oldCreditCardFormState:e,newCreditCardFormState:n})},this.showFullNameField=function(){this.attr.fullNameRequestedVisible=!0,"saved"!=this.attr.fullNameTrackingCreditCardFormState?this.select("fullNameFieldSelector").show():this.select("fullNameFieldSelector").hide()},this.hideFullNameField=function(){this.attr.fullNameRequestedVisible=!1,this.select("fullNameFieldSelector").hide()},this.creditCardFormStateChangedToggleFullname=function(t,e){this.attr.fullNameTrackingCreditCardFormState=e.newCreditCardFormState,this.attr.fullNameRequestedVisible?this.showFullNameField():this.hideFullNameField(),this.trigger("uiFullNameVisibilityChanged")},this.showZipcodeField=function(t){"new"==this.attr.user.card.credit&&0==this.select("ccZipcodeFieldContainerSelector").length&&this.renderDynamicZipcodeField(t)},this.renderDynamicZipcodeField=function(t){this.hideFullNameField(),this.select("expiryDateContainerSelector").after(e());var n=0,i=1,r="GB"==t?i:n,a=[I18n.t("js.zip_code"),I18n.t("js.postal")],s=["12345","W11 2BQ"],o=["52px","76px"],l=["128px","115px"];this.select("ccZipcodeLabelSelector").text(a[r]);var u=s[r];r==n&&"US"!=t&&(u=""),this.select("ccZipcodeFieldSelector").prop("placeholder",u),this.select("ccZipcodeFieldSelector").css("width",o[r]),this.select("ccZipcodeFieldContainerSelector").css("left",l[r])},this.isGeneric=function(){return"generic_card"==this.attr.currentCardType},this.isAmex=function(){return"amex"==this.attr.currentCardType},this.removeSavedCardAndShowNewCard=function(t){t.preventDefault();var e=this.select("rememberedSelector"),n=this.select("newCardSelector");e.addClass("cancelled-element"),this.trigger("uiRemoveSavedCreditCardStarted"),setTimeout(function(){n.hide().removeClass("hidden"),n.fadeIn(100,function(){e.hide(),this.select("ccNumberSelector").focus(),n.find("input").each(function(){$(this).addClass("required")})}.bind(this)),this.trigger("uiRemoveSavedCreditCardCompleted"),this.setCreditCardFormState("new")}.bind(this),300)},this.setRequiredFromCardFields=function(t){$.each(["ccNumberSelector","cvCodeSelector","expiryDateSelector","fullNameInputSelector"],function(e,n){this.select(n).toggleClass("required",t)}.bind(this))},this.updateCardType=function(){var t=this.select("ccNumberSelector").val();this.attr.currentCardType=$.payment.cardType(t),-1==$.inArray(this.attr.currentCardType,this.attr.supportedCardImageTypes)&&(this.attr.currentCardType="generic_card"),this.setCard(),this.updateSecurityIndicator()},this.updateSecurityIndicator=function(){var t=$.payment.validateCardNumber(this.select("ccNumberSelector").val());this.select("securityIndicatorSelector")[t?"addClass":"removeClass"]("valid")},this.setCard=function(){this.changeCardIcon(this.attr.currentCardType),this.select("cvCodeSelector").animate({width:this.isAmex()?39:31}).attr({placeholder:this.isAmex()?"1234":"123"})},this.changeCardIcon=function(t){this.select("securityIndicatorSelector").fadeOut(),this.select("ccIconSelector").removeClass(this.attr.supportedCardImageTypes.join(" ")).addClass(t).fadeIn()},this.showSecurityBlurb=function(){this.select("securityBlurbSelector").fadeIn()},this.hideSecurityBlurb=function(){setTimeout(function(){this.select("securityBlurbSelector").fadeOut()}.bind(this),300)},this.validateCreditCardForm=function(){if(this.payingWithPayPal())return!0;var t=this.select("ccNumberSelector"),e=this.select("expiryDateSelector"),n=this.select("cvCodeSelector"),i=!this.isRequired(t)||$.payment.validateCardNumber(t.val()),r=!this.isRequired(e)||$.payment.validateCardExpiry(e.payment("cardExpiryVal")),a=!this.isRequired(n)||$.payment.validateCardCVC(n.val(),$.payment.cardType(t.val()));return this.toggleError(t,i),this.toggleError(e,r),this.toggleError(n,a),i&&r&&a},this.userLoggedInAndElectedToSaveCard=function(){return this.attr.user&&this.attr.user.is_logged_in&&this.select("saveCardSelector").prop("checked")},this.shouldSaveCard=function(){return this.userLoggedInAndElectedToSaveCard()||this.isCardSaveRequired()},this.getReusableCardParams=function(t){return this.payingWithPayPal()?void this.preparePayPalPayment(t):void t({cardParams:null})},this.getCardParams=function(t){if("new"!=this.attr.creditCardFormState)return void t({cardParams:{}});if(this.payingWithPayPal())return void this.preparePayPalPayment(t);var e=this.select("ccNumberSelector").val(),n=this.select("expiryDateSelector").val(),i=this.select("cvCodeSelector").val(),r=this.select("ccZipcodeFieldSelector").val(),a={number:e,expiryDate:n,cvc:i.length>0?i:null,zipCode:r};this.trigger("uiNeedsCardPrepared",{associatedData:{callback:t},cardData:a})},this.clearCvc=function(){this.select("cvCodeSelector").val("")},this.prepareCardCompleted=function(t,e){e.associatedData.callback({cardParams:e.cardParams})},this.isRequired=function(t){return t.hasClass("required")&&t.is(":visible")},this.toggleError=function(t,e){e?this.hideError(t):this.showError(t)},this.setCardSaveRequired=function(t){this.attr.cardSaveRequired=t},this.isCardSaveRequired=function(){return this.attr.cardSaveRequired},this.getDebugCcNumber=function(){var t=window.location.search.match(/debugCcNumber=([0-9]{13,16})/);if(t&&2===t.length){var e=t[1];switch(e){case"4000000000000077":case"4000000000000259":return e.match(/[0-9]{4}/g).join(" ")}}return"4242 4242 4242 4242"},this.after("initialize",function(){var t=!!window.location.search.match(/debug/);n.attachTo(this.$node,{cardDataHandlingMode:$(this.attr.metaCardDataHandlingModeSelector).attr("value"),stripePk:$(this.attr.metaStripePublicKeySelector).attr("value")}),this.on("dataCardPrepared",this.prepareCardCompleted),this.on("click",{useDifferentCardSelector:this.removeSavedCardAndShowNewCard}),this.on("keyup paste",{ccNumberSelector:this.updateCardType}),this.on("uiChangedCreditCardFormState",this.creditCardFormStateChangedToggleFullname),this.select("ccNumberSelector").payment("formatCardNumber"),this.select("expiryDateSelector").payment("formatCardExpiry"),this.select("cvCodeSelector").payment("formatCardCVC"),this.select("securityIndicatorSelector").hover(this.showSecurityBlurb.bind(this),this.hideSecurityBlurb.bind(this));var e=this.select("creditCardHolder").data("formState");if("undefined"!=typeof e&&(this.attr.creditCardFormState=e),t){var i=(new Date).getFullYear(),r=String(i),a=r.substr(-2);this.select("ccNumberSelector").val(this.getDebugCcNumber()),this.select("expiryDateSelector").val("12/"+a),this.select("cvCodeSelector").val("123"),this.select("fullNameInputSelector").val("Mr. Gumstein")}})}return a}),define("$app/ui/product/with_credit_card_on_payment_form",["$app/ui/shared/with_credit_card","flight/lib/compose"],function(t,e){function n(){e.mixin(this,[t]),this.defaultAttrs({creditCardHolderSelector:".credit_card_holder",cardErrorSelector:".card_error_popup",cardErrorPopupMessageSelector:".card_error_popup .message",rememberedCardIconSelector:".remembered .card_icon",presetCCNumberSelector:".preset_cc_number",presetCCInputSelector:".saved_card .js-expiry_date_p .preset_cc_input",saveCardSelector:'input[name="save_card"]',savePayPalSelector:".js-save-paypal-selector",keepOnFileSelector:".keep-on-file-notice",creditCardRequiredFieldSelector:".credit_card_holder .credit_card.new-card .required",numericSelector:".credit_card_holder .numeric",numericSpacesSelector:".credit_card_holder .numeric-spaces",isCreditCardFormInUse:!1}),this.setCreditCardFormInUse=function(t){this.attr.isCreditCardFormInUse=t},this.isCreditCardFormInUse=function(){return this.attr.isCreditCardFormInUse},this.setCreditCard=function(){this.setCreditCardFormState(this.attr.user.card.credit);var t=this.select("testCardSelector"),e=this.select("newCardSelector"),n=this.select("savedCardSelector"),i=this.select("creditCardRequiredFieldSelector");"test"!=this.attr.user.card.credit||this.attr.isDemo?"saved"!=this.attr.user.card.credit||this.attr.isDemo?"new"==this.attr.user.card.credit&&(n.remove(),t.remove()):(t.remove(),"paypal"==this.attr.user.card.type?(this.select("rememberedSelector").hide(),this.select("keepOnFileSelector").hide(),n.hide(),e.fadeIn(),this.setSavedPayPalCardInUse(this.attr.user.card.visual)):(this.select("presetCCNumberSelector").html(this.attr.user.card.visual),this.select("presetCCInputSelector").html(this.attr.user.card.date),this.select("rememberedCardIconSelector").addClass(this.attr.user.card.type),n.fadeIn(),e.fadeOut()),i.removeClass("required")):(this.attr.isSamplePurchase=!0,t.fadeIn(),e.fadeOut(),n.remove(),i.removeClass("required"))},this.setCreditCardFormVisibility=function(t){t+this.attr.shippingCents>0&&!this.attr.isMultiBuyEnabled?this.showCreditCardForm():0==t&&0==this.attr.shippingCents&&this.hideCreditCardForm()},this.showCreditCardForm=function(){var t=this.select("creditCardHolderSelector"),e=this.select("payButtonSelector");this.select("paymentFormSelector");this.attr.zeroPlusEnabled?e.text(I18n.t("js.give_prompt")):e.text(e.data("default")),t.show(),this.trigger("uiAnimatePaymentFormHeight",{animate:!1})},this.hideCreditCardForm=function(){var t=this.select("creditCardHolderSelector"),e=this.select("payButtonSelector");this.select("paymentFormSelector");t.is(":visible")&&(e.text(I18n.t("js.get_prompt")),t.hide(),this.trigger("uiAnimatePaymentFormHeight",{animate:!1}))},this.makeCreditCardUsable=function(){var t=this.select("creditCardHolderSelector");t.addClass("usable"),t.find("input").prop("readonly",!1)},this.makeCreditCardNotUsable=function(){var t=this.select("creditCardHolderSelector");t.removeClass("usable"),t.find("input").prop("readonly",!0)},this.popupCreditCardError=function(t){var e=this.select("cardErrorSelector");this.select("cardErrorPopupMessageSelector").text(t),e.removeClass("hidden").fadeIn(400),setTimeout(function(){e.fadeOut(400)},3e3)},this.showCreditCardError=function(t,e){this.popupCreditCardError(e.error_message)},this.payIfEnterKeyPressed=function(t){13==t.which&&this.payIfAllowed()},this.hideAndUncheckPayPalSelector=function(){this.select("saveCardSelector").prop("checked",!1),this.select("savePayPalSelector").hide()},this.syncSaveCardCheckboxes=function(t){this.select("saveCardSelector").prop("checked",$(t.target).prop("checked"))},this.after("initialize",function(){this.on("keypress",{numericSelector:this.payIfEnterKeyPressed,numericSpacesSelector:this.payIfEnterKeyPressed}),this.on("click",{saveCardSelector:this.syncSaveCardCheckboxes}),this.on(document,"uiNeedsToShowCreditCardError",this.showCreditCardError)})}return n}),define("$app/utils/currency_utils",[],function(){var t={parseCurrencyString:function(t){if(!t)return null;var e=t.match(/\s*-/)?"-":"",n=t.replace(/[^0-9.,]/g,""),i=n.lastIndexOf("."),r=n.lastIndexOf(","),a=i>0&&i==n.length-4,s=r>0&&r==n.length-4;return i>=n.length-3&&i>0||s?(n=n.replace(/,/g,""),n=n.match(/\./g)&&1==n.match(/\./g).length?n.replace(/,/g,""):n.replace(/[^0-9]/g,""),e+n):r>=n.length-3&&r>0||a?(n=n.replace(/\./g,""),n=n.match(/,/g)&&1==n.match(/,/g).length?n.replace(",","."):n.replace(/[^0-9]/g,""),e+n):-1==r&&-1==i?e+n:null}};return t}),define("$app/ui/product/with_pay_what_you_want",["$app/ui/shared/with_form_base","$app/utils/currency_utils","flight/lib/compose"],function(t,e,n){function i(){n.mixin(this,[t]),this.defaultAttrs({productPriceWrapperSelector:".link_price_wrapper",payWhatYouWantSelectionSelector:".pay_what_you_want_selection",priceRangeSelector:".link_price_range",zeroPlusEnabled:!1}),this.setPriceRange=function(t){var e=t%1==0?t:t.toFixed(2),n=this.select("priceRangeSelector");this.attr.isPayWhatYouWant&&(e+="+"),(!n.data("suggested-price")||n.data("suggested-price")<t)&&n.attr("placeholder",e),n.data("min-price",t)},this.validatePriceRange=function(){var t=this.select("priceRangeSelector"),n=parseFloat(t.data("min-price")),i=e.parseCurrencyString(t.val()),r=parseFloat(i||-1);return"undefined"==typeof r||n>r||0==n&&0>r?(this.showError(t),t.focus(),!1):!0},this.toggleCreditCardForm=function(){var t=this.select("priceRangeSelector");if(t.length>0&&0==t.val().length||this.select("paymentFormSelector").is(":animated")||this.attr.isMultiBuyEnabled)return!1;var e=parseFloat(t.val());return this.attr.zeroPlusEnabled&&this.trigger("uiNeedsToEvaluateCreditCardFormVisibility",e),!1},this.customizedPriceCents=function(){return this.validatePriceRangeString()?e.parseCurrencyString(this.select("priceRangeSelector").val())*(this.attr.isSingleUnit?1:100):null},this.validatePriceRangeString=function(){return!isNaN(parseFloat(e.parseCurrencyString(this.select("priceRangeSelector").val())))},this.after("initialize",function(){this.on("keyup",{priceRangeSelector:this.toggleCreditCardForm}),this.on("keyup",{priceRangeSelector:this.setPrice})})}return i}),function(t,e){function n(e){return e.map(function(){return this.elements?t.makeArray(this.elements):this}).filter(":input:not(:disabled)").get()}function i(n){var i,r={};return t.each(n,function(n,a){i=r[a.name],r[a.name]=i===e?a:t.isArray(i)?i.concat(a):[i,a]}),r}var r=Array.prototype.push,a=/^(?:radio|checkbox)$/i,s=/\+/g,o=/^(?:option|select-one|select-multiple)$/i,l=/^(?:button|color|date|datetime|datetime-local|email|hidden|month|number|password|range|reset|search|submit|tel|text|textarea|time|url|week)$/i;t.fn.deserialize=function(u,c){var h,d,p=n(this),f=[];if(!u||!p.length)return this;if(t.isArray(u))f=u;else if(t.isPlainObject(u)){var m,g;for(m in u)t.isArray(g=u[m])?r.apply(f,t.map(g,function(t){return{name:m,value:t}})):r.call(f,{name:m,value:g})}else if("string"==typeof u){var y;for(u=u.split("&"),h=0,d=u.length;d>h;h++)y=u[h].split("="),r.call(f,{name:decodeURIComponent(y[0]),value:decodeURIComponent(y[1].replace(s,"%20"))})}if(!(d=f.length))return this;var v,_,S,b,w,P,C,g,k=t.noop,x=t.noop,E={};for(c=c||{},p=i(p),t.isFunction(c)?x=c:(k=t.isFunction(c.change)?c.change:k,x=t.isFunction(c.complete)?c.complete:x),h=0;d>h;h++)if(v=f[h],w=v.name,g=v.value,(_=p[w])&&(C=(b=_.length)?_[0]:_,C=(C.type||C.nodeName).toLowerCase(),P=null,l.test(C)?(b&&(S=E[w],_=_[E[w]=S==e?0:++S]),k.call(_,_.value=g)):a.test(C)?P="checked":o.test(C)&&(P="selected"),P))for(b||(_=[_],b=1),S=0;b>S;S++)v=_[S],v.value==g&&k.call(v,(v[P]=!0)&&g);return x.call(this),this}}(jQuery),define("$vendor/jquery.deserialize",function(){}),define("$app/ui/product/with_payment_form",["$app/ui/product/with_envelope","$app/ui/product/with_credit_card_on_payment_form","$app/ui/product/with_pay_what_you_want","$app/ui/product/third_party_analytics","$app/ui/shared/with_form_base","$app/utils/with_url","$app/utils/with_event","flight/lib/compose","$vendor/jquery.deserialize"],function(t,e,n,i,r,a,s,o){function l(){o.mixin(this,[t,e,n,r,a,s]),this.defaultAttrs({paymentFormSelector:".buy-form-main",paymentContainerSelector:".payment-container",payButtonContainerSelector:".pay_button_container",permalinkSelector:".permalink",payButtonSelector:".pay_button",urlParamsSelector:".url_parameters",fromProfileSelector:".from_profile",fromMultiOverlaySelector:".from-multi-overlay",socialSignupWrapperSelector:".social-signup-wrapper",purchaseFormSelector:".purchase_form",changedMindButtonSelector:".changed_mind_button",parentIdSelector:".parent_id",referrerSelector:".referrer",pluginsSelector:".plugins",sourceSelector:".source",isPreorderSelector:".is_in_preorder_state",isPhysicalSelector:".is_physical",wasProductRecommendedSelector:".js-was-product-recommended",recommendedBySelector:".js-recommended-by",purchaseFormRequiredFieldSelector:".purchase_form .required",envelopeRequiredFieldSelector:".envelope .required",authenticityTokenSelector:'input[name="authenticity_token"]',utf8Selector:'input[name="utf8"]',zipcodeFieldSelector:"input.js-cc_zipcode",bundleBuyButtonSelector:".js-bundle-pay-trigger",localeSelector:".js-locale",isSamplePurchase:!1,isProcessingPayment:!1,isSingleUnit:!1,offerCodeUsed:!1,taxCountry:"",paymentFormPadding:20}),this.setLoginInfo=function(){this.attr.user.is_logged_in?(this.setSubscriptionNotice(),this.select("passwordPSelector").remove(),this.select("socialSignupWrapperSelector").remove(),this.select("creditCardHolderSelector").addClass("usable"),this.attr.isModal||this.attr.isEmbed||this.trigger("uiNeedsToGetCustomizationModules",{permalink:this.attr.permalink}),this.select("emailReceiptFormSelector").hide()):this.select("keepOnFileSelector").hide()},this.payIfAllowed=function(t){return t&&t.preventDefault(),!this.attr.isShowingPaymentForm||this.attr.isProcessingPayment||this.attr.isProductDisabled||this.validatePaymentForm(),this.trigger("uiSwitchSteps",{step:2}),!1},this.validatePaymentForm=function(){for(var t=!0,e=this.isFreePurchase()?this.select("envelopeRequiredFieldSelector"):this.select("purchaseFormRequiredFieldSelector"),n=0;n<e.length;n++)t&&(t=this.validateRequiredInput($(e[n])));return t=t&&this.validateEmailsIfNotAutoFill()&&this.validateQuantity(),this.isFreePurchase()||(t=t&&this.validateCreditCardForm()),t&&(this.showPaymentAsProcessing(),this.verifyShippingAddress()),t},this.isFreePurchase=function(){var t=this.select("priceRangeSelector"),e=0==parseFloat(this.attr.shippingCents),n=0==parseFloat(t.val())&&e,i=this.attr.productsInBundle&&0==this.totalBundlePriceCents()&&0==this.totalBundleShippingRateCents(),r=0==t.length&&0==parseFloat(this.select("perceivedPriceCentsSelector").val())&&e;return!!(n||i||r)},this.makePayment=function(){return this.attr.isProcessingPayment=!0,(this.isFreePurchase()||this.attr.isSamplePurchase)&&this.setPasswordPromptForAccountCreationInReceipt(),this.select("changedMindButtonSelector").hide(),this.select("receiptContainerSelector").fadeIn(),this.processPayment(),!1},this.setPaymentAsProcessingForMultiBuyMode=function(){return this.attr.isProcessingPayment=!0,this.select("receiptContainerSelector").fadeIn(),!0},this.showPaymentAsProcessing=function(){var t=this.select("payButtonSelector");this.select("paymentFormSelector").animate({height:this.getPaymentFormHeight()}),t.data("default",t.text()),t.text(I18n.t("js.processing_notice")),t.attr("disabled",!0),this.select("payWithPaypalHolderSelector").hide(),this.select("payWithCreditCardHolderSelector").hide(),this.trigger("uiShouldHideTipsys")},this.resetPayButton=function(){var t=this.select("payButtonSelector");t.attr("disabled",!1),t.text(t.data("default")),this.select("payWithPaypalHolderSelector").show(),this.select("payWithCreditCardHolderSelector").show()},this.processPayment=function(){this.trigger("uiNeedsToTrackProductSpecificEvent",{name:"process_payment",permalink:this.attr.permalink,wasProductRecommended:this.attr.wasProductRecommended}),this.trigger("uiSetFriendValue"),this.isFreePurchase()||this.attr.isDemo?(this.setCreditCardFormInUse(!1),this.processPaymentWithCardParams({})):(this.setCreditCardFormInUse(!0),this.getCardParams(function(t){this.processPaymentWithCardParams(t.cardParams)}.bind(this)))},this.processPaymentWithCardParams=function(t){var e=this.select("wantFormSelector").serialize()+"&"+this.select("purchaseFormSelector").serialize()+"&"+$.param(t)+"&"+$.param({tax_country_election:this.attr.taxCountry})+"&"+$.param({is_rental:this.attr.isRentalModeActive});this.attr.isRecurringBilling&&(e+="&"+$.param({price_id:this.attr.selectedPriceInfo.id})),this.trigger("uiNeedsToMakePayment",{permalink:this.attr.permalink,is_bundled:!1,payingWithPayPal:this.attr.payingWithPayPal,serializedForm:e})},this.notifyGoogleAnalytics=function(t,e){this.trigger("uiNeedsToTrackActivityWithSellerGoogleAnalytics",{permalink:e.permalink,action:"purchased",value:(Number(e.non_formatted_price)*(this.attr.isSingleUnit?1:100)).toString()}),this.trigger("uiNeedsToTrackECommerceEventWithSellerGoogleAnalytics",{permalink:e.permalink,purchase_external_id:e.id,currency:e.currency_type.toUpperCase(),product_name:e.name,price:e.non_formatted_price,quantity:e.quantity,tax:e.non_formatted_seller_tax_amount})},this.notifyRetargeting=function(t,e){this.trigger("uiNeedsToTrackECommerceOrder",{externalId:e.id,total:Number(e.total_price_including_tax_and_shipping.replace(/[^0-9\.]+/g,"")),tax:Number(e.non_formatted_seller_tax_amount)||0,shipping:Number(e.shipping_amount.replace(/[^0-9\.]+/g,""))||0,currency:e.currency_type.toUpperCase(),productExternalId:e.product_id})},this.getThirdPartyAnalytics=function(t,e){this.trigger(this.$node,"uiToAddThirdPartyAnalytics",{permalink:e.permalink,purchase_id:e.id})},this.notifyPurchaseAndShowReceipt=function(t,e){this.attr.isProcessingPayment=!1,this.select("payButtonSelector").attr("disabled",!1),this.attr.permalink==e.permalink&&(this.fillReceiptWithPurchaseDetails(e),this.attr.user.product.remaining=e.remaining,this.attr.user.product.variants=e.variants,this.hideGiftInputs(),this.trigger("uiSetTwitterSharingUrlForPurchase",{url:e.twitter_share_url,text:e.twitter_share_text}),this.trigger("uiCompleteDemo"),this.showReceipt(!0),this.attr.purchaseWasGift="true"==this.select("giftSignifierSelector").val())},this.notifyClearCvc=function(){this.clearCvc()},this.notifyRecommendations=function(){this.trigger("uiNeedstoRememberPersonalBuyerInfo",{ccNumber:this.select("ccNumberSelector").val(),expiryDate:this.select("expiryDateSelector").val(),fullName:this.select("fullNameSelector").val(),email:this.select("emailSelector").val()})},this.getRecommendedProducts=function(t,e){this.shouldFetchRecommendedProducts()&&this.trigger("uiNeedsToGetRecommendedProducts",{permalink:e.permalink})},this.shouldFetchRecommendedProducts=function(){return!this.attr.onUserProfile&&!this.attr.isEmbed&&!this.attr.isMobile},this.stopProcessingAndShowError=function(t,e){if(e.zipcode_required&&(this.showZipcodeField(e.card_country),this.select("zipcodeFieldSelector").addClass("required error")),this.attr.permalink==e.permalink){var n=e&&e.error_message?e.error_message:I18n.t("js.something_went_wrong_notice");this.select("creditCardHolderSelector").is(":visible")&&this.select("envelopeSelector").is(":visible")?this.popupCreditCardError(n):this.trigger("uiShowFlashMessage",{message:n}),this.resetPayButton(),this.select("changedMindButtonSelector").show(),this.select("receiptContainerSelector").fadeOut(function(){this.select("paymentFormSelector").animate({height:this.getPaymentFormHeight()})}.bind(this)),this.attr.isProcessingPayment=!1}},this.showCheckEmailNotice=function(t,e){this.attr.isProcessingPayment=!1,this.select("payButtonSelector").attr("disabled",!1),this.attr.permalink===e.permalink&&(this.hideGiftInputs(),this.trigger("uiCompleteDemo"),this.showCheckEmailReceipt(),this.attr.purchaseWasGift="true"==this.select("giftSignifierSelector").val())},this.getPaymentFormHeight=function(){var t=this.select("paymentContainerSelector");if(t.length>0){var e=t.height()+2*this.attr.paymentFormPadding;return this.attr.isMobile&&(e-=this.attr.paymentFormPadding),this.attr.paymentFormHeight>0&&(e=this.attr.paymentFormHeight,this.setPaymentFormHeight(0)),e}return 0},this.setPaymentFormHeight=function(t){this.attr.paymentFormHeight=t},this.resetAndShowProductMain=function(t){return t.preventDefault(),this.trigger("uiSwitchSteps",{step:0}),this.switchToProductMain(!0),!1},this.disablePayButton=function(){this.disablePayPalButton(),this.select("payButtonSelector").attr("disabled",!0)},this.enablePayButton=function(){this.enablePayPalButton(),this.select("payButtonSelector").attr("disabled",!1)},this.getSerializedFormExcludingCreditCard=function(){var t="textarea, select, input:not("+this.attr.utf8Selector+", "+this.attr.authenticityTokenSelector+", "+this.attr.permalinkSelector+", "+this.attr.isPreorderSelector+", "+this.attr.isPhysicalSelector+", "+this.attr.parentIdSelector+", "+this.attr.saveCardSelector+", "+this.attr.ccNumberSelector+", "+this.attr.expiryDateSelector+", "+this.attr.cvCodeSelector+")";return this.select("purchaseFormSelector").find(t).serialize()},this.updateUrlParameters=function(t,e){this.select("urlParamsSelector").val(JSON.stringify(e))},this.validateBundleCheckoutForm=function(){var t=!0,e=this.select("bundleCheckoutFormSelector").find(".required:visible, .required-placeholder:visible");return $.each(e,function(e,n){return this.validateRequiredInput($(n))?void 0:(t=!1,!1)}.bind(this)),t},this.after("initialize",function(){this.select("urlParamsSelector").val(JSON.stringify(this.getUrlParams())),this.select("referrerSelector").val(this.getReferrer()),this.select("pluginsSelector").val(this.getPluginNames()),this.select("sourceSelector").val(this.getSource()),this.select("localeSelector").val(I18n.locale),this.select("fromProfileSelector").val(this.attr.onUserProfile),this.select("fromMultiOverlaySelector").val(this.attr.onMultiOverlay),this.select("wasProductRecommendedSelector").val(this.attr.wasProductRecommended),this.select("recommendedBySelector").val(this.attr.recommendedBy),this.attr.isMobile&&this.select("payButtonSelector").addClass("small");var t=this.select("productSelector").data("seller-has-third-party-analytics");t&&(i.attachTo(this.$node),this.trigger("uiThirdPartyAnalyticsEnabled")),this.on(document,"uiNeedsToCheckForRecommendedProducts",this.getRecommendedProducts),this.on(document,"dataPurchaseSuccessful",this.notifyClearCvc),this.on(document,"dataPurchaseSuccessful",this.notifyPurchaseAndShowReceipt),this.on(document,"dataPurchaseSuccessful",this.notifyGoogleAnalytics),this.on(document,"dataPurchaseSuccessful",this.notifyRecommendations),this.on(document,"dataPurchaseSuccessful",this.getRecommendedProducts),this.on(document,"dataPurchaseSuccessful",this.getThirdPartyAnalytics),this.on(document,"dataPurchaseSuccessful",this.notifyRetargeting),this.on(document,"dataPurchaseFail",this.stopProcessingAndShowError),this.on(document,"dataPurchaseTimeout",this.showCheckEmailNotice),this.on(document,"dataPurchaseTimeout",this.getRecommendedProducts),this.on(document,"uiShowProductMain",this.resetAndShowProductMain),this.on(document,"uiUpdateUrlParameters",this.updateUrlParameters),this.on(this.$node,"uiShouldDisablePayButton",this.disablePayButton),this.on(this.$node,"uiShouldEnablePayButton",this.enablePayButton),this.on(this.$node,"uiShouldResetPayButton",this.resetPayButton),this.on("click",{changedMindButtonSelector:this.resetAndShowProductMain,payButtonSelector:this.payIfAllowed})})}return l}),define("$app/ui/product/with_offer_code",[],function(){function t(){this.defaultAttrs({offerCodeSelector:".offer_code_name",offerCodeFieldSelector:".offer_code_field",offerCodePSelector:".js-offer-code-p"}),this.setOfferCode=function(){var t=this.select("offerCodeSelector");this.attr.offerCodeUsed&&(this.attr.user.product.offer_code.is_valid?t.val(decodeURIComponent(this.attr.offerCodeName)):(t.val(this.select("offerCodeFieldSelector").val()),this.trigger("uiShowFlashMessage",{message:this.attr.user.product.offer_code.error_message})),this.setPrice())},this.updateOfferCode=function(t,e){if(this.attr.productsInBundle&&e.success){for(var n=0;n<this.attr.productsInBundle.length;n++)if(this.attr.productsInBundle[n].permalink===e.permalink){var i=this.attr.productsInBundle[n].originalPriceCents;i-=e.is_percent?(i*(e.offer_code_amount/100)).toFixed():e.offer_code_amount*this.attr.productsInBundle[n].quantity,
this.attr.productsInBundle[n].perceivedPriceCents=i,this.attr.productsInBundle[n].offerCodeName=e.name||this.attr.offerCodeName,this.attr.productsInBundle[n].hasOfferCodeField=!0}this.updateBundleButton()}else e.permalink==this.attr.permalink&&(this.attr.user.product.offer_code.is_valid=e.success,this.attr.user.product.offer_code.is_valid?(this.attr.user.product.offer_code.amount=e.offer_code_amount,this.attr.user.product.offer_code.is_percent=e.is_percent):(this.attr.user.product.offer_code.amount=0,this.trigger("uiShowFlashMessage",{message:e.error_message})),this.setPrice());this.trigger("uiShouldEnablePayButton")},this.removeLoadingIndicator=function(){this.select("offerCodeFieldSelector").removeClass("loading")},this.scheduleUpdateOfferCodeName=function(){0!=this.select("offerCodeFieldSelector").val().length?(this.select("offerCodeFieldSelector").addClass("loading"),this.trigger("uiShouldDisablePayButton")):this.removeLoadingIndicator(),this.delay(function(){this.attr.productsInBundle?this.updateOfferCodeNameForBundle():this.updateOfferCodeNameForProduct()}.bind(this),0)},this.updateOfferCodeNameForBundle=function(){this.setOfferCodeName(this.select("offerCodeFieldSelector").val()),this.delay(function(){if(this.attr.offerCodeUsed)for(var t=0;t<this.attr.productsInBundle.length;t++)this.trigger("uiNeedsToGetOfferCode",{offerCode:this.attr.offerCodeName,permalink:this.attr.productsInBundle[t].permalink})}.bind(this),2e3)},this.updateOfferCodeNameForProduct=function(){this.setOfferCodeName(this.select("offerCodeFieldSelector").val()),this.attr.offerCodeUsed||this.setPrice(),this.delay(function(){this.attr.offerCodeUsed&&this.trigger("uiNeedsToGetOfferCode",{offerCode:this.attr.offerCodeName,permalink:this.attr.permalink})}.bind(this),2e3)},this.setOfferCodeName=function(t){this.attr.usingSetOfferCode=!0,this.attr.offerCodeName=t,this.select("offerCodeSelector").val(this.attr.offerCodeName),this.attr.offerCodeUsed=!!this.attr.offerCodeName},this.delay=function(){var t=0;return function(e,n){clearTimeout(t),t=setTimeout(e,n)}}(),this.isOfferCodeApplicable=function(){return this.attr.offerCodeUsed&&this.attr.user.product.offer_code.is_valid},this.getOfferCodeNameFromUrl=function(){var t=location.pathname.match(/\/.*\/.*\/(.*)\//);return t||(t=location.pathname.match(/\/.*\/.*\/(.*)/)),t?t[1]:null},this.isUsingPresetOfferCode=function(){return!this.attr.usingSetOfferCode&&this.isOfferCodeApplicable()},this.after("initialize",function(){this.on(document,"dataOfferCode",this.updateOfferCode),this.on(document,"dataOfferCode",this.removeLoadingIndicator),this.on("keyup",{offerCodeFieldSelector:this.scheduleUpdateOfferCodeName}),this.on("paste",{offerCodeFieldSelector:this.scheduleUpdateOfferCodeName}),this.attr.offerCodeUsed&&this.select("offerCodePSelector").remove()})}return t}),!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function n(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function i(t){return null===t?NaN:+t}function r(t){return!isNaN(t)}function a(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var a=i+r>>>1;t(e[a],n)<0?i=a+1:r=a}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var a=i+r>>>1;t(e[a],n)>0?r=a:i=a+1}return i}}}function s(t){return t.length}function o(t){for(var e=1;t*e%1;)e*=10;return e}function l(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function u(){this._=Object.create(null)}function c(t){return(t+="")===fs||t[0]===ms?ms+t:t}function h(t){return(t+="")[0]===ms?t.slice(1):t}function d(t){return c(t)in this._}function p(t){return(t=c(t))in this._&&delete this._[t]}function f(){var t=[];for(var e in this._)t.push(h(e));return t}function m(){var t=0;for(var e in this._)++t;return t}function g(){for(var t in this._)return!1;return!0}function y(){this._=Object.create(null)}function v(t){return t}function _(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function S(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=gs.length;i>n;++n){var r=gs[n]+e;if(r in t)return r}}function b(){}function w(){}function P(t){function e(){for(var e,i=n,r=-1,a=i.length;++r<a;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new u;return e.on=function(e,r){var a,s=i.get(e);return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,a=n.indexOf(s)).concat(n.slice(a+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function C(){es.event.preventDefault()}function k(){for(var t,e=es.event;t=e.sourceEvent;)e=t;return e}function x(t){for(var e=new w,n=0,i=arguments.length;++n<i;)e[arguments[n]]=P(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=es.event;r.target=t,es.event=r,e[r.type].apply(n,i)}finally{es.event=a}}},e}function E(t){return vs(t,ws),t}function T(t){return"function"==typeof t?t:function(){return _s(t,this)}}function A(t){return"function"==typeof t?t:function(){return Ss(t,this)}}function M(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function a(){this.setAttributeNS(t.space,t.local,e)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=es.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?o:s:t.local?a:r}function j(t){return t.trim().replace(/\s+/g," ")}function I(t){return new RegExp("(?:^|\\s+)"+es.requote(t)+"(?:\\s+|$)","g")}function N(t){return(t+"").trim().split(/^|\s+/)}function F(t,e){function n(){for(var n=-1;++n<r;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);++n<r;)t[n](this,i)}t=N(t).map(R);var r=t.length;return"function"==typeof e?i:n}function R(t){var e=I(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",j(r+" "+t))):n.setAttribute("class",j(r.replace(e," ")))}}function L(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function a(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?a:r}function B(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function O(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n?e.createElementNS(n,t):e.createElement(t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=es.ns.qualify(t)).local?n:e}function D(){var t=this.parentNode;t&&t.removeChild(this)}function $(t){return{__data__:t}}function q(t){return function(){return bs(this,t)}}function U(t){return arguments.length||(t=n),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function z(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,a=t[n],s=0,o=a.length;o>s;s++)(r=a[s])&&e(r,s,n);return t}function H(t){return vs(t,Cs),t}function W(t){var e,n;return function(i,r,a){var s,o=t[a].update,l=o.length;for(a!=n&&(n=a,e=0),r>=e&&(e=r+1);!(s=o[e])&&++e<l;);return s}}function V(t,e,n){function i(){var e=this[s];e&&(this.removeEventListener(t,e,e.$),delete this[s])}function r(){var r=l(e,is(arguments));i.call(this),this.addEventListener(t,this[s]=r,r.$=n),r._=e}function a(){var e,n=new RegExp("^__on([^.]+)"+es.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var s="__on"+t,o=t.indexOf("."),l=Y;o>0&&(t=t.slice(0,o));var u=ks.get(t);return u&&(t=u,l=J),o?e?r:i:e?b:a}function Y(t,e){return function(n){var i=es.event;es.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{es.event=i}}}function J(t,e){var n=Y(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function G(n){var i=".dragsuppress-"+ ++Es,r="click"+i,a=es.select(e(n)).on("touchmove"+i,C).on("dragstart"+i,C).on("selectstart"+i,C);if(null==xs&&(xs="onselectstart"in n?!1:S(n.style,"userSelect")),xs){var s=t(n).style,o=s[xs];s[xs]="none"}return function(t){if(a.on(i,null),xs&&(s[xs]=o),t){var e=function(){a.on(r,null)};a.on(r,function(){C(),e()},!0),setTimeout(e,0)}}}function K(t,n){n.changedTouches&&(n=n.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var r=i.createSVGPoint();if(0>Ts){var a=e(t);if(a.scrollX||a.scrollY){i=es.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var s=i[0][0].getScreenCTM();Ts=!(s.f||s.e),i.remove()}}return Ts?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var o=t.getBoundingClientRect();return[n.clientX-o.left-t.clientLeft,n.clientY-o.top-t.clientTop]}function Q(){return es.event.changedTouches[0].identifier}function Z(t){return t>0?1:0>t?-1:0}function X(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function tt(t){return t>1?0:-1>t?js:Math.acos(t)}function et(t){return t>1?Fs:-1>t?-Fs:Math.asin(t)}function nt(t){return((t=Math.exp(t))-1/t)/2}function it(t){return((t=Math.exp(t))+1/t)/2}function rt(t){return((t=Math.exp(2*t))-1)/(t+1)}function at(t){return(t=Math.sin(t/2))*t}function st(){}function ot(t,e,n){return this instanceof ot?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof ot?new ot(t.h,t.s,t.l):bt(""+t,wt,ot):new ot(t,e,n)}function lt(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?a+(s-a)*t/60:180>t?s:240>t?a+(s-a)*(240-t)/60:a}function r(t){return Math.round(255*i(t))}var a,s;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,s=.5>=n?n*(1+e):n+e-n*e,a=2*n-s,new yt(r(t+120),r(t),r(t-120))}function ut(t,e,n){return this instanceof ut?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ut?new ut(t.h,t.c,t.l):t instanceof ht?pt(t.l,t.a,t.b):pt((t=Pt((t=es.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ut(t,e,n)}function ct(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ht(n,Math.cos(t*=Rs)*e,Math.sin(t)*e)}function ht(t,e,n){return this instanceof ht?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ht?new ht(t.l,t.a,t.b):t instanceof ut?ct(t.h,t.c,t.l):Pt((t=yt(t)).r,t.g,t.b):new ht(t,e,n)}function dt(t,e,n){var i=(t+16)/116,r=i+e/500,a=i-n/200;return r=ft(r)*Vs,i=ft(i)*Ys,a=ft(a)*Js,new yt(gt(3.2404542*r-1.5371385*i-.4985314*a),gt(-.969266*r+1.8760108*i+.041556*a),gt(.0556434*r-.2040259*i+1.0572252*a))}function pt(t,e,n){return t>0?new ut(Math.atan2(n,e)*Ls,Math.sqrt(e*e+n*n),t):new ut(NaN,NaN,t)}function ft(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function mt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function gt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function yt(t,e,n){return this instanceof yt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof yt?new yt(t.r,t.g,t.b):bt(""+t,yt,lt):new yt(t,e,n)}function vt(t){return new yt(t>>16,t>>8&255,255&t)}function _t(t){return vt(t)+""}function St(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function bt(t,e,n){var i,r,a,s=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(kt(r[0]),kt(r[1]),kt(r[2]))}return(a=Qs.get(t))?e(a.r,a.g,a.b):(null==t||"#"!==t.charAt(0)||isNaN(a=parseInt(t.slice(1),16))||(4===t.length?(s=(3840&a)>>4,s=s>>4|s,o=240&a,o=o>>4|o,l=15&a,l=l<<4|l):7===t.length&&(s=(16711680&a)>>16,o=(65280&a)>>8,l=255&a)),e(s,o,l))}function wt(t,e,n){var i,r,a=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),o=s-a,l=(s+a)/2;return o?(r=.5>l?o/(s+a):o/(2-s-a),i=t==s?(e-n)/o+(n>e?6:0):e==s?(n-t)/o+2:(t-e)/o+4,i*=60):(i=NaN,r=l>0&&1>l?0:i),new ot(i,r,l)}function Pt(t,e,n){t=Ct(t),e=Ct(e),n=Ct(n);var i=mt((.4124564*t+.3575761*e+.1804375*n)/Vs),r=mt((.2126729*t+.7151522*e+.072175*n)/Ys),a=mt((.0193339*t+.119192*e+.9503041*n)/Js);return ht(116*r-16,500*(i-r),200*(r-a))}function Ct(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function kt(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function xt(t){return"function"==typeof t?t:function(){return t}}function Et(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Tt(e,n,t,i)}}function Tt(t,e,n,i){function r(){var t,e=l.status;if(!e&&Mt(l)||e>=200&&300>e||304===e){try{t=n.call(a,l)}catch(i){return void s.error.call(a,i)}s.load.call(a,t)}else s.error.call(a,l)}var a={},s=es.dispatch("beforesend","progress","load","error"),o={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=es.event;es.event=t;try{s.progress.call(a,l)}finally{es.event=e}},a.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?o[t]:(null==e?delete o[t]:o[t]=e+"",a)},a.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",a):e},a.responseType=function(t){return arguments.length?(u=t,a):u},a.response=function(t){return n=t,a},["get","post"].forEach(function(t){a[t]=function(){return a.send.apply(a,[t].concat(is(arguments)))}}),a.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,t,!0),null==e||"accept"in o||(o.accept=e+",*/*"),l.setRequestHeader)for(var c in o)l.setRequestHeader(c,o[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=r&&a.on("error",r).on("load",function(t){r(null,t)}),s.beforesend.call(a,l),l.send(null==i?null:i),a},a.abort=function(){return l.abort(),a},es.rebind(a,s,"on"),null==i?a:a.get(At(i))}function At(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Mt(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function jt(){var t=It(),e=Nt()-t;e>24?(isFinite(e)&&(clearTimeout(eo),eo=setTimeout(jt,e)),to=0):(to=1,io(jt))}function It(){var t=Date.now();for(no=Zs;no;)t>=no.t&&(no.f=no.c(t-no.t)),no=no.n;return t}function Nt(){for(var t,e=Zs,n=1/0;e;)e.f?e=t?t.n=e.n:Zs=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return Xs=t,n}function Ft(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Rt(t,e){var n=Math.pow(10,3*ps(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Lt(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,a=i&&n?function(t,e){for(var r=t.length,a=[],s=0,o=i[0],l=0;r>0&&o>0&&(l+o+1>e&&(o=Math.max(1,e-l)),a.push(t.substring(r-=o,r+o)),!((l+=o+1)>e));)o=i[s=(s+1)%i.length];return a.reverse().join(n)}:v;return function(t){var n=ao.exec(t),i=n[1]||" ",s=n[2]||">",o=n[3]||"-",l=n[4]||"",u=n[5],c=+n[6],h=n[7],d=n[8],p=n[9],f=1,m="",g="",y=!1,v=!0;switch(d&&(d=+d.substring(1)),(u||"0"===i&&"="===s)&&(u=i="0",s="="),p){case"n":h=!0,p="g";break;case"%":f=100,g="%",p="f";break;case"p":f=100,g="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(m="0"+p.toLowerCase());case"c":v=!1;case"d":y=!0,d=0;break;case"s":f=-1,p="r"}"$"===l&&(m=r[0],g=r[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):("e"==p||"f"==p)&&(d=Math.max(0,Math.min(20,d)))),p=so.get(p)||Bt;var _=u&&h;return function(t){var n=g;if(y&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===o?"":o;if(0>f){var l=es.formatPrefix(t,d);t=l.scale(t),n=l.symbol+g}else t*=f;t=p(t,d);var S,b,w=t.lastIndexOf(".");if(0>w){var P=v?t.lastIndexOf("e"):-1;0>P?(S=t,b=""):(S=t.substring(0,P),b=t.substring(P))}else S=t.substring(0,w),b=e+t.substring(w+1);!u&&h&&(S=a(S,1/0));var C=m.length+S.length+b.length+(_?0:r.length),k=c>C?new Array(C=c-C+1).join(i):"";return _&&(S=a(k+S,k.length?c-b.length:1/0)),r+=m,t=S+b,("<"===s?r+t+k:">"===s?k+r+t:"^"===s?k.substring(0,C>>=1)+r+t+k.substring(C):r+(_?t:k+t))+n}}}function Bt(t){return t+""}function Ot(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Dt(t,e,n){function i(e){var n=t(e),i=a(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new lo(n-1)),1),n}function a(t,n){return e(t=new lo(+t),n),t}function s(t,i,a){var s=r(t),o=[];if(a>1)for(;i>s;)n(s)%a||o.push(new Date(+s)),e(s,1);else for(;i>s;)o.push(new Date(+s)),e(s,1);return o}function o(t,e,n){try{lo=Ot;var i=new Ot;return i._=t,s(i,e,n)}finally{lo=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=a,t.range=s;var l=t.utc=$t(t);return l.floor=l,l.round=$t(i),l.ceil=$t(r),l.offset=$t(a),l.range=o,t}function $t(t){return function(e,n){try{lo=Ot;var i=new Ot;return i._=e,t(i,n)._}finally{lo=Date}}}function qt(t){function e(t){function e(e){for(var n,r,a,s=[],o=-1,l=0;++o<i;)37===t.charCodeAt(o)&&(s.push(t.slice(l,o)),null!=(r=co[n=t.charAt(++o)])&&(n=t.charAt(++o)),(a=T[n])&&(n=a(e,null==r?"e"===n?" ":"0":r)),s.push(n),l=o+1);return s.push(t.slice(l,o)),s.join("")}var i=t.length;return e.parse=function(e){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=n(i,t,e,0);if(r!=e.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var a=null!=i.Z&&lo!==Ot,s=new(a?Ot:lo);return"j"in i?s.setFullYear(i.y,0,i.j):"w"in i&&("W"in i||"U"in i)?(s.setFullYear(i.y,0,1),s.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(s.getDay()+5)%7:i.w+7*i.U-(s.getDay()+6)%7)):s.setFullYear(i.y,i.m,i.d),s.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),a?s._:s},e.toString=function(){return t},e}function n(t,e,n,i){for(var r,a,s,o=0,l=e.length,u=n.length;l>o;){if(i>=u)return-1;if(r=e.charCodeAt(o++),37===r){if(s=e.charAt(o++),a=A[s in co?e.charAt(o++):s],!a||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function i(t,e,n){w.lastIndex=0;var i=w.exec(e.slice(n));return i?(t.w=P.get(i[0].toLowerCase()),n+i[0].length):-1}function r(t,e,n){S.lastIndex=0;var i=S.exec(e.slice(n));return i?(t.w=b.get(i[0].toLowerCase()),n+i[0].length):-1}function a(t,e,n){x.lastIndex=0;var i=x.exec(e.slice(n));return i?(t.m=E.get(i[0].toLowerCase()),n+i[0].length):-1}function s(t,e,n){C.lastIndex=0;var i=C.exec(e.slice(n));return i?(t.m=k.get(i[0].toLowerCase()),n+i[0].length):-1}function o(t,e,i){return n(t,T.c.toString(),e,i)}function l(t,e,i){return n(t,T.x.toString(),e,i)}function u(t,e,i){return n(t,T.X.toString(),e,i)}function c(t,e,n){var i=_.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}var h=t.dateTime,d=t.date,p=t.time,f=t.periods,m=t.days,g=t.shortDays,y=t.months,v=t.shortMonths;e.utc=function(t){function n(t){try{lo=Ot;var e=new lo;return e._=t,i(e)}finally{lo=Date}}var i=e(t);return n.parse=function(t){try{lo=Ot;var e=i.parse(t);return e&&e._}finally{lo=Date}},n.toString=i.toString,n},e.multi=e.utc.multi=oe;var _=es.map(),S=zt(m),b=Ht(m),w=zt(g),P=Ht(g),C=zt(y),k=Ht(y),x=zt(v),E=Ht(v);f.forEach(function(t,e){_.set(t.toLowerCase(),e)});var T={a:function(t){return g[t.getDay()]},A:function(t){return m[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return y[t.getMonth()]},c:e(h),d:function(t,e){return Ut(t.getDate(),e,2)},e:function(t,e){return Ut(t.getDate(),e,2)},H:function(t,e){return Ut(t.getHours(),e,2)},I:function(t,e){return Ut(t.getHours()%12||12,e,2)},j:function(t,e){return Ut(1+oo.dayOfYear(t),e,3)},L:function(t,e){return Ut(t.getMilliseconds(),e,3)},m:function(t,e){return Ut(t.getMonth()+1,e,2)},M:function(t,e){return Ut(t.getMinutes(),e,2)},p:function(t){return f[+(t.getHours()>=12)]},S:function(t,e){return Ut(t.getSeconds(),e,2)},U:function(t,e){return Ut(oo.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Ut(oo.mondayOfYear(t),e,2)},x:e(d),X:e(p),y:function(t,e){return Ut(t.getFullYear()%100,e,2)},Y:function(t,e){return Ut(t.getFullYear()%1e4,e,4)},Z:ae,"%":function(){return"%"}},A={a:i,A:r,b:a,B:s,c:o,d:Xt,e:Xt,H:ee,I:ee,j:te,L:re,m:Zt,M:ne,p:c,S:ie,U:Vt,w:Wt,W:Yt,x:l,X:u,y:Gt,Y:Jt,Z:Kt,"%":se};return e}function Ut(t,e,n){var i=0>t?"-":"",r=(i?-t:t)+"",a=r.length;return i+(n>a?new Array(n-a+1).join(e)+r:r)}function zt(t){return new RegExp("^(?:"+t.map(es.requote).join("|")+")","i")}function Ht(t){for(var e=new u,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Wt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Vt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Yt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Jt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Gt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.y=Qt(+i[0]),n+i[0].length):-1}function Kt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Qt(t){return t+(t>68?1900:2e3)}function Zt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Xt(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function te(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function ee(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ne(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function ie(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function re(t,e,n){ho.lastIndex=0;var i=ho.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function ae(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=ps(e)/60|0,r=ps(e)%60;return n+Ut(i,"0",2)+Ut(r,"0",2)}function se(t,e,n){po.lastIndex=0;var i=po.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function oe(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}function le(){}function ue(t,e,n){var i=n.s=t+e,r=i-t,a=i-r;n.t=t-a+(e-r)}function ce(t,e){t&&yo.hasOwnProperty(t.type)&&yo[t.type](t,e)}function he(t,e,n){var i,r=-1,a=t.length-n;for(e.lineStart();++r<a;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function de(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)he(t[n],e,1);e.polygonEnd()}function pe(){function t(t,e){t*=Rs,e=e*Rs/2+js/4;var n=t-i,s=n>=0?1:-1,o=s*n,l=Math.cos(e),u=Math.sin(e),c=a*u,h=r*l+c*Math.cos(o),d=c*s*Math.sin(o);_o.add(Math.atan2(d,h)),i=t,r=l,a=u}var e,n,i,r,a;So.point=function(s,o){So.point=t,i=(e=s)*Rs,r=Math.cos(o=(n=o)*Rs/2+js/4),a=Math.sin(o)},So.lineEnd=function(){t(e,n)}}function fe(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function me(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ge(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ye(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ve(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function _e(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Se(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function be(t,e){return ps(t[0]-e[0])<As&&ps(t[1]-e[1])<As}function we(t,e){t*=Rs;var n=Math.cos(e*=Rs);Pe(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Pe(t,e,n){++bo,Po+=(t-Po)/bo,Co+=(e-Co)/bo,ko+=(n-ko)/bo}function Ce(){function t(t,r){t*=Rs;var a=Math.cos(r*=Rs),s=a*Math.cos(t),o=a*Math.sin(t),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=n*l-i*o)*u+(u=i*s-e*l)*u+(u=e*o-n*s)*u),e*s+n*o+i*l);wo+=u,xo+=u*(e+(e=s)),Eo+=u*(n+(n=o)),To+=u*(i+(i=l)),Pe(e,n,i)}var e,n,i;Io.point=function(r,a){r*=Rs;var s=Math.cos(a*=Rs);e=s*Math.cos(r),n=s*Math.sin(r),i=Math.sin(a),Io.point=t,Pe(e,n,i)}}function ke(){Io.point=we}function xe(){function t(t,e){t*=Rs;var n=Math.cos(e*=Rs),s=n*Math.cos(t),o=n*Math.sin(t),l=Math.sin(e),u=r*l-a*o,c=a*s-i*l,h=i*o-r*s,d=Math.sqrt(u*u+c*c+h*h),p=i*s+r*o+a*l,f=d&&-tt(p)/d,m=Math.atan2(d,p);Ao+=f*u,Mo+=f*c,jo+=f*h,wo+=m,xo+=m*(i+(i=s)),Eo+=m*(r+(r=o)),To+=m*(a+(a=l)),Pe(i,r,a)}var e,n,i,r,a;Io.point=function(s,o){e=s,n=o,Io.point=t,s*=Rs;var l=Math.cos(o*=Rs);i=l*Math.cos(s),r=l*Math.sin(s),a=Math.sin(o),Pe(i,r,a)},Io.lineEnd=function(){t(e,n),Io.lineEnd=ke,Io.point=we}}function Ee(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function Te(){return!0}function Ae(t,e,n,i,r){var a=[],s=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(be(n,i)){r.lineStart();for(var o=0;e>o;++o)r.point((n=t[o])[0],n[1]);return void r.lineEnd()}var l=new je(n,t,null,!0),u=new je(n,null,l,!1);l.o=u,a.push(l),s.push(u),l=new je(i,t,null,!1),u=new je(i,null,l,!0),l.o=u,a.push(l),s.push(u)}}),s.sort(e),Me(a),Me(s),a.length){for(var o=0,l=n,u=s.length;u>o;++o)s[o].e=l=!l;for(var c,h,d=a[0];;){for(var p=d,f=!0;p.v;)if((p=p.n)===d)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(var o=0,u=c.length;u>o;++o)r.point((h=c[o])[0],h[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f){c=p.p.z;for(var o=c.length-1;o>=0;--o)r.point((h=c[o])[0],h[1])}else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,c=p.z,f=!f}while(!p.v);r.lineEnd()}}}function Me(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function je(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Ie(t,e,n,i){return function(r,a){function s(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&a.point(e,n)}function o(t,e){var n=r(t,e);g.point(n[0],n[1])}function l(){v.point=o,g.lineStart()}function u(){v.point=s,g.lineEnd()}function c(t,e){m.push([t,e]);var n=r(t,e);S.point(n[0],n[1])}function h(){S.lineStart(),m=[]}function d(){c(m[0][0],m[0][1]),S.lineEnd();var t,e=S.clean(),n=_.buffer(),i=n.length;if(m.pop(),f.push(m),m=null,i)if(1&e){t=n[0];var r,i=t.length-1,s=-1;if(i>0){for(b||(a.polygonStart(),b=!0),a.lineStart();++s<i;)a.point((r=t[s])[0],r[1]);a.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Ne))}var p,f,m,g=e(a),y=r.invert(i[0],i[1]),v={point:s,lineStart:l,lineEnd:u,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=d,p=[],f=[]},polygonEnd:function(){v.point=s,v.lineStart=l,v.lineEnd=u,p=es.merge(p);var t=De(y,f);p.length?(b||(a.polygonStart(),b=!0),Ae(p,Re,t,n,a)):t&&(b||(a.polygonStart(),b=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),b&&(a.polygonEnd(),b=!1),p=f=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}},_=Fe(),S=e(_),b=!1;return v}}function Ne(t){return t.length>1}function Fe(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:b,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Re(t,e){return((t=t.x)[0]<0?t[1]-Fs-As:Fs-t[1])-((e=e.x)[0]<0?e[1]-Fs-As:Fs-e[1])}function Le(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,s){var o=a>0?js:-js,l=ps(a-n);ps(l-js)<As?(t.point(n,i=(i+s)/2>0?Fs:-Fs),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),t.point(a,i),e=0):r!==o&&l>=js&&(ps(n-r)<As&&(n-=r*As),ps(a-o)<As&&(a-=o*As),i=Be(n,i,a,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),e=0),t.point(n=a,i=s),r=o},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}function Be(t,e,n,i){var r,a,s=Math.sin(t-n);return ps(s)>As?Math.atan((Math.sin(e)*(a=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*a*s)):(e+i)/2}function Oe(t,e,n,i){var r;if(null==t)r=n*Fs,i.point(-js,r),i.point(0,r),i.point(js,r),i.point(js,0),i.point(js,-r),i.point(0,-r),i.point(-js,-r),i.point(-js,0),i.point(-js,r);else if(ps(t[0]-e[0])>As){var a=t[0]<e[0]?js:-js;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function De(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],a=0,s=0;_o.reset();for(var o=0,l=e.length;l>o;++o){var u=e[o],c=u.length;if(c)for(var h=u[0],d=h[0],p=h[1]/2+js/4,f=Math.sin(p),m=Math.cos(p),g=1;;){g===c&&(g=0),t=u[g];var y=t[0],v=t[1]/2+js/4,_=Math.sin(v),S=Math.cos(v),b=y-d,w=b>=0?1:-1,P=w*b,C=P>js,k=f*_;if(_o.add(Math.atan2(k*w*Math.sin(P),m*S+k*Math.cos(P))),a+=C?b+w*Is:b,C^d>=n^y>=n){var x=ge(fe(h),fe(t));_e(x);var E=ge(r,x);_e(E);var T=(C^b>=0?-1:1)*et(E[2]);(i>T||i===T&&(x[0]||x[1]))&&(s+=C^b>=0?1:-1)}if(!g++)break;d=y,f=_,m=S,h=t}}return(-As>a||As>a&&0>_o)^1&s}function $e(t){function e(t,e){return Math.cos(t)*Math.cos(e)>a}function n(t){var n,a,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],m=e(h,d),g=s?m?0:r(h,d):m?r(h+(0>h?js:-js),d):0;if(!n&&(u=l=m)&&t.lineStart(),m!==l&&(p=i(n,f),(be(n,p)||be(f,p))&&(f[0]+=As,f[1]+=As,m=e(f[0],f[1]))),m!==l)c=0,m?(t.lineStart(),p=i(f,n),t.point(p[0],p[1])):(p=i(n,f),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(o&&n&&s^m){var y;g&a||!(y=i(f,n,!0))||(c=0,s?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!m||n&&be(n,f)||t.point(f[0],f[1]),n=f,l=m,a=g},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}}function i(t,e,n){var i=fe(t),r=fe(e),s=[1,0,0],o=ge(i,r),l=me(o,o),u=o[0],c=l-u*u;if(!c)return!n&&t;var h=a*l/c,d=-a*u/c,p=ge(s,o),f=ve(s,h),m=ve(o,d);ye(f,m);var g=p,y=me(f,g),v=me(g,g),_=y*y-v*(me(f,f)-1);if(!(0>_)){var S=Math.sqrt(_),b=ve(g,(-y-S)/v);if(ye(b,f),b=Se(b),!n)return b;var w,P=t[0],C=e[0],k=t[1],x=e[1];P>C&&(w=P,P=C,C=w);var E=C-P,T=ps(E-js)<As,A=T||As>E;if(!T&&k>x&&(w=k,k=x,x=w),A?T?k+x>0^b[1]<(ps(b[0]-P)<As?k:x):k<=b[1]&&b[1]<=x:E>js^(P<=b[0]&&b[0]<=C)){var M=ve(g,(-y+S)/v);return ye(M,f),[b,Se(M)]}}}function r(e,n){var i=s?t:js-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var a=Math.cos(t),s=a>0,o=ps(a)>As,l=fn(t,6*Rs);return Ie(e,n,l,s?[0,-t]:[-js,t-js])}function qe(t,e,n,i){return function(r){var a,s=r.a,o=r.b,l=s.x,u=s.y,c=o.x,h=o.y,d=0,p=1,f=c-l,m=h-u;if(a=t-l,f||!(a>0)){if(a/=f,0>f){if(d>a)return;p>a&&(p=a)}else if(f>0){if(a>p)return;a>d&&(d=a)}if(a=n-l,f||!(0>a)){if(a/=f,0>f){if(a>p)return;a>d&&(d=a)}else if(f>0){if(d>a)return;p>a&&(p=a)}if(a=e-u,m||!(a>0)){if(a/=m,0>m){if(d>a)return;p>a&&(p=a)}else if(m>0){if(a>p)return;a>d&&(d=a)}if(a=i-u,m||!(0>a)){if(a/=m,0>m){if(a>p)return;a>d&&(d=a)}else if(m>0){if(d>a)return;p>a&&(p=a)}return d>0&&(r.a={x:l+d*f,y:u+d*m}),1>p&&(r.b={x:l+p*f,y:u+p*m}),r}}}}}}function Ue(t,e,n,i){function r(i,r){return ps(i[0]-t)<As?r>0?0:3:ps(i[0]-n)<As?r>0?2:1:ps(i[1]-e)<As?r>0?1:0:r>0?3:2}function a(t,e){return s(t.x,e.x)}function s(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){function l(t){for(var e=0,n=g.length,i=t[1],r=0;n>r;++r)for(var a,s=1,o=g[r],l=o.length,u=o[0];l>s;++s)a=o[s],u[1]<=i?a[1]>i&&X(u,a,t)>0&&++e:a[1]<=i&&X(u,a,t)<0&&--e,u=a;return 0!==e}function u(a,o,l,u){var c=0,h=0;if(null==a||(c=r(a,l))!==(h=r(o,l))||s(a,o)<0^l>0){do u.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+l+4)%4)!==h)}else u.point(o[0],o[1])}function c(r,a){return r>=t&&n>=r&&a>=e&&i>=a}function h(t,e){c(t,e)&&o.point(t,e)}function d(){A.point=f,g&&g.push(y=[]),C=!0,P=!1,b=w=NaN}function p(){m&&(f(v,_),S&&P&&E.rejoin(),m.push(E.buffer())),A.point=h,P&&o.lineEnd()}function f(t,e){t=Math.max(-Fo,Math.min(Fo,t)),e=Math.max(-Fo,Math.min(Fo,e));var n=c(t,e);if(g&&y.push([t,e]),C)v=t,_=e,S=n,C=!1,n&&(o.lineStart(),o.point(t,e));else if(n&&P)o.point(t,e);else{var i={a:{x:b,y:w},b:{x:t,y:e}};T(i)?(P||(o.lineStart(),o.point(i.a.x,i.a.y)),o.point(i.b.x,i.b.y),n||o.lineEnd(),k=!1):n&&(o.lineStart(),o.point(t,e),k=!1)}b=t,w=e,P=n}var m,g,y,v,_,S,b,w,P,C,k,x=o,E=Fe(),T=qe(t,e,n,i),A={point:h,lineStart:d,lineEnd:p,polygonStart:function(){o=E,m=[],g=[],k=!0},polygonEnd:function(){o=x,m=es.merge(m);var e=l([t,i]),n=k&&e,r=m.length;(n||r)&&(o.polygonStart(),n&&(o.lineStart(),u(null,null,1,o),o.lineEnd()),r&&Ae(m,a,e,u,o),o.polygonEnd()),m=g=y=null}};return A}}function ze(t){var e=0,n=js/3,i=sn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*js/180,n=t[1]*js/180):[e/js*180,n/js*180]},r}function He(t,e){function n(t,e){var n=Math.sqrt(a-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),s-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,a=1+i*(2*r-i),s=Math.sqrt(a)/r;return n.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/r,et((a-(t*t+n*n)*r*r)/(2*r))]},n}function We(){function t(t,e){Lo+=r*t-i*e,i=t,r=e}var e,n,i,r;qo.point=function(a,s){qo.point=t,e=i=a,n=r=s},qo.lineEnd=function(){t(e,n)}}function Ve(t,e){
Bo>t&&(Bo=t),t>Do&&(Do=t),Oo>e&&(Oo=e),e>$o&&($o=e)}function Ye(){function t(t,e){s.push("M",t,",",e,a)}function e(t,e){s.push("M",t,",",e),o.point=n}function n(t,e){s.push("L",t,",",e)}function i(){o.point=t}function r(){s.push("Z")}var a=Je(4.5),s=[],o={point:t,lineStart:function(){o.point=e},lineEnd:i,polygonStart:function(){o.lineEnd=r},polygonEnd:function(){o.lineEnd=i,o.point=t},pointRadius:function(t){return a=Je(t),o},result:function(){if(s.length){var t=s.join("");return s=[],t}}};return o}function Je(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ge(t,e){Po+=t,Co+=e,++ko}function Ke(){function t(t,i){var r=t-e,a=i-n,s=Math.sqrt(r*r+a*a);xo+=s*(e+t)/2,Eo+=s*(n+i)/2,To+=s,Ge(e=t,n=i)}var e,n;zo.point=function(i,r){zo.point=t,Ge(e=i,n=r)}}function Qe(){zo.point=Ge}function Ze(){function t(t,e){var n=t-i,a=e-r,s=Math.sqrt(n*n+a*a);xo+=s*(i+t)/2,Eo+=s*(r+e)/2,To+=s,s=r*t-i*e,Ao+=s*(i+t),Mo+=s*(r+e),jo+=3*s,Ge(i=t,r=e)}var e,n,i,r;zo.point=function(a,s){zo.point=t,Ge(e=i=a,n=r=s)},zo.lineEnd=function(){t(e,n)}}function Xe(t){function e(e,n){t.moveTo(e+s,n),t.arc(e,n,s,0,Is)}function n(e,n){t.moveTo(e,n),o.point=i}function i(e,n){t.lineTo(e,n)}function r(){o.point=e}function a(){t.closePath()}var s=4.5,o={point:e,lineStart:function(){o.point=n},lineEnd:r,polygonStart:function(){o.lineEnd=a},polygonEnd:function(){o.lineEnd=r,o.point=e},pointRadius:function(t){return s=t,o},result:b};return o}function tn(t){function e(t){return(o?i:n)(t)}function n(e){return rn(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){_=NaN,C.point=a,e.lineStart()}function a(n,i){var a=fe([n,i]),s=t(n,i);r(_,S,v,b,w,P,_=s[0],S=s[1],v=n,b=a[0],w=a[1],P=a[2],o,e),e.point(_,S)}function s(){C.point=n,e.lineEnd()}function l(){i(),C.point=u,C.lineEnd=c}function u(t,e){a(h=t,d=e),p=_,f=S,m=b,g=w,y=P,C.point=a}function c(){r(_,S,v,b,w,P,p,f,h,m,g,y,o,e),C.lineEnd=s,s()}var h,d,p,f,m,g,y,v,_,S,b,w,P,C={point:n,lineStart:i,lineEnd:s,polygonStart:function(){e.polygonStart(),C.lineStart=l},polygonEnd:function(){e.polygonEnd(),C.lineStart=i}};return C}function r(e,n,i,o,l,u,c,h,d,p,f,m,g,y){var v=c-e,_=h-n,S=v*v+_*_;if(S>4*a&&g--){var b=o+p,w=l+f,P=u+m,C=Math.sqrt(b*b+w*w+P*P),k=Math.asin(P/=C),x=ps(ps(P)-1)<As||ps(i-d)<As?(i+d)/2:Math.atan2(w,b),E=t(x,k),T=E[0],A=E[1],M=T-e,j=A-n,I=_*M-v*j;(I*I/S>a||ps((v*M+_*j)/S-.5)>.3||s>o*p+l*f+u*m)&&(r(e,n,i,o,l,u,T,A,x,b/=C,w/=C,P,g,y),y.point(T,A),r(T,A,x,b,w,P,c,h,d,p,f,m,g,y))}}var a=.5,s=Math.cos(30*Rs),o=16;return e.precision=function(t){return arguments.length?(o=(a=t*t)>0&&16,e):Math.sqrt(a)},e}function en(t){var e=tn(function(e,n){return t([e*Ls,n*Ls])});return function(t){return on(e(t))}}function nn(t){this.stream=t}function rn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function an(t){return sn(function(){return t})()}function sn(t){function e(t){return t=o(t[0]*Rs,t[1]*Rs),[t[0]*d+l,u-t[1]*d]}function n(t){return t=o.invert((t[0]-l)/d,(u-t[1])/d),t&&[t[0]*Ls,t[1]*Ls]}function i(){o=Ee(s=cn(y,_,S),a);var t=a(m,g);return l=p-t[0]*d,u=f+t[1]*d,r()}function r(){return c&&(c.valid=!1,c=null),e}var a,s,o,l,u,c,h=tn(function(t,e){return t=a(t,e),[t[0]*d+l,u-t[1]*d]}),d=150,p=480,f=250,m=0,g=0,y=0,_=0,S=0,b=No,w=v,P=null,C=null;return e.stream=function(t){return c&&(c.valid=!1),c=on(b(s,h(w(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(P=t,No):$e((P=+t)*Rs),r()):P},e.clipExtent=function(t){return arguments.length?(C=t,w=t?Ue(t[0][0],t[0][1],t[1][0],t[1][1]):v,r()):C},e.scale=function(t){return arguments.length?(d=+t,i()):d},e.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],i()):[p,f]},e.center=function(t){return arguments.length?(m=t[0]%360*Rs,g=t[1]%360*Rs,i()):[m*Ls,g*Ls]},e.rotate=function(t){return arguments.length?(y=t[0]%360*Rs,_=t[1]%360*Rs,S=t.length>2?t[2]%360*Rs:0,i()):[y*Ls,_*Ls,S*Ls]},es.rebind(e,h,"precision"),function(){return a=t.apply(this,arguments),e.invert=a.invert&&n,i()}}function on(t){return rn(t,function(e,n){t.point(e*Rs,n*Rs)})}function ln(t,e){return[t,e]}function un(t,e){return[t>js?t-Is:-js>t?t+Is:t,e]}function cn(t,e,n){return t?e||n?Ee(dn(t),pn(e,n)):dn(t):e||n?pn(e,n):un}function hn(t){return function(e,n){return e+=t,[e>js?e-Is:-js>e?e+Is:e,n]}}function dn(t){var e=hn(t);return e.invert=hn(-t),e}function pn(t,e){function n(t,e){var n=Math.cos(e),o=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*i+o*r;return[Math.atan2(l*a-c*s,o*i-u*r),et(c*a+l*s)]}var i=Math.cos(t),r=Math.sin(t),a=Math.cos(e),s=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),o=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*a-l*s;return[Math.atan2(l*a+u*s,o*i+c*r),et(c*i-o*r)]},n}function fn(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,a,s,o){var l=s*e;null!=r?(r=mn(n,r),a=mn(n,a),(s>0?a>r:r>a)&&(r+=s*Is)):(r=t+s*Is,a=t-.5*l);for(var u,c=r;s>0?c>a:a>c;c-=l)o.point((u=Se([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function mn(t,e){var n=fe(e);n[0]-=t,_e(n);var i=tt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-As)%(2*Math.PI)}function gn(t,e,n){var i=es.range(t,e-As,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function yn(t,e,n){var i=es.range(t,e-As,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function vn(t){return t.source}function _n(t){return t.target}function Sn(t,e,n,i){var r=Math.cos(e),a=Math.sin(e),s=Math.cos(i),o=Math.sin(i),l=r*Math.cos(t),u=r*Math.sin(t),c=s*Math.cos(n),h=s*Math.sin(n),d=2*Math.asin(Math.sqrt(at(i-e)+r*s*at(n-t))),p=1/Math.sin(d),f=d?function(t){var e=Math.sin(t*=d)*p,n=Math.sin(d-t)*p,i=n*l+e*c,r=n*u+e*h,s=n*a+e*o;return[Math.atan2(r,i)*Ls,Math.atan2(s,Math.sqrt(i*i+r*r))*Ls]}:function(){return[t*Ls,e*Ls]};return f.distance=d,f}function bn(){function t(t,r){var a=Math.sin(r*=Rs),s=Math.cos(r),o=ps((t*=Rs)-e),l=Math.cos(o);Ho+=Math.atan2(Math.sqrt((o=s*Math.sin(o))*o+(o=i*a-n*s*l)*o),n*a+i*s*l),e=t,n=a,i=s}var e,n,i;Wo.point=function(r,a){e=r*Rs,n=Math.sin(a*=Rs),i=Math.cos(a),Wo.point=t},Wo.lineEnd=function(){Wo.point=Wo.lineEnd=b}}function wn(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),a=t(i*r);return[a*r*Math.sin(e),a*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),a=Math.sin(r),s=Math.cos(r);return[Math.atan2(t*a,i*s),Math.asin(i&&n*a/i)]},n}function Pn(t,e){function n(t,e){s>0?-Fs+As>e&&(e=-Fs+As):e>Fs-As&&(e=Fs-As);var n=s/Math.pow(r(e),a);return[n*Math.sin(a*t),s-n*Math.cos(a*t)]}var i=Math.cos(t),r=function(t){return Math.tan(js/4+t/2)},a=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),s=i*Math.pow(r(t),a)/a;return a?(n.invert=function(t,e){var n=s-e,i=Z(a)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/a,2*Math.atan(Math.pow(s/i,1/a))-Fs]},n):kn}function Cn(t,e){function n(t,e){var n=a-e;return[n*Math.sin(r*t),a-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),a=i/r+t;return ps(r)<As?ln:(n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,a-Z(r)*Math.sqrt(t*t+n*n)]},n)}function kn(t,e){return[t,Math.log(Math.tan(js/4+e/2))]}function xn(t){var e,n=an(t),i=n.scale,r=n.translate,a=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var s=a.apply(n,arguments);if(s===n){if(e=null==t){var o=js*i(),l=r();a([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else e&&(s=null);return s},n.clipExtent(null)}function En(t,e){return[Math.log(Math.tan(js/4+e/2)),-t]}function Tn(t){return t[0]}function An(t){return t[1]}function Mn(t){for(var e=t.length,n=[0,1],i=2,r=2;e>r;r++){for(;i>1&&X(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function jn(t,e){return t[0]-e[0]||t[1]-e[1]}function In(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Nn(t,e,n,i){var r=t[0],a=n[0],s=e[0]-r,o=i[0]-a,l=t[1],u=n[1],c=e[1]-l,h=i[1]-u,d=(o*(l-u)-h*(r-a))/(h*s-o*c);return[r+d*s,l+d*c]}function Fn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Rn(){ni(this),this.edge=this.site=this.circle=null}function Ln(t){var e=il.pop()||new Rn;return e.site=t,e}function Bn(t){Yn(t),tl.remove(t),il.push(t),ni(t)}function On(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},a=t.P,s=t.N,o=[t];Bn(t);for(var l=a;l.circle&&ps(n-l.circle.x)<As&&ps(i-l.circle.cy)<As;)a=l.P,o.unshift(l),Bn(l),l=a;o.unshift(l),Yn(l);for(var u=s;u.circle&&ps(n-u.circle.x)<As&&ps(i-u.circle.cy)<As;)s=u.N,o.push(u),Bn(u),u=s;o.push(u),Yn(u);var c,h=o.length;for(c=1;h>c;++c)u=o[c],l=o[c-1],Xn(u.edge,l.site,u.site,r);l=o[0],u=o[h-1],u.edge=Qn(l.site,u.site,null,r),Vn(l),Vn(u)}function Dn(t){for(var e,n,i,r,a=t.x,s=t.y,o=tl._;o;)if(i=$n(o,s)-a,i>As)o=o.L;else{if(r=a-qn(o,s),!(r>As)){i>-As?(e=o.P,n=o):r>-As?(e=o,n=o.N):e=n=o;break}if(!o.R){e=o;break}o=o.R}var l=Ln(t);if(tl.insert(e,l),e||n){if(e===n)return Yn(e),n=Ln(e.site),tl.insert(l,n),l.edge=n.edge=Qn(e.site,l.site),Vn(e),void Vn(n);if(!n)return void(l.edge=Qn(e.site,l.site));Yn(e),Yn(n);var u=e.site,c=u.x,h=u.y,d=t.x-c,p=t.y-h,f=n.site,m=f.x-c,g=f.y-h,y=2*(d*g-p*m),v=d*d+p*p,_=m*m+g*g,S={x:(g*v-p*_)/y+c,y:(d*_-m*v)/y+h};Xn(n.edge,u,f,S),l.edge=Qn(u,t,null,S),n.edge=Qn(t,f,null,S),Vn(e),Vn(n)}}function $n(t,e){var n=t.site,i=n.x,r=n.y,a=r-e;if(!a)return i;var s=t.P;if(!s)return-1/0;n=s.site;var o=n.x,l=n.y,u=l-e;if(!u)return o;var c=o-i,h=1/a-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-a/2)))/h+i:(i+o)/2}function qn(t,e){var n=t.N;if(n)return $n(n,e);var i=t.site;return i.y===e?i.x:1/0}function Un(t){this.site=t,this.edges=[]}function zn(t){for(var e,n,i,r,a,s,o,l,u,c,h=t[0][0],d=t[1][0],p=t[0][1],f=t[1][1],m=Xo,g=m.length;g--;)if(a=m[g],a&&a.prepare())for(o=a.edges,l=o.length,s=0;l>s;)c=o[s].end(),i=c.x,r=c.y,u=o[++s%l].start(),e=u.x,n=u.y,(ps(i-e)>As||ps(r-n)>As)&&(o.splice(s,0,new ti(Zn(a.site,c,ps(i-h)<As&&f-r>As?{x:h,y:ps(e-h)<As?n:f}:ps(r-f)<As&&d-i>As?{x:ps(n-f)<As?e:d,y:f}:ps(i-d)<As&&r-p>As?{x:d,y:ps(e-d)<As?n:p}:ps(r-p)<As&&i-h>As?{x:ps(n-p)<As?e:h,y:p}:null),a.site,null)),++l)}function Hn(t,e){return e.angle-t.angle}function Wn(){ni(this),this.x=this.y=this.arc=this.site=this.cy=null}function Vn(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var s=r.x,o=r.y,l=i.x-s,u=i.y-o,c=a.x-s,h=a.y-o,d=2*(l*h-u*c);if(!(d>=-Ms)){var p=l*l+u*u,f=c*c+h*h,m=(h*p-u*f)/d,g=(l*f-c*p)/d,h=g+o,y=rl.pop()||new Wn;y.arc=t,y.site=r,y.x=m+s,y.y=h+Math.sqrt(m*m+g*g),y.cy=h,t.circle=y;for(var v=null,_=nl._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}nl.insert(v,y),v||(el=y)}}}}function Yn(t){var e=t.circle;e&&(e.P||(el=e.N),nl.remove(e),rl.push(e),ni(e),t.circle=null)}function Jn(t){for(var e,n=Zo,i=qe(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)e=n[r],(!Gn(e,t)||!i(e)||ps(e.a.x-e.b.x)<As&&ps(e.a.y-e.b.y)<As)&&(e.a=e.b=null,n.splice(r,1))}function Gn(t,e){var n=t.b;if(n)return!0;var i,r,a=t.a,s=e[0][0],o=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,d=c.x,p=c.y,f=h.x,m=h.y,g=(d+f)/2,y=(p+m)/2;if(m===p){if(s>g||g>=o)return;if(d>f){if(a){if(a.y>=u)return}else a={x:g,y:l};n={x:g,y:u}}else{if(a){if(a.y<l)return}else a={x:g,y:u};n={x:g,y:l}}}else if(i=(d-f)/(m-p),r=y-i*g,-1>i||i>1)if(d>f){if(a){if(a.y>=u)return}else a={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(a){if(a.y<l)return}else a={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(m>p){if(a){if(a.x>=o)return}else a={x:s,y:i*s+r};n={x:o,y:i*o+r}}else{if(a){if(a.x<s)return}else a={x:o,y:i*o+r};n={x:s,y:i*s+r}}return t.a=a,t.b=n,!0}function Kn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Qn(t,e,n,i){var r=new Kn(t,e);return Zo.push(r),n&&Xn(r,t,e,n),i&&Xn(r,e,t,i),Xo[t.i].edges.push(new ti(r,t,e)),Xo[e.i].edges.push(new ti(r,e,t)),r}function Zn(t,e,n){var i=new Kn(t,null);return i.a=e,i.b=n,Zo.push(i),i}function Xn(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function ti(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function ei(){this._=null}function ni(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ii(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ri(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function ai(t){for(;t.L;)t=t.L;return t}function si(t,e){var n,i,r,a=t.sort(oi).pop();for(Zo=[],Xo=new Array(t.length),tl=new ei,nl=new ei;;)if(r=el,a&&(!r||a.y<r.y||a.y===r.y&&a.x<r.x))(a.x!==n||a.y!==i)&&(Xo[a.i]=new Un(a),Dn(a),n=a.x,i=a.y),a=t.pop();else{if(!r)break;On(r.arc)}e&&(Jn(e),zn(e));var s={cells:Xo,edges:Zo};return tl=nl=Zo=Xo=null,s}function oi(t,e){return e.y-t.y||e.x-t.x}function li(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function ui(t){return t.x}function ci(t){return t.y}function hi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function di(t,e,n,i,r,a){if(!t(e,n,i,r,a)){var s=.5*(n+r),o=.5*(i+a),l=e.nodes;l[0]&&di(t,l[0],n,i,s,o),l[1]&&di(t,l[1],s,i,r,o),l[2]&&di(t,l[2],n,o,s,a),l[3]&&di(t,l[3],s,o,r,a)}}function pi(t,e,n,i,r,a,s){var o,l=1/0;return function u(t,c,h,d,p){if(!(c>a||h>s||i>d||r>p)){if(f=t.point){var f,m=e-t.x,g=n-t.y,y=m*m+g*g;if(l>y){var v=Math.sqrt(l=y);i=e-v,r=n-v,a=e+v,s=n+v,o=f}}for(var _=t.nodes,S=.5*(c+d),b=.5*(h+p),w=e>=S,P=n>=b,C=P<<1|w,k=C+4;k>C;++C)if(t=_[3&C])switch(3&C){case 0:u(t,c,h,S,b);break;case 1:u(t,S,h,d,b);break;case 2:u(t,c,b,S,p);break;case 3:u(t,S,b,d,p)}}}(t,i,r,a,s),o}function fi(t,e){t=es.rgb(t),e=es.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,s=e.g-i,o=e.b-r;return function(t){return"#"+St(Math.round(n+a*t))+St(Math.round(i+s*t))+St(Math.round(r+o*t))}}function mi(t,e){var n,i={},r={};for(n in t)n in e?i[n]=vi(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function gi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function yi(t,e){var n,i,r,a=sl.lastIndex=ol.lastIndex=0,s=-1,o=[],l=[];for(t+="",e+="";(n=sl.exec(t))&&(i=ol.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),o[s]?o[s]+=r:o[++s]=r),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:gi(n,i)})),a=ol.lastIndex;return a<e.length&&(r=e.slice(a),o[s]?o[s]+=r:o[++s]=r),o.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;e>i;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}function vi(t,e){for(var n,i=es.interpolators.length;--i>=0&&!(n=es.interpolators[i](t,e)););return n}function _i(t,e){var n,i=[],r=[],a=t.length,s=e.length,o=Math.min(t.length,e.length);for(n=0;o>n;++n)i.push(vi(t[n],e[n]));for(;a>n;++n)r[n]=t[n];for(;s>n;++n)r[n]=e[n];return function(t){for(n=0;o>n;++n)r[n]=i[n](t);return r}}function Si(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function bi(t){return function(e){return 1-t(1-e)}}function wi(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Pi(t){return t*t}function Ci(t){return t*t*t}function ki(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function xi(t){return function(e){return Math.pow(e,t)}}function Ei(t){return 1-Math.cos(t*Fs)}function Ti(t){return Math.pow(2,10*(t-1))}function Ai(t){return 1-Math.sqrt(1-t*t)}function Mi(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Is*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Is/e)}}function ji(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Ii(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Ni(t,e){t=es.hcl(t),e=es.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,s=e.c-i,o=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.c:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return ct(n+a*t,i+s*t,r+o*t)+""}}function Fi(t,e){t=es.hsl(t),e=es.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,s=e.s-i,o=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.s:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return lt(n+a*t,i+s*t,r+o*t)+""}}function Ri(t,e){t=es.lab(t),e=es.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,s=e.a-i,o=e.b-r;return function(t){return dt(n+a*t,i+s*t,r+o*t)+""}}function Li(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Bi(t){var e=[t.a,t.b],n=[t.c,t.d],i=Di(e),r=Oi(e,n),a=Di($i(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ls,this.translate=[t.e,t.f],this.scale=[i,a],this.skew=a?Math.atan2(r,a)*Ls:0}function Oi(t,e){return t[0]*e[0]+t[1]*e[1]}function Di(t){var e=Math.sqrt(Oi(t,t));return e&&(t[0]/=e,t[1]/=e),e}function $i(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function qi(t,e){var n,i=[],r=[],a=es.transform(t),s=es.transform(e),o=a.translate,l=s.translate,u=a.rotate,c=s.rotate,h=a.skew,d=s.skew,p=a.scale,f=s.scale;return o[0]!=l[0]||o[1]!=l[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:gi(o[0],l[0])},{i:3,x:gi(o[1],l[1])})):i.push(l[0]||l[1]?"translate("+l+")":""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:gi(u,c)})):c&&i.push(i.pop()+"rotate("+c+")"),h!=d?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:gi(h,d)}):d&&i.push(i.pop()+"skewX("+d+")"),p[0]!=f[0]||p[1]!=f[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:gi(p[0],f[0])},{i:n-2,x:gi(p[1],f[1])})):(1!=f[0]||1!=f[1])&&i.push(i.pop()+"scale("+f+")"),n=r.length,function(t){for(var e,a=-1;++a<n;)i[(e=r[a]).i]=e.x(t);return i.join("")}}function Ui(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function zi(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Hi(t){for(var e=t.source,n=t.target,i=Vi(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function Wi(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Vi(t,e){if(t===e)return t;for(var n=Wi(t),i=Wi(e),r=n.pop(),a=i.pop(),s=null;r===a;)s=r,r=n.pop(),a=i.pop();return s}function Yi(t){t.fixed|=2}function Ji(t){t.fixed&=-7}function Gi(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Ki(t){t.fixed&=-5}function Qi(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var a,s=t.nodes,o=s.length,l=-1;++l<o;)a=s[l],null!=a&&(Qi(a,e,n),t.charge+=a.charge,i+=a.charge*a.cx,r+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,i+=u*t.point.x,r+=u*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function Zi(t,e){return es.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=rr,t}function Xi(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function tr(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(a=t.children)&&(r=a.length))for(var r,a,s=-1;++s<r;)n.push(a[s]);for(;null!=(t=i.pop());)e(t)}function er(t){return t.children}function nr(t){return t.value}function ir(t,e){return e.value-t.value}function rr(t){return es.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ar(t){return t.x}function sr(t){return t.y}function or(t,e,n){t.y0=e,t.y=n}function lr(t){return es.range(t.length)}function ur(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function cr(t){for(var e,n=1,i=0,r=t[0][1],a=t.length;a>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function hr(t){return t.reduce(dr,0)}function dr(t,e){return t+e[1]}function pr(t,e){return fr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function fr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,a=[];++n<=e;)a[n]=r*n+i;return a}function mr(t){return[es.min(t),es.max(t)]}function gr(t,e){return t.value-e.value}function yr(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function vr(t,e){t._pack_next=e,e._pack_prev=t}function _r(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function Sr(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),p=Math.max(t.y+t.r,p)}if((n=t.children)&&(u=n.length)){var n,i,r,a,s,o,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;if(n.forEach(br),i=n[0],i.x=-i.r,i.y=0,e(i),u>1&&(r=n[1],r.x=r.r,r.y=0,e(r),u>2))for(a=n[2],Cr(i,r,a),e(a),yr(i,a),i._pack_prev=a,yr(a,r),r=i._pack_next,s=3;u>s;s++){Cr(i,r,a=n[s]);var f=0,m=1,g=1;for(o=r._pack_next;o!==r;o=o._pack_next,m++)if(_r(o,a)){f=1;break}if(1==f)for(l=i._pack_prev;l!==o._pack_prev&&!_r(l,a);l=l._pack_prev,g++);f?(g>m||m==g&&r.r<i.r?vr(i,r=o):vr(i=l,r),s--):(yr(i,a),r=a,e(a))}var y=(c+h)/2,v=(d+p)/2,_=0;for(s=0;u>s;s++)a=n[s],a.x-=y,a.y-=v,_=Math.max(_,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=_,n.forEach(wr)}}function br(t){t._pack_next=t._pack_prev=t}function wr(t){delete t._pack_next,delete t._pack_prev}function Pr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var a=-1,s=r.length;++a<s;)Pr(r[a],e,n,i)}function Cr(t,e,n){var i=t.r+n.r,r=e.x-t.x,a=e.y-t.y;if(i&&(r||a)){var s=e.r+n.r,o=r*r+a*a;s*=s,i*=i;var l=.5+(i-s)/(2*o),u=Math.sqrt(Math.max(0,2*s*(i+o)-(i-=o)*i-s*s))/(2*o);n.x=t.x+l*r+u*a,n.y=t.y+l*a-u*r}else n.x=t.x+i,n.y=t.y}function kr(t,e){return t.parent==e.parent?1:2}function xr(t){var e=t.children;return e.length?e[0]:t.t}function Er(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Tr(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Ar(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)e=r[a],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}function Mr(t,e,n){return t.a.parent===e.parent?t.a:n}function jr(t){return 1+es.max(t,function(t){return t.y})}function Ir(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Nr(t){var e=t.children;return e&&e.length?Nr(e[0]):t}function Fr(t){var e,n=t.children;return n&&(e=n.length)?Fr(n[e-1]):t}function Rr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Lr(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>a&&(i+=a/2,a=0),{x:n,y:i,dx:r,dy:a}}function Br(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Or(t){return t.rangeExtent?t.rangeExtent():Br(t.range())}function Dr(t,e,n,i){var r=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(r(t))}}function $r(t,e){var n,i=0,r=t.length-1,a=t[i],s=t[r];return a>s&&(n=i,i=r,r=n,n=a,a=s,s=n),t[i]=e.floor(a),t[r]=e.ceil(s),t}function qr(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:vl}function Ur(t,e,n,i){var r=[],a=[],s=0,o=Math.min(t.length,e.length)-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<=o;)r.push(n(t[s-1],t[s])),a.push(i(e[s-1],e[s]));return function(e){var n=es.bisect(t,e,1,o)-1;return a[n](r[n](e))}}function zr(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?Ur:Dr,l=i?zi:Ui;return s=r(t,e,l,n),o=r(e,t,l,vi),a}function a(t){return s(t)}var s,o;return a.invert=function(t){return o(t)},a.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},a.range=function(t){return arguments.length?(e=t,r()):e},a.rangeRound=function(t){return a.range(t).interpolate(Li)},a.clamp=function(t){return arguments.length?(i=t,r()):i},a.interpolate=function(t){return arguments.length?(n=t,r()):n},a.ticks=function(e){return Yr(t,e)},a.tickFormat=function(e,n){return Jr(t,e,n)},a.nice=function(e){return Wr(t,e),r()},a.copy=function(){return zr(t,e,n,i)},r()}function Hr(t,e){return es.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Wr(t,e){return $r(t,qr(Vr(t,e)[2]))}function Vr(t,e){null==e&&(e=10);var n=Br(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*r;return.15>=a?r*=10:.35>=a?r*=5:.75>=a&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Yr(t,e){return es.range.apply(es,Vr(t,e))}function Jr(t,e,n){var i=Vr(t,e);if(n){var r=ao.exec(n);if(r.shift(),"s"===r[8]){var a=es.formatPrefix(Math.max(ps(i[0]),ps(i[1])));return r[7]||(r[7]="."+Gr(a.scale(i[2]))),r[8]="f",n=es.format(r.join("")),function(t){return n(a.scale(t))+a.symbol}}r[7]||(r[7]="."+Kr(r[8],i)),n=r.join("")}else n=",."+Gr(i[2])+"f";return es.format(n)}function Gr(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Kr(t,e){var n=Gr(e[2]);return t in _l?Math.abs(n-Gr(Math.max(ps(e[0]),ps(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Qr(t,e,n,i){function r(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function a(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function s(e){return t(r(e))}return s.invert=function(e){return a(t.invert(e))},s.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),s):i},s.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),s):e},s.nice=function(){var e=$r(i.map(r),n?Math:bl);return t.domain(e),i=e.map(a),s},s.ticks=function(){var t=Br(i),s=[],o=t[0],l=t[1],u=Math.floor(r(o)),c=Math.ceil(r(l)),h=e%1?2:e;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var d=1;h>d;d++)s.push(a(u)*d);s.push(a(u))}else for(s.push(a(u));u++<c;)for(var d=h-1;d>0;d--)s.push(a(u)*d);for(u=0;s[u]<o;u++);for(c=s.length;s[c-1]>l;c--);s=s.slice(u,c)}return s},s.tickFormat=function(t,e){if(!arguments.length)return Sl;arguments.length<2?e=Sl:"function"!=typeof e&&(e=es.format(e));var i,o=Math.max(.1,t/s.ticks().length),l=n?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return t/a(l(r(t)+i))<=o?e(t):""}},s.copy=function(){return Qr(t.copy(),e,n,i)},Hr(s,t)}function Zr(t,e,n){function i(e){return t(r(e))}var r=Xr(e),a=Xr(1/e);return i.invert=function(e){return a(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return Yr(n,t)},i.tickFormat=function(t,e){return Jr(n,t,e)},i.nice=function(t){return i.domain(Wr(n,t))},i.exponent=function(s){return arguments.length?(r=Xr(e=s),a=Xr(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return Zr(t.copy(),e,n)},Hr(i,t)}function Xr(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function ta(t,e){function n(n){return a[((r.get(n)||("range"===e.t?r.set(n,t.push(n)):NaN))-1)%a.length]}function i(e,n){return es.range(t.length).map(function(t){return e+n*t})}var r,a,s;return n.domain=function(i){if(!arguments.length)return t;t=[],r=new u;for(var a,s=-1,o=i.length;++s<o;)r.has(a=i[s])||r.set(a,t.push(a));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(a=t,s=0,e={t:"range",a:arguments},n):a},n.rangePoints=function(r,o){arguments.length<2&&(o=0);var l=r[0],u=r[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+o);return a=i(l+c*o/2,c),s=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(r,o){arguments.length<2&&(o=0);var l=r[0],u=r[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+o)|0;return a=i(l+Math.round(c*o/2+(u-l-(t.length-1+o)*c)/2),c),s=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(r,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=(h-c)/(t.length-o+2*l);return a=i(c+d*l,d),u&&a.reverse(),s=d*(1-o),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,o,l){arguments.length<2&&(o=0),arguments.length<3&&(l=o);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=Math.floor((h-c)/(t.length-o+2*l));return a=i(c+Math.round((h-c-(t.length-o)*d)/2),d),u&&a.reverse(),s=Math.round(d*(1-o)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return s},n.rangeExtent=function(){return Br(e.a[0])},n.copy=function(){return ta(t,e)},n.domain(t)}function ea(t,e){function a(){var n=0,i=e.length;for(o=[];++n<i;)o[n-1]=es.quantile(t,n/i);return s}function s(t){return isNaN(t=+t)?void 0:e[es.bisect(o,t)]}var o;return s.domain=function(e){return arguments.length?(t=e.map(i).filter(r).sort(n),a()):t},s.range=function(t){return arguments.length?(e=t,a()):e},s.quantiles=function(){return o},s.invertExtent=function(n){return n=e.indexOf(n),0>n?[NaN,NaN]:[n>0?o[n-1]:t[0],n<o.length?o[n]:t[t.length-1]]},s.copy=function(){return ea(t,e)},a()}function na(t,e,n){function i(e){return n[Math.max(0,Math.min(s,Math.floor(a*(e-t))))]}function r(){return a=n.length/(e-t),s=n.length-1,i}var a,s;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=0>e?NaN:e/a+t,[e,e+1/a]},i.copy=function(){return na(t,e,n)},r()}function ia(t,e){function n(n){return n>=n?e[es.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return ia(t,e)},n}function ra(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Yr(t,e)},e.tickFormat=function(e,n){return Jr(t,e,n)},e.copy=function(){return ra(t)},e}function aa(){return 0}function sa(t){return t.innerRadius}function oa(t){return t.outerRadius}function la(t){return t.startAngle}function ua(t){return t.endAngle}function ca(t){return t&&t.padAngle}function ha(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function da(t,e,n,i,r){var a=t[0]-e[0],s=t[1]-e[1],o=(r?i:-i)/Math.sqrt(a*a+s*s),l=o*s,u=-o*a,c=t[0]+l,h=t[1]+u,d=e[0]+l,p=e[1]+u,f=(c+d)/2,m=(h+p)/2,g=d-c,y=p-h,v=g*g+y*y,_=n-i,S=c*p-d*h,b=(0>y?-1:1)*Math.sqrt(_*_*v-S*S),w=(S*y-g*b)/v,P=(-S*g-y*b)/v,C=(S*y+g*b)/v,k=(-S*g+y*b)/v,x=w-f,E=P-m,T=C-f,A=k-m;return x*x+E*E>T*T+A*A&&(w=C,P=k),[[w-l,P-u],[w*n/_,P*n/_]]}function pa(t){function e(e){function s(){u.push("M",a(t(c),o))}for(var l,u=[],c=[],h=-1,d=e.length,p=xt(n),f=xt(i);++h<d;)r.call(this,l=e[h],h)?c.push([+p.call(this,l,h),+f.call(this,l,h)]):c.length&&(s(),c=[]);return c.length&&s(),u.length?u.join(""):null}var n=Tn,i=An,r=Te,a=fa,s=a.key,o=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=El.get(t)||fa).key,e):s},e.tension=function(t){return arguments.length?(o=t,e):o},e}function fa(t){return t.join("L")}function ma(t){return fa(t)+"Z"}function ga(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function ya(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function va(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function _a(t,e){return t.length<4?fa(t):t[1]+wa(t.slice(1,-1),Pa(t,e))}function Sa(t,e){return t.length<3?fa(t):t[0]+wa((t.push(t[0]),t),Pa([t[t.length-2]].concat(t,[t[1]]),e))}function ba(t,e){return t.length<3?fa(t):t[0]+wa(t,Pa(t,e))}function wa(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return fa(t);var n=t.length!=e.length,i="",r=t[0],a=t[1],s=e[0],o=s,l=1;if(n&&(i+="Q"+(a[0]-2*s[0]/3)+","+(a[1]-2*s[1]/3)+","+a[0]+","+a[1],r=t[1],l=2),e.length>1){o=e[1],a=t[l],l++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1];for(var u=2;u<e.length;u++,l++)a=t[l],o=e[u],i+="S"+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1]}if(n){var c=t[l];i+="Q"+(a[0]+2*o[0]/3)+","+(a[1]+2*o[1]/3)+","+c[0]+","+c[1]}return i}function Pa(t,e){for(var n,i=[],r=(1-e)/2,a=t[0],s=t[1],o=1,l=t.length;++o<l;)n=a,a=s,s=t[o],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function Ca(t){if(t.length<3)return fa(t);var e=1,n=t.length,i=t[0],r=i[0],a=i[1],s=[r,r,r,(i=t[1])[0]],o=[a,a,a,i[1]],l=[r,",",a,"L",Ta(Ml,s),",",Ta(Ml,o)];for(t.push(t[n-1]);++e<=n;)i=t[e],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Aa(l,s,o);return t.pop(),l.push("L",i),l.join("")}function ka(t){if(t.length<4)return fa(t);for(var e,n=[],i=-1,r=t.length,a=[0],s=[0];++i<3;)e=t[i],a.push(e[0]),s.push(e[1]);for(n.push(Ta(Ml,a)+","+Ta(Ml,s)),--i;++i<r;)e=t[i],a.shift(),a.push(e[0]),s.shift(),s.push(e[1]),Aa(n,a,s);return n.join("")}function xa(t){for(var e,n,i=-1,r=t.length,a=r+4,s=[],o=[];++i<4;)n=t[i%r],s.push(n[0]),o.push(n[1]);for(e=[Ta(Ml,s),",",Ta(Ml,o)],--i;++i<a;)n=t[i%r],s.shift(),s.push(n[0]),o.shift(),o.push(n[1]),Aa(e,s,o);return e.join("")}function Ea(t,e){var n=t.length-1;if(n)for(var i,r,a=t[0][0],s=t[0][1],o=t[n][0]-a,l=t[n][1]-s,u=-1;++u<=n;)i=t[u],r=u/n,i[0]=e*i[0]+(1-e)*(a+r*o),i[1]=e*i[1]+(1-e)*(s+r*l);return Ca(t)}function Ta(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Aa(t,e,n){t.push("C",Ta(Tl,e),",",Ta(Tl,n),",",Ta(Al,e),",",Ta(Al,n),",",Ta(Ml,e),",",Ta(Ml,n));
}function Ma(t,e){return(e[1]-t[1])/(e[0]-t[0])}function ja(t){for(var e=0,n=t.length-1,i=[],r=t[0],a=t[1],s=i[0]=Ma(r,a);++e<n;)i[e]=(s+(s=Ma(r=a,a=t[e+1])))/2;return i[e]=s,i}function Ia(t){for(var e,n,i,r,a=[],s=ja(t),o=-1,l=t.length-1;++o<l;)e=Ma(t[o],t[o+1]),ps(e)<As?s[o]=s[o+1]=0:(n=s[o]/e,i=s[o+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),s[o]=r*n,s[o+1]=r*i));for(o=-1;++o<=l;)r=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+s[o]*s[o])),a.push([r||0,s[o]*r||0]);return a}function Na(t){return t.length<3?fa(t):t[0]+wa(t,Ia(t))}function Fa(t){for(var e,n,i,r=-1,a=t.length;++r<a;)e=t[r],n=e[0],i=e[1]-Fs,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Ra(t){function e(e){function l(){m.push("M",o(t(y),h),c,u(t(g.reverse()),h),"Z")}for(var d,p,f,m=[],g=[],y=[],v=-1,_=e.length,S=xt(n),b=xt(r),w=n===i?function(){return p}:xt(i),P=r===a?function(){return f}:xt(a);++v<_;)s.call(this,d=e[v],v)?(g.push([p=+S.call(this,d,v),f=+b.call(this,d,v)]),y.push([+w.call(this,d,v),+P.call(this,d,v)])):g.length&&(l(),g=[],y=[]);return g.length&&l(),m.length?m.join(""):null}var n=Tn,i=Tn,r=0,a=An,s=Te,o=fa,l=o.key,u=o,c="L",h=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=a=t,e):a},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(a=t,e):a},e.defined=function(t){return arguments.length?(s=t,e):s},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?o=t:(o=El.get(t)||fa).key,u=o.reverse||o,c=o.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function La(t){return t.radius}function Ba(t){return[t.x,t.y]}function Oa(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Fs;return[n*Math.cos(i),n*Math.sin(i)]}}function Da(){return 64}function $a(){return"circle"}function qa(t){var e=Math.sqrt(t/js);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Ua(t){return function(){var e,n;(e=this[t])&&(n=e[e.active])&&(--e.count?delete e[e.active]:delete this[t],e.active+=.5,n.event&&n.event.interrupt.call(this,this.__data__,n.index))}}function za(t,e,n){return vs(t,Bl),t.namespace=e,t.id=n,t}function Ha(t,e,n,i){var r=t.id,a=t.namespace;return z(t,"function"==typeof n?function(t,s,o){t[a][r].tween.set(e,i(n.call(t,t.__data__,s,o)))}:(n=i(n),function(t){t[a][r].tween.set(e,n)}))}function Wa(t){return null==t&&(t=""),function(){this.textContent=t}}function Va(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ya(t,e,n,i,r){var a=t[n]||(t[n]={active:0,count:0}),s=a[i];if(!s){var o=r.time;s=a[i]={tween:new u,time:o,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++a.count,es.timer(function(r){function l(n){if(a.active>i)return c();var r=a[a.active];r&&(--a.count,delete a[a.active],r.event&&r.event.interrupt.call(t,t.__data__,r.index)),a.active=i,s.event&&s.event.start.call(t,t.__data__,e),s.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&m.push(i)}),d=s.ease,h=s.duration,es.timer(function(){return f.c=u(n||1)?Te:u,1},0,o)}function u(n){if(a.active!==i)return 1;for(var r=n/h,o=d(r),l=m.length;l>0;)m[--l].call(t,o);return r>=1?(s.event&&s.event.end.call(t,t.__data__,e),c()):void 0}function c(){return--a.count?delete a[i]:delete t[n],1}var h,d,p=s.delay,f=no,m=[];return f.t=p+o,r>=p?l(r-p):void(f.c=l)},0,o)}}function Ja(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function Ga(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}function Ka(t){return t.toISOString()}function Qa(t,e,n){function i(e){return t(e)}function r(t,n){var i=t[1]-t[0],r=i/n,a=es.bisect(Vl,r);return a==Vl.length?[e.year,Vr(t.map(function(t){return t/31536e6}),n)[2]]:a?e[r/Vl[a-1]<Vl[a]/r?a-1:a]:[Gl,Vr(t,n)[2]]}return i.invert=function(e){return Za(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Za)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Za(+n+1),e).length}var a=i.domain(),s=Br(a),o=null==t?r(s,10):"number"==typeof t&&r(s,t);return o&&(t=o[0],e=o[1]),i.domain($r(a,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Za(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Za(+e+1);return e}}:t))},i.ticks=function(t,e){var n=Br(i.domain()),a=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return a&&(t=a[0],e=a[1]),t.range(n[0],Za(+n[1]+1),1>e?1:e)},i.tickFormat=function(){return n},i.copy=function(){return Qa(t.copy(),e,n)},Hr(i,t)}function Za(t){return new Date(t)}function Xa(t){return JSON.parse(t.responseText)}function ts(t){var e=rs.createRange();return e.selectNode(rs.body),e.createContextualFragment(t.responseText)}var es={version:"3.5.6"},ns=[].slice,is=function(t){return ns.call(t)},rs=this.document;if(rs)try{is(rs.documentElement.childNodes)[0].nodeType}catch(as){is=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),rs)try{rs.createElement("DIV").style.setProperty("opacity",0,"")}catch(ss){var os=this.Element.prototype,ls=os.setAttribute,us=os.setAttributeNS,cs=this.CSSStyleDeclaration.prototype,hs=cs.setProperty;os.setAttribute=function(t,e){ls.call(this,t,e+"")},os.setAttributeNS=function(t,e,n){us.call(this,t,e,n+"")},cs.setProperty=function(t,e,n){hs.call(this,t,e+"",n)}}es.ascending=n,es.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:NaN},es.min=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;++r<a;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<a;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<a;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<a;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},es.max=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;++r<a;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<a;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<a;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<a;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},es.extent=function(t,e){var n,i,r,a=-1,s=t.length;if(1===arguments.length){for(;++a<s;)if(null!=(i=t[a])&&i>=i){n=r=i;break}for(;++a<s;)null!=(i=t[a])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;++a<s;)if(null!=(i=e.call(t,t[a],a))&&i>=i){n=r=i;break}for(;++a<s;)null!=(i=e.call(t,t[a],a))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},es.sum=function(t,e){var n,i=0,a=t.length,s=-1;if(1===arguments.length)for(;++s<a;)r(n=+t[s])&&(i+=n);else for(;++s<a;)r(n=+e.call(t,t[s],s))&&(i+=n);return i},es.mean=function(t,e){var n,a=0,s=t.length,o=-1,l=s;if(1===arguments.length)for(;++o<s;)r(n=i(t[o]))?a+=n:--l;else for(;++o<s;)r(n=i(e.call(t,t[o],o)))?a+=n:--l;return l?a/l:void 0},es.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],a=n-i;return a?r+a*(t[i]-r):r},es.median=function(t,e){var a,s=[],o=t.length,l=-1;if(1===arguments.length)for(;++l<o;)r(a=i(t[l]))&&s.push(a);else for(;++l<o;)r(a=i(e.call(t,t[l],l)))&&s.push(a);return s.length?es.quantile(s.sort(n),.5):void 0},es.variance=function(t,e){var n,a,s=t.length,o=0,l=0,u=-1,c=0;if(1===arguments.length)for(;++u<s;)r(n=i(t[u]))&&(a=n-o,o+=a/++c,l+=a*(n-o));else for(;++u<s;)r(n=i(e.call(t,t[u],u)))&&(a=n-o,o+=a/++c,l+=a*(n-o));return c>1?l/(c-1):void 0},es.deviation=function(){var t=es.variance.apply(this,arguments);return t?Math.sqrt(t):t};var ds=a(n);es.bisectLeft=ds.left,es.bisect=es.bisectRight=ds.right,es.bisector=function(t){return a(1===t.length?function(e,i){return n(t(e),i)}:t)},es.shuffle=function(t,e,n){(a=arguments.length)<3&&(n=t.length,2>a&&(e=0));for(var i,r,a=n-e;a;)r=Math.random()*a--|0,i=t[a+e],t[a+e]=t[r+e],t[r+e]=i;return t},es.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},es.pairs=function(t){for(var e,n=0,i=t.length-1,r=t[0],a=new Array(0>i?0:i);i>n;)a[n]=[e=r,r=t[++n]];return a},es.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=es.min(arguments,s),n=new Array(e);++t<e;)for(var i,r=-1,a=n[t]=new Array(i);++r<i;)a[r]=arguments[r][t];return n},es.transpose=function(t){return es.zip.apply(es,t)},es.keys=function(t){var e=[];for(var n in t)e.push(n);return e},es.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},es.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},es.merge=function(t){for(var e,n,i,r=t.length,a=-1,s=0;++a<r;)s+=t[a].length;for(n=new Array(s);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--s]=i[e];return n};var ps=Math.abs;es.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var i,r=[],a=o(ps(n)),s=-1;if(t*=a,e*=a,n*=a,0>n)for(;(i=t+n*++s)>e;)r.push(i/a);else for(;(i=t+n*++s)<e;)r.push(i/a);return r},es.map=function(t,e){var n=new u;if(t instanceof u)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,a=t.length;if(1===arguments.length)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e.call(t,i=t[r],r),i)}else for(var s in t)n.set(s,t[s]);return n};var fs="__proto__",ms="\x00";l(u,{has:d,get:function(t){return this._[c(t)]},set:function(t,e){return this._[c(t)]=e},remove:p,keys:f,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:h(e),value:this._[e]});return t},size:m,empty:g,forEach:function(t){for(var e in this._)t.call(this,h(e),this._[e])}}),es.nest=function(){function t(e,s,o){if(o>=a.length)return i?i.call(r,s):n?s.sort(n):s;for(var l,c,h,d,p=-1,f=s.length,m=a[o++],g=new u;++p<f;)(d=g.get(l=m(c=s[p])))?d.push(c):g.set(l,[c]);return e?(c=e(),h=function(n,i){c.set(n,t(e,i,o))}):(c={},h=function(n,i){c[n]=t(e,i,o)}),g.forEach(h),c}function e(t,n){if(n>=a.length)return t;var i=[],r=s[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,r={},a=[],s=[];return r.map=function(e,n){return t(n,e,0)},r.entries=function(n){return e(t(es.map,n,0),0)},r.key=function(t){return a.push(t),r},r.sortKeys=function(t){return s[a.length-1]=t,r},r.sortValues=function(t){return n=t,r},r.rollup=function(t){return i=t,r},r},es.set=function(t){var e=new y;if(t)for(var n=0,i=t.length;i>n;++n)e.add(t[n]);return e},l(y,{has:d,add:function(t){return this._[c(t+="")]=!0,t},remove:p,values:f,size:m,empty:g,forEach:function(t){for(var e in this._)t.call(this,h(e))}}),es.behavior={},es.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=_(t,e,e[n]);return t};var gs=["webkit","ms","moz","Moz","o","O"];es.dispatch=function(){for(var t=new w,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=P(t);return t},w.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},es.event=null,es.requote=function(t){return t.replace(ys,"\\$&")};var ys=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,vs={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},_s=function(t,e){return e.querySelector(t)},Ss=function(t,e){return e.querySelectorAll(t)},bs=function(t,e){var n=t.matches||t[S(t,"matchesSelector")];return(bs=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(_s=function(t,e){return Sizzle(t,e)[0]||null},Ss=Sizzle,bs=Sizzle.matchesSelector),es.selection=function(){return es.select(rs.documentElement)};var ws=es.selection.prototype=[];ws.select=function(t){var e,n,i,r,a=[];t=T(t);for(var s=-1,o=this.length;++s<o;){a.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,s)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return E(a)},ws.selectAll=function(t){var e,n,i=[];t=A(t);for(var r=-1,a=this.length;++r<a;)for(var s=this[r],o=-1,l=s.length;++o<l;)(n=s[o])&&(i.push(e=is(t.call(n,n.__data__,o,r))),e.parentNode=n);return E(i)};var Ps={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};es.ns={prefix:Ps,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),Ps.hasOwnProperty(n)?{space:Ps[n],local:t}:t}},ws.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=es.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(M(e,t[e]));return this}return this.each(M(t,e))},ws.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=N(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!I(t[r]).test(e))return!1;return!0}for(e in t)this.each(F(e,t[e]));return this}return this.each(F(t,e))},ws.style=function(t,n,i){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(n="");for(i in t)this.each(L(i,t[i],n));return this}if(2>r){var a=this.node();return e(a).getComputedStyle(a,null).getPropertyValue(t)}i=""}return this.each(L(t,n,i))},ws.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(B(e,t[e]));return this}return this.each(B(t,e))},ws.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ws.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ws.append=function(t){return t=O(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ws.insert=function(t,e){return t=O(t),e=T(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ws.remove=function(){return this.each(D)},ws.data=function(t,e){function n(t,n){var i,r,a,s=t.length,h=n.length,d=Math.min(s,h),p=new Array(h),f=new Array(h),m=new Array(s);if(e){var g,y=new u,v=new Array(s);for(i=-1;++i<s;)y.has(g=e.call(r=t[i],r.__data__,i))?m[i]=r:y.set(g,r),v[i]=g;for(i=-1;++i<h;)(r=y.get(g=e.call(n,a=n[i],i)))?r!==!0&&(p[i]=r,r.__data__=a):f[i]=$(a),y.set(g,!0);for(i=-1;++i<s;)y.get(v[i])!==!0&&(m[i]=t[i])}else{for(i=-1;++i<d;)r=t[i],a=n[i],r?(r.__data__=a,p[i]=r):f[i]=$(a);for(;h>i;++i)f[i]=$(n[i]);for(;s>i;++i)m[i]=t[i]}f.update=p,f.parentNode=p.parentNode=m.parentNode=t.parentNode,o.push(f),l.push(p),c.push(m)}var i,r,a=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(i=this[0]).length);++a<s;)(r=i[a])&&(t[a]=r.__data__);return t}var o=H([]),l=E([]),c=E([]);if("function"==typeof t)for(;++a<s;)n(i=this[a],t.call(i,i.parentNode.__data__,a));else for(;++a<s;)n(i=this[a],t);return l.enter=function(){return o},l.exit=function(){return c},l},ws.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ws.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=q(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i,i.__data__,o,a)&&e.push(i)}return E(r)},ws.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,a=i[r];--r>=0;)(n=i[r])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},ws.sort=function(t){t=U.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},ws.each=function(t){return z(this,function(e,n,i){t.call(e,e.__data__,n,i)})},ws.call=function(t){var e=is(arguments);return t.apply(e[0]=this,e),this},ws.empty=function(){return!this.node()},ws.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var a=n[i];if(a)return a}return null},ws.size=function(){var t=0;return z(this,function(){++t}),t};var Cs=[];es.selection.enter=H,es.selection.enter.prototype=Cs,Cs.append=ws.append,Cs.empty=ws.empty,Cs.node=ws.node,Cs.call=ws.call,Cs.size=ws.size,Cs.select=function(t){for(var e,n,i,r,a,s=[],o=-1,l=this.length;++o<l;){i=(r=this[o]).update,s.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(a=r[u])?(e.push(i[u]=n=t.call(r.parentNode,a.__data__,u,o)),n.__data__=a.__data__):e.push(null)}return E(s)},Cs.insert=function(t,e){return arguments.length<2&&(e=W(this)),ws.insert.call(this,t,e)},es.select=function(e){var n;return"string"==typeof e?(n=[_s(e,rs)],n.parentNode=rs.documentElement):(n=[e],n.parentNode=t(e)),E([n])},es.selectAll=function(t){var e;return"string"==typeof t?(e=is(Ss(t,rs)),e.parentNode=rs.documentElement):(e=t,e.parentNode=null),E([e])},ws.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(V(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(V(t,e,n))};var ks=es.map({mouseenter:"mouseover",mouseleave:"mouseout"});rs&&ks.forEach(function(t){"on"+t in rs&&ks.remove(t)});var xs,Es=0;es.mouse=function(t){return K(t,k())};var Ts=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;es.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=k().changedTouches),e)for(var i,r=0,a=e.length;a>r;++r)if((i=e[r]).identifier===n)return K(t,i)},es.behavior.drag=function(){function t(){this.on("mousedown.drag",a).on("touchstart.drag",s)}function n(t,e,n,a,s){return function(){function o(){var t,n,i=e(d,m);i&&(t=i[0]-_[0],n=i[1]-_[1],f|=t|n,_=i,p({type:"drag",x:i[0]+u[0],y:i[1]+u[1],dx:t,dy:n}))}function l(){e(d,m)&&(y.on(a+g,null).on(s+g,null),v(f&&es.event.target===h),p({type:"dragend"}))}var u,c=this,h=es.event.target,d=c.parentNode,p=i.of(c,arguments),f=0,m=t(),g=".drag"+(null==m?"":"-"+m),y=es.select(n(h)).on(a+g,o).on(s+g,l),v=G(h),_=e(d,m);r?(u=r.apply(c,arguments),u=[u.x-_[0],u.y-_[1]]):u=[0,0],p({type:"dragstart"})}}var i=x(t,"drag","dragstart","dragend"),r=null,a=n(b,es.mouse,e,"mousemove","mouseup"),s=n(Q,es.touch,v,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},es.rebind(t,i,"on")},es.touches=function(t,e){return arguments.length<2&&(e=k().touches),e?is(e).map(function(e){var n=K(t,e);return n.identifier=e.identifier,n}):[]};var As=1e-6,Ms=As*As,js=Math.PI,Is=2*js,Ns=Is-As,Fs=js/2,Rs=js/180,Ls=180/js,Bs=Math.SQRT2,Os=2,Ds=4;es.interpolateZoom=function(t,e){function n(t){var e=t*v;if(y){var n=it(m),s=a/(Os*d)*(n*rt(Bs*e+m)-nt(m));return[i+s*u,r+s*c,a*n/it(Bs*e+m)]}return[i+t*u,r+t*c,a*Math.exp(Bs*e)]}var i=t[0],r=t[1],a=t[2],s=e[0],o=e[1],l=e[2],u=s-i,c=o-r,h=u*u+c*c,d=Math.sqrt(h),p=(l*l-a*a+Ds*h)/(2*a*Os*d),f=(l*l-a*a-Ds*h)/(2*l*Os*d),m=Math.log(Math.sqrt(p*p+1)-p),g=Math.log(Math.sqrt(f*f+1)-f),y=g-m,v=(y||Math.log(l/a))/Bs;return n.duration=1e3*v,n},es.behavior.zoom=function(){function t(t){t.on(j,h).on(qs+".zoom",p).on("dblclick.zoom",f).on(F,d)}function n(t){return[(t[0]-k.x)/k.k,(t[1]-k.y)/k.k]}function i(t){return[t[0]*k.k+k.x,t[1]*k.k+k.y]}function r(t){k.k=Math.max(T[0],Math.min(T[1],t))}function a(t,e){e=i(e),k.x+=t[0]-e[0],k.y+=t[1]-e[1]}function s(e,n,i,s){e.__chart__={x:k.x,y:k.y,k:k.k},r(Math.pow(2,s)),a(g=n,i),e=es.select(e),A>0&&(e=e.transition().duration(A)),e.call(t.event)}function o(){b&&b.domain(S.range().map(function(t){return(t-k.x)/k.k}).map(S.invert)),P&&P.domain(w.range().map(function(t){return(t-k.y)/k.k}).map(w.invert))}function l(t){M++||t({type:"zoomstart"})}function u(t){o(),t({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function c(t){--M||(t({type:"zoomend"}),g=null)}function h(){function t(){h=1,a(es.mouse(r),p),u(o)}function i(){d.on(I,null).on(N,null),f(h&&es.event.target===s),c(o)}var r=this,s=es.event.target,o=R.of(r,arguments),h=0,d=es.select(e(r)).on(I,t).on(N,i),p=n(es.mouse(r)),f=G(r);Ll.call(r),l(o)}function d(){function t(){var t=es.touches(f);return p=k.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=n(t))}),t}function e(){var e=es.event.target;es.select(e).on(S,i).on(b,o),w.push(e);for(var n=es.event.changedTouches,r=0,a=n.length;a>r;++r)g[n[r].identifier]=null;var l=t(),u=Date.now();if(1===l.length){if(500>u-_){var c=l[0];s(f,c,g[c.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),C()}_=u}else if(l.length>1){var c=l[0],h=l[1],d=c[0]-h[0],p=c[1]-h[1];y=d*d+p*p}}function i(){var t,e,n,i,s=es.touches(f);Ll.call(f);for(var o=0,l=s.length;l>o;++o,i=null)if(n=s[o],i=g[n.identifier]){if(e)break;t=n,e=i}if(i){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=y&&Math.sqrt(c/y);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],r(h*p)}_=null,a(t,e),u(m)}function o(){if(es.event.touches.length){for(var e=es.event.changedTouches,n=0,i=e.length;i>n;++n)delete g[e[n].identifier];for(var r in g)return void t()}es.selectAll(w).on(v,null),P.on(j,h).on(F,d),x(),c(m)}var p,f=this,m=R.of(f,arguments),g={},y=0,v=".zoom-"+es.event.changedTouches[0].identifier,S="touchmove"+v,b="touchend"+v,w=[],P=es.select(f),x=G(f);e(),l(m),P.on(j,null).on(F,e)}function p(){var t=R.of(this,arguments);v?clearTimeout(v):(Ll.call(this),m=n(g=y||es.mouse(this)),l(t)),v=setTimeout(function(){v=null,c(t)},50),C(),r(Math.pow(2,.002*$s())*k.k),a(g,m),u(t)}function f(){var t=es.mouse(this),e=Math.log(k.k)/Math.LN2;s(this,t,n(t),es.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var m,g,y,v,_,S,b,w,P,k={x:0,y:0,k:1},E=[960,500],T=Us,A=250,M=0,j="mousedown.zoom",I="mousemove.zoom",N="mouseup.zoom",F="touchstart.zoom",R=x(t,"zoomstart","zoom","zoomend");return qs||(qs="onwheel"in rs?($s=function(){return-es.event.deltaY*(es.event.deltaMode?120:1)},"wheel"):"onmousewheel"in rs?($s=function(){return es.event.wheelDelta},"mousewheel"):($s=function(){return-es.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=R.of(this,arguments),e=k;Fl?es.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},l(t)}).tween("zoom:zoom",function(){var n=E[0],i=E[1],r=g?g[0]:n/2,a=g?g[1]:i/2,s=es.interpolateZoom([(r-k.x)/k.k,(a-k.y)/k.k,n/k.k],[(r-e.x)/e.k,(a-e.y)/e.k,n/e.k]);return function(e){var i=s(e),o=n/i[2];this.__chart__=k={x:r-i[0]*o,y:a-i[1]*o,k:o},u(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=k,l(t),u(t),c(t))})},t.translate=function(e){return arguments.length?(k={x:+e[0],y:+e[1],k:k.k},o(),t):[k.x,k.y]},t.scale=function(e){return arguments.length?(k={x:k.x,y:k.y,k:+e},o(),t):k.k},t.scaleExtent=function(e){return arguments.length?(T=null==e?Us:[+e[0],+e[1]],t):T},t.center=function(e){return arguments.length?(y=e&&[+e[0],+e[1]],t):y},t.size=function(e){return arguments.length?(E=e&&[+e[0],+e[1]],t):E},t.duration=function(e){return arguments.length?(A=+e,t):A},t.x=function(e){return arguments.length?(b=e,S=e.copy(),k={x:0,y:0,k:1},t):b},t.y=function(e){return arguments.length?(P=e,w=e.copy(),k={x:0,y:0,k:1},t):P},es.rebind(t,R,"on")};var $s,qs,Us=[0,1/0];es.color=st,st.prototype.toString=function(){return this.rgb()+""},es.hsl=ot;var zs=ot.prototype=new st;zs.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new ot(this.h,this.s,this.l/t)},zs.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ot(this.h,this.s,t*this.l)},zs.rgb=function(){return lt(this.h,this.s,this.l)},es.hcl=ut;var Hs=ut.prototype=new st;Hs.brighter=function(t){return new ut(this.h,this.c,Math.min(100,this.l+Ws*(arguments.length?t:1)))},Hs.darker=function(t){return new ut(this.h,this.c,Math.max(0,this.l-Ws*(arguments.length?t:1)))},Hs.rgb=function(){return ct(this.h,this.c,this.l).rgb()},es.lab=ht;var Ws=18,Vs=.95047,Ys=1,Js=1.08883,Gs=ht.prototype=new st;Gs.brighter=function(t){return new ht(Math.min(100,this.l+Ws*(arguments.length?t:1)),this.a,this.b)},Gs.darker=function(t){return new ht(Math.max(0,this.l-Ws*(arguments.length?t:1)),this.a,this.b)},Gs.rgb=function(){return dt(this.l,this.a,this.b)},es.rgb=yt;var Ks=yt.prototype=new st;Ks.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),new yt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new yt(r,r,r)},Ks.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new yt(t*this.r,t*this.g,t*this.b)},Ks.hsl=function(){return wt(this.r,this.g,this.b)},Ks.toString=function(){return"#"+St(this.r)+St(this.g)+St(this.b)};var Qs=es.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Qs.forEach(function(t,e){Qs.set(t,vt(e))}),es.functor=xt,es.xhr=Et(v),es.dsv=function(t,e){function n(t,n,a){arguments.length<3&&(a=n,n=null);var s=Tt(t,e,null==n?i:r(n),a);return s.row=function(t){return arguments.length?s.response(null==(n=t)?i:r(t)):n},s}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function a(e){return e.map(s).join(t)}function s(t){return o.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var o=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=u)return s;if(r)return r=!1,a;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u>c;){var i=t.charCodeAt(c++),o=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++o);else if(i!==l)continue;return t.slice(e,c-o)}return t.slice(e)}for(var i,r,a={},s={},o=[],u=t.length,c=0,h=0;(i=n())!==s;){for(var d=[];i!==a&&i!==s;)d.push(i),i=n();e&&null==(d=e(d,h++))||o.push(d)}return o},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new y,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(s).join(t)].concat(e.map(function(e){return r.map(function(t){return s(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(a).join("\n")},n},es.csv=es.dsv(",","text/csv"),es.tsv=es.dsv("	","text/tab-separated-values");var Zs,Xs,to,eo,no,io=this[S(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};es.timer=function(t,e,n){var i=arguments.length;2>i&&(e=0),3>i&&(n=Date.now());var r=n+e,a={c:t,t:r,f:!1,n:null};Xs?Xs.n=a:Zs=a,Xs=a,to||(eo=clearTimeout(eo),to=1,io(jt))},es.timer.flush=function(){It(),Nt()},es.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var ro=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Rt);es.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=es.round(t,Ft(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),ro[8+n/3]};var ao=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,so=es.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=es.round(t,Ft(t,e))).toFixed(Math.max(0,Math.min(20,Ft(t*(1+1e-15),e))))}}),oo=es.time={},lo=Date;Ot.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){uo.setUTCDate.apply(this._,arguments)},setDay:function(){uo.setUTCDay.apply(this._,arguments)},setFullYear:function(){uo.setUTCFullYear.apply(this._,arguments)},setHours:function(){uo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){uo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){uo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){uo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){uo.setUTCSeconds.apply(this._,arguments)},setTime:function(){uo.setTime.apply(this._,arguments)}};var uo=Date.prototype;oo.year=Dt(function(t){return t=oo.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),oo.years=oo.year.range,oo.years.utc=oo.year.utc.range,oo.day=Dt(function(t){var e=new lo(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),oo.days=oo.day.range,oo.days.utc=oo.day.utc.range,oo.dayOfYear=function(t){var e=oo.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=oo[t]=Dt(function(t){return(t=oo.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=oo.year(t).getDay();return Math.floor((oo.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});oo[t+"s"]=n.range,oo[t+"s"].utc=n.utc.range,oo[t+"OfYear"]=function(t){var n=oo.year(t).getDay();return Math.floor((oo.dayOfYear(t)+(n+e)%7)/7)}}),oo.week=oo.sunday,oo.weeks=oo.sunday.range,oo.weeks.utc=oo.sunday.utc.range,oo.weekOfYear=oo.sundayOfYear;var co={"-":"",_:" ",0:"0"},ho=/^\s*\d+/,po=/^%/;es.locale=function(t){return{numberFormat:Lt(t),timeFormat:qt(t)}};var fo=es.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",
date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});es.format=fo.numberFormat,es.geo={},le.prototype={s:0,t:0,add:function(t){ue(t,this.t,mo),ue(mo.s,this.s,this),this.s?this.t+=mo.t:this.s=mo.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var mo=new le;es.geo.stream=function(t,e){t&&go.hasOwnProperty(t.type)?go[t.type](t,e):ce(t,e)};var go={Feature:function(t,e){ce(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)ce(n[i].geometry,e)}},yo={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){he(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)he(n[i],e,0)},Polygon:function(t,e){de(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)de(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)ce(n[i],e)}};es.geo.area=function(t){return vo=0,es.geo.stream(t,So),vo};var vo,_o=new le,So={sphere:function(){vo+=4*js},point:b,lineStart:b,lineEnd:b,polygonStart:function(){_o.reset(),So.lineStart=pe},polygonEnd:function(){var t=2*_o;vo+=0>t?4*js+t:t,So.lineStart=So.lineEnd=So.point=b}};es.geo.bounds=function(){function t(t,e){_.push(S=[c=t,d=t]),h>e&&(h=e),e>p&&(p=e)}function e(e,n){var i=fe([e*Rs,n*Rs]);if(y){var r=ge(y,i),a=[r[1],-r[0],0],s=ge(a,r);_e(s),s=Se(s);var l=e-f,u=l>0?1:-1,m=s[0]*Ls*u,g=ps(l)>180;if(g^(m>u*f&&u*e>m)){var v=s[1]*Ls;v>p&&(p=v)}else if(m=(m+360)%360-180,g^(m>u*f&&u*e>m)){var v=-s[1]*Ls;h>v&&(h=v)}else h>n&&(h=n),n>p&&(p=n);g?f>e?o(c,e)>o(c,d)&&(d=e):o(e,d)>o(c,d)&&(c=e):d>=c?(c>e&&(c=e),e>d&&(d=e)):e>f?o(c,e)>o(c,d)&&(d=e):o(e,d)>o(c,d)&&(c=e)}else t(e,n);y=i,f=e}function n(){b.point=e}function i(){S[0]=c,S[1]=d,b.point=t,y=null}function r(t,n){if(y){var i=t-f;v+=ps(i)>180?i+(i>0?360:-360):i}else m=t,g=n;So.point(t,n),e(t,n)}function a(){So.lineStart()}function s(){r(m,g),So.lineEnd(),ps(v)>As&&(c=-(d=180)),S[0]=c,S[1]=d,y=null}function o(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,d,p,f,m,g,y,v,_,S,b={point:t,lineStart:n,lineEnd:i,polygonStart:function(){b.point=r,b.lineStart=a,b.lineEnd=s,v=0,So.polygonStart()},polygonEnd:function(){So.polygonEnd(),b.point=t,b.lineStart=n,b.lineEnd=i,0>_o?(c=-(d=180),h=-(p=90)):v>As?p=90:-As>v&&(h=-90),S[0]=c,S[1]=d}};return function(t){p=d=-(c=h=1/0),_=[],es.geo.stream(t,b);var e=_.length;if(e){_.sort(l);for(var n,i=1,r=_[0],a=[r];e>i;++i)n=_[i],u(n[0],r)||u(n[1],r)?(o(r[0],n[1])>o(r[0],r[1])&&(r[1]=n[1]),o(n[0],r[1])>o(r[0],r[1])&&(r[0]=n[0])):a.push(r=n);for(var s,n,f=-1/0,e=a.length-1,i=0,r=a[e];e>=i;r=n,++i)n=a[i],(s=o(r[1],n[0]))>f&&(f=s,c=n[0],d=r[1])}return _=S=null,1/0===c||1/0===h?[[NaN,NaN],[NaN,NaN]]:[[c,h],[d,p]]}}(),es.geo.centroid=function(t){bo=wo=Po=Co=ko=xo=Eo=To=Ao=Mo=jo=0,es.geo.stream(t,Io);var e=Ao,n=Mo,i=jo,r=e*e+n*n+i*i;return Ms>r&&(e=xo,n=Eo,i=To,As>wo&&(e=Po,n=Co,i=ko),r=e*e+n*n+i*i,Ms>r)?[NaN,NaN]:[Math.atan2(n,e)*Ls,et(i/Math.sqrt(r))*Ls]};var bo,wo,Po,Co,ko,xo,Eo,To,Ao,Mo,jo,Io={sphere:b,point:we,lineStart:Ce,lineEnd:ke,polygonStart:function(){Io.lineStart=xe},polygonEnd:function(){Io.lineStart=Ce}},No=Ie(Te,Le,Oe,[-js,-js/2]),Fo=1e9;es.geo.clipExtent=function(){var t,e,n,i,r,a,s={stream:function(t){return r&&(r.valid=!1),r=a(t),r.valid=!0,r},extent:function(o){return arguments.length?(a=Ue(t=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),r&&(r.valid=!1,r=null),s):[[t,e],[n,i]]}};return s.extent([[0,0],[960,500]])},(es.geo.conicEqualArea=function(){return ze(He)}).raw=He,es.geo.albers=function(){return es.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},es.geo.albersUsa=function(){function t(t){var a=t[0],s=t[1];return e=null,n(a,s),e||(i(a,s),e)||r(a,s),e}var e,n,i,r,a=es.geo.albers(),s=es.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=es.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=a.scale(),n=a.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?s:r>=.166&&.234>r&&i>=-.214&&-.115>i?o:a).invert(t)},t.stream=function(t){var e=a.stream(t),n=s.stream(t),i=o.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),o.precision(e),t):a.precision()},t.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),o.scale(e),t.translate(a.translate())):a.scale()},t.translate=function(e){if(!arguments.length)return a.translate();var u=a.scale(),c=+e[0],h=+e[1];return n=a.translate(e).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=s.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+As,h+.12*u+As],[c-.214*u-As,h+.234*u-As]]).stream(l).point,r=o.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+As,h+.166*u+As],[c-.115*u-As,h+.234*u-As]]).stream(l).point,t},t.scale(1070)};var Ro,Lo,Bo,Oo,Do,$o,qo={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Lo=0,qo.lineStart=We},polygonEnd:function(){qo.lineStart=qo.lineEnd=qo.point=b,Ro+=ps(Lo/2)}},Uo={point:Ve,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},zo={point:Ge,lineStart:Ke,lineEnd:Qe,polygonStart:function(){zo.lineStart=Ze},polygonEnd:function(){zo.point=Ge,zo.lineStart=Ke,zo.lineEnd=Qe}};es.geo.path=function(){function t(t){return t&&("function"==typeof o&&a.pointRadius(+o.apply(this,arguments)),s&&s.valid||(s=r(a)),es.geo.stream(t,s)),a.result()}function e(){return s=null,t}var n,i,r,a,s,o=4.5;return t.area=function(t){return Ro=0,es.geo.stream(t,r(qo)),Ro},t.centroid=function(t){return Po=Co=ko=xo=Eo=To=Ao=Mo=jo=0,es.geo.stream(t,r(zo)),jo?[Ao/jo,Mo/jo]:To?[xo/To,Eo/To]:ko?[Po/ko,Co/ko]:[NaN,NaN]},t.bounds=function(t){return Do=$o=-(Bo=Oo=1/0),es.geo.stream(t,r(Uo)),[[Bo,Oo],[Do,$o]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||en(t):v,e()):n},t.context=function(t){return arguments.length?(a=null==(i=t)?new Ye:new Xe(t),"function"!=typeof o&&a.pointRadius(o),e()):i},t.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(a.pointRadius(+e),+e),t):o},t.projection(es.geo.albersUsa()).context(null)},es.geo.transform=function(t){return{stream:function(e){var n=new nn(e);for(var i in t)n[i]=t[i];return n}}},nn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},es.geo.projection=an,es.geo.projectionMutator=sn,(es.geo.equirectangular=function(){return an(ln)}).raw=ln.invert=ln,es.geo.rotation=function(t){function e(e){return e=t(e[0]*Rs,e[1]*Rs),e[0]*=Ls,e[1]*=Ls,e}return t=cn(t[0]%360*Rs,t[1]*Rs,t.length>2?t[2]*Rs:0),e.invert=function(e){return e=t.invert(e[0]*Rs,e[1]*Rs),e[0]*=Ls,e[1]*=Ls,e},e},un.invert=ln,es.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=cn(-t[0]*Rs,-t[1]*Rs,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Ls,t[1]*=Ls}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=fn((e=+i)*Rs,r*Rs),t):e},t.precision=function(i){return arguments.length?(n=fn(e*Rs,(r=+i)*Rs),t):r},t.angle(90)},es.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Rs,r=t[1]*Rs,a=e[1]*Rs,s=Math.sin(i),o=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(a),h=Math.cos(a);return Math.atan2(Math.sqrt((n=h*s)*n+(n=u*c-l*h*o)*n),l*c+u*h*o)},es.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return es.range(Math.ceil(a/g)*g,r,g).map(d).concat(es.range(Math.ceil(u/y)*y,l,y).map(p)).concat(es.range(Math.ceil(i/f)*f,n,f).filter(function(t){return ps(t%g)>As}).map(c)).concat(es.range(Math.ceil(o/m)*m,s,m).filter(function(t){return ps(t%y)>As}).map(h))}var n,i,r,a,s,o,l,u,c,h,d,p,f=10,m=f,g=90,y=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[d(a).concat(p(l).slice(1),d(r).reverse().slice(1),p(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(a=+e[0][0],r=+e[1][0],u=+e[0][1],l=+e[1][1],a>r&&(e=a,a=r,r=e),u>l&&(e=u,u=l,l=e),t.precision(v)):[[a,u],[r,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],o=+e[0][1],s=+e[1][1],i>n&&(e=i,i=n,n=e),o>s&&(e=o,o=s,s=e),t.precision(v)):[[i,o],[n,s]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(g=+e[0],y=+e[1],t):[g,y]},t.minorStep=function(e){return arguments.length?(f=+e[0],m=+e[1],t):[f,m]},t.precision=function(e){return arguments.length?(v=+e,c=gn(o,s,90),h=yn(i,n,v),d=gn(u,l,90),p=yn(a,r,v),t):v},t.majorExtent([[-180,-90+As],[180,90-As]]).minorExtent([[-180,-80-As],[180,80+As]])},es.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=vn,r=_n;return t.distance=function(){return es.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},es.geo.interpolate=function(t,e){return Sn(t[0]*Rs,t[1]*Rs,e[0]*Rs,e[1]*Rs)},es.geo.length=function(t){return Ho=0,es.geo.stream(t,Wo),Ho};var Ho,Wo={sphere:b,point:b,lineStart:bn,lineEnd:b,polygonStart:b,polygonEnd:b},Vo=wn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(es.geo.azimuthalEqualArea=function(){return an(Vo)}).raw=Vo;var Yo=wn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},v);(es.geo.azimuthalEquidistant=function(){return an(Yo)}).raw=Yo,(es.geo.conicConformal=function(){return ze(Pn)}).raw=Pn,(es.geo.conicEquidistant=function(){return ze(Cn)}).raw=Cn;var Jo=wn(function(t){return 1/t},Math.atan);(es.geo.gnomonic=function(){return an(Jo)}).raw=Jo,kn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Fs]},(es.geo.mercator=function(){return xn(kn)}).raw=kn;var Go=wn(function(){return 1},Math.asin);(es.geo.orthographic=function(){return an(Go)}).raw=Go;var Ko=wn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(es.geo.stereographic=function(){return an(Ko)}).raw=Ko,En.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Fs]},(es.geo.transverseMercator=function(){var t=xn(En),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=En,es.geom={},es.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=xt(n),a=xt(i),s=t.length,o=[],l=[];for(e=0;s>e;e++)o.push([+r.call(this,t[e],e),+a.call(this,t[e],e),e]);for(o.sort(jn),e=0;s>e;e++)l.push([o[e][0],-o[e][1]]);var u=Mn(o),c=Mn(l),h=c[0]===u[0],d=c[c.length-1]===u[u.length-1],p=[];for(e=u.length-1;e>=0;--e)p.push(t[o[u[e]][2]]);for(e=+h;e<c.length-d;++e)p.push(t[o[c[e]][2]]);return p}var n=Tn,i=An;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},es.geom.polygon=function(t){return vs(t,Qo),t};var Qo=es.geom.polygon.prototype=[];Qo.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},Qo.centroid=function(t){var e,n,i=-1,r=this.length,a=0,s=0,o=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=o,o=this[i],n=e[0]*o[1]-o[0]*e[1],a+=(e[0]+o[0])*n,s+=(e[1]+o[1])*n;return[a*t,s*t]},Qo.clip=function(t){for(var e,n,i,r,a,s,o=Fn(t),l=-1,u=this.length-Fn(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,r=this[l],a=e[(i=e.length-o)-1],n=-1;++n<i;)s=e[n],In(s,c,r)?(In(a,c,r)||t.push(Nn(a,s,c,r)),t.push(s)):In(a,c,r)&&t.push(Nn(a,s,c,r)),a=s;o&&t.push(t[0]),c=r}return t};var Zo,Xo,tl,el,nl,il=[],rl=[];Un.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(Hn),e.length},ti.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ei.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ai(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ii(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ri(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(ri(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ii(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,a=t.L,s=t.R;if(n=a?s?ai(s):a:s,r?r.L===t?r.L=n:r.R=n:this._=n,a&&s?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,ii(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ri(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,ii(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,ri(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ii(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,ri(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},es.geom.voronoi=function(t){function e(t){var e=new Array(t.length),i=o[0][0],r=o[0][1],a=o[1][0],s=o[1][1];return si(n(t),o).cells.forEach(function(n,o){var l=n.edges,u=n.site,c=e[o]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=i&&u.x<=a&&u.y>=r&&u.y<=s?[[i,s],[a,s],[a,r],[i,r]]:[];c.point=t[o]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(a(t,e)/As)*As,y:Math.round(s(t,e)/As)*As,i:e}})}var i=Tn,r=An,a=i,s=r,o=al;return t?e(t):(e.links=function(t){return si(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return si(n(t)).cells.forEach(function(n,i){for(var r,a,s=n.site,o=n.edges.sort(Hn),l=-1,u=o.length,c=o[u-1].edge,h=c.l===s?c.r:c.l;++l<u;)r=c,a=h,c=o[l].edge,h=c.l===s?c.r:c.l,i<a.i&&i<h.i&&li(s,a,h)<0&&e.push([t[i],t[a.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(a=xt(i=t),e):i},e.y=function(t){return arguments.length?(s=xt(r=t),e):r},e.clipExtent=function(t){return arguments.length?(o=null==t?al:t,e):o===al?null:o},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):o===al?null:o&&o[1]},e)};var al=[[-1e6,-1e6],[1e6,1e6]];es.geom.delaunay=function(t){return es.geom.voronoi().triangles(t)},es.geom.quadtree=function(t,e,n,i,r){function a(t){function a(t,e,n,i,r,a,s,o){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(ps(l-n)+ps(c-i)<.01)u(t,e,n,i,r,a,s,o);else{var h=t.point;t.x=t.y=t.point=null,u(t,h,l,c,r,a,s,o),u(t,e,n,i,r,a,s,o)}else t.x=n,t.y=i,t.point=e}else u(t,e,n,i,r,a,s,o)}function u(t,e,n,i,r,s,o,l){var u=.5*(r+o),c=.5*(s+l),h=n>=u,d=i>=c,p=d<<1|h;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=hi()),h?r=u:o=u,d?s=c:l=c,a(t,e,n,i,r,s,o,l)}var c,h,d,p,f,m,g,y,v,_=xt(o),S=xt(l);if(null!=e)m=e,g=n,y=i,v=r;else if(y=v=-(m=g=1/0),h=[],d=[],f=t.length,s)for(p=0;f>p;++p)c=t[p],c.x<m&&(m=c.x),c.y<g&&(g=c.y),c.x>y&&(y=c.x),c.y>v&&(v=c.y),h.push(c.x),d.push(c.y);else for(p=0;f>p;++p){var b=+_(c=t[p],p),w=+S(c,p);m>b&&(m=b),g>w&&(g=w),b>y&&(y=b),w>v&&(v=w),h.push(b),d.push(w)}var P=y-m,C=v-g;P>C?v=g+P:y=m+C;var k=hi();if(k.add=function(t){a(k,t,+_(t,++p),+S(t,p),m,g,y,v)},k.visit=function(t){di(t,k,m,g,y,v)},k.find=function(t){return pi(k,t[0],t[1],m,g,y,v)},p=-1,null==e){for(;++p<f;)a(k,t[p],h[p],d[p],m,g,y,v);--p}else t.forEach(k.add);return h=d=t=c=null,k}var s,o=Tn,l=An;return(s=arguments.length)?(o=ui,l=ci,3===s&&(r=n,i=e,n=e=0),a(t)):(a.x=function(t){return arguments.length?(o=t,a):o},a.y=function(t){return arguments.length?(l=t,a):l},a.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),a):null==e?null:[[e,n],[i,r]]},a.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),a):null==e?null:[i-e,r-n]},a)},es.interpolateRgb=fi,es.interpolateObject=mi,es.interpolateNumber=gi,es.interpolateString=yi;var sl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ol=new RegExp(sl.source,"g");es.interpolate=vi,es.interpolators=[function(t,e){var n=typeof e;return("string"===n?Qs.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?fi:yi:e instanceof st?fi:Array.isArray(e)?_i:"object"===n&&isNaN(e)?mi:gi)(t,e)}],es.interpolateArray=_i;var ll=function(){return v},ul=es.map({linear:ll,poly:xi,quad:function(){return Pi},cubic:function(){return Ci},sin:function(){return Ei},exp:function(){return Ti},circle:function(){return Ai},elastic:Mi,back:ji,bounce:function(){return Ii}}),cl=es.map({"in":v,out:bi,"in-out":wi,"out-in":function(t){return wi(bi(t))}});es.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=ul.get(n)||ll,i=cl.get(i)||v,Si(i(n.apply(null,ns.call(arguments,1))))},es.interpolateHcl=Ni,es.interpolateHsl=Fi,es.interpolateLab=Ri,es.interpolateRound=Li,es.transform=function(t){var e=rs.createElementNS(es.ns.prefix.svg,"g");return(es.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Bi(n?n.matrix:hl)})(t)},Bi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var hl={a:1,b:0,c:0,d:1,e:0,f:0};es.interpolateTransform=qi,es.layout={},es.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Hi(t[n]));return e}},es.layout.chord=function(){function t(){var t,u,h,d,p,f={},m=[],g=es.range(a),y=[];for(n=[],i=[],t=0,d=-1;++d<a;){for(u=0,p=-1;++p<a;)u+=r[d][p];m.push(u),y.push(es.range(a)),t+=u}for(s&&g.sort(function(t,e){return s(m[t],m[e])}),o&&y.forEach(function(t,e){t.sort(function(t,n){return o(r[e][t],r[e][n])})}),t=(Is-c*a)/t,u=0,d=-1;++d<a;){for(h=u,p=-1;++p<a;){var v=g[d],_=y[v][p],S=r[v][_],b=u,w=u+=S*t;f[v+"-"+_]={index:v,subindex:_,startAngle:b,endAngle:w,value:S}}i[v]={index:v,startAngle:h,endAngle:u,value:(u-h)/t},u+=c}for(d=-1;++d<a;)for(p=d-1;++p<a;){var P=f[d+"-"+p],C=f[p+"-"+d];(P.value||C.value)&&n.push(P.value<C.value?{source:C,target:P}:{source:P,target:C})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,a,s,o,l,u={},c=0;return u.matrix=function(t){return arguments.length?(a=(r=t)&&r.length,n=i=null,u):r},u.padding=function(t){return arguments.length?(c=t,n=i=null,u):c},u.sortGroups=function(t){return arguments.length?(s=t,n=i=null,u):s},u.sortSubgroups=function(t){return arguments.length?(o=t,n=null,u):o},u.sortChords=function(t){return arguments.length?(l=t,n&&e(),u):l},u.chords=function(){return n||t(),n},u.groups=function(){return i||t(),i},u},es.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var a=e.cx-t.x,s=e.cy-t.y,o=r-n,l=a*a+s*s;if(l>o*o/g){if(f>l){var u=e.charge/l;t.px-=a*u,t.py-=s*u}return!0}if(e.point&&l&&f>l){var u=e.pointCharge/l;t.px-=a*u,t.py-=s*u}}return!e.charge}}function e(t){t.px=es.event.x,t.py=es.event.y,o.resume()}var n,i,r,a,s,o={},l=es.dispatch("start","tick","end"),u=[1,1],c=.9,h=dl,d=pl,p=-30,f=fl,m=.1,g=.64,y=[],_=[];return o.tick=function(){if((i*=.99)<.005)return l.end({type:"end",alpha:i=0}),!0;var e,n,o,h,d,f,g,v,S,b=y.length,w=_.length;for(n=0;w>n;++n)o=_[n],h=o.source,d=o.target,v=d.x-h.x,S=d.y-h.y,(f=v*v+S*S)&&(f=i*a[n]*((f=Math.sqrt(f))-r[n])/f,v*=f,S*=f,d.x-=v*(g=h.weight/(d.weight+h.weight)),d.y-=S*g,h.x+=v*(g=1-g),h.y+=S*g);if((g=i*m)&&(v=u[0]/2,S=u[1]/2,n=-1,g))for(;++n<b;)o=y[n],o.x+=(v-o.x)*g,o.y+=(S-o.y)*g;if(p)for(Qi(e=es.geom.quadtree(y),i,s),n=-1;++n<b;)(o=y[n]).fixed||e.visit(t(o));for(n=-1;++n<b;)o=y[n],o.fixed?(o.x=o.px,o.y=o.py):(o.x-=(o.px-(o.px=o.x))*c,o.y-=(o.py-(o.py=o.y))*c);l.tick({type:"tick",alpha:i})},o.nodes=function(t){return arguments.length?(y=t,o):y},o.links=function(t){return arguments.length?(_=t,o):_},o.size=function(t){return arguments.length?(u=t,o):u},o.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,o):h},o.distance=o.linkDistance,o.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,o):d},o.friction=function(t){return arguments.length?(c=+t,o):c},o.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,o):p},o.chargeDistance=function(t){return arguments.length?(f=t*t,o):Math.sqrt(f)},o.gravity=function(t){return arguments.length?(m=+t,o):m},o.theta=function(t){return arguments.length?(g=t*t,o):Math.sqrt(g)},o.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(l.start({type:"start",alpha:i=t}),es.timer(o.tick)),o):i},o.start=function(){function t(t,i){if(!n){for(n=new Array(l),o=0;l>o;++o)n[o]=[];for(o=0;c>o;++o){var r=_[o];n[r.source.index].push(r.target),n[r.target.index].push(r.source)}}for(var a,s=n[e],o=-1,u=s.length;++o<u;)if(!isNaN(a=s[o][t]))return a;return Math.random()*i}var e,n,i,l=y.length,c=_.length,f=u[0],m=u[1];for(e=0;l>e;++e)(i=y[e]).index=e,i.weight=0;for(e=0;c>e;++e)i=_[e],"number"==typeof i.source&&(i.source=y[i.source]),"number"==typeof i.target&&(i.target=y[i.target]),++i.source.weight,++i.target.weight;for(e=0;l>e;++e)i=y[e],isNaN(i.x)&&(i.x=t("x",f)),isNaN(i.y)&&(i.y=t("y",m)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(r=[],"function"==typeof h)for(e=0;c>e;++e)r[e]=+h.call(this,_[e],e);else for(e=0;c>e;++e)r[e]=h;if(a=[],"function"==typeof d)for(e=0;c>e;++e)a[e]=+d.call(this,_[e],e);else for(e=0;c>e;++e)a[e]=d;if(s=[],"function"==typeof p)for(e=0;l>e;++e)s[e]=+p.call(this,y[e],e);else for(e=0;l>e;++e)s[e]=p;return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){return n||(n=es.behavior.drag().origin(v).on("dragstart.force",Yi).on("drag.force",e).on("dragend.force",Ji)),arguments.length?void this.on("mouseover.force",Gi).on("mouseout.force",Ki).call(n):n},es.rebind(o,l,"on")};var dl=20,pl=1,fl=1/0;es.layout.hierarchy=function(){function t(r){var a,s=[r],o=[];for(r.depth=0;null!=(a=s.pop());)if(o.push(a),(u=n.call(t,a,a.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)s.push(c=u[l]),c.parent=a,c.depth=a.depth+1;i&&(a.value=0),a.children=u}else i&&(a.value=+i.call(t,a,a.depth)||0),delete a.children;return tr(r,function(t){var n,r;e&&(n=t.children)&&n.sort(e),i&&(r=t.parent)&&(r.value+=t.value)}),o}var e=ir,n=er,i=nr;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return i&&(Xi(e,function(t){t.children&&(t.value=0)}),tr(e,function(e){var n;e.children||(e.value=+i.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},es.layout.partition=function(){function t(e,n,i,r){var a=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,a&&(s=a.length)){var s,o,l,u=-1;for(i=e.value?i/e.value:0;++u<s;)t(o=a[u],n,l=o.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,a=-1;++a<r;)i=Math.max(i,e(n[a]));return 1+i}function n(n,a){var s=i.call(this,n,a);return t(s[0],0,r[0],r[1]/e(s[0])),s}var i=es.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},Zi(n,i)},es.layout.pie=function(){function t(s){var o,l=s.length,u=s.map(function(n,i){return+e.call(t,n,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof r?r.apply(this,arguments):r)-c,d=Math.min(Math.abs(h)/l,+("function"==typeof a?a.apply(this,arguments):a)),p=d*(0>h?-1:1),f=(h-l*p)/es.sum(u),m=es.range(l),g=[];return null!=n&&m.sort(n===ml?function(t,e){return u[e]-u[t]}:function(t,e){return n(s[t],s[e])}),m.forEach(function(t){g[t]={data:s[t],value:o=u[t],startAngle:c,endAngle:c+=o*f+p,padAngle:d}}),g}var e=Number,n=ml,i=0,r=Is,a=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t.padAngle=function(e){return arguments.length?(a=e,t):a},t};var ml={};es.layout.stack=function(){function t(o,l){if(!(d=o.length))return o;var u=o.map(function(n,i){return e.call(t,n,i)}),c=u.map(function(e){return e.map(function(e,n){return[a.call(t,e,n),s.call(t,e,n)]})}),h=n.call(t,c,l);u=es.permute(u,h),c=es.permute(c,h);var d,p,f,m,g=i.call(t,c,l),y=u[0].length;for(f=0;y>f;++f)for(r.call(t,u[0][f],m=g[f],c[0][f][1]),p=1;d>p;++p)r.call(t,u[p][f],m+=c[p-1][f][1],c[p][f][1]);return o}var e=v,n=lr,i=ur,r=or,a=ar,s=sr;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:gl.get(e)||lr,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:yl.get(e)||ur,t):i},t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(s=e,t):s},t.out=function(e){return arguments.length?(r=e,t):r},t};var gl=es.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(cr),a=t.map(hr),s=es.range(i).sort(function(t,e){return r[t]-r[e]}),o=0,l=0,u=[],c=[];for(e=0;i>e;++e)n=s[e],l>o?(o+=a[n],u.push(n)):(l+=a[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return es.range(t.length).reverse()},"default":lr}),yl=es.map({silhouette:function(t){var e,n,i,r=t.length,a=t[0].length,s=[],o=0,l=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>o&&(o=i),s.push(i)}for(n=0;a>n;++n)l[n]=(o-s[n])/2;return l},wiggle:function(t){var e,n,i,r,a,s,o,l,u,c=t.length,h=t[0],d=h.length,p=[];for(p[0]=l=u=0,n=1;d>n;++n){for(e=0,r=0;c>e;++e)r+=t[e][n][1];for(e=0,a=0,o=h[n][0]-h[n-1][0];c>e;++e){for(i=0,s=(t[e][n][1]-t[e][n-1][1])/(2*o);e>i;++i)s+=(t[i][n][1]-t[i][n-1][1])/o;a+=s*t[e][n][1]}p[n]=l-=r?a/r*o:0,u>l&&(u=l)}for(n=0;d>n;++n)p[n]-=u;return p},expand:function(t){var e,n,i,r=t.length,a=t[0].length,s=1/r,o=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=s}for(n=0;a>n;++n)o[n]=0;return o},zero:ur});es.layout.histogram=function(){function t(t,a){for(var s,o,l=[],u=t.map(n,this),c=i.call(this,u,a),h=r.call(this,c,u,a),a=-1,d=u.length,p=h.length-1,f=e?1:1/d;++a<p;)s=l[a]=[],s.dx=h[a+1]-(s.x=h[a]),s.y=0;if(p>0)for(a=-1;++a<d;)o=u[a],o>=c[0]&&o<=c[1]&&(s=l[es.bisect(h,o,1,p)-1],s.y+=f,s.push(t[a]));return l}var e=!0,n=Number,i=mr,r=pr;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=xt(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return fr(t,e)}:xt(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},es.layout.pack=function(){function t(t,a){var s=n.call(this,t,a),o=s[0],l=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(o.x=o.y=0,tr(o,function(t){t.r=+c(t.value)}),tr(o,Sr),i){var h=i*(e?1:Math.max(2*o.r/l,2*o.r/u))/2;tr(o,function(t){t.r+=h}),tr(o,Sr),tr(o,function(t){t.r-=h})}return Pr(o,l/2,u/2,e?1:1/Math.max(2*o.r/l,2*o.r/u)),s}var e,n=es.layout.hierarchy().sort(gr),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},Zi(t,n)},es.layout.tree=function(){function t(t,r){var c=s.call(this,t,r),h=c[0],d=e(h);if(tr(d,n),d.parent.m=-d.z,Xi(d,i),u)Xi(h,a);else{var p=h,f=h,m=h;Xi(h,function(t){t.x<p.x&&(p=t),t.x>f.x&&(f=t),t.depth>m.depth&&(m=t)});var g=o(p,f)/2-p.x,y=l[0]/(f.x+o(f,p)/2+g),v=l[1]/(m.depth||1);Xi(h,function(t){t.x=(t.x+g)*y,t.y=t.depth*v})}return c}function e(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var r,a=e.children,s=0,o=a.length;o>s;++s)i.push((a[s]=r={_:a[s],parent:e,children:(r=a[s].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:s}).a=r);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){Ar(t);var a=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+o(t._,i._),t.m=t.z-a):t.z=a}else i&&(t.z=i.z+o(t._,i._));t.parent.A=r(t,i,t.parent.A||n[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,n){if(e){for(var i,r=t,a=t,s=e,l=r.parent.children[0],u=r.m,c=a.m,h=s.m,d=l.m;s=Er(s),r=xr(r),s&&r;)l=xr(l),a=Er(a),a.a=t,i=s.z+h-r.z-u+o(s._,r._),i>0&&(Tr(Mr(s,t,n),t,i),u+=i,c+=i),h+=s.m,u+=r.m,d+=l.m,c+=a.m;s&&!Er(a)&&(a.t=s,a.m+=h-c),r&&!xr(l)&&(l.t=r,l.m+=u-d,n=t)}return n}function a(t){t.x*=l[0],t.y=t.depth*l[1]}var s=es.layout.hierarchy().sort(null).value(null),o=kr,l=[1,1],u=null;return t.separation=function(e){return arguments.length?(o=e,t):o},t.size=function(e){return arguments.length?(u=null==(l=e)?a:null,t):u?null:l},t.nodeSize=function(e){return arguments.length?(u=null==(l=e)?null:a,t):u?l:null},Zi(t,s)},es.layout.cluster=function(){function t(t,a){var s,o=e.call(this,t,a),l=o[0],u=0;tr(l,function(t){var e=t.children;e&&e.length?(t.x=Ir(e),t.y=jr(e)):(t.x=s?u+=n(t,s):0,t.y=0,s=t)});var c=Nr(l),h=Fr(l),d=c.x-n(c,h)/2,p=h.x+n(h,c)/2;return tr(l,r?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-d)/(p-d)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),o}var e=es.layout.hierarchy().sort(null).value(null),n=kr,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},Zi(t,e)},es.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,a=t.length;++r<a;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var a=n.children;if(a&&a.length){var s,o,l,u=h(n),c=[],d=a.slice(),f=1/0,m="slice"===p?u.dx:"dice"===p?u.dy:"slice-dice"===p?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(d,u.dx*u.dy/n.value),c.area=0;(l=d.length)>0;)c.push(s=d[l-1]),c.area+=s.area,"squarify"!==p||(o=i(c,m))<=f?(d.pop(),f=o):(c.area-=c.pop().area,r(c,m,u,!1),m=Math.min(u.dx,u.dy),c.length=c.area=0,f=1/0);c.length&&(r(c,m,u,!0),c.length=c.area=0),a.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var a,s=h(e),o=i.slice(),l=[];for(t(o,s.dx*s.dy/e.value),l.area=0;a=o.pop();)l.push(a),l.area+=a.area,null!=a.z&&(r(l,a.z?s.dx:s.dy,s,!o.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,a=1/0,s=-1,o=t.length;++s<o;)(n=t[s].area)&&(a>n&&(a=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*f/i,i/(e*a*f)):1/0}function r(t,e,n,i){var r,a=-1,s=t.length,o=n.x,u=n.y,c=e?l(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);++a<s;)r=t[a],r.x=o,r.y=u,r.dy=c,o+=r.dx=Math.min(n.x+n.dx-o,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-o,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++a<s;)r=t[a],r.x=o,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function a(i){var r=s||o(i),a=r[0];return a.x=0,a.y=0,a.dx=u[0],a.dy=u[1],s&&o.revalue(a),t([a],a.dx*a.dy/a.value),(s?n:e)(a),d&&(s=r),r}var s,o=es.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=Rr,d=!1,p="squarify",f=.5*(1+Math.sqrt(5));return a.size=function(t){return arguments.length?(u=t,a):u},a.padding=function(t){function e(e){var n=t.call(a,e,e.depth);return null==n?Rr(e):Lr(e,"number"==typeof n?[n,n,n,n]:n);
}function n(e){return Lr(e,t)}if(!arguments.length)return c;var i;return h=null==(c=t)?Rr:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,a},a.round=function(t){return arguments.length?(l=t?Math.round:Number,a):l!=Number},a.sticky=function(t){return arguments.length?(d=t,s=null,a):d},a.ratio=function(t){return arguments.length?(f=t,a):f},a.mode=function(t){return arguments.length?(p=t+"",a):p},Zi(a,o)},es.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=es.random.normal.apply(es,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=es.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},es.scale={};var vl={floor:v,ceil:v};es.scale.linear=function(){return zr([0,1],[0,1],vi,!1)};var _l={s:1,g:1,p:1,r:1,e:1};es.scale.log=function(){return Qr(es.scale.linear().domain([0,1]),10,!0,[1,10])};var Sl=es.format(".0e"),bl={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};es.scale.pow=function(){return Zr(es.scale.linear(),1,[0,1])},es.scale.sqrt=function(){return es.scale.pow().exponent(.5)},es.scale.ordinal=function(){return ta([],{t:"range",a:[[]]})},es.scale.category10=function(){return es.scale.ordinal().range(wl)},es.scale.category20=function(){return es.scale.ordinal().range(Pl)},es.scale.category20b=function(){return es.scale.ordinal().range(Cl)},es.scale.category20c=function(){return es.scale.ordinal().range(kl)};var wl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(_t),Pl=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(_t),Cl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(_t),kl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(_t);es.scale.quantile=function(){return ea([],[])},es.scale.quantize=function(){return na(0,1,[0,1])},es.scale.threshold=function(){return ia([.5],[0,1])},es.scale.identity=function(){return ra([0,1])},es.svg={},es.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+i.apply(this,arguments)),c=s.apply(this,arguments)-Fs,h=o.apply(this,arguments)-Fs,d=Math.abs(h-c),p=c>h?0:1;if(t>u&&(f=u,u=t,t=f),d>=Ns)return e(u,p)+(t?e(t,1-p):"")+"Z";var f,m,g,y,v,_,S,b,w,P,C,k,x=0,E=0,T=[];if((y=(+l.apply(this,arguments)||0)/2)&&(g=a===xl?Math.sqrt(t*t+u*u):+a.apply(this,arguments),p||(E*=-1),u&&(E=et(g/u*Math.sin(y))),t&&(x=et(g/t*Math.sin(y)))),u){v=u*Math.cos(c+E),_=u*Math.sin(c+E),S=u*Math.cos(h-E),b=u*Math.sin(h-E);var A=Math.abs(h-c-2*E)<=js?0:1;if(E&&ha(v,_,S,b)===p^A){var M=(c+h)/2;v=u*Math.cos(M),_=u*Math.sin(M),S=b=null}}else v=_=0;if(t){w=t*Math.cos(h-x),P=t*Math.sin(h-x),C=t*Math.cos(c+x),k=t*Math.sin(c+x);var j=Math.abs(c-h+2*x)<=js?0:1;if(x&&ha(w,P,C,k)===1-p^j){var I=(c+h)/2;w=t*Math.cos(I),P=t*Math.sin(I),C=k=null}}else w=P=0;if((f=Math.min(Math.abs(u-t)/2,+r.apply(this,arguments)))>.001){m=u>t^p?0:1;var N=null==C?[w,P]:null==S?[v,_]:Nn([v,_],[C,k],[S,b],[w,P]),F=v-N[0],R=_-N[1],L=S-N[0],B=b-N[1],O=1/Math.sin(Math.acos((F*L+R*B)/(Math.sqrt(F*F+R*R)*Math.sqrt(L*L+B*B)))/2),D=Math.sqrt(N[0]*N[0]+N[1]*N[1]);if(null!=S){var $=Math.min(f,(u-D)/(O+1)),q=da(null==C?[w,P]:[C,k],[v,_],u,$,p),U=da([S,b],[w,P],u,$,p);f===$?T.push("M",q[0],"A",$,",",$," 0 0,",m," ",q[1],"A",u,",",u," 0 ",1-p^ha(q[1][0],q[1][1],U[1][0],U[1][1]),",",p," ",U[1],"A",$,",",$," 0 0,",m," ",U[0]):T.push("M",q[0],"A",$,",",$," 0 1,",m," ",U[0])}else T.push("M",v,",",_);if(null!=C){var z=Math.min(f,(t-D)/(O-1)),H=da([v,_],[C,k],t,-z,p),W=da([w,P],null==S?[v,_]:[S,b],t,-z,p);f===z?T.push("L",W[0],"A",z,",",z," 0 0,",m," ",W[1],"A",t,",",t," 0 ",p^ha(W[1][0],W[1][1],H[1][0],H[1][1]),",",1-p," ",H[1],"A",z,",",z," 0 0,",m," ",H[0]):T.push("L",W[0],"A",z,",",z," 0 0,",m," ",H[0])}else T.push("L",w,",",P)}else T.push("M",v,",",_),null!=S&&T.push("A",u,",",u," 0 ",A,",",p," ",S,",",b),T.push("L",w,",",P),null!=C&&T.push("A",t,",",t," 0 ",j,",",1-p," ",C,",",k);return T.push("Z"),T.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=sa,i=oa,r=aa,a=xl,s=la,o=ua,l=ca;return t.innerRadius=function(e){return arguments.length?(n=xt(e),t):n},t.outerRadius=function(e){return arguments.length?(i=xt(e),t):i},t.cornerRadius=function(e){return arguments.length?(r=xt(e),t):r},t.padRadius=function(e){return arguments.length?(a=e==xl?xl:xt(e),t):a},t.startAngle=function(e){return arguments.length?(s=xt(e),t):s},t.endAngle=function(e){return arguments.length?(o=xt(e),t):o},t.padAngle=function(e){return arguments.length?(l=xt(e),t):l},t.centroid=function(){var t=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2,e=(+s.apply(this,arguments)+ +o.apply(this,arguments))/2-Fs;return[Math.cos(e)*t,Math.sin(e)*t]},t};var xl="auto";es.svg.line=function(){return pa(v)};var El=es.map({linear:fa,"linear-closed":ma,step:ga,"step-before":ya,"step-after":va,basis:Ca,"basis-open":ka,"basis-closed":xa,bundle:Ea,cardinal:ba,"cardinal-open":_a,"cardinal-closed":Sa,monotone:Na});El.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Tl=[0,2/3,1/3,0],Al=[0,1/3,2/3,0],Ml=[0,1/6,2/3,1/6];es.svg.line.radial=function(){var t=pa(Fa);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ya.reverse=va,va.reverse=ya,es.svg.area=function(){return Ra(v)},es.svg.area.radial=function(){var t=Ra(Fa);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},es.svg.chord=function(){function t(t,o){var l=e(this,a,t,o),u=e(this,s,t,o);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),a=o.call(t,r,i),s=l.call(t,r,i)-Fs,c=u.call(t,r,i)-Fs;return{r:a,a0:s,a1:c,p0:[a*Math.cos(s),a*Math.sin(s)],p1:[a*Math.cos(c),a*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>js)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var a=vn,s=_n,o=La,l=la,u=ua;return t.radius=function(e){return arguments.length?(o=xt(e),t):o},t.source=function(e){return arguments.length?(a=xt(e),t):a},t.target=function(e){return arguments.length?(s=xt(e),t):s},t.startAngle=function(e){return arguments.length?(l=xt(e),t):l},t.endAngle=function(e){return arguments.length?(u=xt(e),t):u},t},es.svg.diagonal=function(){function t(t,r){var a=e.call(this,t,r),s=n.call(this,t,r),o=(a.y+s.y)/2,l=[a,{x:a.x,y:o},{x:s.x,y:o},s];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=vn,n=_n,i=Ba;return t.source=function(n){return arguments.length?(e=xt(n),t):e},t.target=function(e){return arguments.length?(n=xt(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},es.svg.diagonal.radial=function(){var t=es.svg.diagonal(),e=Ba,n=t.projection;return t.projection=function(t){return arguments.length?n(Oa(e=t)):e},t},es.svg.symbol=function(){function t(t,i){return(jl.get(e.call(this,t,i))||qa)(n.call(this,t,i))}var e=$a,n=Da;return t.type=function(n){return arguments.length?(e=xt(n),t):e},t.size=function(e){return arguments.length?(n=xt(e),t):n},t};var jl=es.map({circle:qa,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Nl)),n=e*Nl;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Il),n=e*Il/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Il),n=e*Il/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});es.svg.symbolTypes=jl.keys();var Il=Math.sqrt(3),Nl=Math.tan(30*Rs);ws.transition=function(t){for(var e,n,i=Fl||++Ol,r=Va(t),a=[],s=Rl||{time:Date.now(),ease:ki,delay:0,duration:250},o=-1,l=this.length;++o<l;){a.push(e=[]);for(var u=this[o],c=-1,h=u.length;++c<h;)(n=u[c])&&Ya(n,c,r,i,s),e.push(n)}return za(a,r,i)},ws.interrupt=function(t){return this.each(null==t?Ll:Ua(Va(t)))};var Fl,Rl,Ll=Ua(Va()),Bl=[],Ol=0;Bl.call=ws.call,Bl.empty=ws.empty,Bl.node=ws.node,Bl.size=ws.size,es.transition=function(t,e){return t&&t.transition?Fl?t.transition(e):t:es.selection().transition(t)},es.transition.prototype=Bl,Bl.select=function(t){var e,n,i,r=this.id,a=this.namespace,s=[];t=T(t);for(var o=-1,l=this.length;++o<l;){s.push(e=[]);for(var u=this[o],c=-1,h=u.length;++c<h;)(i=u[c])&&(n=t.call(i,i.__data__,c,o))?("__data__"in i&&(n.__data__=i.__data__),Ya(n,c,a,r,i[a][r]),e.push(n)):e.push(null)}return za(s,a,r)},Bl.selectAll=function(t){var e,n,i,r,a,s=this.id,o=this.namespace,l=[];t=A(t);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],d=-1,p=h.length;++d<p;)if(i=h[d]){a=i[o][s],n=t.call(i,i.__data__,d,u),l.push(e=[]);for(var f=-1,m=n.length;++f<m;)(r=n[f])&&Ya(r,f,o,s,a),e.push(r)}return za(l,o,s)},Bl.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=q(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]);for(var n=this[a],o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i,i.__data__,o,a)&&e.push(i)}return za(r,this.namespace,this.id)},Bl.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):z(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},Bl.attr=function(t,e){function n(){this.removeAttribute(o)}function i(){this.removeAttributeNS(o.space,o.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(o);return n!==t&&(e=s(n,t),function(t){this.setAttribute(o,e(t))})})}function a(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(o.space,o.local);return n!==t&&(e=s(n,t),function(t){this.setAttributeNS(o.space,o.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var s="transform"==t?qi:vi,o=es.ns.qualify(t);return Ha(this,"attr."+t,e,o.local?a:r)},Bl.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=es.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},Bl.style=function(t,n,i){function r(){this.style.removeProperty(t)}function a(n){return null==n?r:(n+="",function(){var r,a=e(this).getComputedStyle(this,null).getPropertyValue(t);return a!==n&&(r=vi(a,n),function(e){this.style.setProperty(t,r(e),i)})})}var s=arguments.length;if(3>s){if("string"!=typeof t){2>s&&(n="");for(i in t)this.style(i,t[i],n);return this}i=""}return Ha(this,"style."+t,n,a)},Bl.styleTween=function(t,n,i){function r(r,a){var s=n.call(this,r,a,e(this).getComputedStyle(this,null).getPropertyValue(t));return s&&function(e){this.style.setProperty(t,s(e),i)}}return arguments.length<3&&(i=""),this.tween("style."+t,r)},Bl.text=function(t){return Ha(this,"text",t,Wa)},Bl.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Bl.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=es.ease.apply(es,arguments)),z(this,function(i){i[n][e].ease=t}))},Bl.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:z(this,"function"==typeof t?function(i,r,a){i[n][e].delay=+t.call(i,i.__data__,r,a)}:(t=+t,function(i){i[n][e].delay=t}))},Bl.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:z(this,"function"==typeof t?function(i,r,a){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,a))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},Bl.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=Rl,a=Fl;try{Fl=n,z(this,function(e,r,a){Rl=e[i][n],t.call(e,e.__data__,r,a)})}finally{Rl=r,Fl=a}}else z(this,function(r){var a=r[i][n];(a.event||(a.event=es.dispatch("start","end","interrupt"))).on(t,e)});return this},Bl.transition=function(){for(var t,e,n,i,r=this.id,a=++Ol,s=this.namespace,o=[],l=0,u=this.length;u>l;l++){o.push(t=[]);for(var e=this[l],c=0,h=e.length;h>c;c++)(n=e[c])&&(i=n[s][r],Ya(n,c,s,a,{time:i.time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration})),t.push(n)}return za(o,s,a)},es.svg.axis=function(){function t(t){t.each(function(){var t,u=es.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),d=null==l?h.ticks?h.ticks.apply(h,o):h.domain():l,p=null==e?h.tickFormat?h.tickFormat.apply(h,o):v:e,f=u.selectAll(".tick").data(d,h),m=f.enter().insert("g",".domain").attr("class","tick").style("opacity",As),g=es.transition(f.exit()).style("opacity",As).remove(),y=es.transition(f.order()).style("opacity",1),_=Math.max(r,0)+s,S=Or(h),b=u.selectAll(".domain").data([0]),w=(b.enter().append("path").attr("class","domain"),es.transition(b));m.append("line"),m.append("text");var P,C,k,x,E=m.select("line"),T=y.select("line"),A=f.select("text").text(p),M=m.select("text"),j=y.select("text"),I="top"===i||"left"===i?-1:1;if("bottom"===i||"top"===i?(t=Ja,P="x",k="y",C="x2",x="y2",A.attr("dy",0>I?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+S[0]+","+I*a+"V0H"+S[1]+"V"+I*a)):(t=Ga,P="y",k="x",C="y2",x="x2",A.attr("dy",".32em").style("text-anchor",0>I?"end":"start"),w.attr("d","M"+I*a+","+S[0]+"H0V"+S[1]+"H"+I*a)),E.attr(x,I*r),M.attr(k,I*_),T.attr(C,0).attr(x,I*r),j.attr(P,0).attr(k,I*_),h.rangeBand){var N=h,F=N.rangeBand()/2;c=h=function(t){return N(t)+F}}else c.rangeBand?c=h:g.call(t,h,c);m.call(t,c,h),y.call(t,h,h)})}var e,n=es.scale.linear(),i=Dl,r=6,a=6,s=3,o=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in $l?e+"":Dl,t):i},t.ticks=function(){return arguments.length?(o=arguments,t):o},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,a=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(a=+e,t):a},t.tickPadding=function(e){return arguments.length?(s=+e,t):s},t.tickSubdivide=function(){return arguments.length&&t},t};var Dl="bottom",$l={top:1,right:1,bottom:1,left:1};es.svg.brush=function(){function t(e){e.each(function(){var e=es.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),s=e.selectAll(".background").data([0]);s.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var o=e.selectAll(".resize").data(m,v);o.exit().remove(),o.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return ql[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),o.style("display",t.empty()?"none":null);var l,h=es.transition(e),d=es.transition(s);u&&(l=Or(u),d.attr("x",l[0]).attr("width",l[1]-l[0]),i(h)),c&&(l=Or(c),d.attr("y",l[0]).attr("height",l[1]-l[0]),r(h)),n(h)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function i(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function r(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function a(){function a(){32==es.event.keyCode&&(A||(_=null,j[0]-=h[1],j[1]-=d[1],A=2),C())}function m(){32==es.event.keyCode&&2==A&&(j[0]+=h[1],j[1]+=d[1],A=0,C())}function g(){var t=es.mouse(b),e=!1;S&&(t[0]+=S[0],t[1]+=S[1]),A||(es.event.altKey?(_||(_=[(h[0]+h[1])/2,(d[0]+d[1])/2]),j[0]=h[+(t[0]<_[0])],j[1]=d[+(t[1]<_[1])]):_=null),E&&y(t,u,0)&&(i(k),e=!0),T&&y(t,c,1)&&(r(k),e=!0),e&&(n(k),P({type:"brush",mode:A?"move":"resize"}))}function y(t,e,n){var i,r,a=Or(e),l=a[0],u=a[1],c=j[n],m=n?d:h,g=m[1]-m[0];return A&&(l-=c,u-=g+c),i=(n?f:p)?Math.max(l,Math.min(u,t[n])):t[n],A?r=(i+=c)+g:(_&&(c=Math.max(l,Math.min(u,2*_[n]-i))),i>c?(r=i,i=c):r=c),m[0]!=i||m[1]!=r?(n?o=null:s=null,m[0]=i,m[1]=r,!0):void 0}function v(){g(),k.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),es.select("body").style("cursor",null),I.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),M(),P({type:"brushend"})}var _,S,b=this,w=es.select(es.event.target),P=l.of(b,arguments),k=es.select(b),x=w.datum(),E=!/^(n|s)$/.test(x)&&u,T=!/^(e|w)$/.test(x)&&c,A=w.classed("extent"),M=G(b),j=es.mouse(b),I=es.select(e(b)).on("keydown.brush",a).on("keyup.brush",m);if(es.event.changedTouches?I.on("touchmove.brush",g).on("touchend.brush",v):I.on("mousemove.brush",g).on("mouseup.brush",v),k.interrupt().selectAll("*").interrupt(),A)j[0]=h[0]-j[0],j[1]=d[0]-j[1];else if(x){var N=+/w$/.test(x),F=+/^n/.test(x);S=[h[1-N]-j[0],d[1-F]-j[1]],j[0]=h[N],j[1]=d[F]}else es.event.altKey&&(_=j.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),es.select("body").style("cursor",w.style("cursor")),P({type:"brushstart"}),g()}var s,o,l=x(t,"brushstart","brush","brushend"),u=null,c=null,h=[0,0],d=[0,0],p=!0,f=!0,m=Ul[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:h,y:d,i:s,j:o},n=this.__chart__||e;this.__chart__=e,Fl?es.select(this).transition().each("start.brush",function(){s=n.i,o=n.j,h=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=_i(h,e.x),i=_i(d,e.y);return s=o=null,function(r){h=e.x=n(r),d=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){s=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,m=Ul[!u<<1|!c],t):u},t.y=function(e){return arguments.length?(c=e,m=Ul[!u<<1|!c],t):c},t.clamp=function(e){return arguments.length?(u&&c?(p=!!e[0],f=!!e[1]):u?p=!!e:c&&(f=!!e),t):u&&c?[p,f]:u?p:c?f:null},t.extent=function(e){var n,i,r,a,l;return arguments.length?(u&&(n=e[0],i=e[1],c&&(n=n[0],i=i[0]),s=[n,i],u.invert&&(n=u(n),i=u(i)),n>i&&(l=n,n=i,i=l),(n!=h[0]||i!=h[1])&&(h=[n,i])),c&&(r=e[0],a=e[1],u&&(r=r[1],a=a[1]),o=[r,a],c.invert&&(r=c(r),a=c(a)),r>a&&(l=r,r=a,a=l),(r!=d[0]||a!=d[1])&&(d=[r,a])),t):(u&&(s?(n=s[0],i=s[1]):(n=h[0],i=h[1],u.invert&&(n=u.invert(n),i=u.invert(i)),n>i&&(l=n,n=i,i=l))),c&&(o?(r=o[0],a=o[1]):(r=d[0],a=d[1],c.invert&&(r=c.invert(r),a=c.invert(a)),r>a&&(l=r,r=a,a=l))),u&&c?[[n,r],[i,a]]:u?[n,i]:c&&[r,a])},t.clear=function(){return t.empty()||(h=[0,0],d=[0,0],s=o=null),t},t.empty=function(){return!!u&&h[0]==h[1]||!!c&&d[0]==d[1]},es.rebind(t,l,"on")};var ql={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ul=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],zl=oo.format=fo.timeFormat,Hl=zl.utc,Wl=Hl("%Y-%m-%dT%H:%M:%S.%LZ");zl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Ka:Wl,Ka.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Ka.toString=Wl.toString,oo.second=Dt(function(t){return new lo(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),oo.seconds=oo.second.range,oo.seconds.utc=oo.second.utc.range,oo.minute=Dt(function(t){return new lo(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),oo.minutes=oo.minute.range,oo.minutes.utc=oo.minute.utc.range,oo.hour=Dt(function(t){var e=t.getTimezoneOffset()/60;return new lo(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),oo.hours=oo.hour.range,oo.hours.utc=oo.hour.utc.range,oo.month=Dt(function(t){return t=oo.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),oo.months=oo.month.range,oo.months.utc=oo.month.utc.range;var Vl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Yl=[[oo.second,1],[oo.second,5],[oo.second,15],[oo.second,30],[oo.minute,1],[oo.minute,5],[oo.minute,15],[oo.minute,30],[oo.hour,1],[oo.hour,3],[oo.hour,6],[oo.hour,12],[oo.day,1],[oo.day,2],[oo.week,1],[oo.month,1],[oo.month,3],[oo.year,1]],Jl=zl.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Te]]),Gl={range:function(t,e,n){return es.range(Math.ceil(t/n)*n,+e,n).map(Za)},floor:v,ceil:v};Yl.year=oo.year,oo.scale=function(){return Qa(es.scale.linear(),Yl,Jl)};var Kl=Yl.map(function(t){return[t[0].utc,t[1]]}),Ql=Hl.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Te]]);Kl.year=oo.year.utc,oo.scale.utc=function(){return Qa(es.scale.linear(),Kl,Ql)},es.text=Et(function(t){return t.responseText}),es.json=function(t,e){return Tt(t,"application/json",Xa,e)},es.html=function(t,e){return Tt(t,"text/html",ts,e)},es.xml=Et(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define("$vendor/d3.min",es):"object"==typeof module&&module.exports&&(module.exports=es),this.d3=es}(),define("$app/ui/shared/with_d3_formatter",["$vendor/d3.min"],function(){function t(){this.formatMoney=d3.format(",.2f"),this.moneyFormatter=function(t){return"$"+this.formatComma(t/100)}.bind(this),this.formatComma=d3.format(",f"),this.commaFormatter=function(t){return t%1==0?this.formatComma(t):""}.bind(this),this.formatPercent=d3.format(".2%"),this.percentFormatter=function(t){return this.formatPercent(t)}.bind(this)}return t}),define("$app/ui/product/with_payment_blurb",["$app/ui/shared/with_d3_formatter","$app/utils/checkout"],function(t,e){function n(){this.defaultAttrs({paymentBlurbSelector:".js-payment-blurb",effectivePriceSelector:".js-price",taxAmountTextSelector:".js-tax-amount",vatCountryIndicatorSelector:".js-vat-country-choice-trigger",vatCountryChoiceSelector:".js-vat-country-choice",vatCountryChoiceSelectSelector:".js-vat-country-select",paymentBlurbTaxSuppressed:!1,totalPriceCents:0}),this.flashPrice=function(){var t=this.select("paymentBlurbSelector").find(this.attr.effectivePriceSelector);t.addClass("highlighted"),setTimeout(function(){t.removeClass("highlighted")}.bind(this),1e3)},this.updatePrice=function(t){this.select("paymentBlurbSelector").find(this.attr.effectivePriceSelector).text(t)},this.updateTax=function(t){this.select("paymentBlurbSelector").find(this.attr.taxAmountTextSelector)&&(this.select("paymentBlurbSelector").find(this.attr.taxAmountTextSelector).text(t),this.attr.requireCountryConfirmation&&(this.select("paymentBlurbSelector").find(this.attr.vatCountryIndicatorSelector).text(this.attr.taxCountry),this.select("vatCountryChoiceSelectSelector").val(this.attr.taxCountry)))},this.selectDataPropertyFromBlurb=function(t){var e=$(".js-payment-blurb");return e.size()>1?$(e[1]).data(t):$(e[0]).data(t)},this.formattedMoney=function(t,e){var n=this.isWholeNumber(t)?0:2;return accounting.formatMoney(t,{symbol:e,precision:n})},this.setPaymentBlurb=function(t,e){var n=this.selectDataPropertyFromBlurb("currency-symbol");return 0==t?this.hidePaymentBlurb():(parseFloat(e)?this.updateTax(this.formattedMoney(e,n)):this.updateTax(this.formattedMoney(0,n)),this.updatePrice(this.formattedMoney(t,n)),this.select("paymentBlurbSelector").show(),void this.trigger("uiAnimatePaymentFormHeight",{animate:!0}))},this.isWholeNumber=function(t){var e=t.toFixed(2);return!parseInt(e.substring(e.length-2,e.length))},this.hidePaymentBlurb=function(){this.select("paymentBlurbSelector").hide(),this.trigger("uiAnimatePaymentFormHeight",{animate:!0})},this.USDToForeign=function(t,e){return e?parseFloat(t*e):t},this.ForeignToUSD=function(t,e){return e?parseFloat(t)/e:t},this.cleanedPrice=function(t){return t%1==0?t:t.toFixed(2)},this.singleUnitRate=function(t){return t?1:100},this.toDisplayCurrency=function(t,e,n){var i=this.selectDataPropertyFromBlurb("merchant-account-currency"),r=this.singleUnitRate(e),a=1;return n&&(a=parseFloat(n)),"doesnotexist"===i?parseFloat(this.cleanedPrice(this.ForeignToUSD(parseFloat(t)/r,a))):parseFloat(this.cleanedPrice(this.USDToForeign(parseFloat(t)/r,a)))},this.toDisplayCurrencyCents=function(t,e,n){return parseFloat(this.cleanedPrice(100*this.toDisplayCurrency(t,e,n)))},this.initiatePriceInformationUpdate=function(t){if(!e.isUsingCheckout())if(this.attr.productsInBundle)for(var n=0;n<this.attr.productsInBundle.length;n++){var i=this.attr.productsInBundle[n];this.trigger("uiNeedsProductCustomerSurcharge",{externalId:i.externalId,permalink:i.permalink,priceCents:i.perceivedPriceCents,quantity:i.quantity,sellerId:this.attr.sellerId,postalCode:i.isPhysical?this.select("zipCodeSelector").val():"",country:i.isPhysical?this.select("countrySelector").val():i.taxCountry,isPhysical:i.isPhysical,isTaxExclusive:i.isTaxedExclusively,isPartOfBundle:!0})}else this.attr.isPhysical=this.select("paymentBlurbSelector").data("is-physical"),this.trigger("uiNeedsProductCustomerSurcharge",{externalId:this.attr.externalId,priceCents:this.attr.totalPriceCents,sellerId:this.attr.sellerId,postalCode:this.attr.isPhysical?this.select("zipCodeSelector").val():"",country:this.attr.isPhysical?this.select("countrySelector").val():this.attr.taxCountry,isPhysical:this.attr.isPhysical,isTaxExclusive:this.attr.isTaxedExclusively,productNode:this.$node,quantity:this.attr.quantity})},this.updateCustomerSurcharge=function(t,e){var n,i=0,r=0,a=0,s=0,o=0,l=!1;if(this.attr.productsInBundle)i=this.totalBundlePrice()+this.totalBundleShippingRate(),r=this.totalBundleTax(),a=this.bundleExclusiveTax(),o=this.bundleExclusiveVat(),s=this.bundleVat(),l=this.productsWithExchangeRates(),n=this.bundleTaxCountry();else{var u=this.selectDataPropertyFromBlurb("exchange-rate"),c=this.attr.isSingleUnit;i=this.toDisplayCurrency(parseInt(e.price_cents)+parseInt(e.shipping_rate_cents),c,u),r=this.toDisplayCurrency(parseInt(e.tax_cents),c,u),a=e.is_price_tax_exclusive&&e.tax_info&&!e.tax_info.is_vat?this.toDisplayCurrency(parseInt(e.tax_cents),c,u):0,l=1!=u,s=e.tax_info&&e.tax_info.is_vat?this.toDisplayCurrency(parseInt(e.tax_cents),c,u):0,o=e.is_price_tax_exclusive?s:0,n=e.tax_info&&e.tax_info.country}this.attr.requireCountryConfirmation=s>0,n&&(this.attr.taxCountry=n),i+=a+o;var h=Math.floor(100*i);this.attr.totalTransactionCents!=h&&(this.attr.totalTransactionCents=h,this.trigger(this.node,"uiTotalPriceCentsChanged")),s>0?(this.select("paymentBlurbSelector").html(I18n.t("js.card_will_be_charged_with_price_including_vat_tax")),this.setPaymentBlurb(i,s)):r>0?(this.select("paymentBlurbSelector").html(I18n.t("js.card_will_be_charged_with_price_including_sales_tax")),this.setPaymentBlurb(i)):l||this.select("paymentBlurbSelector").is(":visible")||this.attr.productsInBundle||this.attr.isPayWhatYouWant||this.attr.offerCodeUsed?this.setPaymentBlurb(i):this.hidePaymentBlurb(),this.flashPrice(),this.trigger("uiShouldEnablePayButton")},this.notifyTotalTransactionCents=function(t,e){this.trigger(this.node,"uiHasTotalTransactionCents",{totalPriceCents:this.attr.totalTransactionCents})},this.selectVatCountry=function(t,e){if(this.attr.taxCountry=this.select("vatCountryChoiceSelectSelector").val(),this.attr.productsInBundle)for(var n=0;n<this.attr.productsInBundle.length;n++)this.attr.productsInBundle[n].taxCountry=this.attr.taxCountry;this.select("vatCountryIndicatorSelector").text(this.attr.taxCountry),this.initiatePriceInformationUpdate(),this.hideVatCountrySelector()},this.toggleVatCountrySelector=function(t){t&&t.preventDefault();var e=this.select("vatCountryChoiceSelector"),n=this.select("vatCountryIndicatorSelector");return 1==n.length&&e.css({top:n.position().top-e.outerHeight()+35,left:n.position().left-e.outerWidth()/2+n.width()/2}).toggleClass("showing"),!1},this.hideVatCountrySelector=function(t,e){this.select("vatCountryChoiceSelector").removeClass("showing")},this.showNewVatCountryOptions=function(t,e){if(e.is_tax_mismatch){setTimeout(function(){this.toggleVatCountrySelector()}.bind(this),1e3),this.select("vatCountryChoiceSelectSelector").find("option").each(function(){-1==$.inArray(this.value,[e.card_country,e.ip_country])&&this.remove()});var n=this.select("vatCountryChoiceSelectSelector").find("option:first").val();this.select("vatCountryChoiceSelectSelector").val(n),this.attr.taxCountry=n,this.initiatePriceInformationUpdate()}},this.after("initialize",function(){this.on("click",{vatCountryIndicatorSelector:this.toggleVatCountrySelector}),this.on("change",{vatCountryChoiceSelectSelector:this.selectVatCountry}),this.on(this.$node,"dataCustomerSurcharge",this.updateCustomerSurcharge),this.on(this.$node,"uiNeedsCustomerSurcharge",this.initiatePriceInformationUpdate),this.on(document,"dataPurchaseFail",this.showNewVatCountryOptions),this.on(document,"uiNeedsToHideVatCountrySelector",this.hideVatCountrySelector),this.on(this.node,"uiNeedsTotalTransactionCents",this.notifyTotalTransactionCents)})}return n}),define("$app/utils/with_social_share",[],function(){function t(){this.getTwitterShareUrl=function(t){return"https://twitter.com/intent/tweet?text="+encodeURI(t)}}return t}),/*
 * jPlayer Plugin for jQuery JavaScript Library
 * http://www.jplayer.org
 *
 * Copyright (c) 2009 - 2011 Happyworm Ltd
 * Dual licensed under the MIT and GPL licenses.
 *  - http://www.opensource.org/licenses/mit-license.php
 *  - http://www.gnu.org/copyleft/gpl.html
 *
 * Author: Mark J Panaghiston
 * Version: 2.1.0
 * Date: 1st September 2011
 */
function(t,e){t.fn.jPlayer=function(n){var i="string"==typeof n,r=Array.prototype.slice.call(arguments,1),a=this,n=!i&&r.length?t.extend.apply(null,[!0,n].concat(r)):n;return i&&"_"===n.charAt(0)?a:(i?this.each(function(){var i=t.data(this,"jPlayer"),s=i&&t.isFunction(i[n])?i[n].apply(i,r):i;return s!==i&&s!==e?(a=s,!1):void 0}):this.each(function(){var e=t.data(this,"jPlayer");e?e.option(n||{}):t.data(this,"jPlayer",new t.jPlayer(n,this))}),a)},t.jPlayer=function(e,n){if(arguments.length){this.element=t(n),this.options=t.extend(!0,{},this.options,e);var i=this;this.element.bind("remove.jPlayer",function(){i.destroy()}),this._init()}},t.jPlayer.emulateMethods="load play pause",t.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",t.jPlayer.emulateOptions="muted volume",t.jPlayer.reservedEvent="ready flashreset resize repeat error warning",t.jPlayer.event={ready:"jPlayer_ready",flashreset:"jPlayer_flashreset",resize:"jPlayer_resize",repeat:"jPlayer_repeat",click:"jPlayer_click",error:"jPlayer_error",warning:"jPlayer_warning",loadstart:"jPlayer_loadstart",progress:"jPlayer_progress",suspend:"jPlayer_suspend",abort:"jPlayer_abort",emptied:"jPlayer_emptied",stalled:"jPlayer_stalled",play:"jPlayer_play",pause:"jPlayer_pause",loadedmetadata:"jPlayer_loadedmetadata",loadeddata:"jPlayer_loadeddata",waiting:"jPlayer_waiting",playing:"jPlayer_playing",canplay:"jPlayer_canplay",canplaythrough:"jPlayer_canplaythrough",seeking:"jPlayer_seeking",seeked:"jPlayer_seeked",timeupdate:"jPlayer_timeupdate",ended:"jPlayer_ended",ratechange:"jPlayer_ratechange",durationchange:"jPlayer_durationchange",volumechange:"jPlayer_volumechange"},t.jPlayer.htmlEvent="loadstart,abort,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,ratechange".split(","),t.jPlayer.pause=function(){t.each(t.jPlayer.prototype.instances,function(t,e){e.data("jPlayer").status.srcSet&&e.jPlayer("pause")})},t.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""},t.jPlayer.convertTime=function(e){var n=new Date(1e3*e),i=n.getUTCHours(),e=n.getUTCMinutes(),n=n.getUTCSeconds(),i=t.jPlayer.timeFormat.padHour&&10>i?"0"+i:i,e=t.jPlayer.timeFormat.padMin&&10>e?"0"+e:e,n=t.jPlayer.timeFormat.padSec&&10>n?"0"+n:n;return(t.jPlayer.timeFormat.showHour?i+t.jPlayer.timeFormat.sepHour:"")+(t.jPlayer.timeFormat.showMin?e+t.jPlayer.timeFormat.sepMin:"")+(t.jPlayer.timeFormat.showSec?n+t.jPlayer.timeFormat.sepSec:"")},t.jPlayer.uaBrowser=function(t){var t=t.toLowerCase(),e=/(opera)(?:.*version)?[ \/]([\w.]+)/,n=/(msie) ([\w.]+)/,i=/(mozilla)(?:.*? rv:([\w.]+))?/,t=/(webkit)[ \/]([\w.]+)/.exec(t)||e.exec(t)||n.exec(t)||t.indexOf("compatible")<0&&i.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}},t.jPlayer.uaPlatform=function(t){var e=t.toLowerCase(),n=/(android)/,i=/(mobile)/,t=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/.exec(e)||[],e=/(ipad|playbook)/.exec(e)||!i.exec(e)&&n.exec(e)||[];return t[1]&&(t[1]=t[1].replace(/\s/g,"_")),{platform:t[1]||"",tablet:e[1]||""}},t.jPlayer.browser={},t.jPlayer.platform={};var n=t.jPlayer.uaBrowser(navigator.userAgent);n.browser&&(t.jPlayer.browser[n.browser]=!0,t.jPlayer.browser.version=n.version),n=t.jPlayer.uaPlatform(navigator.userAgent),n.platform&&(t.jPlayer.platform[n.platform]=!0,t.jPlayer.platform.mobile=!n.tablet,t.jPlayer.platform.tablet=!!n.tablet),t.jPlayer.prototype={count:0,version:{script:"2.1.0",needFlash:"2.1.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",preload:"metadata",volume:.8,muted:!1,wmode:"opaque",backgroundColor:"black",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",currentTime:".jp-current-time",duration:".jp-duration",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},fullScreen:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1e3},loop:!1,repeat:function(e){e.jPlayer.options.loop?t(this).unbind(".jPlayerRepeat").bind(t.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){t(this).jPlayer("play")}):t(this).unbind(".jPlayerRepeat")},nativeVideoControls:{},noFullScreen:{msie:/msie [0-6]/,ipad:/ipad.*?os [0-4]/,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3](?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/,playbook:/playbook/},verticalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,errorAlerts:!1,warningAlerts:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:!1},solution:{html:!0,flash:!0},format:{mp3:{codec:'audio/mpeg; codecs="mp3"',flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis"',flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"}},_init:function(){var n=this;if(this.element.empty(),this.status=t.extend({},this.status),this.internal=t.extend({},this.internal),this.internal.domNode=this.element.get(0),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),t.each(this.options.supplied.toLowerCase().split(","),function(e,i){var r=i.replace(/^\s+|\s+$/g,"");if(n.format[r]){var a=!1;t.each(n.formats,function(t,e){return r===e?(a=!0,!1):void 0}),a||n.formats.push(r)}}),t.each(this.options.solution.toLowerCase().split(","),function(e,i){var r=i.replace(/^\s+|\s+$/g,"");if(n.solution[r]){var a=!1;t.each(n.solutions,function(t,e){return r===e?(a=!0,!1):void 0}),a||n.solutions.push(r)}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=t.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=t.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:e}),this.internal.video=t.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:e}),this.internal.flash=t.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:e,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"Jplayer.swf":"")}),this.internal.poster=t.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:e}),t.each(t.jPlayer.event,function(t,i){n.options[t]!==e&&(n.element.bind(i+".jPlayer",n.options[t]),n.options[t]=e)}),this.require.audio=!1,this.require.video=!1,t.each(this.formats,function(t,e){n.require[n.format[e].media]=!0}),this.options=this.require.video?t.extend(!0,{},this.optionsVideo,this.options):t.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){(!n.status.video||n.status.waitForPlay)&&n.internal.poster.jq.show()},this.element.append(this.htmlElement.poster),this.internal.poster.jq=t("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){n._trigger(t.jPlayer.event.click)}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10),this.html.canPlay={},this.flash.canPlay={},t.each(this.formats,function(t,e){n.html.canPlay[e]=n.html[n.format[e].media].available&&""!==n.htmlElement[n.format[e].media].canPlayType(n.format[e].codec),n.flash.canPlay[e]=n.format[e].flashCanPlay&&n.flash.available}),this.html.desired=!1,this.flash.desired=!1,t.each(this.solutions,function(e,i){if(0===e)n[i].desired=!0;else{var r=!1,a=!1;t.each(n.formats,function(t,e){n[n.solutions[0]].canPlay[e]&&("video"===n.format[e].media?a=!0:r=!0)}),n[i].desired=n.require.audio&&!r||n.require.video&&!a}}),this.html.support={},this.flash.support={},t.each(this.formats,function(t,e){n.html.support[e]=n.html.canPlay[e]&&n.html.desired,n.flash.support[e]=n.flash.canPlay[e]&&n.flash.desired}),this.html.used=!1,this.flash.used=!1,t.each(this.solutions,function(e,i){t.each(n.formats,function(t,e){return n[i].support[e]?(n[i].used=!0,!1):void 0})}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:t.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:t.jPlayer.errorMsg.NO_SOLUTION,hint:t.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var i,r="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if(t.browser.msie&&Number(t.browser.version)<=8){r=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+r+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'],i=document.createElement('<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0"></object>');for(var a=0;a<r.length;a++)i.appendChild(document.createElement(r[a]))}else a=function(t,e,n){var i=document.createElement("param");i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)},i=document.createElement("object"),i.setAttribute("id",this.internal.flash.id),i.setAttribute("data",this.internal.flash.swf),i.setAttribute("type","application/x-shockwave-flash"),i.setAttribute("width","1"),i.setAttribute("height","1"),a(i,"flashvars",r),a(i,"allowscriptaccess","always"),a(i,"bgcolor",this.options.backgroundColor),a(i,"wmode",this.options.wmode);this.element.append(i),this.internal.flash.jq=t(i)}this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=t("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=t("#"+this.internal.video.id),this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):this.internal.video.jq.css({width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){n._trigger(t.jPlayer.event.click)}))),this.options.emulateHtml&&this._emulateHtmlBridge(),this.html.used&&!this.flash.used&&setTimeout(function(){n.internal.ready=!0,n.version.flash="n/a",n._trigger(t.jPlayer.event.repeat),n._trigger(t.jPlayer.event.ready)},100),this._updateNativeVideoControls(),this._updateInterface(),this._updateButtons(!1),this._updateAutohide(),this._updateVolume(this.options.volume),this._updateMute(this.options.muted),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),t.jPlayer.prototype.count++},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),t.each(this.css.jq,function(t,e){e.length&&e.unbind(".jPlayer")}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]},enable:function(){},disable:function(){},_testCanPlayType:function(t){try{return t.canPlayType(this.format.mp3.codec),!0}catch(e){return!1}},_uaBlocklist:function(e){var n=navigator.userAgent.toLowerCase(),i=!1;return t.each(e,function(t,e){return e&&e.test(n)?(i=!0,!1):void 0}),i},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullScreen=!0)},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))},_addHtmlEventListeners:function(e,n){var i=this;e.preload=this.options.preload,e.muted=this.options.muted,e.volume=this.options.volume,e.addEventListener("progress",function(){n.gate&&(i._getHtmlStatus(e),i._updateInterface(),i._trigger(t.jPlayer.event.progress))},!1),e.addEventListener("timeupdate",function(){n.gate&&(i._getHtmlStatus(e),i._updateInterface(),i._trigger(t.jPlayer.event.timeupdate))},!1),e.addEventListener("durationchange",function(){n.gate&&(i.status.duration=this.duration,i._getHtmlStatus(e),i._updateInterface(),i._trigger(t.jPlayer.event.durationchange))},!1),e.addEventListener("play",function(){n.gate&&(i._updateButtons(!0),i._html_checkWaitForPlay(),i._trigger(t.jPlayer.event.play))},!1),e.addEventListener("playing",function(){n.gate&&(i._updateButtons(!0),i._seeked(),i._trigger(t.jPlayer.event.playing))},!1),e.addEventListener("pause",function(){n.gate&&(i._updateButtons(!1),i._trigger(t.jPlayer.event.pause))},!1),e.addEventListener("waiting",function(){n.gate&&(i._seeking(),i._trigger(t.jPlayer.event.waiting))},!1),e.addEventListener("seeking",function(){n.gate&&(i._seeking(),i._trigger(t.jPlayer.event.seeking))},!1),e.addEventListener("seeked",function(){n.gate&&(i._seeked(),i._trigger(t.jPlayer.event.seeked))},!1),e.addEventListener("volumechange",function(){n.gate&&(i.options.volume=e.volume,i.options.muted=e.muted,i._updateMute(),i._updateVolume(),i._trigger(t.jPlayer.event.volumechange))},!1),e.addEventListener("suspend",function(){n.gate&&(i._seeked(),i._trigger(t.jPlayer.event.suspend))},!1),e.addEventListener("ended",function(){n.gate&&(t.jPlayer.browser.webkit||(i.htmlElement.media.currentTime=0),i.htmlElement.media.pause(),i._updateButtons(!1),i._getHtmlStatus(e,!0),i._updateInterface(),i._trigger(t.jPlayer.event.ended))},!1),e.addEventListener("error",function(){n.gate&&(i._updateButtons(!1),i._seeked(),i.status.srcSet)&&(clearTimeout(i.internal.htmlDlyCmdId),i.status.waitForLoad=!0,i.status.waitForPlay=!0,i.status.video&&!i.status.nativeVideoControls&&i.internal.video.jq.css({width:"0px",height:"0px"}),i._validString(i.status.media.poster)&&!i.status.nativeVideoControls&&i.internal.poster.jq.show(),i.css.jq.videoPlay.length&&i.css.jq.videoPlay.show(),i._error({type:t.jPlayer.error.URL,context:i.status.src,message:t.jPlayer.errorMsg.URL,hint:t.jPlayer.errorHint.URL}))},!1),t.each(t.jPlayer.htmlEvent,function(r,a){e.addEventListener(this,function(){n.gate&&i._trigger(t.jPlayer.event[a])},!1)})},_getHtmlStatus:function(t,e){var n=0,i=0,r=0,a=0;t.duration&&(this.status.duration=t.duration),n=t.currentTime,i=this.status.duration>0?100*n/this.status.duration:0,"object"==typeof t.seekable&&t.seekable.length>0?(r=this.status.duration>0?100*t.seekable.end(t.seekable.length-1)/this.status.duration:100,a=100*t.currentTime/t.seekable.end(t.seekable.length-1)):(r=100,a=i),e&&(i=a=n=0),this.status.seekPercent=r,this.status.currentPercentRelative=a,this.status.currentPercentAbsolute=i,this.status.currentTime=n,this.status.readyState=t.readyState,this.status.networkState=t.networkState,this.status.playbackRate=t.playbackRate,this.status.ended=t.ended},_resetStatus:function(){this.status=t.extend({},this.status,t.jPlayer.prototype.status)},_trigger:function(e,n,i){e=t.Event(e),e.jPlayer={},e.jPlayer.version=t.extend({},this.version),e.jPlayer.options=t.extend(!0,{},this.options),e.jPlayer.status=t.extend(!0,{},this.status),e.jPlayer.html=t.extend(!0,{},this.html),e.jPlayer.flash=t.extend(!0,{},this.flash),n&&(e.jPlayer.error=t.extend({},n)),i&&(e.jPlayer.warning=t.extend({},i)),this.element.trigger(e)},jPlayerFlashEvent:function(e,n){if(e===t.jPlayer.event.ready)if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var i=this.status.currentTime,r=this.status.paused;this.setMedia(this.status.media),i>0&&(r?this.pause(i):this.play(i))}this._trigger(t.jPlayer.event.flashreset)}}else this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=n.version,this.version.needFlash!==this.version.flash&&this._error({type:t.jPlayer.error.VERSION,context:this.version.flash,message:t.jPlayer.errorMsg.VERSION+this.version.flash,hint:t.jPlayer.errorHint.VERSION}),this._trigger(t.jPlayer.event.repeat),this._trigger(e);if(this.flash.gate)switch(e){case t.jPlayer.event.progress:this._getFlashStatus(n),this._updateInterface(),this._trigger(e);break;case t.jPlayer.event.timeupdate:this._getFlashStatus(n),this._updateInterface(),this._trigger(e);break;case t.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(e);break;case t.jPlayer.event.pause:this._updateButtons(!1),this._trigger(e);break;case t.jPlayer.event.ended:this._updateButtons(!1),this._trigger(e);break;case t.jPlayer.event.click:this._trigger(e);break;case t.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:t.jPlayer.error.URL,context:n.src,message:t.jPlayer.errorMsg.URL,hint:t.jPlayer.errorHint.URL});break;case t.jPlayer.event.seeking:this._seeking(),this._trigger(e);break;case t.jPlayer.event.seeked:this._seeked(),this._trigger(e);break;case t.jPlayer.event.ready:break;default:this._trigger(e)}return!1},_getFlashStatus:function(t){this.status.seekPercent=t.seekPercent,this.status.currentPercentRelative=t.currentPercentRelative,this.status.currentPercentAbsolute=t.currentPercentAbsolute,this.status.currentTime=t.currentTime,this.status.duration=t.duration,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_updateButtons:function(t){t!==e&&(this.status.paused=!t,this.css.jq.play.length&&this.css.jq.pause.length&&(t?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide()))),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullScreen?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullScreen?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&this.css.jq.playBar.width(this.status.currentPercentRelative+"%"),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(t.jPlayer.convertTime(this.status.currentTime)),this.css.jq.duration.length&&this.css.jq.duration.text(t.jPlayer.convertTime(this.status.duration))},_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg")},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg")},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.flash.gate=!1},_resetActive:function(){this.html.active=!1,this.flash.active=!1},setMedia:function(e){var n=this,i=!1,r=this.status.media.poster!==e.poster;this._resetMedia(),this._resetGate(),this._resetActive(),t.each(this.formats,function(r,a){var s="video"===n.format[a].media;return t.each(n.solutions,function(t,r){if(n[r].support[a]&&n._validString(e[a])){var o="html"===r;return s?(o?(n.html.video.gate=!0,n._html_setVideo(e),n.html.active=!0):(n.flash.gate=!0,n._flash_setVideo(e),n.flash.active=!0),n.css.jq.videoPlay.length&&n.css.jq.videoPlay.show(),n.status.video=!0):(o?(n.html.audio.gate=!0,n._html_setAudio(e),n.html.active=!0):(n.flash.gate=!0,n._flash_setAudio(e),n.flash.active=!0),n.css.jq.videoPlay.length&&n.css.jq.videoPlay.hide(),n.status.video=!1),i=!0,!1}}),i?!1:void 0}),i?(this.status.nativeVideoControls&&this.html.video.gate||!this._validString(e.poster)||(r?this.htmlElement.poster.src=e.poster:this.internal.poster.jq.show()),this.status.srcSet=!0,this.status.media=t.extend({},e),this._updateButtons(!1),this._updateInterface()):this._error({type:t.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:t.jPlayer.errorMsg.NO_SUPPORT,hint:t.jPlayer.errorHint.NO_SUPPORT})},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.flash.active&&this._flash_resetMedia()},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()},load:function(){this.status.srcSet?this.html.active?this._html_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")},play:function(t){t="number"==typeof t?t:NaN,this.status.srcSet?this.html.active?this._html_play(t):this.flash.active&&this._flash_play(t):this._urlNotSetError("play")},videoPlay:function(){this.play()},pause:function(t){t="number"==typeof t?t:NaN,this.status.srcSet?this.html.active?this._html_pause(t):this.flash.active&&this._flash_pause(t):this._urlNotSetError("pause")},pauseOthers:function(){var e=this;t.each(this.instances,function(t,n){e.element!==n&&n.data("jPlayer").status.srcSet&&n.jPlayer("pause")})},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")},playHead:function(t){t=this._limitValue(t,0,100),this.status.srcSet?this.html.active?this._html_playHead(t):this.flash.active&&this._flash_playHead(t):this._urlNotSetError("playHead")},_muted:function(e){this.options.muted=e,this.html.used&&this._html_mute(e),this.flash.used&&this._flash_mute(e),!this.html.video.gate&&!this.html.audio.gate&&(this._updateMute(e),this._updateVolume(this.options.volume),this._trigger(t.jPlayer.event.volumechange))},mute:function(t){t=t===e?!0:!!t,this._muted(t)},unmute:function(t){t=t===e?!0:!!t,this._muted(!t)},_updateMute:function(t){t===e&&(t=this.options.muted),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):t?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))},volume:function(e){e=this._limitValue(e,0,1),this.options.volume=e,this.html.used&&this._html_volume(e),this.flash.used&&this._flash_volume(e),!this.html.video.gate&&!this.html.audio.gate&&(this._updateVolume(e),this._trigger(t.jPlayer.event.volumechange))},volumeBar:function(t){if(this.css.jq.volumeBar.length){var e=this.css.jq.volumeBar.offset(),n=t.pageX-e.left,i=this.css.jq.volumeBar.width(),t=this.css.jq.volumeBar.height()-t.pageY+e.top,e=this.css.jq.volumeBar.height();this.options.verticalVolume?this.volume(t/e):this.volume(n/i)}this.options.muted&&this._muted(!1)},volumeBarValue:function(t){this.volumeBar(t)},_updateVolume:function(t){t===e&&(t=this.options.volume),t=this.options.muted?0:t,this.status.noVolume?(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*t+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)},_cssSelectorAncestor:function(e){var n=this;this.options.cssSelectorAncestor=e,this._removeUiClass(),this.ancestorJq=e?t(e):[],e&&1!==this.ancestorJq.length&&this._warning({type:t.jPlayer.warning.CSS_SELECTOR_COUNT,context:e,message:t.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:t.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),t.each(this.options.cssSelector,function(t,e){n._cssSelector(t,e)})},_cssSelector:function(e,n){var i=this;"string"==typeof n?t.jPlayer.prototype.options.cssSelector[e]?(this.css.jq[e]&&this.css.jq[e].length&&this.css.jq[e].unbind(".jPlayer"),this.options.cssSelector[e]=n,this.css.cs[e]=this.options.cssSelectorAncestor+" "+n,this.css.jq[e]=n?t(this.css.cs[e]):[],this.css.jq[e].length&&this.css.jq[e].bind("click.jPlayer",function(n){return i[e](n),t(this).blur(),!1}),n&&1!==this.css.jq[e].length&&this._warning({type:t.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[e],message:t.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[e].length+" found for "+e+" method.",hint:t.jPlayer.warningHint.CSS_SELECTOR_COUNT})):this._warning({type:t.jPlayer.warning.CSS_SELECTOR_METHOD,context:e,message:t.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:t.jPlayer.warningHint.CSS_SELECTOR_METHOD}):this._warning({type:t.jPlayer.warning.CSS_SELECTOR_STRING,context:n,message:t.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:t.jPlayer.warningHint.CSS_SELECTOR_STRING})},seekBar:function(t){if(this.css.jq.seekBar){var e=this.css.jq.seekBar.offset(),t=t.pageX-e.left,e=this.css.jq.seekBar.width();this.playHead(100*t/e)}},playBar:function(t){this.seekBar(t)},repeat:function(){this._loop(!0)},repeatOff:function(){this._loop(!1)},_loop:function(e){this.options.loop!==e&&(this.options.loop=e,this._updateButtons(),this._trigger(t.jPlayer.event.repeat))},currentTime:function(){},duration:function(){},gui:function(){},noSolution:function(){},option:function(n,i){var r=n;if(0===arguments.length)return t.extend(!0,{},this.options);if("string"==typeof n){var a=n.split(".");if(i===e){for(var r=t.extend(!0,{},this.options),s=0;s<a.length;s++){if(r[a[s]]===e)return this._warning({type:t.jPlayer.warning.OPTION_KEY,context:n,message:t.jPlayer.warningMsg.OPTION_KEY,hint:t.jPlayer.warningHint.OPTION_KEY}),e;r=r[a[s]]}return r}for(var s=r={},o=0;o<a.length;o++)o<a.length-1?(s[a[o]]={},s=s[a[o]]):s[a[o]]=i}return this._setOptions(r),this},_setOptions:function(e){var n=this;return t.each(e,function(t,e){n._setOption(t,e)}),this},_setOption:function(e,n){var i=this;switch(e){case"volume":this.volume(n);break;case"muted":this._muted(n);break;case"cssSelectorAncestor":this._cssSelectorAncestor(n);break;case"cssSelector":t.each(n,function(t,e){i._cssSelector(t,e)});break;case"fullScreen":this.options[e]!==n&&(this._removeUiClass(),this.options[e]=n,this._refreshSize());break;case"size":!this.options.fullScreen&&this.options[e].cssClass!==n.cssClass&&this._removeUiClass(),this.options[e]=t.extend({},this.options[e],n),this._refreshSize();break;case"sizeFull":this.options.fullScreen&&this.options[e].cssClass!==n.cssClass&&this._removeUiClass(),this.options[e]=t.extend({},this.options[e],n),this._refreshSize();break;case"autohide":this.options[e]=t.extend({},this.options[e],n),this._updateAutohide();break;case"loop":this._loop(n);break;case"nativeVideoControls":this.options[e]=t.extend({},this.options[e],n),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();break;case"noFullScreen":this.options[e]=t.extend({},this.options[e],n),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen),this._restrictNativeVideoControls(),this._updateButtons();break;case"noVolume":this.options[e]=t.extend({},this.options[e],n),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();break;case"emulateHtml":this.options[e]!==n&&((this.options[e]=n)?this._emulateHtmlBridge():this._destroyHtmlBridge())}return this},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger(t.jPlayer.event.resize)},_setSize:function(){this.options.fullScreen?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})},_updateAutohide:function(){var t=this,e=function(){t.css.jq.gui.fadeIn(t.options.autohide.fadeIn,function(){clearTimeout(t.internal.autohideId),t.internal.autohideId=setTimeout(function(){t.css.jq.gui.fadeOut(t.options.autohide.fadeOut)},t.options.autohide.hold)})};this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),this.element.unbind(".jPlayerAutohide"),this.css.jq.gui.unbind(".jPlayerAutohide"),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullScreen&&this.options.autohide.full||!this.options.fullScreen&&this.options.autohide.restored?(this.element.bind("mousemove.jPlayer.jPlayerAutohide",e),this.css.jq.gui.bind("mousemove.jPlayer.jPlayerAutohide",e),
this.css.jq.gui.hide()):this.css.jq.gui.show())},fullScreen:function(){this._setOption("fullScreen",!0)},restoreScreen:function(){this._setOption("fullScreen",!1)},_html_initMedia:function(){this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger(t.jPlayer.event.timeupdate)},_html_setAudio:function(e){var n=this;t.each(this.formats,function(t,i){return n.html.support[i]&&e[i]?(n.status.src=e[i],n.status.format[i]=!0,n.status.formatType=i,!1):void 0}),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia()},_html_setVideo:function(e){var n=this;t.each(this.formats,function(t,i){return n.html.support[i]&&e[i]?(n.status.src=e[i],n.status.format[i]=!0,n.status.formatType=i,!1):void 0}),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(e.poster)?e.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia()},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id===this.internal.video.id&&!this.status.nativeVideoControls&&this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="",this.htmlElement.media.load())},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(t){var e=this;if(this._html_load(),this.htmlElement.media.play(),!isNaN(t))try{this.htmlElement.media.currentTime=t}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){e.play(t)},100))}this._html_checkWaitForPlay()},_html_pause:function(t){var e=this;if(t>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),this.htmlElement.media.pause(),!isNaN(t))try{this.htmlElement.media.currentTime=t}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){e.pause(t)},100))}t>0&&this._html_checkWaitForPlay()},_html_playHead:function(t){var e=this;this._html_load();try{if("object"==typeof this.htmlElement.media.seekable&&this.htmlElement.media.seekable.length>0)this.htmlElement.media.currentTime=t*this.htmlElement.media.seekable.end(this.htmlElement.media.seekable.length-1)/100;else{if(!(this.htmlElement.media.duration>0)||isNaN(this.htmlElement.media.duration))throw"e";this.htmlElement.media.currentTime=t*this.htmlElement.media.duration/100}}catch(n){return void(this.internal.htmlDlyCmdId=setTimeout(function(){e.playHead(t)},100))}this.status.waitForLoad||this._html_checkWaitForPlay()},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))},_html_volume:function(t){this.html.audio.available&&(this.htmlElement.audio.volume=t),this.html.video.available&&(this.htmlElement.video.volume=t)},_html_mute:function(t){this.html.audio.available&&(this.htmlElement.audio.muted=t),this.html.video.available&&(this.htmlElement.video.muted=t)},_flash_setAudio:function(e){var n=this;try{t.each(this.formats,function(t,i){if(n.flash.support[i]&&e[i]){switch(i){case"m4a":case"fla":n._getMovie().fl_setAudio_m4a(e[i]);break;case"mp3":n._getMovie().fl_setAudio_mp3(e[i])}return n.status.src=e[i],n.status.format[i]=!0,n.status.formatType=i,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(i){this._flashError(i)}},_flash_setVideo:function(e){var n=this;try{t.each(this.formats,function(t,i){if(n.flash.support[i]&&e[i]){switch(i){case"m4v":case"flv":n._getMovie().fl_setVideo_m4v(e[i])}return n.status.src=e[i],n.status.format[i]=!0,n.status.formatType=i,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(i){this._flashError(i)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(NaN)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(t){this._flashError(t)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(t){this._flashError(t)}this.status.waitForLoad=!1},_flash_play:function(t){try{this._getMovie().fl_play(t)}catch(e){this._flashError(e)}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()},_flash_pause:function(t){try{this._getMovie().fl_pause(t)}catch(e){this._flashError(e)}t>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())},_flash_playHead:function(t){try{this._getMovie().fl_play_head(t)}catch(e){this._flashError(e)}this.status.waitForLoad||this._flash_checkWaitForPlay()},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))},_flash_volume:function(t){try{this._getMovie().fl_volume(t)}catch(e){this._flashError(e)}},_flash_mute:function(t){try{this._getMovie().fl_mute(t)}catch(e){this._flashError(e)}},_getMovie:function(){return document[this.internal.flash.id]},_checkForFlash:function(t){var e,n=!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t),n=!0}catch(i){}else navigator.plugins&&navigator.mimeTypes.length>0&&(e=navigator.plugins["Shockwave Flash"])&&navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")>=t&&(n=!0);return n},_validString:function(t){return t&&"string"==typeof t},_limitValue:function(t,e,n){return e>t?e:t>n?n:t},_urlNotSetError:function(e){this._error({type:t.jPlayer.error.URL_NOT_SET,context:e,message:t.jPlayer.errorMsg.URL_NOT_SET,hint:t.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(e){var n;n=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:t.jPlayer.error[n],context:this.internal.flash.swf,message:t.jPlayer.errorMsg[n]+e.message,hint:t.jPlayer.errorHint[n]}),this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(e){this._trigger(t.jPlayer.event.error,e),this.options.errorAlerts&&this._alert("Error!"+(e.message?"\n\n"+e.message:"")+(e.hint?"\n\n"+e.hint:"")+"\n\nContext: "+e.context)},_warning:function(n){this._trigger(t.jPlayer.event.warning,e,n),this.options.warningAlerts&&this._alert("Warning!"+(n.message?"\n\n"+n.message:"")+(n.hint?"\n\n"+n.hint:"")+"\n\nContext: "+n.context)},_alert:function(t){alert("jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+t)},_emulateHtmlBridge:function(){var e=this;t.each(t.jPlayer.emulateMethods.split(/\s+/g),function(t,n){e.internal.domNode[n]=function(t){e[n](t)}}),t.each(t.jPlayer.event,function(n,i){var r=!0;t.each(t.jPlayer.reservedEvent.split(/\s+/g),function(t,e){return e===n?r=!1:void 0}),r&&e.element.bind(i+".jPlayer.jPlayerHtml",function(){e._emulateHtmlUpdate();var t=document.createEvent("Event");t.initEvent(n,!1,!0),e.internal.domNode.dispatchEvent(t)})})},_emulateHtmlUpdate:function(){var e=this;t.each(t.jPlayer.emulateStatus.split(/\s+/g),function(t,n){e.internal.domNode[n]=e.status[n]}),t.each(t.jPlayer.emulateOptions.split(/\s+/g),function(t,n){e.internal.domNode[n]=e.options[n]})},_destroyHtmlBridge:function(){var e=this;this.element.unbind(".jPlayerHtml"),t.each((t.jPlayer.emulateMethods+" "+t.jPlayer.emulateStatus+" "+t.jPlayer.emulateOptions).split(/\s+/g),function(t,n){delete e.internal.domNode[n]})}},t.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},t.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+t.jPlayer.prototype.version.script+" needs Jplayer.swf version "+t.jPlayer.prototype.version.needFlash+" but found "},t.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},t.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},t.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},t.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}}(jQuery),define("$vendor/jquery.jplayer.min",function(){}),define("$app/ui/shared/with_player",["$vendor/jquery.jplayer.min"],function(){function t(){this.onPlay=function(){},this.onPause=function(){},this.onTimeUpdate=function(){},this.onEnded=function(){},this.play=function(){this.select("playerSelector").jPlayer("play")},this.pause=function(){this.select("playerSelector").jPlayer("pause")},this.getContentTypeFromUrl=function(){return this.attr.audioUrl.split("?")[0].split(".").pop()},this.initializePlayer=function(){var t=this.select("playerSelector");this.attr.audioUrl=t.data("url"),this.attr.audioUrl&&""!=this.attr.audioUrl&&(t.jPlayer({ready:function(t){this.select("playerSelector").jPlayer("setMedia",{mp3:this.attr.audioUrl,wav:this.attr.audioUrl,m4a:this.attr.audioUrl})}.bind(this),preload:"none",swfPath:"/js",supplied:this.getContentTypeFromUrl()}),t.bind($.jPlayer.event.play,this.onPlay.bind(this)),t.bind($.jPlayer.event.pause,this.onPause.bind(this)),t.bind($.jPlayer.event.timeupdate,this.onTimeUpdate.bind(this)),t.bind($.jPlayer.event.ended,this.onEnded.bind(this)))}}return t}),define("$app/ui/shared/with_math",[],function(){function t(){this.getAverage=function(t){if(!(t instanceof Array)||0==t.length)return null;var e=0;return $.each(t,function(t,n){e+=n}),e/t.length},this.getMedian=function(t){if(!(t instanceof Array)||0==t.length)return null;var e=Math.floor(t.length/2),n=t.sort(this.ascendingNumericSort);return t.length%2==0?(n[e]+n[e-1])/2:n[e]},this.ascendingNumericSort=function(t,e){return t-e},this.polarToCartesian=function(t,e){var n=e*Math.PI/180,i=t*Math.cos(n),r=t*(Math.sin(n)+1);return i+" "+r}}return t}),define("$app/ui/shared/with_audio_player",["flight/lib/compose","$app/ui/shared/with_player","$app/ui/shared/with_math"],function(t,e,n){function i(){t.mixin(this,[e,n]),this.defaultAttrs({playerContainerSelector:".js-audio-player",playerSelector:".js-audio-player .player",audioProgressSelector:".js-audio-player .audio-progress",playButtonSelector:".js-audio-player .play-button",pauseButtonSelector:".js-audio-player .pause-button",circleProgressSelector:".js-audio-player .circle-progress",textProgressSelector:".js-audio-player .progress-text",playerOutsideContainerSelector:".js-audio-player-container"}),this.stopAudio=function(t){"stopPreviews"==t.data&&this.pause()},this.togglePlayAndPause=function(t){t&&t.preventDefault(),this.select("playButtonSelector").is(":visible")?(this.trigger("pauseAudioPlayers"),this.playAudio()):this.pauseAudio()},this.playAudio=function(t){t&&t.preventDefault();var e=this.select("playerOutsideContainerSelector").data("url-redirect-id"),n=this.select("playerOutsideContainerSelector").data("product-file-id"),i=this.select("playerOutsideContainerSelector").data("purchase-id");this.trigger("uiNeedsToTrackConsumptionEvent",{eventType:"listen",platform:"web",urlRedirectId:e,productFileId:n,purchaseId:i}),this.play()},this.pauseAudio=function(t){t&&t.preventDefault(),this.pause()},this.around("onPlay",function(){this.select("pauseButtonSelector").show(),this.select("playButtonSelector").hide()}),this.around("onPause",function(){this.select("playButtonSelector").show(),this.select("pauseButtonSelector").hide()}),this.around("onTimeUpdate",function(t,e){if(e.jPlayer.status.duration>0){var n=e.jPlayer.status.currentTime/e.jPlayer.status.duration,i="0";n>.5&&(i="1"),this.select("circleProgressSelector").attr("d","M 40 3 a 37 37 0 "+i+" 1 "+this.polarToCartesian(37,360*n-90)),this.select("textProgressSelector").text($.jPlayer.convertTime(e.jPlayer.status.currentTime)+"/"+$.jPlayer.convertTime(e.jPlayer.status.duration)),this.trigger("uiUpdateReceiptHeight"),this.trigger("uiAnimatePaymentFormHeight",{animate:!1})}}),this.around("onEnded",function(){this.select("playButtonSelector").show(),this.select("pauseButtonSelector").hide();var t=this.select("playerSelector").parents().andSelf().nextAll().find(".js-listen-trigger").andSelf().filter(".js-listen-trigger");$(t[0]).click()}),this.initializeAudioPlayer=function(){this.initializePlayer()},this.after("initialize",function(){window.addEventListener?window.addEventListener("message",this.stopAudio.bind(this)):window.attachEvent("message",this.stopAudio.bind(this)),this.on("click",{playerContainerSelector:this.togglePlayAndPause})})}return i}),define("$app/ui/shared/with_listen",["flight/lib/compose","$app/ui/shared/with_audio_player"],function(t,e){function n(){t.mixin(this,[e]),this.defaultAttrs({listenTriggerSelector:".js-listen-trigger",audioPlayerSelector:".js-audio-player"}),this.showAndStartAudioPlayer=function(t,e){this.trigger("pauseAudioPlayers"),this.select("listenTriggerSelector").hide(),this.select("audioPlayerSelector").hasClass("button-block")?this.select("audioPlayerSelector").removeClass("hidden"):this.select("audioPlayerSelector").css("display","inline-block"),this.playAudio()},this.pauseAudioPlayer=function(){this.pauseAudio()},this.after("initialize",function(){this.initializeAudioPlayer(),this.on(document,"pauseAudioPlayers",this.pauseAudioPlayer),this.on("click",{listenTriggerSelector:this.showAndStartAudioPlayer})})}return n}),define("$app/templates/helpers/t",["hbs/handlebars"],function(t){function e(t,e){return t="js."+t,void 0!==e.hash?I18n.t(t,e.hash):I18n.t(t)}return t.registerHelper("t",e),e}),define("hbs!$app/templates/receipt_entry",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return'  <li class="receipt-entry purchase_error js-receipt-entry-failed">\n    <span class="purchase_failed_notice">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"purchase_failed",{name:"t",hash:{},data:i}))+'</span>\n    <h2 class="product-name">'+this.escapeExpression((r=null!=(r=e.name||(null!=t?t.name:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"name",hash:{},data:i}):r))+'</h2>\n    <p class="purchase_error_message">'+this.escapeExpression((r=null!=(r=e.error_message||(null!=t?t.error_message:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"error_message",hash:{},data:i}):r))+"</p>\n  </li>\n"},3:function(t,e,n,i){var r,a;return'  <li class="receipt-entry js-receipt-entry-successful">\n    <span class="receipt-price">'+this.escapeExpression((a=null!=(a=e.price||(null!=t?t.price:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"price",hash:{},data:i}):a))+'</span>\n    <div class="product-details">\n      <h2 class="product-name">'+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+" "+this.escapeExpression((a=null!=(a=e.variants_displayable||(null!=t?t.variants_displayable:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"variants_displayable",hash:{},data:i}):a))+" "+(null!=(r=e["if"].call(t,null!=t?t.show_quantity:t,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+"</h2>\n"+(null!=(r=e["if"].call(t,null!=t?t.is_redirect_ready:t,{name:"if",hash:{},fn:this.program(6,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.custom_delivery_url:t,{name:"if",hash:{},fn:this.program(18,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_recurring_billing:t,{name:"if",hash:{},fn:this.program(20,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_open_in_appable:t,{name:"if",hash:{},fn:this.program(24,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.license_key:t,{name:"if",hash:{},fn:this.program(26,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_gift_sender_purchase:t,{name:"if",hash:{},fn:this.program(28,i,0),inverse:this.program(33,i,0),data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_gift_receiver_purchase:t,{name:"if",hash:{},fn:this.program(36,i,0),inverse:this.noop,data:i}))?r:"")+"      "+(null!=(r=e["if"].call(t,null!=t?t.test_purchase_notice:t,{name:"if",hash:{},fn:this.program(38,i,0),inverse:this.noop,data:i}))?r:"")+"\n    </div>\n  </li>\n"+(null!=(r=e["if"].call(t,null!=t?t.has_shipping_to_show:t,{name:"if",hash:{},fn:this.program(40,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.has_sales_tax_to_show:t,{name:"if",hash:{},fn:this.program(42,i,0),inverse:this.noop,data:i}))?r:"")},4:function(t,e,n,i){var r;return'<span class="quantity">\xd7 '+this.escapeExpression((r=null!=(r=e.quantity||(null!=t?t.quantity:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"quantity",hash:{},data:i}):r))+"</span>"},6:function(t,e,n,i){var r;return null!=(r=e["if"].call(t,null!=t?t.has_multiple_files:t,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.program(9,i,0),data:i}))?r:""},7:function(t,e,n,i){var r;return'          <a href="'+this.escapeExpression((r=null!=(r=e.redirect_url||(null!=t?t.redirect_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"redirect_url",hash:{},data:i}):r))+'" class="button button-default button-small js-track-product-click-event" data-product-event-name="receipt_view_product" target="_blank">'+this.escapeExpression((r=null!=(r=e.view_files_button_text||(null!=t?t.view_files_button_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"view_files_button_text",hash:{},data:i}):r))+"</a>\n"},9:function(t,e,n,i){var r;return(null!=(r=e["if"].call(t,null!=t?t.is_streamable:t,{name:"if",hash:{},fn:this.program(10,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_readable:t,{name:"if",hash:{},fn:this.program(12,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_listenable:t,{name:"if",hash:{},fn:this.program(14,i,0),inverse:this.noop,data:i}))?r:"")+(null!=(r=e["if"].call(t,null!=t?t.is_downloadable:t,{name:"if",hash:{},fn:this.program(16,i,0),inverse:this.noop,data:i}))?r:"")},10:function(t,e,n,i){var r;return'            <a href="'+this.escapeExpression((r=null!=(r=e.stream_url||(null!=t?t.stream_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"stream_url",hash:{},data:i}):r))+'" class="button button-default button-small js-track-product-click-event" data-product-event-name="receipt_streaming" target="_blank">'+this.escapeExpression((r=null!=(r=e.stream_button_text||(null!=t?t.stream_button_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"stream_button_text",hash:{},data:i}):r))+"</a>\n"},12:function(t,e,n,i){var r;return'            <a href="'+this.escapeExpression((r=null!=(r=e.read_url||(null!=t?t.read_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"read_url",hash:{},data:i}):r))+'" class="button button-default button-small js-track-product-click-event" data-product-event-name="receipt_read" target="_blank">'+this.escapeExpression((r=null!=(r=e.read_button_text||(null!=t?t.read_button_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"read_button_text",hash:{},data:i}):r))+"</a>\n"},14:function(t,e,n,i){var r;return'            <div class="js-audio-player-container" data-url-redirect-id="'+this.escapeExpression((r=null!=(r=e.url_redirect_external_id||(null!=t?t.url_redirect_external_id:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"url_redirect_external_id",hash:{},data:i}):r))+'" data-product-file-id="'+this.escapeExpression((r=null!=(r=e.product_file_external_id||(null!=t?t.product_file_external_id:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"product_file_external_id",hash:{},data:i}):r))+'" data-purchase-id="'+this.escapeExpression((r=null!=(r=e.id||(null!=t?t.id:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"id",hash:{},data:i}):r))+'">\n              <a href="#" class="button button-default button-small js-track-product-click-event js-listen-trigger" data-product-event-name="receipt_listen">'+this.escapeExpression((r=null!=(r=e.listen_button_text||(null!=t?t.listen_button_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"listen_button_text",hash:{},data:i}):r))+'</a>\n\n              <div class="js-audio-player button button-small button-default soft-hidden">\n                <div class="player" data-url="'+this.escapeExpression((r=null!=(r=e.listen_url||(null!=t?t.listen_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"listen_url",hash:{},data:i}):r))+'"></div>\n                <a class="play-button media-control">\u25b6</a>\n                <a class="pause-button media-control">\u2759\u2759</a>\n                <span class="audio-progress progress-text"></span>\n              </div>\n            </div>\n'},16:function(t,e,n,i){var r;return'            <a href="'+this.escapeExpression((r=null!=(r=e.redirect_url||(null!=t?t.redirect_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"redirect_url",hash:{},data:i}):r))+'" class="button button-default button-small js-track-product-click-event" data-product-event-name="receipt_download" target="_blank">'+this.escapeExpression((r=null!=(r=e.download_button_text||(null!=t?t.download_button_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"download_button_text",hash:{},data:i}):r))+"</a>\n"},18:function(t,e,n,i){var r;return'        <a href="'+this.escapeExpression((r=null!=(r=e.custom_delivery_url||(null!=t?t.custom_delivery_url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"custom_delivery_url",hash:{},data:i}):r))+'" class="button button-default button-small js-track-product-click-event js-custom-delivery-url" data-product-event-name="receipt_click_custom_delivery_url" target="_blank"></a>\n'},20:function(t,e,n,i){var r,a;return(null!=(r=e["if"].call(t,null!=t?t.immediate_installments:t,{name:"if",hash:{},fn:this.program(21,i,0),inverse:this.noop,data:i}))?r:"")+'        <a href="'+this.escapeExpression((a=null!=(a=e.library_url||(null!=t?t.library_url:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"library_url",hash:{},data:i}):a))+'" class="button button-default button-small js-track-product-click-event js-library-url" data-product-event-name="receipt_library" target="_blank">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"library_button_text",{name:"t",hash:{},data:i}))+"</a>\n"},21:function(t,e,n,i){var r;return'          <div class="immediate-installments">\n            <p><strong>'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"view_latest_updates",{name:"t",hash:{},data:i}))+"</strong></p>\n"+(null!=(r=e.each.call(t,null!=t?t.immediate_installments:t,{name:"each",hash:{},fn:this.program(22,i,0),inverse:this.noop,data:i}))?r:"")+"          </div>\n"},22:function(t,e,n,i){var r;return'              <a href="'+this.escapeExpression((r=null!=(r=e.link||(null!=t?t.link:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"link",hash:{},data:i}):r))+'" class="js-track-product-click-event js-view-immediate-installment" target="_blank">'+this.escapeExpression((r=null!=(r=e.name||(null!=t?t.name:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"name",hash:{},data:i}):r))+"</a>\n"},24:function(t,e,n,i){var r;return'        <a href="#" class="button button-default button-small js-track-product-click-event js-mobile-app-popover-trigger"\n           data-receipt="true" data-email="'+this.escapeExpression((r=null!=(r=e.email||(null!=t?t.email:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"email",hash:{},data:i}):r))+'" data-has-purchaser="'+this.escapeExpression((r=null!=(r=e.account_by_this_email_exists||(null!=t?t.account_by_this_email_exists:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"account_by_this_email_exists",hash:{},data:i}):r))+'"\n           data-product-event-name="receipt_open_in_app">'+this.escapeExpression((r=null!=(r=e.open_in_app_text||(null!=t?t.open_in_app_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"open_in_app_text",hash:{},data:i}):r))+"</a>\n"},26:function(t,e,n,i){var r;return"        <p class='license-key-container'>"+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"your_license_key_title",{name:"t",hash:{},data:i}))+"</p>\n        <p class='license-key'>"+this.escapeExpression((r=null!=(r=e.license_key||(null!=t?t.license_key:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"license_key",hash:{},data:i}):r))+"</p>\n"},28:function(t,e,n,i){var r,a;return"        <p>"+this.escapeExpression((a=null!=(a=e.gift_sender_text||(null!=t?t.gift_sender_text:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"gift_sender_text",hash:{},data:i}):a))+"</p>\n"+(null!=(r=e["if"].call(t,null!=t?t.has_files:t,{name:"if",hash:{},fn:this.program(29,i,0),inverse:this.program(31,i,0),data:i}))?r:"")},29:function(t,e,n,i){return"          <p>"+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"emailed_gift_notice",{name:"t",hash:{},data:i}))+"</p>\n"},31:function(t,e,n,i){return"          <p>"+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"emailed_gift_notice_physical",{name:"t",hash:{},data:i}))+"</p>\n"},33:function(t,e,n,i){var r;return"        "+(null!=(r=e["if"].call(t,null!=t?t.extra_purchase_notice:t,{name:"if",hash:{},fn:this.program(34,i,0),inverse:this.noop,data:i}))?r:"")+"\n"},34:function(t,e,n,i){var r,a;return"<p>"+(null!=(a=null!=(a=e.extra_purchase_notice||(null!=t?t.extra_purchase_notice:t))?a:e.helperMissing,r="function"==typeof a?a.call(t,{name:"extra_purchase_notice",hash:{},data:i}):a)?r:"")+"</p>"},36:function(t,e,n,i){var r;return"        <p>"+this.escapeExpression((r=null!=(r=e.gift_receiver_text||(null!=t?t.gift_receiver_text:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"gift_receiver_text",hash:{},data:i}):r))+"</p>\n"},38:function(t,e,n,i){var r;return"<p>"+this.escapeExpression((r=null!=(r=e.test_purchase_notice||(null!=t?t.test_purchase_notice:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"test_purchase_notice",hash:{},data:i}):r))+"</p>"},40:function(t,e,n,i){var r;return'    <li class="receipt-entry">\n      <span class="receipt-price">'+this.escapeExpression((r=null!=(r=e.shipping_amount||(null!=t?t.shipping_amount:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"shipping_amount",hash:{},data:i}):r))+'</span>\n      <div class="product-details">\n        <h2 class="product-name">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"shipping",{name:"t",hash:{},data:i}))+"</h2>\n      </div>\n    </li>\n"},42:function(t,e,n,i){var r;return'    <li class="receipt-entry">\n      <span class="receipt-price">'+this.escapeExpression((r=null!=(r=e.sales_tax_amount||(null!=t?t.sales_tax_amount:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"sales_tax_amount",hash:{},data:i}):r))+'</span>\n      <div class="product-details">\n        <h2 class="product-name">'+this.escapeExpression((r=null!=(r=e.sales_tax_label||(null!=t?t.sales_tax_label:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"sales_tax_label",hash:{},data:i}):r))+"</h2>\n      </div>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return null!=(r=e["if"].call(t,null!=t?t.error_message:t,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?r:""},useData:!0});return e.registerPartial("$app/templates/receipt_entry",n),n}),define("hbs!$app/templates/total_receipt_entry",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return'  <li class="receipt-entry">\n    <span class="receipt-price">'+this.escapeExpression((r=null!=(r=e.total_price_including_tax_and_shipping||(null!=t?t.total_price_including_tax_and_shipping:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"total_price_including_tax_and_shipping",hash:{},data:i}):r))+'</span>\n    <div class="product-details">\n      <h2 class="product-name">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"total_amount",{name:"t",hash:{},data:i}))+"</h2>\n    </div>\n  </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return null!=(r=e["if"].call(t,null!=t?t.has_sales_tax_or_shipping_to_show:t,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:""},useData:!0});return e.registerPartial("$app/templates/total_receipt_entry",n),n}),define("$app/templates/helpers/t_upcase",["hbs/handlebars"],function(t){function e(t,e){return t="js."+t,void 0==e?I18n.t(t).toUpperCase():I18n.t(t,e).toUpperCase()}return t.registerHelper("t_upcase",e),e}),define("$app/ui/product/with_receipt",["flight/lib/compose","$app/utils/with_url","$app/utils/with_social_share","$app/ui/shared/with_listen","$app/ui/product/with_credit_card_on_payment_form","hbs!$app/templates/receipt_entry","hbs!$app/templates/total_receipt_entry","$app/templates/helpers/t","$app/templates/helpers/t_upcase"],function(t,e,n,i,r,a,s){function o(){t.mixin(this,[e,n,i,r]),this.defaultAttrs({receiptContainerSelector:".receipt_container",receiptSelector:".receipt",receiptEntriesSelector:".receipt-entries",receiptEntryFailedSelector:".js-receipt-entry-failed",receiptEntrySuccessfulSelector:".js-receipt-entry-successful",emailReceiptFormSelector:".email-receipt-form",emailedLinkNoticeSelector:".emailed-link-notice",receiptPriceSelector:".receipt-price",receiptShadowSelector:".receipt_shadow",customTextSelector:".js-receipt-custom-text",receiptCreateUserMsgSelector:".receipt_create_user_p",userPurchaseIdSelector:".user_purchase_id",createAccountOrAddToLibraryButtonSelector:".create-account-or-add-to-library-button",userEmailSelector:".user_email",userExpDateSelector:".user_exp_date",userNumberSelector:".user_number",userCvcSelector:".user_cvc",userAddPurchaseToExistingAccountSelector:".user_add_purchase_to_existing_account",twitterSelector:".js-twitter-share-trigger",facebookSelector:".js-facebook-share-trigger",viewReceiptSelector:".js-view-receipt-container",receiptTwitterShareSelector:".receipt_container .js-twitter-share-trigger",receiptFacebookShareSelector:".receipt_container .js-facebook-share-trigger",passwordFieldSelector:".js-password-field",libraryUrlSelector:".js-library-url",customDeliveryUrlSelector:".js-custom-delivery-url",customDeliveryRedirectDelayInSeconds:5}),this.setReceipt=function(){if(!this.attr.onUserProfile||!this.$node.parents(".gridster").length){var t=this.select("receiptSelector");this.select("receiptContainerSelector").css({position:"absolute",visibility:"hidden",display:"block"});var e=t.height()+30;this.select("receiptContainerSelector").css({position:"relative",visibility:"visible",display:"none"}),t.css({marginTop:-e})}},this.showReceipt=function(t){var e=this.select("receiptContainerSelector"),n=this.select("receiptSelector"),i=this.select("purchaseFormSelector"),r=this.select("payButtonContainerSelector"),a=this.select("receiptShadowSelector"),s=this.select("changedMindButtonSelector");this.setPaymentFormHeight(this.select("paymentFormSelector").outerHeight()),t?(i.slideUp(),s.fadeOut(),e.animate({"margin-top":0}),r.slideUp(function(){a.animate({opacity:1},600,"linear"),n.animate({"margin-top":3},600,"swing").animate({"margin-top":0},200,"linear")}),e.height(n.height()+45).show(),this.select("paymentFormSelector").animate({height:e.height()+45})):(s.hide(),
i.hide(),e.show(),n.show(),e.css({"margin-top":0}),r.hide(),a.css({opacity:1}),n.css({"margin-top":0}),e.height(n.height()+45).show()),this.attr.isShowingReceipt=!0,this.startRedirect()},this.performRedirect=function(){clearInterval(this.redirectTimer),this.select("customDeliveryUrlSelector").text(I18n.t("js.custom_delivery_prompt"));var t=this.select("customDeliveryUrlSelector").attr("href");this.attr.isOverlayPage?this.trigger("uiNeedsToRedirectOverlayFromReceipt",{url:t}):window.location.href=t},this.showRedirectCountdown=function(){this.select("customDeliveryUrlSelector").text(I18n.t("js.custom_delivery_redirect",{seconds:this.attr.customDeliveryRedirectDelayInSeconds}))},this.startRedirect=function(){0===this.select("receiptEntryFailedSelector").length&&1===this.select("receiptEntrySuccessfulSelector").length&&1===this.select("customDeliveryUrlSelector").length?(this.showRedirectCountdown(),this.redirectTimer=setInterval(function(){this.attr.customDeliveryRedirectDelayInSeconds-=1,this.showRedirectCountdown(),this.attr.customDeliveryRedirectDelayInSeconds<=0&&this.performRedirect()}.bind(this),1e3)):this.select("customDeliveryUrlSelector").text(I18n.t("js.custom_delivery_prompt"))},this.showCheckEmailReceipt=function(){this.select("receiptEntriesSelector").text(I18n.t("js.purchase_processing_check_email_notice")),this.showReceipt(!0)},this.hideReceipt=function(t){var e=this.select("receiptContainerSelector"),n=this.select("receiptSelector"),i=this.select("purchaseFormSelector"),r=this.select("payButtonContainerSelector"),a=this.select("payButtonSelector"),s=this.select("receiptShadowSelector"),o=this.select("changedMindButtonSelector");t?(o.fadeIn(),e.hide(),i.show(),r.show(),this.attr.purchaseWasGift?(this.toggleGiftPaymentForm(!1),this.select("paymentFormSelector").stop()):this.select("paymentFormSelector").animate({height:this.select("paymentContainerSelector").outerHeight()}),e.show(),i.hide(),r.hide(),a.text(a.data("default")),s.animate({opacity:0},600,"linear"),n.animate({"margin-top":-(n.height()+45)},600,"swing"),setTimeout(function(){i.show().css({position:"relative",top:-(i.height()+40)}),e.animate({"margin-top":20}),r.show(),i.animate({top:0}),e.height("auto").hide()},600)):(o.show(),i.show(),r.show(),this.select("paymentFormSelector").height(this.getPaymentFormHeight()),n.show(),e.css({"margin-top":20}),s.css({opacity:0}),n.css({"margin-top":-(n.height()+45)}),e.hide().height("auto")),this.attr.isShowingReceipt=!1},this.setPasswordPromptForAccountCreationInReceipt=function(){this.select("receiptCreateUserMsgSelector").text(I18n.t("js.enter_pwd_to_create_account_free"))},this.fillReceiptWithPurchaseDetails=function(t){this.select("userPurchaseIdSelector").val(t.id),this.select("parentIdSelector").val(t.id),t.name=this.attr.name,this.select("receiptEntriesSelector").html(a(t)+s(t)),this.attr.user.purchase.parent_id=t.id,t.is_following&&this.showFollowing(),this.attr.user.is_logged_in?this.select("emailReceiptFormSelector").hide():t.account_by_this_email_exists&&(this.select("userAddPurchaseToExistingAccountSelector").val(!0),this.select("receiptCreateUserMsgSelector").text(I18n.t("js.add_to_library_prompt")),this.select("createAccountOrAddToLibraryButtonSelector").text(I18n.t("js.add_to_library_button_title")),this.select("emailReceiptFormSelector").show()),this.initializeAudioPlayer()},this.createAccountOrAddToLibrary=function(t){return t.preventDefault(),this.select("userAddPurchaseToExistingAccountSelector").val()?this.addPurchaseToLibrary():this.createAccount(),!1},this.addPurchaseToLibrary=function(){var t=this.select("createAccountOrAddToLibraryButtonSelector");t.data("default",t.text()),t.text(I18n.t("js.adding")),this.trigger("uiNeedsToAddPurchaseToLibrary",{permalink:this.attr.permalink,serializedForm:this.select("emailReceiptFormSelector").serialize()})},this.createAccount=function(){var t=this.select("createAccountOrAddToLibraryButtonSelector");this.select("userEmailSelector").val(this.select("emailSelector").val()),t.data("default",t.text()),t.text("..."),this.isCreditCardFormInUse()?this.getCardParams(function(t){this.createAccountWithCardParams(t.cardParams)}.bind(this)):this.createAccountWithCardParams({})},this.createAccountWithCardParams=function(t){var e=this.select("emailReceiptFormSelector").serialize()+"&"+$.param({user:t});this.trigger("uiNeedsToCreateAccount",{permalink:this.attr.permalink,serializedForm:e})},this.reloadPage=function(t,e){this.attr.preventReload||this.attr.permalink==e.permalink&&location.reload(!0)},this.showAccountCreationError=function(t,e){if(this.attr.permalink==e.permalink){var n=this.select("createAccountOrAddToLibraryButtonSelector");this.select("receiptCreateUserMsgSelector").text(e.message).addClass("error"),n.text(n.data("default"))}},this.redirectToLibrary=function(t,e){this.attr.permalink==e.permalink&&(window.location=e.redirect_location)},this.showAddToLibraryError=function(t,e){if(this.attr.permalink==e.permalink){var n=this.select("createAccountOrAddToLibraryButtonSelector");this.select("receiptCreateUserMsgSelector").text(e.message).addClass("error"),n.text(n.data("default"))}},this.updateSocialShareTextForProductBundle=function(t){var e=window.location.host+window.location.pathname,n=this.select("facebookSelector"),i=this.select("twitterSelector");if(this.attr.isOverlayPage&&(e=this.attr.overlayPageShareUrl||[window.location.host,"l",this.attr.productsInBundle[0].permalink].join("/")),n.data("url",e),2==t.length){var r=I18n.t("js.twitter_share_text_for_multi_buy.counting",{name:t[0],another_name:t[1],count:1,url:e});i.attr("href",this.getTwitterShareUrl(r))}else if(t.length>0){var r=I18n.t("js.twitter_share_text_for_multi_buy.counting",{name:t[0],count:t.length-1,url:e});i.attr("href",this.getTwitterShareUrl(r))}else i.hide(),n.hide()},this.showFollowing=function(){this.trigger("uiShowFollowing")},this.updateCustomText=function(t,e){if(e.text.length>0){var n=$("<div></div>").text(e.text).html();this.select("customTextSelector").html("<p>"+n.replace(/\n/g,"</p><p>")+"</p>"),this.select("customTextSelector").show()}else this.select("customTextSelector").hide();var i=this.select("receiptContainerSelector"),r=this.select("receiptSelector");i.height(r.height()+45).show(),this.select("paymentFormSelector").stop().animate({height:i.height()+45})},this.initializeModalShareURLs=function(){var t=this.select("receiptTwitterShareSelector"),e=this.select("receiptFacebookShareSelector"),n=this.getUrlParams().source_url;"undefined"!=typeof n&&t.length>0&&e.length>0&&(t.attr("href",t.attr("href").replace(/%20.*$/,"%20"+n)),e.attr("data-url",n))},this.hideReceiptWithoutAnimation=function(t){return t.preventDefault(),this.hideReceipt(!1),!1},this.showReceiptExample=function(t,e){return t.preventDefault(),this.select("receiptContainerSelector").fadeIn(),this.fillReceiptWithPurchaseDetails(e),this.attr.onUserProfile||this.trigger("uiSetTwitterSharingUrlForPurchase",{url:e.twitter_share_url,text:e.twitter_share_text}),this.attr.isShowingPaymentForm?this.showReceipt(!0):(this.showReceipt(!1),this.switchToPaymentForm(!0)),!1},this.updateReceiptHeight=function(){this.showReceipt(!1)},this.showMobileAppPopover=function(){this.select("productInformationSelector").hide(),this.select("previewContainerSelector").hide(),this.select("paymentFormSelector").css({overflow:"visible"}),this.select("productSelector").css({overflow:"visible"}),this.select("productMainSelector").css({overflow:"visible"}),this.select("receiptContainerSelector").css({overflow:"visible"})},this.hideMobileAppPopover=function(){this.select("productInformationSelector").show(),this.select("previewContainerSelector").show(),this.select("paymentFormSelector").css({overflow:"hidden"}),this.select("productSelector").css({overflow:"hidden"}),this.select("productMainSelector").css({overflow:"hidden"}),this.select("receiptContainerSelector").css({overflow:"hidden"})},this.setOverlayPageShareUrl=function(t,e){this.attr.isOverlayPage=!0,e.url&&(this.attr.overlayPageShareUrl=e.url)},this.after("initialize",function(){this.on(document,"dataAccount",this.reloadPage),this.on(document,"dataFailedToCreateAccount",this.showAccountCreationError),this.on(document,"dataPurchaseAddedToLibrary",this.redirectToLibrary),this.on(document,"dataFailedToAddPurchaseToLibrary",this.showAddToLibraryError),this.on(document,"uiUpdateReceiptCustomText",this.updateCustomText),this.on(document,"uiShowReceipt",this.showReceiptExample),this.on(document,"uiUpdateReceiptHeight",this.updateReceiptHeight),this.on(document,"uiHideReceipt",this.hideReceipt),this.on(document,"uiHideReceiptWithoutAnimation",this.hideReceiptWithoutAnimation),this.on(document,"uiNeedsToDisplayMobileAppPopover",this.showMobileAppPopover),this.on(document,"uiNeedsToHideMobileAppPopover",this.hideMobileAppPopover),this.on(document,"uiSetOverlayPageShareUrl",this.setOverlayPageShareUrl),this.on("click",{createAccountOrAddToLibraryButtonSelector:this.createAccountOrAddToLibrary}),this.attr.isModal&&this.initializeModalShareURLs()})}return o}),define("hbs!$app/templates/variant_category",["hbs","hbs/handlebars"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return"<option disabled selected>"+this.escapeExpression((r=null!=(r=e.name||(null!=t?t.name:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"name",hash:{},data:i}):r))+"</option>"},3:function(t,e,n,i){var r;return null!=(r=e["if"].call(t,null!=t?t.sold_out:t,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.program(6,i,0),data:i}))?r:""},4:function(t,e,n,i){var r;return'      <option disabled class="disabled">'+this.escapeExpression((r=null!=(r=e.displayable||(null!=t?t.displayable:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"displayable",hash:{},data:i}):r))+"</option>\n"},6:function(t,e,n,i){var r;return'      <option data-price-offset-cents="'+this.escapeExpression((r=null!=(r=e.price_difference_cents||(null!=t?t.price_difference_cents:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"price_difference_cents",hash:{},data:i}):r))+'" data-price-offset="'+this.escapeExpression((r=null!=(r=e.price_difference_in_currency_units||(null!=t?t.price_difference_in_currency_units:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"price_difference_in_currency_units",hash:{},data:i}):r))+'" data-quantity-left="'+this.escapeExpression((r=null!=(r=e.quantity_left||(null!=t?t.quantity_left:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"quantity_left",hash:{},data:i}):r))+'" value="'+this.escapeExpression((r=null!=(r=e.id||(null!=t?t.id:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"id",hash:{},data:i}):r))+'">'+this.escapeExpression((r=null!=(r=e.displayable||(null!=t?t.displayable:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"displayable",hash:{},data:i}):r))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r,a;return'<select class="variant js-variant appearance-none required" data-var="'+this.escapeExpression((a=null!=(a=e.i||(null!=t?t.i:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"i",hash:{},data:i}):a))+'" name="variants['+this.escapeExpression((a=null!=(a=e.i||(null!=t?t.i:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"i",hash:{},data:i}):a))+']">\n  '+(null!=(r=e["if"].call(t,null!=t?t.name:t,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+"\n"+(null!=(r=e.each.call(t,null!=t?t.options:t,{name:"each",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?r:"")+"</select>\n"},useData:!0});return e.registerPartial("$app/templates/variant_category",n),n}),define("$app/ui/product/with_variants",["hbs!$app/templates/variant_category"],function(t){function e(){this.defaultAttrs({variantSelectionSelector:".js-variant-selection",variantSelector:".js-variant",selectedPriceChanges:[]}),this.setVariants=function(){if(this.attr.user.product.variants){if(this.select("variantSelector").remove(),this.attr.user.product.variants.skus&&this.attr.user.product.variants.skus.length>0){var e={name:this.attr.user.product.variants.skus_title,options:this.attr.user.product.variants.skus,i:0},n=t(e),i=this.select("variantSelectionSelector");i.append(n)}else $.each(this.attr.user.product.variants.categories,function(e,n){var i=t(n),r=this.select("variantSelectionSelector");r.append(i)}.bind(this));this.attr.variantSelectionRequired&&(this.select("variantSelector").addClass("error"),delete this.attr.variantSelectionRequired);var r=this.select("variantSelector").find(":selected");r.length>0&&(this.attr.selectedPriceChanges[r.parent().data("var")]=[r.data("price-offset"),r.data("price-offset-cents")]),this.attr.variantsHaveBeenShown=!0,this.setPrice()}},this.updateVariantSelection=function(t){var e=$(t.target||t.srcElement);e.removeClass("error"),this.updateSelectedPriceChanges(e),this.setPrice(),this.trigger("uiShouldResetQuantityUI")},this.updateSelectedPriceChanges=function(t){this.attr.selectedPriceChanges[t.data("var")]=[t.find(":selected").data("price-offset"),t.find(":selected").data("price-offset-cents")]},this.after("initialize",function(){this.on("change",{variantSelector:this.updateVariantSelection})})}return e}),define("hbs!$app/templates/buyer_bar",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({1:function(t,e,n,i){return'  <a href="#" class="js-buyer-menu-trigger buyer-circle-link">\n    <div class="profile-picture-small">\n      <div class="profile-picture js-buyer-circle"></div>\n    </div>\n  </a>\n'},3:function(t,e,n,i){var r;return'    <li>\n      <a href="/settings"><i class="gi gi-gear"></i> '+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"settings_prompt",{name:"t",hash:{},data:i}))+"</a>\n    </li>\n\n"+(null!=(r=e["if"].call(t,null!=t?t.show_library_link:t,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+'\n    <li>\n      <a href="/logout" class="js-logout-link"><i class="gi gi-logout"></i> '+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"logout_prompt",{name:"t",hash:{},data:i}))+"</a>\n    </li>\n"},4:function(t,e,n,i){return'      <li>\n        <a href="/library"><i class="gi gi-library"></i> '+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"library_prompt",{name:"t",hash:{},data:i}))+"</a>\n      </li>\n"},6:function(t,e,n,i){return'    <li>\n      <a href="#" class="js-login-trigger">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"login",{name:"t",hash:{},data:i}))+"</a>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return(null!=(r=e.unless.call(t,null!=t?t.is_on_custom_domain:t,{name:"unless",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+'\n<ul class="account nav core js-buyer-menu">\n'+(null!=(r=e["if"].call(t,null!=t?t.is_logged_in:t,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.program(6,i,0),data:i}))?r:"")+"</ul>\n"},useData:!0});return e.registerPartial("$app/templates/buyer_bar",n),n}),define("hbs!$app/templates/custom_field_set",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({1:function(t,e,n,i){var r,a;return'      <input type="text" name="'+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+'" placeholder="'+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+(null!=(r=e.unless.call(t,null!=t?t.required:t,{name:"unless",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?r:"")+'" '+(null!=(r=e["if"].call(t,null!=t?t.required:t,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+" />\n"},2:function(t,e,n,i){return" ("+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"optional",{name:"t",hash:{},data:i}))+")"},4:function(t,e,n,i){return'class="required"'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r,a;return'<div class="custom-field-container js-custom-field-set" data-permalink="'+this.escapeExpression((a=null!=(a=e.permalink||(null!=t?t.permalink:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"permalink",hash:{},data:i}):a))+'">\n  <div class="mini-rule"></div>\n  <p class="custom-field-p">\n    <label for="'+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+'">'+this.escapeExpression((a=null!=(a=e.name||(null!=t?t.name:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"name",hash:{},data:i}):a))+":</label>\n"+(null!=(r=e.each.call(t,null!=t?t.customFields:t,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+"  </p>\n</div>\n"},useData:!0});return e.registerPartial("$app/templates/custom_field_set",n),n}),define("hbs!$app/templates/try_again",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){return'<div class="try-again js-try-again">\n  <a href="#" class="button button-default button-block button-small">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"try_again_prompt",{name:"t",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0});return e.registerPartial("$app/templates/try_again",n),n}),define("$app/ui/shared/bundle_button",["flight/lib/component","$app/data/boostable_retargeting","$app/ui/shared/with_bundled_product_list","$app/ui/shared/with_persistent_bundle","$app/ui/product/third_party_analytics","$app/ui/product/with_payment_form","$app/ui/product/with_credit_card_on_payment_form","$app/ui/product/with_offer_code","$app/ui/product/with_payment_blurb","$app/ui/product/with_receipt","$app/ui/product/with_variants","hbs!$app/templates/receipt_entry","hbs!$app/templates/buyer_bar","hbs!$app/templates/custom_field_set","hbs!$app/templates/try_again","$app/utils/checkout","$app/utils/gumroad_utils","$app/utils/with_sha","$app/templates/helpers/t","$app/templates/helpers/t_upcase"],function(t,e,n,i,r,a,s,o,l,u,c,h,d,p,f,m,g,y){function v(){this.defaultAttrs({bundleCircleSelector:".js-bundle-circle",bundleTooltipTriggerSelector:".js-bundle-tooltip-trigger",bundleStartCheckoutButtonSelector:".js-bundle-start-trigger",bundleCancelCheckoutButtonSelector:".js-bundle-cancel-trigger",bundlePayButtonSelector:".js-bundle-pay-trigger",bundleToolTipSelector:".js-bundle-tool-tip",bundledListContainerSelector:".js-bundled-product-list-holder",bundleCheckoutFormSelector:".js-bundle-checkout-form",bundleCheckoutFormFullNameSelector:".js-bundle-checkout-form .full_name.first",bundleCheckoutFormEmailSelector:".js-bundle-checkout-form .email",bundleCheckoutFormPasswordSelector:".js-bundle-checkout-form .password",bundleCheckoutFormCcNumberSelector:".js-bundle-checkout-form .cc_number",bundleCheckoutFormExpiryDateSelector:".js-bundle-checkout-form .expiry_date",bundleCheckoutFormCvcSelector:".js-bundle-checkout-form .cv_code",bundleRequiresAccountSelector:".js-bundle-account-required",bundleMessageSelector:".js-bundle-message",buyerBarContentSelector:".js-buyer-bar-content",customFieldInputSelector:".js-custom-field",customFieldsContainerSelector:".js-custom-fields-container",customFieldSetSelector:".js-custom-field-set",offerCodeContainerSelector:".js-offer-code-container",tryAgainSelector:".js-try-again",showingCheckout:!1,productsInBundle:[]}),this.showProductCountInCircle=function(){0===this.select("bundleCircleSelector").length&&this.select("buyerBarContentSelector").html(d($(".js-login").data("user")||{})),this.attr.productsInBundle.length>0?(this.select("bundleCircleSelector").text(this.attr.productsInBundle.length),this.select("bundleTooltipTriggerSelector").addClass("showing"),this.select("bundleToolTipSelector").addClass("showing")):(this.select("bundleCircleSelector").text(""),this.select("bundleTooltipTriggerSelector").removeClass("showing"),this.select("bundleToolTipSelector").removeClass("showing"))},this.updateBundleButton=function(){this.updateBundleMessage(),this.attr.bundleRequiresAccount=this.bundleContainsSubscriptions()&&!(this.attr.user&&this.attr.user.is_logged_in),this.setCardSaveRequired(this.bundleNeedsCardSaved()),!this.bundleContainsSubscriptions()&&this.attr.user&&this.attr.user.is_logged_in?this.select("keepOnFileSelector").show():this.select("keepOnFileSelector").hide(),this.bundleContainsOfferCodeField()?this.select("offerCodeContainerSelector").show():this.select("offerCodeContainerSelector").hide(),this.attr.productsInBundle.length>0?(this.select("bundleCircleSelector").text(this.attr.productsInBundle.length),this.totalBundlePriceCents()>0||this.totalBundleShippingRateCents()>0?this.showCreditCardForm():this.hideCreditCardForm(),this.productsWithShipping()>0?this.showShippingInputs():this.hideShippingInputs(),this.initiatePriceInformationUpdate(),this.attr.showingCheckout?this.$node.addClass("showing-checkout").show():this.$node.removeClass("showing-checkout"),this.select("bundleRequiresAccountSelector").toggle(this.attr.bundleRequiresAccount),this.$node.addClass("showing-bundle").show(),this.trigger("uiNeedsToHideBuyerMenu")):this.trigger("uiHideFooter"),this.showProductCountInCircle(),this.trigger("uiNeedsToSetPersistentBundle",{products:this.attr.productsInBundle}),this.trigger("uiResizeCheckoutArea")},this.updateBundleMessage=function(){this.$node.data("creator")?this.select("bundleMessageSelector").text(I18n.t("js.back_to_bundle_product_count_creator",{count:this.attr.productsInBundle.length,creator:this.$node.data("creator")})):this.select("bundleMessageSelector").text(I18n.t("js.back_to_bundle_product_count",{count:this.attr.productsInBundle.length}))},this.toggleBundleTooltip=function(t){t.preventDefault(),this.select("bundleToolTipSelector").toggleClass("showing"),this.select("bundleToolTipSelector").hasClass("showing")?(this.$node.addClass("showing-bundle"),this.trigger("uiNeedsToHideBuyerMenu")):this.$node.removeClass("showing-bundle")},this.hideBundle=function(t){this.select("bundleToolTipSelector").removeClass("showing"),this.$node.removeClass("showing-bundle")},this.addProductToBundle=function(t,e){0==this.attr.productsInBundle.length&&(this.attr.failedBundledProducts=[],this.attr.succeededBundledProducts=[],this.attr.numProductsInBundlePaymentCompleted=0,this.attr.receiptEntries="",this.attr.errorReceiptEntries=""),e.customFields&&e.customFields.length>0&&this.select("customFieldsContainerSelector").append(p(e)).show(),delete e.sha,e.sha=this.stringToSha(JSON.stringify(e)),this.attr.productsInBundle.push(e),this.attr.sellerId=e.sellerId,this.updateBundleButton()},this.removeProductFromBundle=function(t,e){this.trigger("uiNeedsToTrackECommerceCartUpdate",{cartAction:"remove",externalId:this.attr.productsInBundle[e.index].externalId}),this.attr.productsInBundle.splice(e.index,1),this.select("customFieldSetSelector").get(e.index)&&this.select("customFieldSetSelector").get(e.index).remove(),this.select("customFieldSetSelector").length<1&&this.select("customFieldsContainerSelector").hide(),this.updateBundleButton()},this.totalBundlePriceCents=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)t+=this.attr.productsInBundle[e].perceivedPriceCents;return t},this.totalBundlePrice=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++){var n=this.attr.productsInBundle[e];t+=this.toDisplayCurrency(n.perceivedPriceCents,n.isSingleUnit,n.exchangeRate)}return t},this.totalBundleTax=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++){var n=this.attr.productsInBundle[e];t+=this.toDisplayCurrency(parseInt(this.attr.productsInBundle[e].taxCents),n.isSingleUnit,n.exchangeRate)}return t},this.updateCustomerSurchargeForBundle=function(t,e){for(var n=0;n<this.attr.productsInBundle.length;n++)if(this.attr.productsInBundle[n].permalink==e.permalink){var i=this.attr.productsInBundle[n];i.taxCents=e.tax_cents,i.isTaxExclusive=e.is_price_tax_exclusive,i.isVat=e.tax_info&&e.tax_info.is_vat,i.taxCountry=e.tax_info&&e.tax_info.country,i.shippingRateCents=e.shipping_rate_cents,i.formattedShippingRate=e.formatted_shipping_rate}this.updateCustomerSurcharge(),this.updateShippingRate()},this.totalBundleShippingRateDisplayCurrencyCents=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++){var n=this.attr.productsInBundle[e],i=parseInt(this.attr.productsInBundle[e].shippingRateCents);t+=this.toDisplayCurrencyCents(i,n.isSingleUnit,n.exchangeRate)}return t},this.totalBundleShippingRate=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++){var n=this.attr.productsInBundle[e],i=parseInt(this.attr.productsInBundle[e].shippingRateCents);t+=this.toDisplayCurrency(i,n.isSingleUnit,n.exchangeRate)}return t},this.totalBundleShippingRateCents=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)t+=parseInt(this.attr.productsInBundle[e].shippingRateCents);return t},this.productsWithExchangeRates=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)1!=parseInt(this.attr.productsInBundle[e].exchangeRate)&&(t+=1);return t},this.bundleExclusiveTax=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)if(this.attr.productsInBundle[e].isTaxExclusive&&!this.attr.productsInBundle[e].isVat){var n=this.attr.productsInBundle[e],i=parseInt(n.taxCents);t+=this.toDisplayCurrency(i,n.isSingleUnit,n.exchangeRate)}return t},this.bundleVat=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)if(this.attr.productsInBundle[e].isVat){var n=this.attr.productsInBundle[e],i=parseInt(n.taxCents);t+=this.toDisplayCurrency(i,n.isSingleUnit,n.exchangeRate)}return t},this.bundleExclusiveVat=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)if(this.attr.productsInBundle[e].isTaxExclusive&&this.attr.productsInBundle[e].isVat){var n=this.attr.productsInBundle[e],i=parseInt(n.taxCents);t+=this.toDisplayCurrency(i,n.isSingleUnit,n.exchangeRate)}return t},this.bundleTaxCountry=function(){for(var t=0;t<this.attr.productsInBundle.length;t++)if(this.attr.productsInBundle[t].taxCountry)return this.attr.productsInBundle[t].taxCountry;return!1},this.productsWithShipping=function(){for(var t=0,e=0;e<this.attr.productsInBundle.length;e++)this.attr.productsInBundle[e].shippingRequired&&(t+=1);return t},this.bundleContainsSubscriptions=function(){for(var t=0;t<this.attr.productsInBundle.length;t++)if(this.attr.productsInBundle[t].isRecurringBilling)return!0;return!1},this.bundleContainsPreOrders=function(){for(var t=0;t<this.attr.productsInBundle.length;t++)if(this.attr.productsInBundle[t].isPreorder)return!0;return!1},this.bundleContainsOfferCodeField=function(){for(var t=0;t<this.attr.productsInBundle.length;t++)if(this.attr.productsInBundle[t].hasOfferCodeField)return!0;return!1},this.bundleNeedsCardSaved=function(){return this.bundleContainsSubscriptions()||this.bundleContainsPreOrders()},this.startBundleCheckout=function(t){t&&t.preventDefault(),m.isUsingCheckout()?this.startExternalCheckout():(this.trigger("uiNeedsToStartBundleCheckout"),this.attr.showingCheckout=!0,this.select("bundledListContainerSelector").slideUp(),this.select("bundleCheckoutFormSelector").slideDown(),this.updateBundleButton())},this.cancelBundleCheckout=function(t){t&&t.preventDefault(),this.attr.showingCheckout=!1,this.select("bundledListContainerSelector").slideDown(),this.select("bundleCheckoutFormSelector").slideUp(function(){this.trigger("uiNeedsToCancelBundleCheckout")}.bind(this)),this.updateBundleButton()},this.initiateValidationForProductBundle=function(t){return t&&t.preventDefault(),this.validateBundleCheckoutForm()&&(this.select("bundledListContainerSelector").slideUp(),this.showPaymentAsProcessing(),g.isExternalPresentation()?this.continueWithPayment():this.verifyShippingAddress()),!1},this.initiatePaymentForProductBundle=function(t){t&&t.preventDefault(),this.attr.bundleRequiresAccount?(this.attr.preventReload=!0,this.trigger("uiNeedsToCreateAccount",{serializedForm:this.simpleSerialize({"user[full_name]":this.select("bundleCheckoutFormFullNameSelector").val(),"user[email]":this.select("bundleCheckoutFormEmailSelector").val(),"user[password]":this.select("bundleCheckoutFormPasswordSelector").val(),"user[buyer_signup]":!0})})):this.makePaymentForProductBundle()},this.completeAccountCreation=function(t,e){this.select("buyerBarContentSelector").html(d(e.buyer_bar_data)),this.makePaymentForProductBundle()},this.failedAccountCreation=function(t,e){this.trigger("uiBundledProductPaymentFailed",e)},this.makePaymentForProductBundle=function(){return this.setPaymentAsProcessingForMultiBuyMode(),this.trigger("uiNeedsToTrackUserActionEvent",{name:"process_payment"}),this.trigger("uiSetFriendValue"),this.setCreditCardFormInUse(0!=this.totalBundlePriceCents()||0!=this.totalBundleShippingRateCents()),this.getReusableCardParams(function(t){this.makePaymentForProducts(t.cardParams)}.bind(this)),!1},this.makePaymentForProducts=function(t){for(var e=0;e<this.attr.productsInBundle.length;e++){var n=this.attr.productsInBundle[e];this.makePaymentForProduct(n,t)}},this.makePaymentForProduct=function(t,e){0==t.price&&0==t.shippingRateCents?this.makePaymentForProductWithCard(t,{}):e?this.makePaymentForProductWithCard(t,e):this.getCardParams(function(e){this.makePaymentForProductWithCard(t,e.cardParams)}.bind(this))},this.makePaymentForProductWithCard=function(t,e){var n={permalink:t.permalink,is_multi_buy:"true",cc_zipcode_required:this.select("ccZipcodeRequiredSelector").val(),cc_zipcode:this.select("ccZipcodeFieldSelector").val(),perceived_price_cents:t.perceivedPriceCents,is_preorder:t.isPreorder,is_physical:t.isPhysical,offer_code_name:t.offerCodeName?t.offerCodeName:"",was_product_recommended:t.wasProductRecommended,recommended_by:t.recommendedBy};t.variants&&$.each(t.variants,function(t,e){n["variants["+t+"]"]=e}),this.select("customFieldSetSelector").filter('[data-permalink="'+t.permalink+'"]').find("input").each(function(t,e){n[encodeURIComponent("custom_fields["+$(e).attr("name")+"]")]=$(e).val()}),"undefined"!=typeof t.priceRange&&(n.price_range=t.priceRange);var i=this.getSerializedBundleForm()+"&"+this.simpleSerialize(n)+"&"+$.param(e)+"&"+$.param({tax_country_election:this.attr.taxCountry})+"&"+$.param({is_rental:t.isRentalModeActive})+"&"+$.param({quantity:t.quantity});t.isRecurringBilling&&(i+="&"+$.param({price_id:t.selectedPriceInfo.id})),this.trigger("uiNeedsToTrackProductSpecificEvent",{name:"process_payment",permalink:t.permalink}),this.trigger("uiNeedsToMakePayment",{permalink:t.permalink,is_bundled:!0,payingWithPayPal:this.attr.payingWithPayPal,name:t.name,formattedPrice:t.currency+t.formattedPrice,serializedForm:i,sha:t.sha})},this.handleCompletionForBundledProduct=function(t,e){e.is_open_in_appable&&delete e.is_open_in_appable;var n=h(e);e.error_message?(this.attr.errorReceiptEntries+=n,this.attr.failedBundledProducts.push(e.permalink)):(this.attr.receiptEntries+=n,this.attr.succeededBundledProducts.push(e.name),e.success&&(this.trigger(this.$node,"uiToAddThirdPartyAnalytics",{permalink:e.permalink,purchase_id:e.id}),this.trigger("uiNeedsToTrackECommerceOrder",{externalId:e.id,total:Number(e.total_price_including_tax_and_shipping.replace(/[^0-9\.]+/g,"")),tax:Number(e.non_formatted_seller_tax_amount)||0,shipping:Number(e.shipping_amount.replace(/[^0-9\.]+/g,""))||0,currency:e.currency_type.toUpperCase(),productExternalId:e.product_id}))),this.attr.numProductsInBundlePaymentCompleted++,this.attr.numProductsInBundlePaymentCompleted==this.attr.productsInBundle.length&&(this.showProductBundleReceipt(),this.attr.failedBundledProducts=[],this.attr.succeededBundledProducts=[])},this.handleErrorForBundledProduct=function(t,e){var n=e&&e.error_message?e.error_message:I18n.t("js.something_went_wrong_notice");e.error_message=n,e.zipcode_required?(this.select("bundlePayButtonSelector").prop("disabled",!1).text(I18n.t("js.pay_prompt")),this.select("receiptContainerSelector").fadeOut()):e.is_tax_mismatch?(this.select("bundlePayButtonSelector").prop("disabled",!1).text(I18n.t("js.pay_prompt")),this.select("receiptContainerSelector").fadeOut(),this.showNewVatCountryOptions(t,e)):this.trigger("uiBundledProductPaymentCompleted",e)},this.handleTimeoutForBundledProduct=function(t,e){e.extra_purchase_notice=I18n.t("js.purchase_with_name_processing_check_email_notice",{name:e.name}),this.trigger("uiNeedsToRemoveProductFromPersistentBundle",e),this.trigger("uiBundledProductPaymentCompleted",e)},this.showProductBundleReceipt=function(){this.select("bundleMessageSelector").text(I18n.t("js.back_to_bundle_product_count_completed_creator",{count:this.attr.succeededBundledProducts.length,creator:this.$node.data("creator")})),this.select("bundleCancelCheckoutButtonSelector").hide(),
this.trigger("completedBundle"),this.updateSocialShareTextForProductBundle(this.attr.succeededBundledProducts),this.select("receiptEntriesSelector").html(this.attr.receiptEntries+this.attr.errorReceiptEntries),this.attr.failedBundledProducts&&this.attr.failedBundledProducts.length>0&&this.select("receiptEntriesSelector").append(f({message:I18n.t("js.try_again_message")})),this.showReceipt(!1)},this.tryAgain=function(){this.attr.productsInBundle=[],this.trigger("uiNeedsToResetBundledList"),this.select("purchaseFormSelector").show(),this.select("bundleCancelCheckoutButtonSelector").show(),this.select("receiptEntriesSelector").empty(),this.hideReceipt(),this.trigger("uiNeedsToStartBundleCheckout"),this.updateBundleButton()},this.getSerializedBundleForm=function(){var t="textarea, input:not("+this.attr.utf8Selector+", "+this.attr.authenticityTokenSelector+", "+this.attr.permalinkSelector+", "+this.attr.isPreorderSelector+", "+this.attr.isPhysicalSelector+", "+this.attr.parentIdSelector+", "+this.attr.saveCardSelector+", "+this.attr.ccNumberSelector+", "+this.attr.expiryDateSelector+", "+this.attr.cvCodeSelector;return t+=0==this.productsWithShipping()?", "+this.attr.zipCodeSelector+"), select:not("+this.attr.countrySelector+")":"), select",this.select("bundleCheckoutFormSelector").find(t).serialize()},this.setCurrentUserInfo=function(t,e){this.attr.isCurrentUserSet||(this.attr.user=e,this.setCreditCard(),this.setEmail(),this.attr.isCurrentUserSet=!0)},this.simpleSerialize=function(t){var e=[];for(var n in t)e.push(n+"="+encodeURIComponent(t[n]).replace(/%20/g,"+"));return e.join("&")},this.attachThirdPartyAnalytics=function(){r.attachTo(this.$node)},this.attachBoostableRetargeting=function(){e.attachTo(this.$node)},this.startExternalCheckout=function(){this.trigger("uiNeedsToCreateBundle",{products:this.attr.productsInBundle})},this.redirectToCheckout=function(t,e){window.location=e.host+Routes.checkout_path(e.bundle_id)},this.initializeBundleCheckout=function(t,e){if(0==this.attr.productsInBundle.length&&(this.attr.failedBundledProducts=[],this.attr.succeededBundledProducts=[],this.attr.numProductsInBundlePaymentCompleted=0,this.attr.receiptEntries="",this.attr.errorReceiptEntries=""),e.customFields&&e.customFields.length>0&&this.select("customFieldsContainerSelector").append(p(e)).show(),e.products.length>0){this.attr.productsInBundle=e.products,this.attr.sellerId=this.attr.productsInBundle[0].sellerId,$(document).trigger("dataCurrentUserInfo",this.$node.data("user")),this.setShippingInfo(),this.updateBundleButton();for(var n=0;n<this.attr.productsInBundle.length;n++)this.trigger("uiAddProductToBundledList",this.attr.productsInBundle[n])}this.trigger("uiShowFooter")},this.addOfferCodeToBundle=function(t,e){this.updateOfferCode(null,e)},this.after("initialize",function(){this.on(document,"dataCurrentUserInfo",this.setCurrentUserInfo),this.on(document,"dataAccount",this.completeAccountCreation),this.on(document,"dataFailedToCreateAccount",this.failedAccountCreation),this.on(document,"dataBundleCreated",this.redirectToCheckout),this.on(document,"addProductToBundle",this.addProductToBundle),this.on(document,"removeProductFromBundle",this.removeProductFromBundle),this.on(document,"uiBundledProductPaymentCompleted",this.handleCompletionForBundledProduct),this.on(document,"uiBundledProductPaymentFailed",this.handleErrorForBundledProduct),this.on(document,"uiBundledProductPaymentTimeout",this.handleTimeoutForBundledProduct),this.on(document,"dataCustomerSurchargeForBundle",this.updateCustomerSurchargeForBundle),this.on(document,"uiThirdPartyAnalyticsEnabled",this.attachThirdPartyAnalytics),this.on(document,"uiShowOverlayCreditCardForm",this.startBundleCheckout),this.on(document,"uiShouldHideBundle",this.hideBundle),this.on(document,"uiNeedsToInitializeBundleCheckout",this.initializeBundleCheckout),this.on(document,"uiNeedsToEnableRetargeting",this.attachBoostableRetargeting),this.on(document,"uiNeedsToShowProductCountInCircle",this.showProductCountInCircle),this.on(document,"uiNeedsToAddOfferCodeToBundle",this.addOfferCodeToBundle),this.on("click",{bundlePayButtonSelector:this.initiateValidationForProductBundle,bundleStartCheckoutButtonSelector:this.startBundleCheckout,bundleCancelCheckoutButtonSelector:this.cancelBundleCheckout,bundleTooltipTriggerSelector:this.toggleBundleTooltip,tryAgainSelector:this.tryAgain})})}return t(v,n,i,a,s,o,l,u,c,y)}),define("$app/ui/shared/login",["flight/lib/component","$app/utils/auth_modal_setup","hbs!$app/templates/buyer_bar","$app/utils/checkout","$app/templates/helpers/t"],function(t,e,n,i){function r(){this.defaultAttrs({buyerMenuTriggerSelector:".js-buyer-menu-trigger",buyerCircleSelector:".js-buyer-circle",buyerMenuSelector:".js-buyer-menu",buyerBarContentSelector:".js-buyer-bar-content",bundleToolTipSelector:".js-bundle-tool-tip",userInfoSet:!1}),this.toggleBuyerMenu=function(t){t.preventDefault(),this.select("buyerMenuSelector").toggleClass("showing"),this.select("buyerMenuSelector").hasClass("showing")&&!i.isOnCheckoutPage()&&this.trigger("uiShouldHideBundle")},this.showBuyerMenu=function(t){i.isOnCheckoutPage()||(this.select("buyerMenuSelector").addClass("showing"),this.trigger("uiNeedsToShowBundle"))},this.hideBuyerMenu=function(t){i.isOnCheckoutPage()||this.select("buyerMenuSelector").removeClass("showing")},this.setCurrentUserInfo=function(t,i){this.userInfoSet||(this.userInfoSet=!0,this.select("buyerBarContentSelector").html(n(i)),i.profile_picture_url?this.select("buyerCircleSelector").attr("style","background-image: url("+i.profile_picture_url+");").addClass("showing-profile-picture"):this.select("buyerCircleSelector").addClass("empty showing-profile-picture"),e(),this.$node.fadeIn(),this.trigger("uiFadeInSharing"))},this.hideLoginSection=function(){this.$node.fadeOut()},this.showLoginSection=function(){this.$node.fadeIn()},this.resizeCheckoutArea=function(){this.$node.css("height",this.select("bundleToolTipSelector").outerHeight()+90)},this.after("initialize",function(){this.on(document,"dataCurrentUserInfo",this.setCurrentUserInfo),this.on(document,"uiNeedsToShowBuyerMenu",this.showBuyerMenu),this.on(document,"uiNeedsToHideBuyerMenu",this.hideBuyerMenu),this.on(document,"uiShouldShowEditing",this.hideLoginSection),this.on(document,"uiShouldHideEditing",this.showLoginSection),this.on(document,"uiResizeCheckoutArea",this.resizeCheckoutArea);var t=this.$node.data("user");void 0!=t&&(this.trigger("dataCurrentUserInfo",t),t.is_owner&&this.attr.username&&this.trigger("uiNeedsToGetCustomizationModules",{username:this.attr.username})),this.on("click",{buyerMenuTriggerSelector:this.toggleBuyerMenu})})}return t(r)}),define("hbs!$app/templates/custom_attributes",["hbs","hbs/handlebars"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return'  <li class="js-custom-file-info-attribute"><span>'+this.escapeExpression((r=null!=(r=e.name||(null!=t?t.name:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"name",hash:{},data:i}):r))+"</span> <strong>"+this.escapeExpression((r=null!=(r=e.value||(null!=t?t.value:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"value",hash:{},data:i}):r))+"</strong></li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return null!=(r=e.each.call(t,null!=t?t.custom_attributes:t,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:""},useData:!0});return e.registerPartial("$app/templates/custom_attributes",n),n}),/*! jQuery UI - v1.10.4 - 2014-02-14
* http://jqueryui.com
* Includes: jquery.ui.effect.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
function(t,e){var n="ui-effects-";t.effects={effect:{}},function(t,e){function n(t,e,n){var i=h[e.type]||{};return null==t?n||!e.def?null:e.def:(t=i.floor?~~t:parseFloat(t),isNaN(t)?e.def:i.mod?(t+i.mod)%i.mod:0>t?0:t>i.max?i.max:t)}function i(n){var i=u(),r=i._rgba=[];return n=n.toLowerCase(),f(l,function(t,a){var s,o=a.re.exec(n),l=o&&a.parse(o),u=a.space||"rgba";return l?(s=i[u](l),i[c[u].cache]=s[c[u].cache],r=i._rgba=s._rgba,!1):e}),r.length?("0,0,0,0"===r.join()&&t.extend(r,a.transparent),i):a[n]}function r(t,e,n){return n=(n+1)%1,1>6*n?t+6*(e-t)*n:1>2*n?e:2>3*n?t+6*(e-t)*(2/3-n):t}var a,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",o=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],u=t.Color=function(e,n,i,r){return new t.Color.fn.parse(e,n,i,r)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=u.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),u.fn=t.extend(u.prototype,{parse:function(r,s,o,l){if(r===e)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(s),s=e);var h=this,d=t.type(r),p=this._rgba=[];return s!==e&&(r=[r,s,o,l],d="array"),"string"===d?this.parse(i(r)||a._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=n(r[e.idx],e)}),this):"object"===d?(r instanceof u?f(c,function(t,e){r[e.cache]&&(h[e.cache]=r[e.cache].slice())}):f(c,function(e,i){var a=i.cache;f(i.props,function(t,e){if(!h[a]&&i.to){if("alpha"===t||null==r[t])return;h[a]=i.to(h._rgba)}h[a][e.idx]=n(r[t],e,!0)}),h[a]&&0>t.inArray(null,h[a].slice(0,3))&&(h[a][3]=1,i.from&&(h._rgba=i.from(h[a])))}),this):e},is:function(t){var n=u(t),i=!0,r=this;return f(c,function(t,a){var s,o=n[a.cache];return o&&(s=r[a.cache]||a.to&&a.to(r._rgba)||[],f(a.props,function(t,n){return null!=o[n.idx]?i=o[n.idx]===s[n.idx]:e})),i}),i},_space:function(){var t=[],e=this;return f(c,function(n,i){e[i.cache]&&t.push(n)}),t.pop()},transition:function(t,e){var i=u(t),r=i._space(),a=c[r],s=0===this.alpha()?u("transparent"):this,o=s[a.cache]||a.to(s._rgba),l=o.slice();return i=i[a.cache],f(a.props,function(t,r){var a=r.idx,s=o[a],u=i[a],c=h[r.type]||{};null!==u&&(null===s?l[a]=u:(c.mod&&(u-s>c.mod/2?s+=c.mod:s-u>c.mod/2&&(s-=c.mod)),l[a]=n((u-s)*e+s,r)))}),this[r](l)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),r=u(e)._rgba;return u(t.map(n,function(t,e){return(1-i)*r[e]+i*t}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),u.fn.parse.prototype=u.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,n,i=t[0]/255,r=t[1]/255,a=t[2]/255,s=t[3],o=Math.max(i,r,a),l=Math.min(i,r,a),u=o-l,c=o+l,h=.5*c;return e=l===o?0:i===o?60*(r-a)/u+360:r===o?60*(a-i)/u+120:60*(i-r)/u+240,n=0===u?0:.5>=h?u/c:u/(2-c),[Math.round(e)%360,n,h,null==s?1:s]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,n=t[1],i=t[2],a=t[3],s=.5>=i?i*(1+n):i+n-i*n,o=2*i-s;return[Math.round(255*r(o,s,e+1/3)),Math.round(255*r(o,s,e)),Math.round(255*r(o,s,e-1/3)),a]},f(c,function(i,r){var a=r.props,s=r.cache,l=r.to,c=r.from;u.fn[i]=function(i){if(l&&!this[s]&&(this[s]=l(this._rgba)),i===e)return this[s].slice();var r,o=t.type(i),h="array"===o||"object"===o?i:arguments,d=this[s].slice();return f(a,function(t,e){var i=h["object"===o?t:e.idx];null==i&&(i=d[e.idx]),d[e.idx]=n(i,e)}),c?(r=u(c(d)),r[s]=d,r):u(d)},f(a,function(e,n){u.fn[e]||(u.fn[e]=function(r){var a,s=t.type(r),l="alpha"===e?this._hsla?"hsla":"rgba":i,u=this[l](),c=u[n.idx];return"undefined"===s?c:("function"===s&&(r=r.call(this,c),s=t.type(r)),null==r&&n.empty?this:("string"===s&&(a=o.exec(r),a&&(r=c+parseFloat(a[2])*("+"===a[1]?1:-1))),u[n.idx]=r,this[l](u)))})})}),u.hook=function(e){var n=e.split(" ");f(n,function(e,n){t.cssHooks[n]={set:function(e,r){var a,s,o="";if("transparent"!==r&&("string"!==t.type(r)||(a=i(r)))){if(r=u(a||r),!d.rgba&&1!==r._rgba[3]){for(s="backgroundColor"===n?e.parentNode:e;(""===o||"transparent"===o)&&s&&s.style;)try{o=t.css(s,"backgroundColor"),s=s.parentNode}catch(l){}r=r.blend(o&&"transparent"!==o?o:"_default")}r=r.toRgbaString()}try{e.style[n]=r}catch(l){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=u(e.elem,n),e.end=u(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}})},u.hook(s),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(n,i){e["border"+i+"Color"]=t}),e}},a=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(e){var n,i,r=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,a={};if(r&&r.length&&r[0]&&r[r[0]])for(i=r.length;i--;)n=r[i],"string"==typeof r[n]&&(a[t.camelCase(n)]=r[n]);else for(n in r)"string"==typeof r[n]&&(a[n]=r[n]);return a}function i(e,n){var i,r,s={};for(i in n)r=n[i],e[i]!==r&&(a[i]||(t.fx.step[i]||!isNaN(parseFloat(r)))&&(s[i]=r));return s}var r=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,n){t.fx.step[n]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,n,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,a,s,o){var l=t.speed(a,s,o);return this.queue(function(){var a,s=t(this),o=s.attr("class")||"",u=l.children?s.find("*").addBack():s;u=u.map(function(){var e=t(this);return{el:e,start:n(this)}}),a=function(){t.each(r,function(t,n){e[n]&&s[n+"Class"](e[n])})},a(),u=u.map(function(){return this.end=n(this.el[0]),this.diff=i(this.start,this.end),this}),s.attr("class",o),u=u.map(function(){var e=this,n=t.Deferred(),i=t.extend({},l,{queue:!1,complete:function(){n.resolve(e)}});return this.el.animate(this.diff,i),n.promise()}),t.when.apply(t,u.get()).done(function(){a(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(s[0])})})},t.fn.extend({addClass:function(e){return function(n,i,r,a){return i?t.effects.animateClass.call(this,{add:n},i,r,a):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(n,i,r,a){return arguments.length>1?t.effects.animateClass.call(this,{remove:n},i,r,a):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(n){return function(i,r,a,s,o){return"boolean"==typeof r||r===e?a?t.effects.animateClass.call(this,r?{add:i}:{remove:i},a,s,o):n.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},r,a,s)}}(t.fn.toggleClass),switchClass:function(e,n,i,r,a){return t.effects.animateClass.call(this,{add:n,remove:e},i,r,a)}})}(),function(){function i(e,n,i,r){return t.isPlainObject(e)&&(n=e,e=e.effect),e={effect:e},null==n&&(n={}),t.isFunction(n)&&(r=n,i=null,n={}),("number"==typeof n||t.fx.speeds[n])&&(r=i,i=n,n={}),t.isFunction(i)&&(r=i,i=null),n&&t.extend(e,n),i=i||n.duration,e.duration=t.fx.off?0:"number"==typeof i?i:i in t.fx.speeds?t.fx.speeds[i]:t.fx.speeds._default,e.complete=r||n.complete,e}function r(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.4",save:function(t,e){for(var i=0;e.length>i;i++)null!==e[i]&&t.data(n+e[i],t[0].style[e[i]])},restore:function(t,i){var r,a;for(a=0;i.length>a;a++)null!==i[a]&&(r=t.data(n+i[a]),r===e&&(r=""),t.css(i[a],r))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var n,i;switch(t[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=t[0]/e.height}switch(t[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=t[1]/e.width}return{x:i,y:n}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var n={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},i=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:e.width(),height:e.height()},a=document.activeElement;try{a.id}catch(s){a=document.body}return e.wrap(i),(e[0]===a||t.contains(e[0],a))&&t(a).focus(),i=e.parent(),"static"===e.css("position")?(i.css({position:"relative"}),e.css({position:"relative"})):(t.extend(n,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,i){n[i]=e.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(r),i.css(n).show()},removeWrapper:function(e){var n=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===n||t.contains(e[0],n))&&t(n).focus()),e},setTransition:function(e,n,i,r){return r=r||{},t.each(n,function(t,n){var a=e.cssUnit(n);a[0]>0&&(r[n]=a[0]*i+a[1])}),r}}),t.fn.extend({effect:function(){function e(e){function i(){t.isFunction(a)&&a.call(r[0]),t.isFunction(e)&&e()}var r=t(this),a=n.complete,o=n.mode;(r.is(":hidden")?"hide"===o:"show"===o)?(r[o](),i()):s.call(r[0],n,i)}var n=i.apply(this,arguments),r=n.mode,a=n.queue,s=t.effects.effect[n.effect];return t.fx.off||!s?r?this[r](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):a===!1?this.each(e):this.queue(a||"fx",e)},show:function(t){return function(e){if(r(e))return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(t.fn.show),hide:function(t){return function(e){if(r(e))return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(t.fn.hide),toggle:function(t){return function(e){if(r(e)||"boolean"==typeof e)return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(t.fn.toggle),cssUnit:function(e){var n=this.css(e),i=[];return t.each(["em","px","%","pt"],function(t,e){n.indexOf(e)>0&&(i=[parseFloat(n),e])}),i}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,n){e[n]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,n=4;((e=Math.pow(2,--n))-1)/11>t;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,n){t.easing["easeIn"+e]=n,t.easing["easeOut"+e]=function(t){return 1-n(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?n(2*t)/2:1-n(-2*t+2)/2}})}()}(jQuery),define("$vendor/jquery-ui-effects-core.min",function(){}),define("$app/ui/product/with_product_main",["$app/utils/with_url","$app/ui/shared/with_form_base","hbs!$app/templates/custom_attributes","flight/lib/compose","$vendor/jquery-ui-effects-core.min","$vendor/jquery.tipsy"],function(t,e,n,i){function r(){i.mixin(this,[t,e]),this.defaultAttrs({productMainSelector:".product-main",productContentSelector:".product-content",productInformationSelector:".js-product-information",previewContainerSelector:".preview-container",processingPreviewContainerSelector:".processing.preview_container",productLeftContainerSelector:".products-left-container",productLeftSelector:".products-left",contentHeaderSelector:".product-content h1",productPriceSelector:".product-price-tag",priceSelector:".product-price-tag .price",oldPriceSelector:".product-price-tag .old-price",wantContainerSelector:".want-container",wantFormSelector:".js-i-want-this-form",alreadyBoughtNoticeSelector:".js-already-bought-notice",alreadyBoughtNoticeButtonSelector:".js-already-bought-notice-button",actionsContainerSelector:".actions-container",wantThisContainerSelector:".i-want-this-container",wantButtonSelector:".i_want_this_button",territoryBlockedSelector:".territory_blocked",notForSaleNoticeSelector:".not-for-sale-notice",descriptionContainerSelector:".description-container",nameSelector:'h1[itemprop="name"] strong',noneRemainingNoticeSelector:".none-remaining-notice",giftSignifierSelector:'input[name="is_gift"]',linkCustomSummarySelector:"#js-main-product-pane ul li.summary",linkInfoAttributesSelector:"#js-main-product-pane",linkInfoAttributesListSelector:"#js-main-product-pane ul",linkFileInfoAttributesSelector:".js-file-info-attribute",linkCustomFileInfoAttributesSelector:".js-custom-file-info-attribute",canGiftSelector:'input[name="can_gift"]',purchaseModeSelector:".js-purchase-mode",rentalTermsSelector:".js-rental-terms",subscriptionChargeOccurrencesMessageSelector:".js-subscription-charge-occurrences-message",paymentOptionSelector:".js-payment-option",priceTagSelector:".js-price-tag",wantThis:!1,showingAddToBundle:!1,isDemo:!1,isOutboundEmbed:!1,isUsingBundle:!0}),this.redirectToPaymentForm=function(){var t="?wanted=true&referrer="+document.referrer;this.attr.selectedPriceInfo&&this.attr.selectedPriceInfo.recurrence&&(t+="&"+this.attr.selectedPriceInfo.recurrence+"=true"),window.top.location.href=Routes.short_link_path(this.attr.permalink)+t},this.trackAction=function(){this.trigger("uiNeedsToTrackActivityWithSellerGoogleAnalytics",{permalink:this.attr.permalink,action:"iwantthis"}),this.trigger("uiNeedsToTrackECommerceCartUpdate",{cartAction:"add",externalId:this.attr.externalId,name:this.attr.name,vertical:this.attr.vertical,price:this.attr.price,quantity:this.attr.quantity,currency:this.attr.currency}),this.trigger("uiNeedsToTrackProductSpecificEvent",{name:"i_want_this",permalink:this.attr.permalink,wasProductRecommended:this.attr.wasProductRecommended})},this.canShowPaymentFormFromOverlay=function(){if(this.attr.isOverlayPage&&this.attr.wantThis){if(this.attr.overlayPaymentOption)return this.triggerPaymentOptionUpdate(),this.attr.overlayPaymentOption=!1,!1;if(this.attr.hasVariants&&!this.attr.variantsHaveBeenShown)return this.attr.variantSelectionRequired=!0,!1}return!0},this.showPaymentFormIfPossible=function(t,e){if(t&&t.preventDefault(),void 0===e&&(e=!0),this.attr.isOutboundEmbed)return void this.redirectToPaymentForm();var n=this.attr.user&&this.attr.purchase&&this.attr.user.purchase.should_show_receipt;if(n||!this.validateForm(this.select("wantFormSelector"))||!this.validatePriceRange())return void this.trigger("uiCannotShowPaymentForm");if(this.trackAction(),this.isMultiBuyable()){if(!this.canShowPaymentFormFromOverlay())return void this.trigger("uiCannotShowPaymentForm");this.addSelfToBundle(),this.trigger("uiCanShowPaymentForm")}else this.attr.isCurrentUserSet&&(this.attr.onOverlayPage&&!this.attr.singleProductMode?this.trigger("uiCanShowPaymentForm"):(this.switchToPaymentForm(e),this.trigger("uiCannotShowPaymentForm")));this.trigger("uiScrollToTopOfEmbed"),this.trigger("uiSwitchSteps",{step:1})},this.showPaymentForm=function(){this.switchToPaymentForm(!0)},this.toggleGiftPaymentForm=function(t){return t&&t.preventDefault(),this.attr.isProcessingPayment||this.attr.isAnimatingPaymentForm?!1:("true"==this.select("giftSignifierSelector").val()?this.hideGiftInputs():this.showGiftInputs(),this.switchToPaymentForm(!0),!1)},this.setPreviewProcessing=function(){"test"!=this.attr.user.card.credit||this.attr.isDemo||this.select("processingPreviewContainerSelector").fadeIn()},this.setPriceTag=function(t){var e,n=this.select("priceSelector");e=this.priceWithCommas(t%1==0?t:t.toFixed(2)),this.attr.isPayWhatYouWant&&(e+="+"),this.attr.isRecurringBilling&&(e+=this.attr.selectedPriceInfo.recurrence_formatted),n.text(n.data("currency")+e)},this.priceWithCommas=function(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},this.showOldPrice=function(t){var e,n=this.select("priceSelector");e=this.priceWithCommas(t%1==0?t:t.toFixed(2)),this.select("oldPriceSelector").text(n.data("currency")+e).show()},this.hideOldPrice=function(){this.select("oldPriceSelector").hide()},this.updateDefaultHeightAttributes=function(){this.attr.defaultProductMainHeight=this.select("productMainSelector").outerHeight(),this.attr.previewHeightOnInitialize=this.select("productSelector").find(".preview-container").outerHeight()},this.updateDefaultHeight=function(){"undefined"==typeof this.attr.defaultProductMainHeight&&this.updateDefaultHeightAttributes()},this.setRemaining=function(){(this.attr.user.product.remaining||0==this.attr.user.product.remaining)&&(this.select("productLeftSelector").text(I18n.t("js.left_with_count",{count:this.attr.user.product.remaining})),this.select("productLeftContainerSelector").show(),this.attr.hasPreview||this.select("contentHeaderSelector").css("padding-left",50),0==this.attr.user.product.remaining&&(this.select("noneRemainingNoticeSelector").show(),this.select("wantThisContainerSelector").hide(),this.attr.isProductDisabled=!0))},this.setTerritoryBlockedNotice=function(){(this.attr.user.product.territory_blocked||this.attr.user.product.compliance_blocked)&&(this.select("territoryBlockedSelector").show(),this.select("wantThisContainerSelector").hide())},this.updateWantButtonText=function(t,e){this.select("wantButtonSelector").text(e.buttonText)},this.updateCustomAttributes=function(t,e){e.customAttributes.length>0||e.linkCustomSummaryText.length>0?this.select("linkInfoAttributesSelector").removeClass("hidden"):this.select("linkInfoAttributesSelector").addClass("hidden"),0==this.select("linkCustomSummarySelector").length&&this.select("linkInfoAttributesListSelector").prepend('<li class="summary"></li>'),this.select("linkCustomSummarySelector").text(e.linkCustomSummaryText),this.select("linkCustomFileInfoAttributesSelector").remove(),this.select("linkInfoAttributesListSelector").append(n({custom_attributes:e.customAttributes})),this.select("productMainSelector").height()>0&&this.select("productMainSelector").height("auto"),0==e.linkCustomSummaryText.length&&this.select("linkCustomSummarySelector").remove()},this.grabFileInfoAttributeByFileInfoKeyName=function(t){return $(this.attr.linkFileInfoAttributesSelector+'[data-file-info-key-name="'+t+'"]')},this.updateFileInfoAttributes=function(t,e){this.grabFileInfoAttributeByFileInfoKeyName(e.removedFileInfoAttribute).remove()},this.purchaseModeChanged=function(t){var e=this.select("purchaseModeSelector").is(":checked");this.attr.isRentalModeActive=!e,this.attr.isRentalModeActive?this.select("rentalTermsSelector").show():this.select("rentalTermsSelector").hide(),this.setPayButtonText(),this.trigger("uiNeedsToUpdatePriceDueToPurchaseModeChange")},this.updatePaymentOptionSelection=function(t){var e=$(this.attr.paymentOptionSelector+'[data-recurrence="'+t+'"]');e.prop("checked",!0).trigger("change"),this.paymentOptionChanged({target:e})},this.paymentOptionChanged=function(t){var e=$(t.target||t.srcElement);this.attr.selectedPriceInfo=e.data().priceInfo,this.setPrice();var n=e.data().priceRecurrenceNotice,i=e.data().priceFixedLengthRecurrenceNotice;this.select("priceTagSelector").attr("original-title",n),i&&this.select("subscriptionChargeOccurrencesMessageSelector").html(i)},this.setAlreadyBought=function(){this.attr.user.purchase.should_show_receipt&&(this.select("alreadyBoughtNoticeButtonSelector").text(this.attr.user.purchase.download_button_text).attr("href",this.attr.user.purchase.redirect_url),this.select("alreadyBoughtNoticeSelector").show(),this.trigger("uiNeedsToCheckForRecommendedProducts",{permalink:this.attr.permalink}))},this.updateChargeOccurrenceMessage=function(t,e){var n=this.select("priceTagSelector").data("currency")+(e%1==0?e:e.toFixed(2));0===e?this.select("subscriptionChargeOccurrencesMessageSelector").hide():(this.select("subscriptionChargeOccurrencesMessageSelector").find(".js-price").text(n),this.select("subscriptionChargeOccurrencesMessageSelector").show())},this.after("initialize",function(){this.select("productPriceSelector").tipsy(),this.attr.hasPreview=this.select("previewContainerSelector").length>0,this.attr.canGift=this.select("canGiftSelector").length>0;var t=this.select("authorHovercardTriggerSelector"),e=this.select("authorHovercardSelector");t.length>0&&e.length>0&&e.css({bottom:$(".product").height()-t.offset().top+78});var n=this.select("productSelector").find(".preview-container"),i=this.select("productSelector").find(".image-preview-container img");i.load(function(){n.data("height",i.height()),"undefined"!=typeof this.attr.defaultProductMainHeight&&(this.attr.defaultProductMainHeight+=n.outerHeight()-this.attr.previewHeightOnInitialize),this.attr.isShowingPaymentForm||this.attr.isShowingReceipt||this.switchToProductMain(!1),this.trigger("uiNeedsToToggleScrollButton")}.bind(this)),this.on(document,"uiForceShowPaymentForm",this.showPaymentForm),this.on(document,"uiShowPaymentForm",this.showPaymentFormIfPossible),this.on(document,"uiUpdateWantButton",this.updateWantButtonText),this.on(document,"uiUpdateCustomAttributes",this.updateCustomAttributes),this.on(document,"uiUpdateFileInfoAttributes",this.updateFileInfoAttributes),this.on(document,"uiToUpdateChargeOccurrenceMessage",this.updateChargeOccurrenceMessage),this.on("change",{purchaseModeSelector:this.purchaseModeChanged,paymentOptionSelector:this.paymentOptionChanged}),this.select("purchaseModeSelector").prop("disabled",!1),this.select("paymentOptionSelector").prop("disabled",!1),this.on("click",{wantButtonSelector:this.showPaymentFormIfPossible}),this.trigger("uiNeedsToToggleScrollButton")})}return r}),define("$app/ui/product/with_facebook_login",["flight/lib/component"],function(){function t(){this.defaultAttrs({facebookLoginSelector:".facebook-login"}),this.loginWithFacebook=function(t){t.preventDefault();var e=this.select("facebookLoginSelector");return e.data("default",e.text()),this.trigger("uiNeedsToLoginWithFacebook"),!1},this.showFacebookLoginVerifyingState=function(){this.select("facebookLoginSelector").text(I18n.t("js.verifying_information"))},this.refreshWindowWithWanted=function(){window.location=window.location+"?wanted=true"},this.showFacebookLoginFailedMessage=function(){var t=this.select("facebookLoginSelector");this.trigger("uiShowFlashMessage",{message:I18n.t("js.something_went_wrong")}),t.text(t.data("default"))},this.after("initialize",function(){this.on(document,"dataFackbookLoginSucceeded",this.refreshWindowWithWanted),this.on(document,"dataFackbookLoginFailed",this.showFacebookLoginFailedMessage),this.on(document,"dataFacebookLoginVerifying",this.showFacebookLoginVerifyingState),this.on("click",{facebookLoginSelector:this.loginWithFacebook})})}return t}),define("$app/ui/product/with_multi_buy",["$app/utils/currency_utils"],function(t){function e(){this.defaultAttrs({isMultiBuyEnabled:!1,completedBundle:!1}),this.isMultiBuyable=function(){return this.attr.isMultiBuyEnabled&&!this.attr.completedBundle&&!this.attr.singleProductMode},this.completedBundle=function(t){this.attr.completedBundle=!0},this.addSelfToBundle=function(){var t=this.select("priceRangeSelector");"undefined"!=typeof t.val()&&(this.attr.priceToAddToProductBundle=this.attr.totalPriceCents/(this.attr.isSingleUnit?1:100)),this.attr.priceToAddToProductBundle||this.setPrice();var e={permalink:this.attr.permalink,externalId:this.attr.externalId,name:this.attr.name,currency:this.select("priceSelector").data("currency"),isSingleUnit:this.attr.isSingleUnit,price:this.attr.priceToAddToProductBundle,isRentalModeActive:this.attr.isRentalModeActive,shippingRequired:this.attr.shippingInfoRequired,isRecurringBilling:this.attr.isRecurringBilling,hasOfferCodeField:this.attr.hasOfferCodeField&&!this.attr.offerCodeUsed,offerCodeName:this.attr.offerCodeName,offerCodeUsed:this.attr.offerCodeUsed,selectedPriceInfo:this.attr.selectedPriceInfo,serializedForm:this.getSerializedFormExcludingCreditCard(),originalPriceCents:parseInt(this.attr.priceToAddToProductBundle*(this.attr.isSingleUnit?1:100)),perceivedPriceCents:parseInt(this.attr.priceToAddToProductBundle*(this.attr.isSingleUnit?1:100)),exchangeRate:this.attr.exchangeRate,priceRange:t.val(),isPreorder:this.attr.isPreorder,isPhysical:this.attr.isPhysical,isTaxedExclusively:this.attr.isTaxedExclusively,sellerId:this.attr.sellerId,variants:[],customFields:this.attr.customFields,quantity:this.attr.quantity,formattedPrice:this.attr.priceToAddToProductBundle%1==0?this.attr.priceToAddToProductBundle:this.attr.priceToAddToProductBundle.toFixed(2),showQuantity:this.attr.quantity>1,wasProductRecommended:this.attr.wasProductRecommended,recommendedBy:this.attr.recommendedBy};$.each(this.select("variantSelector"),function(t,n){e.variants.push($(n).val())}),this.trigger("addProductToBundle",e);var n=this.select("productSelector");n.addClass("to-animate-to-bundle"),setTimeout(function(){var t=n.height(),i=n.width(),r=n.offset().left;n.addClass("animate-to-bundle").css({top:30-t/2,left:$(window).width()-160-i/2-r}),this.trigger("uiAddProductToBundledList",e),setTimeout(function(){this.trigger("uiNeedsToHideProductOverlay")}.bind(this),1e3)}.bind(this),10)},this.after("initialize",function(){this.on(document,"completedBundle",this.completedBundle),this.attr.singleProductMode=$(".js-product-display").data("single-product-mode")})}return e}),define("$app/ui/product/with_price",["flight/lib/component"],function(){function t(){this.defaultAttrs({perceivedPriceCentsSelector:'input[name="perceived_price_cents"]'}),this.setPrice=function(){var t,e,n,i=0;this.attr.isRecurringBilling&&this.attr.selectedPriceInfo?(t=this.attr.selectedPriceInfo.price_cents/(this.attr.isSingleUnit?1:100),e=this.attr.selectedPriceInfo.price_cents):this.attr.isRentalModeActive?(t=this.attr.rentalPrice,e=this.attr.rentalPriceCents):(t=this.attr.price,e=this.attr.priceCents),$.each(this.attr.selectedPriceChanges,function(){this[0]&&(t+=this[0]),this[1]&&(e+=this[1])}),this.attr.isPayWhatYouWant&&(e=this.customizedPriceCents()),this.isOfferCodeApplicable()&&(i=t*this.attr.quantity,n=e,this.attr.user.product.offer_code.is_percent?(t-=(t*(this.attr.user.product.offer_code.amount/100)).toFixed(this.attr.isSingleUnit?0:2),n-=(e*(this.attr.user.product.offer_code.amount/100)).toFixed()):(t-=this.attr.user.product.offer_code.amount/(this.attr.isSingleUnit?1:100),n-=this.attr.user.product.offer_code.amount),this.isUsingPresetOfferCode()&&this.attr.isPayWhatYouWant||(e=n)),t=Math.max(t,0)*this.attr.quantity,e=Math.max(e,0)*(this.attr.isPayWhatYouWant?1:this.attr.quantity),this.attr.totalPrice=t,this.attr.totalPriceCents=e,this.attr.zeroPlusEnabled=0==this.attr.totalPrice&&this.attr.isPayWhatYouWant,this.setOldPrice(i),this.setPriceTag(t),!this.isMultiBuyable()||"undefined"!=typeof this.attr.priceToAddToProductBundle&&"undefined"!=typeof this.select("priceRangeSelector").val()||(this.attr.priceToAddToProductBundle=t),this.select("perceivedPriceCentsSelector").val(e),this.setPriceRange(t),this.setCreditCardFormVisibility(t),this.trigger("uiShouldDisablePayButton"),this.initiatePriceInformationUpdate(),this.attr.isRecurringBilling&&this.attr.selectedPriceInfo&&this.trigger("uiToUpdateChargeOccurrenceMessage",t)},this.evaluateCreditCardVisibilty=function(t){this.setCreditCardFormVisibility(this.attr.totalPriceCents)},this.setOldPrice=function(t){this.isOfferCodeApplicable()?this.showOldPrice(t):this.hideOldPrice()},this.after("initialize",function(){this.on(document,"uiNeedsToUpdatePriceDueToPurchaseModeChange",this.setPrice),this.on(document,"uiNeedsToEvaluateCreditCardFormVisibility",this.evaluateCreditCardVisibilty)})}return t}),define("$app/ui/product/with_subscription",[],function(){function t(){this.defaultAttrs({subscriptionNoticeSelector:".subscription-notice",passwordSelector:".password",passwordPSelector:".js-password-p"}),this.setSubscriptionNotice=function(){var t=this.select("subscriptionNoticeSelector");t.find("strong").text(t.data("logged-in-notice"))},this.checkIfReadyToSubscribe=function(){var t=this.select("passwordSelector");if(0!=t.length){var e=this.select("emailSelector").val().length>0&&t.val().length>0;e?this.makeCreditCardUsable():this.makeCreditCardNotUsable()}},this.after("initialize",function(){this.on("keyup",{emailSelector:this.checkIfReadyToSubscribe,passwordSelector:this.checkIfReadyToSubscribe})})}return t}),define("$app/ui/product/with_quantity",[],function(){function t(){this.defaultAttrs({decreaseQuantitySelector:".js-decrease-quantity-trigger",increaseQuantitySelector:".js-increase-quantity-trigger",quantityIndicatorSelector:".js-quantity-indicator",quantitySelector:".js-quantity-selector",quantityInputSelector:".js-quantity",quantity:1}),this.decreaseQuantity=function(t){return t.preventDefault(),this.attr.quantity>1&&this.attr.quantity--,this.updateQuantityUI(),!1},this.increaseQuantity=function(t){return t.preventDefault(),this.allowIncreasingOfQuantity()&&this.attr.quantity++,this.updateQuantityUI(),!1},this.validateProductQuantity=function(){return!this.attr.user.product.remaining||this.attr.quantity<=this.attr.user.product.remaining},this.validateVariantQuantity=function(){if(this.select("variantSelector").length){var t=this.select("variantSelector").find(":selected").data("quantity-left");return!t||this.attr.quantity<=t}return!0},this.allowIncreasingOfQuantity=function(){var t=this.select("variantSelector").find(":selected").data("quantity-left");return this.attr.user.product.remaining&&this.attr.quantity==this.attr.user.product.remaining?!1:t&&this.attr.quantity==t?!1:!0},this.validateQuantity=function(){return 0==this.select("quantitySelector").length?!0:this.validateProductQuantity()&&this.validateVariantQuantity()?!0:(this.select("quantitySelector").addClass("error"),this.select("quantityIndicatorSelector").addClass("error"),this.trigger("uiShowFlashMessage",{message:I18n.t("js.exceeding_quantity")}),!1)},this.updateQuantityUI=function(){this.resetQuantityButtonsAndLabels(),this.select("quantityInputSelector").val(this.attr.quantity),this.select("quantityIndicatorSelector").text(this.attr.quantity),1==this.attr.quantity&&this.select("decreaseQuantitySelector").addClass("disabled"),this.allowIncreasingOfQuantity()||this.select("increaseQuantitySelector").addClass("disabled"),this.setPrice()},this.resetQuantityUI=function(){this.attr.quantity=1,this.updateQuantityUI()},this.resetQuantityButtonsAndLabels=function(){this.select("quantitySelector").removeClass("error"),this.select("quantityIndicatorSelector").removeClass("error"),this.select("decreaseQuantitySelector").removeClass("disabled"),this.select("increaseQuantitySelector").removeClass("disabled")},this.after("initialize",function(){this.on(document,"uiShouldResetQuantityUI",this.resetQuantityUI),this.on("click",{decreaseQuantitySelector:this.decreaseQuantity,
increaseQuantitySelector:this.increaseQuantity})})}return t}),define("$app/ui/product/with_click_event_tracking",[],function(){function t(){this.defaultAttrs({trackProductClickEventSelector:".js-track-product-click-event"}),this.trackProductClickEvent=function(t){this.trigger("uiNeedsToTrackProductSpecificEvent",{name:$(t.target).data("product-event-name"),permalink:this.attr.permalink})},this.after("initialize",function(){this.on("click",{trackProductClickEventSelector:this.trackProductClickEvent})})}return t}),"undefined"==typeof jwplayer&&(jwplayer=function(){return jwplayer.api?jwplayer.api.selectPlayer.apply(this,arguments):void 0},jwplayer.version="6.12.4956",jwplayer.vid=document.createElement("video"),jwplayer.audio=document.createElement("audio"),jwplayer.source=document.createElement("source"),function(){var t={},e=Array.prototype,n=Object.prototype,i=e.slice,r=e.concat,a=n.toString,s=n.hasOwnProperty,o=e.map,l=e.forEach,u=e.filter,c=e.every,h=e.some,d=e.indexOf,n=Array.isArray,p=Object.keys,f=function(t){return t instanceof f?t:this instanceof f?void 0:new f(t)},m=f.each=f.forEach=function(e,n,i){if(null==e)return e;if(l&&e.forEach===l)e.forEach(n,i);else if(e.length===+e.length){for(var r=0,a=e.length;a>r;r++)if(n.call(i,e[r],r,e)===t)return}else for(var s=f.keys(e),r=0,a=s.length;a>r;r++)if(n.call(i,e[s[r]],s[r],e)===t)return;return e};f.map=f.collect=function(t,e,n){var i=[];return null==t?i:o&&t.map===o?t.map(e,n):(m(t,function(t,r,a){i.push(e.call(n,t,r,a))}),i)},f.find=f.detect=function(t,e,n){var i;return g(t,function(t,r,a){return e.call(n,t,r,a)?(i=t,!0):void 0}),i},f.filter=f.select=function(t,e,n){var i=[];return null==t?i:u&&t.filter===u?t.filter(e,n):(m(t,function(t,r,a){e.call(n,t,r,a)&&i.push(t)}),i)},f.every=f.all=function(e,n,i){n||(n=f.identity);var r=!0;return null==e?r:c&&e.every===c?e.every(n,i):(m(e,function(e,a,s){return(r=r&&n.call(i,e,a,s))?void 0:t}),!!r)};var g=f.some=f.any=function(e,n,i){n||(n=f.identity);var r=!1;return null==e?r:h&&e.some===h?e.some(n,i):(m(e,function(e,a,s){return r||(r=n.call(i,e,a,s))?t:void 0}),!!r)};f.size=function(t){return null==t?0:t.length===+t.length?t.length:f.keys(t).length},f.after=function(t,e){return function(){return 1>--t?e.apply(this,arguments):void 0}},f.sortedIndex=function(t,e,n,i){n=null==n?f.identity:f.isFunction(n)?n:f.property(n),e=n.call(i,e);for(var r=0,a=t.length;a>r;){var s=r+a>>>1;n.call(i,t[s])<e?r=s+1:a=s}return r},f.find=f.detect=function(t,e,n){var i;return g(t,function(t,r,a){return e.call(n,t,r,a)?(i=t,!0):void 0}),i},g=f.some=f.any=function(e,n,i){n||(n=f.identity);var r=!1;return null==e?r:h&&e.some===h?e.some(n,i):(m(e,function(e,a,s){return r||(r=n.call(i,e,a,s))?t:void 0}),!!r)},f.contains=f.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=f.values(t)),0<=f.indexOf(t,e))},f.where=function(t,e){return f.filter(t,f.matches(e))},f.difference=function(t){var n=r.apply(e,i.call(arguments,1));return f.filter(t,function(t){return!f.contains(n,t)})},f.without=function(t){return f.difference(t,i.call(arguments,1))},f.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=f.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(d&&t.indexOf===d)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},f.partial=function(t){var e=i.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,a=i.length;a>r;r++)i[r]===f&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},f.memoize=function(t,e){var n={};return e||(e=f.identity),function(){var i=e.apply(this,arguments);return f.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},f.delay=function(t,e){var n=i.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},f.defer=function(t){return f.delay.apply(f,[t,1].concat(i.call(arguments,1)))},f.keys=function(t){if(!f.isObject(t))return[];if(p)return p(t);var e,n=[];for(e in t)f.has(t,e)&&n.push(e);return n},f.pick=function(t){var n={},a=r.apply(e,i.call(arguments,1));return m(a,function(e){e in t&&(n[e]=t[e])}),n},f.isArray=n||function(t){return"[object Array]"==a.call(t)},f.isObject=function(t){return t===Object(t)},m("Arguments Function String Number Date RegExp".split(" "),function(t){f["is"+t]=function(e){return a.call(e)=="[object "+t+"]"}}),f.isArguments(arguments)||(f.isArguments=function(t){return!(!t||!f.has(t,"callee"))}),"function"!=typeof/./&&(f.isFunction=function(t){return"function"==typeof t}),f.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},f.isNaN=function(t){return f.isNumber(t)&&t!=+t},f.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==a.call(t)},f.isNull=function(t){return null===t},f.isUndefined=function(t){return void 0===t},f.has=function(t,e){return s.call(t,e)},f.identity=function(t){return t},f.constant=function(t){return function(){return t}},f.property=function(t){return function(e){return e[t]}},f.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},f.result=function(t,e){if(null!=t){var n=t[e];return f.isFunction(n)?n.call(t):n}},this._=f}.call(jwplayer),function(t){function e(t){return function(){return s(t)}}function n(t,e,n,r,a){return function(){var s,o;if(a)n(t);else{try{if((s=t.responseXML)&&(o=s.firstChild,s.lastChild&&"parsererror"===s.lastChild.nodeName))return void(r&&r("Invalid XML",e,t))}catch(l){}if(s&&o)return n(t);(s=i.parseXML(t.responseText))&&s.firstChild?(t=i.extend({},t,{responseXML:s}),n(t)):r&&r(t.responseText?"Invalid XML":e,e,t)}}}var i=t.utils={},r=t._;i.exists=function(t){switch(typeof t){case"string":return 0<t.length;case"object":return null!==t;case"undefined":return!1}return!0},i.styleDimension=function(t){return t+(0<t.toString().indexOf("%")?"":"px")},i.getAbsolutePath=function(t,e){if(i.exists(e)||(e=document.location.href),i.exists(t)){var n;if(i.exists(t)){n=t.indexOf("://");var r=t.indexOf("?");n=n>0&&(0>r||r>n)}else n=void 0;if(n)return t;n=e.substring(0,e.indexOf("://")+3);var a,r=e.substring(n.length,e.indexOf("/",n.length+1));0===t.indexOf("/")?a=t.split("/"):(a=e.split("?")[0],a=a.substring(n.length+r.length+1,a.lastIndexOf("/")),a=a.split("/").concat(t.split("/")));for(var s=[],o=0;o<a.length;o++)a[o]&&i.exists(a[o])&&"."!==a[o]&&(".."===a[o]?s.pop():s.push(a[o]));return n+r+"/"+s.join("/")}},i.extend=function(){var t=Array.prototype.slice.call(arguments,0);if(1<t.length){for(var e=t[0],n=function(t,n){void 0!==n&&null!==n&&(e[t]=n)},r=1;r<t.length;r++)i.foreach(t[r],n);return e}return null};var a=window.console=window.console||{log:function(){}};i.log=function(){var t=Array.prototype.slice.call(arguments,0);"object"==typeof a.log?a.log(t):a.log.apply(a,t)};var s=r.memoize(function(t){return null!==navigator.userAgent.toLowerCase().match(t)});i.isFF=e(/firefox/i),i.isChrome=e(/chrome/i),i.isIPod=e(/iP(hone|od)/i),i.isIPad=e(/iPad/i),i.isSafari602=e(/Macintosh.*Mac OS X 10_8.*6\.0\.\d* Safari/i),i.isIETrident=function(t){return t?(t=parseFloat(t).toFixed(1),s(RegExp("trident/.+rv:\\s*"+t,"i"))):s(/trident/i)},i.isMSIE=function(t){return t?(t=parseFloat(t).toFixed(1),s(RegExp("msie\\s*"+t,"i"))):s(/msie/i)},i.isIE=function(t){return t?(t=parseFloat(t).toFixed(1),t>=11?i.isIETrident(t):i.isMSIE(t)):i.isMSIE()||i.isIETrident()},i.isSafari=function(){return s(/safari/i)&&!s(/chrome/i)&&!s(/chromium/i)&&!s(/android/i)},i.isIOS=function(t){return s(t?RegExp("iP(hone|ad|od).+\\sOS\\s"+t,"i"):/iP(hone|ad|od)/i)},i.isAndroidNative=function(t){return i.isAndroid(t,!0)},i.isAndroid=function(t,e){return e&&s(/chrome\/[123456789]/i)&&!s(/chrome\/18/)?!1:t?(i.isInt(t)&&!/\./.test(t)&&(t=""+t+"."),s(RegExp("Android\\s*"+t,"i"))):s(/Android/i)},i.isMobile=function(){return i.isIOS()||i.isAndroid()},i.isIframe=function(){return window.frameElement&&"IFRAME"===window.frameElement.nodeName},i.saveCookie=function(t,e){document.cookie="jwplayer."+t+"="+e+"; path=/"},i.getCookies=function(){for(var t={},e=document.cookie.split("; "),n=0;n<e.length;n++){var i=e[n].split("=");0===i[0].indexOf("jwplayer.")&&(t[i[0].substring(9,i[0].length)]=i[1])}return t},i.isInt=function(t){return 0===parseFloat(t)%1},i.typeOf=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&r.isArray(t)?"array":e},i.translateEventResponse=function(e,n){var r=i.extend({},n);if(e!==t.events.JWPLAYER_FULLSCREEN||r.fullscreen)if("object"==typeof r.data){var a=r.data;delete r.data,r=i.extend(r,a)}else"object"==typeof r.metadata&&i.deepReplaceKeyName(r.metadata,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]);else r.fullscreen="true"===r.message,delete r.message;return i.foreach(["position","duration","offset"],function(t,e){r[e]&&(r[e]=Math.round(1e3*r[e])/1e3)}),r},i.flashVersion=function(){if(i.isAndroid())return 0;var t,e=navigator.plugins;try{if("undefined"!==e&&(t=e["Shockwave Flash"]))return parseInt(t.description.replace(/\D+(\d+)\..*/,"$1"),10)}catch(n){}if("undefined"!=typeof window.ActiveXObject)try{if(t=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return parseInt(t.GetVariable("$version").split(" ")[1].split(",")[0],10)}catch(r){}return 0},i.getScriptPath=function(t){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++){var i=e[n].src;if(i&&0<=i.indexOf(t))return i.substr(0,i.indexOf(t))}return""},i.deepReplaceKeyName=function(e,n,r){switch(t.utils.typeOf(e)){case"array":for(var a=0;a<e.length;a++)e[a]=t.utils.deepReplaceKeyName(e[a],n,r);break;case"object":i.foreach(e,function(i,a){var s;if(n instanceof Array&&r instanceof Array){if(n.length!==r.length)return;s=n}else s=[n];for(var o=i,l=0;l<s.length;l++)o=o.replace(RegExp(n[l],"g"),r[l]);e[o]=t.utils.deepReplaceKeyName(a,n,r),i!==o&&delete e[i]})}return e};var o=i.pluginPathType={ABSOLUTE:0,RELATIVE:1,CDN:2};i.getPluginPathType=function(t){if("string"==typeof t){t=t.split("?")[0];var e=t.indexOf("://");if(e>0)return o.ABSOLUTE;var n=t.indexOf("/");return t=i.extension(t),!(0>e&&0>n)||t&&isNaN(t)?o.RELATIVE:o.CDN}},i.getPluginName=function(t){return t.replace(/^(.*\/)?([^-]*)-?.*\.(swf|js)$/,"$2")},i.getPluginVersion=function(t){return t.replace(/[^-]*-?([^\.]*).*$/,"$1")},i.isYouTube=function(t,e){return"youtube"===e||/^(http|\/\/).*(youtube\.com|youtu\.be)\/.+/.test(t)},i.youTubeID=function(t){try{return/v[=\/]([^?&]*)|youtu\.be\/([^?]*)|^([\w-]*)$/i.exec(t).slice(1).join("").replace("?","")}catch(e){return""}},i.isRtmp=function(t,e){return 0===t.indexOf("rtmp")||"rtmp"===e},i.foreach=function(t,e){var n,r;for(n in t)"function"===i.typeOf(t.hasOwnProperty)?t.hasOwnProperty(n)&&(r=t[n],e(n,r)):(r=t[n],e(n,r))},i.isHTTPS=function(){return 0===window.location.href.indexOf("https")},i.repo=function(){var e="http://p.jwpcdn.com/"+t.version.split(/\W/).splice(0,2).join("/")+"/";try{i.isHTTPS()&&(e=e.replace("http://","https://ssl."))}catch(n){}return e},i.versionCheck=function(e){e=("0"+e).split(/\W/);var n=t.version.split(/\W/),i=parseFloat(e[0]),r=parseFloat(n[0]);return i>r||i===r&&parseFloat("0"+e[1])>parseFloat(n[1])?!1:!0},i.ajax=function(t,e,r,a){var s,o=!1;if(0<t.indexOf("#")&&(t=t.replace(/#.*$/,"")),t&&0<=t.indexOf("://")&&t.split("/")[2]!==window.location.href.split("/")[2]&&i.exists(window.XDomainRequest))s=new window.XDomainRequest,s.onload=n(s,t,e,r,a),s.ontimeout=s.onprogress=function(){},s.timeout=5e3;else{if(!i.exists(window.XMLHttpRequest))return r&&r("",t,s),s;var l=s=new window.XMLHttpRequest,u=t;s.onreadystatechange=function(){if(4===l.readyState)switch(l.status){case 200:n(l,u,e,r,a)();break;case 404:r("File not found",u,l)}}}s.overrideMimeType&&s.overrideMimeType("text/xml");var c=t,h=s;s.onerror=function(){r("Error loading file",c,h)};try{s.open("GET",t,!0)}catch(d){o=!0}return setTimeout(function(){if(o)r&&r(t,t,s);else try{s.send()}catch(e){r&&r(t,t,s)}},0),s},i.parseXML=function(t){var e;try{if(window.DOMParser){if(e=(new window.DOMParser).parseFromString(t,"text/xml"),e.childNodes&&e.childNodes.length&&"parsererror"===e.childNodes[0].firstChild.nodeName)return}else e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)}catch(n){return}return e},i.between=function(t,e,n){return Math.max(Math.min(t,n),e)},i.seconds=function(t){if(r.isNumber(t))return t;t=t.replace(",",".");var e=t.split(":"),n=0;return"s"===t.slice(-1)?n=parseFloat(t):"m"===t.slice(-1)?n=60*parseFloat(t):"h"===t.slice(-1)?n=3600*parseFloat(t):1<e.length?(n=parseFloat(e[e.length-1]),n+=60*parseFloat(e[e.length-2]),3===e.length&&(n+=3600*parseFloat(e[e.length-3]))):n=parseFloat(t),n},i.serialize=function(t){return null===t?null:"true"===t.toString().toLowerCase()?!0:"false"===t.toString().toLowerCase()?!1:isNaN(Number(t))||5<t.length||0===t.length?t:Number(t)},i.addClass=function(t,e){var n=r.isString(t.className)?t.className.split(" "):[],a=r.isArray(e)?e:e.split(" ");r.each(a,function(t){r.contains(n,t)||n.push(t)}),t.className=i.trim(n.join(" "))},i.removeClass=function(t,e){var n=r.isString(t.className)?t.className.split(" "):[],a=r.isArray(e)?e:e.split(" ");t.className=i.trim(r.difference(n,a).join(" "))},i.emptyElement=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},i.indexOf=r.indexOf,i.noop=function(){},i.canCast=function(){var e=t.cast;return!(!e||!r.isFunction(e.available)||!e.available())}}(jwplayer),function(t){function e(t){var e=document.createElement("style");return t&&e.appendChild(document.createTextNode(t)),e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),e}function n(t,e,n){return s.exists(e)?(n=n?" !important":"","string"==typeof e&&isNaN(e)?/png|gif|jpe?g/i.test(e)&&0>e.indexOf("url")?"url("+e+")":e+n:0===e||"z-index"===t||"opacity"===t?""+e+n:/color/i.test(t)?"#"+s.pad(e.toString(16).replace(/^0x/i,""),6)+n:Math.ceil(e)+"px"+n):""}function i(t,e){for(var n=0;n<t.length;n++){var i,r,a=t[n];if(void 0!==a&&null!==a)for(i in e){r=i,r=r.split("-");for(var s=1;s<r.length;s++)r[s]=r[s].charAt(0).toUpperCase()+r[s].slice(1);r=r.join(""),a.style[r]!==e[i]&&(a.style[r]=e[i])}}}function r(t){var e,n,i,r=o[t].sheet;if(r){e=r.cssRules,n=c[t],i=t;var a=l[i];i+=" { ";for(var s in a)i+=s+": "+a[s]+"; ";if(i+="}",void 0!==n&&n<e.length&&e[n].selectorText===t){if(i===e[n].cssText)return;r.deleteRule(n)}else n=e.length,c[t]=n;try{r.insertRule(i,n)}catch(u){}}}var a,s=t.utils,o={},l={},u=null,c={};s.cssKeyframes=function(t,n){var i=o.keyframes;i||(i=e(),o.keyframes=i);var i=i.sheet,r="@keyframes "+t+" { "+n+" }";try{i.insertRule(r,i.cssRules.length)}catch(a){}r=r.replace(/(keyframes|transform)/g,"-webkit-$1");try{i.insertRule(r,i.cssRules.length)}catch(s){}};var h=s.css=function(t,i,s){l[t]||(l[t]={});var c=l[t];s=s||!1;var h,d,p=!1;for(h in i)d=n(h,i[h],s),""!==d?d!==c[h]&&(c[h]=d,p=!0):void 0!==c[h]&&(delete c[h],p=!0);p&&(o[t]||(i=a&&a.sheet&&a.sheet.cssRules&&a.sheet.cssRules.length||0,(!a||i>5e4)&&(a=e()),o[t]=a),null!==u?u.styleSheets[t]=l[t]:r(t))};h.style=function(e,r,a){if(void 0!==e&&null!==e){void 0===e.length&&(e=[e]);var s,o={};for(s in r)o[s]=n(s,r[s]);if(null===u||a)i(e,o);else{r=(r=e.__cssRules)||{};for(var l in o)r[l]=o[l];e.__cssRules=r,0>t._.indexOf(u.elements,e)&&u.elements.push(e)}}},h.block=function(t){null===u&&(u={id:t,styleSheets:{},elements:[]})},h.unblock=function(t){if(u&&(!t||u.id===t)){for(var e in u.styleSheets)r(e);for(t=0;t<u.elements.length;t++)e=u.elements[t],i(e,e.__cssRules);u=null}},s.clearCss=function(t){for(var e in l)0<=e.indexOf(t)&&delete l[e];for(var n in o)0<=n.indexOf(t)&&r(n)},s.transform=function(t,e){var n={};e=e||"",n.transform=e,n["-webkit-transform"]=e,n["-ms-transform"]=e,n["-moz-transform"]=e,n["-o-transform"]=e,"string"==typeof t?h(t,n):h.style(t,n)},s.dragStyle=function(t,e){h(t,{"-webkit-user-select":e,"-moz-user-select":e,"-ms-user-select":e,"-webkit-user-drag":e,"user-select":e,"user-drag":e})},s.transitionStyle=function(t,e){navigator.userAgent.match(/5\.\d(\.\d)? safari/i)||h(t,{"-webkit-transition":e,"-moz-transition":e,"-o-transition":e,transition:e})},s.rotate=function(t,e){s.transform(t,"rotate("+e+"deg)")},s.rgbHex=function(t){return t=String(t).replace("#",""),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t.substr(-6)},s.hexToRgba=function(t,e){var n="rgb",i=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)];return void 0!==e&&100!==e&&(n+="a",i.push(e/100)),n+"("+i.join(",")+")"}}(jwplayer),function(t){var e=jwplayer._,n=t.foreach,i={mp4:"video/mp4",ogg:"video/ogg",oga:"audio/ogg",vorbis:"audio/ogg",webm:"video/webm",aac:"audio/mp4",mp3:"audio/mpeg",hls:"application/vnd.apple.mpegurl"},r={mp4:i.mp4,f4v:i.mp4,m4v:i.mp4,mov:i.mp4,m4a:i.aac,f4a:i.aac,aac:i.aac,mp3:i.mp3,ogv:i.ogg,ogg:i.ogg,oga:i.vorbis,vorbis:i.vorbis,webm:i.webm,m3u8:i.hls,m3u:i.hls,hls:i.hls},a=t.extensionmap={};n(r,function(t,e){a[t]={html5:e}}),n({flv:"video",f4v:"video",mov:"video",m4a:"video",m4v:"video",mp4:"video",aac:"video",f4a:"video",mp3:"sound",smil:"rtmp",m3u8:"hls",hls:"hls"},function(t,e){a[t]||(a[t]={}),a[t].flash=e}),a.types=i,a.mimeType=function(t){var n;return e.find(i,function(e,i){return e===t?(n=i,!0):void 0}),n},a.extType=function(t){return a.mimeType(r[t])}}(jwplayer.utils),function(t){var e=t.loaderstatus={NEW:0,LOADING:1,ERROR:2,COMPLETE:3};t.scriptloader=function(n){function i(t){o=e.ERROR,s.sendEvent(a.ERROR,t)}function r(t){o=e.COMPLETE,s.sendEvent(a.COMPLETE,t)}var a=jwplayer.events,s=t.extend(this,new a.eventdispatcher),o=e.NEW;this.load=function(){if(o===e.NEW){var s=t.scriptloader.loaders[n];if(s&&(o=s.getStatus(),2>o))return s.addEventListener(a.ERROR,i),void s.addEventListener(a.COMPLETE,r);var l=document.getElementsByTagName("head")[0]||document.documentElement,u=document.createElement("script"),c=!1;u.onload=u.onreadystatechange=function(t){c||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(c=!0,r(t),u.onload=u.onreadystatechange=null,l&&u.parentNode&&l.removeChild(u))},u.onerror=i,u.src=n,l.insertBefore(u,l.firstChild),o=e.LOADING,t.scriptloader.loaders[n]=this}},this.getStatus=function(){return o}},t.scriptloader.loaders={}}(jwplayer.utils),function(t){t.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},t.pad=function(t,e,n){for(n||(n="0");t.length<e;)t=n+t;return t},t.xmlAttribute=function(t,e){for(var n=0;n<t.attributes.length;n++)if(t.attributes[n].name&&t.attributes[n].name.toLowerCase()===e.toLowerCase())return t.attributes[n].value.toString();return""},t.extension=function(t){if(!t||"rtmp"===t.substr(0,4))return"";var e;return(e=-1<t.indexOf("(format=m3u8-")?"m3u8":!1)?e:(t=t.substring(t.lastIndexOf("/")+1,t.length).split("?")[0].split("#")[0],-1<t.lastIndexOf(".")?t.substr(t.lastIndexOf(".")+1,t.length).toLowerCase():void 0)},t.stringToColor=function(t){return t=t.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2"),3===t.length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)}}(jwplayer.utils),function(t){var e="touchmove",n="touchstart";t.touch=function(i){function r(t){t.type===n?(l=!0,c=s(d.DRAG_START,t)):t.type===e?l&&(h||(a(d.DRAG_START,t,c),h=!0),a(d.DRAG,t)):(l&&(h?a(d.DRAG_END,t):(t.cancelBubble=!0,a(d.TAP,t))),l=h=!1,c=null)}function a(t,e,n){u[t]&&(e.preventManipulation&&e.preventManipulation(),e.preventDefault&&e.preventDefault(),e=n?n:s(t,e))&&u[t](e)}function s(t,e){var n=null;if(e.touches&&e.touches.length?n=e.touches[0]:e.changedTouches&&e.changedTouches.length&&(n=e.changedTouches[0]),!n)return null;var i=o.getBoundingClientRect(),n={type:t,target:o,x:n.pageX-window.pageXOffset-i.left,y:n.pageY,deltaX:0,deltaY:0};return t!==d.TAP&&c&&(n.deltaX=n.x-c.x,n.deltaY=n.y-c.y),n}var o=i,l=!1,u={},c=null,h=!1,d=t.touchEvents;return document.addEventListener(e,r),document.addEventListener("touchend",function(t){l&&h&&a(d.DRAG_END,t),l=h=!1,c=null}),document.addEventListener("touchcancel",r),i.addEventListener(n,r),i.addEventListener("touchend",r),this.addEventListener=function(t,e){u[t]=e},this.removeEventListener=function(t){delete u[t]},this}}(jwplayer.utils),function(t){t.touchEvents={DRAG:"jwplayerDrag",DRAG_START:"jwplayerDragStart",DRAG_END:"jwplayerDragEnd",TAP:"jwplayerTap"}}(jwplayer.utils),function(t){t.key=function(e){var n,i,r;this.edition=function(){return r&&r.getTime()<(new Date).getTime()?"invalid":n},this.token=function(){return i},t.exists(e)||(e="");try{e=t.tea.decrypt(e,"36QXq4W@GSBV^teR");var a=e.split("/");(n=a[0])?/^(free|pro|premium|enterprise|ads)$/i.test(n)?(i=a[1],a[2]&&0<parseInt(a[2])&&(r=new Date,r.setTime(String(a[2])))):n="invalid":n="free"}catch(s){n="invalid"}}}(jwplayer.utils),function(t){var e=t.tea={};e.encrypt=function(t,r){if(0==t.length)return"";var a=e.strToLongs(i.encode(t));1>=a.length&&(a[1]=0);for(var s,o=e.strToLongs(i.encode(r).slice(0,16)),l=a.length,u=a[l-1],c=a[0],h=Math.floor(6+52/l),d=0;0<h--;){d+=2654435769,s=d>>>2&3;for(var p=0;l>p;p++)c=a[(p+1)%l],u=(u>>>5^c<<2)+(c>>>3^u<<4)^(d^c)+(o[3&p^s]^u),u=a[p]+=u}return a=e.longsToStr(a),n.encode(a)},e.decrypt=function(t,r){if(0==t.length)return"";for(var a,s=e.strToLongs(n.decode(t)),o=e.strToLongs(i.encode(r).slice(0,16)),l=s.length,u=s[l-1],c=s[0],h=2654435769*Math.floor(6+52/l);0!=h;){a=h>>>2&3;for(var d=l-1;d>=0;d--)u=s[d>0?d-1:l-1],u=(u>>>5^c<<2)+(c>>>3^u<<4)^(h^c)+(o[3&d^a]^u),c=s[d]-=u;h-=2654435769}return s=e.longsToStr(s),s=s.replace(/\0+$/,""),i.decode(s)},e.strToLongs=function(t){for(var e=Array(Math.ceil(t.length/4)),n=0;n<e.length;n++)e[n]=t.charCodeAt(4*n)+(t.charCodeAt(4*n+1)<<8)+(t.charCodeAt(4*n+2)<<16)+(t.charCodeAt(4*n+3)<<24);return e},e.longsToStr=function(t){for(var e=Array(t.length),n=0;n<t.length;n++)e[n]=String.fromCharCode(255&t[n],t[n]>>>8&255,t[n]>>>16&255,t[n]>>>24&255);return e.join("")};var n={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t,e){var r,a,s,o,l,u,c=[],h="",d=n.code;if(u=("undefined"==typeof e?0:e)?i.encode(t):t,l=u.length%3,l>0)for(;3>l++;)h+="=",u+="\x00";for(l=0;l<u.length;l+=3)r=u.charCodeAt(l),a=u.charCodeAt(l+1),s=u.charCodeAt(l+2),o=r<<16|a<<8|s,r=o>>18&63,a=o>>12&63,s=o>>6&63,o&=63,c[l/3]=d.charAt(r)+d.charAt(a)+d.charAt(s)+d.charAt(o);return c=c.join(""),c=c.slice(0,c.length-h.length)+h},decode:function(t,e){e="undefined"==typeof e?!1:e;var r,a,s,o,l,u,c=[],h=n.code;u=e?i.decode(t):t;for(var d=0;d<u.length;d+=4)r=h.indexOf(u.charAt(d)),a=h.indexOf(u.charAt(d+1)),o=h.indexOf(u.charAt(d+2)),l=h.indexOf(u.charAt(d+3)),s=r<<18|a<<12|o<<6|l,r=s>>>16&255,a=s>>>8&255,s&=255,c[d/4]=String.fromCharCode(r,a,s),64==l&&(c[d/4]=String.fromCharCode(r,a)),64==o&&(c[d/4]=String.fromCharCode(r));return o=c.join(""),e?i.decode(o):o}},i={encode:function(t){return t=t.replace(/[\u0080-\u07ff]/g,function(t){return t=t.charCodeAt(0),String.fromCharCode(192|t>>6,128|63&t)}),t=t.replace(/[\u0800-\uffff]/g,function(t){return t=t.charCodeAt(0),String.fromCharCode(224|t>>12,128|t>>6&63,128|63&t)})},decode:function(t){return t=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(t){return t=(15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2),String.fromCharCode(t)}),t=t.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(t){return t=(31&t.charCodeAt(0))<<6|63&t.charCodeAt(1),String.fromCharCode(t)})}}}(jwplayer.utils),function(t){t.events={COMPLETE:"COMPLETE",ERROR:"ERROR",API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_SETUP_ERROR:"jwplayerSetupError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_AUDIO_TRACKS:"jwplayerAudioTracks",JWPLAYER_AUDIO_TRACK_CHANGED:"jwplayerAudioTrackChanged",JWPLAYER_MEDIA_LEVELS:"jwplayerMediaLevels",JWPLAYER_MEDIA_LEVEL_CHANGED:"jwplayerMediaLevelChanged",JWPLAYER_CAPTIONS_CHANGED:"jwplayerCaptionsChanged",JWPLAYER_CAPTIONS_LIST:"jwplayerCaptionsList",JWPLAYER_CAPTIONS_LOADED:"jwplayerCaptionsLoaded",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",state:{BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_PLAYLIST_COMPLETE:"jwplayerPlaylistComplete",JWPLAYER_DISPLAY_CLICK:"jwplayerViewClick",JWPLAYER_PROVIDER_CLICK:"jwplayerProviderClick",JWPLAYER_VIEW_TAB_FOCUS:"jwplayerViewTabFocus",JWPLAYER_CONTROLS:"jwplayerViewControls",JWPLAYER_USER_ACTION:"jwplayerUserAction",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed",JWPLAYER_AD_TIME:"jwplayerAdTime",JWPLAYER_AD_ERROR:"jwplayerAdError",JWPLAYER_AD_CLICK:"jwplayerAdClicked",JWPLAYER_AD_COMPLETE:"jwplayerAdComplete",JWPLAYER_AD_IMPRESSION:"jwplayerAdImpression",JWPLAYER_AD_COMPANIONS:"jwplayerAdCompanions",JWPLAYER_AD_SKIPPED:"jwplayerAdSkipped",JWPLAYER_AD_PLAY:"jwplayerAdPlay",JWPLAYER_AD_PAUSE:"jwplayerAdPause",JWPLAYER_AD_META:"jwplayerAdMeta",JWPLAYER_CAST_AVAILABLE:"jwplayerCastAvailable",JWPLAYER_CAST_SESSION:"jwplayerCastSession",JWPLAYER_CAST_AD_CHANGED:"jwplayerCastAdChanged"}}(jwplayer),function(t){var e=t.utils;t.events.eventdispatcher=function(n,i){function r(t,n,i){if(t)for(var r=0;r<t.length;r++){var a=t[r];if(a){null!==a.count&&0===--a.count&&delete t[r];try{a.listener(n)}catch(s){e.log('Error handling "'+i+'" event listener ['+r+"]: "+s.toString(),a.listener,n)}}}}var a,s;this.resetEventListeners=function(){a={},s=[]},this.resetEventListeners(),this.addEventListener=function(t,n,i){try{e.exists(a[t])||(a[t]=[]),"string"===e.typeOf(n)&&(n=new Function("return "+n)()),a[t].push({listener:n,count:i||null})}catch(r){e.log("error",r)}return!1},this.removeEventListener=function(t,n){var i;if(a[t]){try{if(void 0===n)return void(a[t]=[]);for(i=0;i<a[t].length;i++)if(a[t][i].listener.toString()===n.toString()){a[t].splice(i,1);break}}catch(r){e.log("error",r)}return!1}},this.addGlobalListener=function(t,n){try{"string"===e.typeOf(t)&&(t=new Function("return "+t)()),s.push({listener:t,count:n||null})}catch(i){e.log("error",i)}return!1},this.removeGlobalListener=function(t){if(t){try{for(var n=s.length;n--;)s[n].listener.toString()===t.toString()&&s.splice(n,1)}catch(i){e.log("error",i)}return!1}},this.sendEvent=function(o,l){e.exists(l)||(l={}),e.extend(l,{id:n,version:t.version,type:o}),i&&e.log(o,l),r(a[o],l,o),r(s,l,o)}}}(window.jwplayer),function(t){var e={},n={};t.plugins=function(){},t.plugins.loadPlugins=function(i,r){return n[i]=new t.plugins.pluginloader(new t.plugins.model(e),r),n[i]},t.plugins.registerPlugin=function(n,i,r,a){var s=t.utils.getPluginName(n);e[s]||(e[s]=new t.plugins.plugin(n)),e[s].registerPlugin(n,i,r,a)}}(jwplayer),function(t){t.plugins.model=function(e){this.addPlugin=function(n){var i=t.utils.getPluginName(n);return e[i]||(e[i]=new t.plugins.plugin(n)),e[i]},this.getPlugins=function(){return e}}}(jwplayer),function(t){var e=jwplayer.utils,n=jwplayer.events;t.pluginmodes={FLASH:0,JAVASCRIPT:1,HYBRID:2},t.plugin=function(i){function r(){switch(e.getPluginPathType(i)){case e.pluginPathType.ABSOLUTE:return i;case e.pluginPathType.RELATIVE:return e.getAbsolutePath(i,window.location.href)}}function a(){c=setTimeout(function(){h=e.loaderstatus.COMPLETE,d.sendEvent(n.COMPLETE)},1e3)}function s(){h=e.loaderstatus.ERROR,d.sendEvent(n.ERROR,{url:i})}var o,l,u,c,h=e.loaderstatus.NEW,d=new n.eventdispatcher;e.extend(this,d),this.load=function(){if(h===e.loaderstatus.NEW)if(0<i.lastIndexOf(".swf"))o=i,h=e.loaderstatus.COMPLETE,d.sendEvent(n.COMPLETE);else if(e.getPluginPathType(i)===e.pluginPathType.CDN)h=e.loaderstatus.COMPLETE,d.sendEvent(n.COMPLETE);else{h=e.loaderstatus.LOADING;var t=new e.scriptloader(r());t.addEventListener(n.COMPLETE,a),t.addEventListener(n.ERROR,s),t.load()}},this.registerPlugin=function(t,i,r,a){c&&(clearTimeout(c),c=void 0),u=i,r&&a?(o=a,l=r):"string"==typeof r?o=r:"function"==typeof r?l=r:!r&&!a&&(o=t),h=e.loaderstatus.COMPLETE,d.sendEvent(n.COMPLETE)},this.getStatus=function(){return h},this.getPluginName=function(){return e.getPluginName(i)},this.getFlashPath=function(){if(o)switch(e.getPluginPathType(o)){case e.pluginPathType.ABSOLUTE:return o;case e.pluginPathType.RELATIVE:return 0<i.lastIndexOf(".swf")?e.getAbsolutePath(o,window.location.href):e.getAbsolutePath(o,r())}return null},this.getJS=function(){return l},this.getTarget=function(){return u},this.getPluginmode=function(){return"undefined"!=typeof o&&"undefined"!=typeof l?t.pluginmodes.HYBRID:"undefined"!=typeof o?t.pluginmodes.FLASH:"undefined"!=typeof l?t.pluginmodes.JAVASCRIPT:void 0},this.getNewInstance=function(t,e,n){return new l(t,e,n)},this.getURL=function(){return i}}}(jwplayer.plugins),function(t){var e=t.utils,n=t.events,i=t._,r=e.foreach;t.plugins.pluginloader=function(t,a){function s(){h||(h=!0,c=e.loaderstatus.COMPLETE,m.sendEvent(n.COMPLETE))}function o(){if(!f&&((!d||0===i.keys(d).length)&&s(),!h)){var r=t.getPlugins();u=i.after(p,s),e.foreach(d,function(t){t=e.getPluginName(t);var i=r[t];t=i.getJS();var a=i.getTarget(),i=i.getStatus();i===e.loaderstatus.LOADING||i===e.loaderstatus.NEW||(t&&!e.versionCheck(a)&&m.sendEvent(n.ERROR,{message:"Incompatible player version"}),u())})}}function l(t){f||(m.sendEvent(n.ERROR,{message:"File not found"}),t.url&&e.log("File not found",t.url),o())}var u,c=e.loaderstatus.NEW,h=!1,d=a,p=i.size(d),f=!1,m=new n.eventdispatcher;e.extend(this,m),this.setupPlugins=function(n,i,a){var s={length:0,plugins:{}},o=0,l={},u=t.getPlugins();return r(i.plugins,function(t,r){var c=e.getPluginName(t),h=u[c],d=h.getFlashPath(),p=h.getJS(),f=h.getURL();d&&(s.plugins[d]=e.extend({},r),s.plugins[d].pluginmode=h.getPluginmode(),s.length++);try{if(p&&i.plugins&&i.plugins[f]){var m=document.createElement("div");m.id=n.id+"_"+c,m.style.position="absolute",m.style.top=0,m.style.zIndex=o+10,l[c]=h.getNewInstance(n,e.extend({},i.plugins[f]),m),o++,n.onReady(a(l[c],m,!0)),n.onResize(a(l[c],m))}}catch(g){e.log("ERROR: Failed to load "+c+".")}}),n.plugins=l,s},this.load=function(){if(!e.exists(a)||"object"===e.typeOf(a)){c=e.loaderstatus.LOADING,r(a,function(i){e.exists(i)&&(i=t.addPlugin(i),i.addEventListener(n.COMPLETE,o),i.addEventListener(n.ERROR,l))});var i=t.getPlugins();r(i,function(t,e){e.load()})}o()},this.destroy=function(){f=!0,m&&(m.resetEventListeners(),m=null)},this.pluginFailed=l,this.getStatus=function(){return c}}}(jwplayer),function(t){t.parsers={localName:function(t){return t?t.localName?t.localName:t.baseName?t.baseName:"":""},textContent:function(e){return e?e.textContent?t.utils.trim(e.textContent):e.text?t.utils.trim(e.text):"":""},getChildNode:function(t,e){return t.childNodes[e]},numChildren:function(t){return t.childNodes?t.childNodes.length:0}}}(jwplayer),function(t){var e=t.parsers;(e.jwparser=function(){}).parseEntry=function(n,i){for(var r=[],a=[],s=t.utils.xmlAttribute,o=0;o<n.childNodes.length;o++){var l=n.childNodes[o];if("jwplayer"===l.prefix){var u=e.localName(l);"source"===u?(delete i.sources,r.push({file:s(l,"file"),"default":s(l,"default"),label:s(l,"label"),type:s(l,"type")})):"track"===u?(delete i.tracks,a.push({file:s(l,"file"),"default":s(l,"default"),kind:s(l,"kind"),label:s(l,"label")})):(i[u]=t.utils.serialize(e.textContent(l)),"file"===u&&i.sources&&delete i.sources)}i.file||(i.file=i.link)}if(r.length)for(i.sources=[],o=0;o<r.length;o++)0<r[o].file.length&&(r[o]["default"]="true"===r[o]["default"]?!0:!1,r[o].label.length||delete r[o].label,i.sources.push(r[o]));if(a.length)for(i.tracks=[],o=0;o<a.length;o++)0<a[o].file.length&&(a[o]["default"]="true"===a[o]["default"]?!0:!1,a[o].kind=a[o].kind.length?a[o].kind:"captions",a[o].label.length||delete a[o].label,i.tracks.push(a[o]));return i}}(jwplayer),function(t){var e=jwplayer.utils,n=e.xmlAttribute,i=t.localName,r=t.textContent,a=t.numChildren,s=t.mediaparser=function(){};s.parseGroup=function(t,o){var l,u,c=[];for(u=0;u<a(t);u++)if(l=t.childNodes[u],"media"===l.prefix&&i(l))switch(i(l).toLowerCase()){case"content":n(l,"duration")&&(o.duration=e.seconds(n(l,"duration"))),0<a(l)&&(o=s.parseGroup(l,o)),n(l,"url")&&(o.sources||(o.sources=[]),o.sources.push({file:n(l,"url"),type:n(l,"type"),width:n(l,"width"),label:n(l,"label")}));break;case"title":o.title=r(l);break;case"description":o.description=r(l);break;case"guid":o.mediaid=r(l);break;case"thumbnail":o.image||(o.image=n(l,"url"));
break;case"group":s.parseGroup(l,o);break;case"subtitle":var h={};if(h.file=n(l,"url"),h.kind="captions",0<n(l,"lang").length){var d=h;l=n(l,"lang");var p={zh:"Chinese",nl:"Dutch",en:"English",fr:"French",de:"German",it:"Italian",ja:"Japanese",pt:"Portuguese",ru:"Russian",es:"Spanish"};l=p[l]?p[l]:l,d.label=l}c.push(h)}for(o.hasOwnProperty("tracks")||(o.tracks=[]),u=0;u<c.length;u++)o.tracks.push(c[u]);return o}}(jwplayer.parsers),function(t){function e(e){for(var r={},a=0;a<e.childNodes.length;a++){var o=e.childNodes[a],l=s(o);if(l)switch(l.toLowerCase()){case"enclosure":r.file=n.xmlAttribute(o,"url");break;case"title":r.title=i(o);break;case"guid":r.mediaid=i(o);break;case"pubdate":r.date=i(o);break;case"description":r.description=i(o);break;case"link":r.link=i(o);break;case"category":r.tags=r.tags?r.tags+i(o):i(o)}}return r=t.mediaparser.parseGroup(e,r),r=t.jwparser.parseEntry(e,r),new jwplayer.playlist.item(r)}var n=jwplayer.utils,i=t.textContent,r=t.getChildNode,a=t.numChildren,s=t.localName;t.rssparser={},t.rssparser.parse=function(t){for(var n=[],i=0;i<a(t);i++){var o=r(t,i);if("channel"===s(o).toLowerCase())for(var l=0;l<a(o);l++){var u=r(o,l);"item"===s(u).toLowerCase()&&n.push(e(u))}}return n}}(jwplayer.parsers),function(t){var e=t.utils,n=t._;t.playlist=function(e){var i=[];return e=n.isArray(e)?e:[e],n.each(e,function(e){i.push(new t.playlist.item(e))}),i},t.playlist.filterPlaylist=function(t,r){var a=[];return n.each(t,function(t){if(t=e.extend({},t),t.sources=i(t.sources,!1,r),t.sources.length){for(var n=0;n<t.sources.length;n++)t.sources[n].label=t.sources[n].label||n.toString();a.push(t)}}),a};var i=t.playlist.filterSources=function(i,r,a){var s,o=[],l=r?t.embed.flashCanPlay:t.embed.html5CanPlay;return i?(n.each(i,function(t){if(t&&t.file){var n=e.trim(""+t.file),i=t.type;i||(i=e.extension(n),i=e.extensionmap.extType(i)),t=e.extend({},t,{file:n,type:i})}else t=void 0;t&&l(t.file,t.type,a)&&(s=s||t.type,t.type===s&&o.push(t))}),o):void 0}}(jwplayer),function(t){var e=t.item=function(n){var i,r,a=jwplayer.utils,s=a.extend({},e.defaults,n);for(s.tracks=n&&a.exists(n.tracks)?n.tracks:[],0===s.sources.length&&(s.sources=[new t.source(s)]),i=0;i<s.sources.length;i++)r=s.sources[i]["default"],s.sources[i]["default"]=r?"true"===r.toString():!1,s.sources[i]=new t.source(s.sources[i]);if(s.captions&&!a.exists(n.tracks)){for(n=0;n<s.captions.length;n++)s.tracks.push(s.captions[n]);delete s.captions}for(i=0;i<s.tracks.length;i++)s.tracks[i]=new t.track(s.tracks[i]);return s};e.defaults={description:void 0,image:void 0,mediaid:void 0,title:void 0,sources:[],tracks:[]}}(jwplayer.playlist),function(t){var e=t.utils,n=t.events,i=t.parsers;t.playlist.loader=function(){function r(e){try{var r=e.responseXML.childNodes;e="";for(var a=0;a<r.length&&(e=r[a],!(8!==e.nodeType));a++);if("xml"===i.localName(e)&&(e=e.nextSibling),"rss"!==i.localName(e))s("Not a valid RSS feed");else{var l=new t.playlist(i.rssparser.parse(e));o.sendEvent(n.JWPLAYER_PLAYLIST_LOADED,{playlist:l})}}catch(u){s()}}function a(t){s(t.match(/invalid/i)?"Not a valid RSS feed":"")}function s(t){o.sendEvent(n.JWPLAYER_ERROR,{message:t?t:"Error loading file"})}var o=new n.eventdispatcher;e.extend(this,o),this.load=function(t){e.ajax(t,r,a)}}}(jwplayer),function(t){var e=jwplayer.utils,n={file:void 0,label:void 0,type:void 0,"default":void 0};t.source=function(t){var i=e.extend({},n);return e.foreach(n,function(n){e.exists(t[n])&&(i[n]=t[n],delete t[n])}),i.type&&0<i.type.indexOf("/")&&(i.type=e.extensionmap.mimeType(i.type)),"m3u8"===i.type&&(i.type="hls"),"smil"===i.type&&(i.type="rtmp"),i}}(jwplayer.playlist),function(t){var e=jwplayer.utils,n={file:void 0,label:void 0,kind:"captions","default":!1};t.track=function(t){var i=e.extend({},n);return t||(t={}),e.foreach(n,function(n){e.exists(t[n])&&(i[n]=t[n],delete t[n])}),i}}(jwplayer.playlist),function(t){function e(t,e,i){var r=t.style;r.backgroundColor="#000",r.color="#FFF",r.width=n.styleDimension(i.width),r.height=n.styleDimension(i.height),r.display="table",r.opacity=1,i=document.createElement("p"),r=i.style,r.verticalAlign="middle",r.textAlign="center",r.display="table-cell",r.font="15px/20px Arial, Helvetica, sans-serif",i.innerHTML=e.replace(":",":<br>"),t.innerHTML="",t.appendChild(i)}var n=t.utils,i=t.events,r=t._,a=t.embed=function(s){function o(){if(!b){var e=f.playlist;if(r.isArray(e)){if(0===e.length)return void c();if(!(1!==e.length||e[0].sources&&0!==e[0].sources.length&&e[0].sources[0].file))return void c()}if(!S)if(r.isString(e))p=new t.playlist.loader,p.addEventListener(i.JWPLAYER_PLAYLIST_LOADED,function(t){f.playlist=t.playlist,S=!1,o()}),p.addEventListener(i.JWPLAYER_ERROR,function(t){S=!1,c(t)}),S=!0,p.load(f.playlist);else if(_.getStatus()===n.loaderstatus.COMPLETE){for(e=0;e<f.modes.length;e++){var u=f.modes[e],d=u.type;if(d&&a[d]){var m=n.extend({},f);if(w=new a[d](k,u,m,_,s),w.supportsConfig())return w.addEventListener(i.ERROR,l),w.embed(),n.css("object.jwswf, .jwplayer:focus",{outline:"none"}),n.css(".jw-tab-focus:focus",{outline:"solid 2px #0B7EF4"}),s}}f.fallback?(e="No suitable players found and fallback enabled",h(e,!0),n.log(e),new a.download(k,f,c)):(e="No suitable players found and fallback disabled",h(e,!1),n.log(e))}}}function l(t){d(y+t.message)}function u(t){s.dispatchEvent(i.JWPLAYER_ERROR,{message:"Could not load plugin: "+t.message})}function c(t){d(t&&t.message?"Error loading playlist: "+t.message:y+"No playable sources found")}function h(t,e){clearTimeout(P),P=setTimeout(function(){s.dispatchEvent(i.JWPLAYER_SETUP_ERROR,{message:t,fallback:e})},0)}function d(t){b||(v.parentNode.replaceChild(k,v),f.fallback?(b=!0,e(k,t,f),h(t,!0)):h(t,!1))}var p,f=new a.config(s.config),m=f.width,g=f.height,y="Error loading player: ",v=document.getElementById(s.id),_=t.plugins.loadPlugins(s.id,f.plugins),S=!1,b=!1,w=null,P=-1;f.id=s.id,f.aspectratio?s.config.aspectratio=f.aspectratio:delete s.config.aspectratio;var C=s;n.foreach(f.events,function(t,e){var n=C[t];"function"==typeof n&&n.call(C,e)});var k=document.createElement("div");return k.id=v.id,k.style.width=0<m.toString().indexOf("%")?m:m+"px",k.style.height=0<g.toString().indexOf("%")?g:g+"px",this.embed=function(){b||(_.addEventListener(i.COMPLETE,o),_.addEventListener(i.ERROR,u),_.load())},this.destroy=function(){w&&(w.destroy(),w=null),_&&(_.destroy(),_=null),p&&(p.resetEventListeners(),p=null)},this.errorScreen=d,this};t.embed.errorScreen=e}(jwplayer),function(t){function e(t){if(t.playlist)for(var e=0;e<t.playlist.length;e++)t.playlist[e]=new r(t.playlist[e]);else{var a={};i.foreach(r.defaults,function(e){n(t,a,e)}),a.sources||(t.levels?(a.sources=t.levels,delete t.levels):(e={},n(t,e,"file"),n(t,e,"type"),a.sources=e.file?[e]:[])),t.playlist=[new r(a)]}}function n(t,e,n){i.exists(t[n])&&(e[n]=t[n],delete t[n])}var i=t.utils,r=t.playlist.item;(t.embed.config=function(n){var r={fallback:!0,height:270,primary:"html5",width:480,base:n.base?n.base:i.getScriptPath("jwplayer.js"),aspectratio:""};n=i.extend({},r,t.defaults,n);var r={type:"html5",src:"/jwplayer.html5.js"},a={type:"flash",src:"/jwplayer.flash.swf"};if(n.modes="flash"===n.primary?[a,r]:[r,a],n.listbar&&(n.playlistsize=n.listbar.size,n.playlistposition=n.listbar.position,n.playlistlayout=n.listbar.layout),n.flashplayer&&(a.src=n.flashplayer),n.html5player&&(r.src=n.html5player),e(n),a=n.aspectratio,"string"==typeof a&&i.exists(a)){var s=a.indexOf(":");-1===s?r=0:(r=parseFloat(a.substr(0,s)),a=parseFloat(a.substr(s+1)),r=0>=r||0>=a?0:100*(a/r)+"%")}else r=0;return-1===n.width.toString().indexOf("%")?delete n.aspectratio:r?n.aspectratio=r:delete n.aspectratio,n}).addConfig=function(t,n){return e(n),i.extend(t,n)}}(jwplayer),function(t){function e(t,e){function i(t,e){r[a].style[t]=e}for(var r=document.querySelectorAll(t),a=0;a<r.length;a++)n.foreach(e,i)}var n=t.utils;t.embed.download=function(t,i,r){function a(t,e,n){return t=document.createElement(t),e&&(t.className="jwdownload"+e),n&&n.appendChild(t),t}var s,o,l=n.extend({},i),u=l.width?l.width:480,c=l.height?l.height:320;i=i.logo?i.logo:{prefix:n.repo(),file:"logo.png",margin:10};var h,d,p,f,m,g;if(d=l.playlist,l=["mp4","aac","mp3"],d&&d.length){for(p=d[0],f=p.sources,d=0;d<f.length;d++)m=f[d],m.file&&(g=m.type||n.extensionmap.extType(n.extension(m.file)),0<=n.indexOf(l,g)?(s=m.file,o=p.image):n.isYouTube(m.file,g)&&(h=m.file));s?(r=s,t&&(s=a("a","display",t),a("div","icon",s),a("div","logo",s),r&&s.setAttribute("href",n.getAbsolutePath(r))),r="#"+t.id+" .jwdownload",t.style.width="",t.style.height="",e(r+"display",{width:n.styleDimension(Math.max(320,u)),height:n.styleDimension(Math.max(180,c)),background:"black center no-repeat "+(o?"url("+o+")":""),backgroundSize:"contain",position:"relative",border:"none",display:"block"}),e(r+"display div",{position:"absolute",width:"100%",height:"100%"}),e(r+"logo",{top:i.margin+"px",right:i.margin+"px",background:"top right no-repeat url("+i.prefix+i.file+")"}),e(r+"icon",{background:"center no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgNJREFUeNrs28lqwkAYB/CZqNVDDj2r6FN41QeIy8Fe+gj6BL275Q08u9FbT8ZdwVfotSBYEPUkxFOoks4EKiJdaDuTjMn3wWBO0V/+sySR8SNSqVRKIR8qaXHkzlqS9jCfzzWcTCYp9hF5o+59sVjsiRzcegSckFzcjT+ruN80TeSlAjCAAXzdJSGPFXRpAAMYwACGZQkSdhG4WCzehMNhqV6vG6vVSrirKVEw66YoSqDb7cqlUilE8JjHd/y1MQefVzqdDmiaJpfLZWHgXMHn8F6vJ1cqlVAkEsGuAn83J4gAd2RZymQygX6/L1erVQt+9ZPWb+CDwcCC2zXGJaewl/DhcHhK3DVj+KfKZrMWvFarcYNLomAv4aPRSFZVlTlcSPA5fDweW/BoNIqFnKV53JvncjkLns/n/cLdS+92O7RYLLgsKfv9/t8XlDn4eDyiw+HA9Jyz2eyt0+kY2+3WFC5hluej0Ha7zQQq9PPwdDq1Et1sNsx/nFBgCqWJ8oAK1aUptNVqcYWewE4nahfU0YQnk4ntUEfGMIU2m01HoLaCKbTRaDgKtaVLk9tBYaBcE/6Artdr4RZ5TB6/dC+9iIe/WgAMYADDpAUJAxjAAAYwgGFZgoS/AtNNTF7Z2bL0BYPBV3Jw5xFwwWcYxgtBP5OkE8i9G7aWGOOCruvauwADALMLMEbKf4SdAAAAAElFTkSuQmCC)"})):h?(i=h,t=a("iframe","",t),t.src="http://www.youtube.com/embed/"+n.youTubeID(i),t.width=u,t.height=c,t.style.border="none"):r()}}}(jwplayer),function(t){var e=t.utils,n=t.events,i={};(t.embed.flash=function(a,s,o,l,u){function c(t,e,n){var i=document.createElement("param");i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)}function h(t,e,n){return function(){try{n&&document.getElementById(u.id+"_wrapper").appendChild(e);var i=document.getElementById(u.id).getPluginConfig("display");"function"==typeof t.resize&&t.resize(i.width,i.height),e.style.left=i.x,e.style.top=i.h}catch(r){}}}function d(t){if(!t)return{};var n={},i=[];return e.foreach(t,function(t,r){var a=e.getPluginName(t);i.push(t),e.foreach(r,function(t,e){n[a+"."+t]=e})}),n.plugins=i.join(","),n}var p=new t.events.eventdispatcher,f=e.flashVersion();e.extend(this,p),this.embed=function(){if(o.id=u.id,10>f)return p.sendEvent(n.ERROR,{message:"Flash version must be 10.0 or greater"}),!1;var t,r,m=a.id,g=u.config.listbar,y=e.extend({},o);if(t=document.getElementById(u.id),t.parentNode.replaceChild(a,t),m+"_wrapper"===a.parentNode.id)t=document.getElementById(m+"_wrapper");else{if(t=document.createElement("div"),r=document.createElement("div"),r.style.display="none",r.id=m+"_aspect",t.id=m+"_wrapper",t.style.position="relative",t.style.display="block",t.style.width=e.styleDimension(y.width),t.style.height=e.styleDimension(y.height),u.config.aspectratio){var v=parseFloat(u.config.aspectratio);r.style.display="block",r.style.marginTop=u.config.aspectratio,t.style.height="auto",t.style.display="inline-block",g&&("bottom"===g.position?r.style.paddingBottom=g.size+"px":"right"===g.position&&(r.style.marginBottom=-1*g.size*(v/100)+"px"))}a.parentNode.replaceChild(t,a),t.appendChild(a),t.appendChild(r)}for(g=l.setupPlugins(u,y,h),0<g.length?e.extend(y,d(g.plugins)):delete y.plugins,"undefined"!=typeof y["dock.position"]&&"false"===y["dock.position"].toString().toLowerCase()&&(y.dock=y["dock.position"],delete y["dock.position"]),g=y.wmode||(y.height&&40>=y.height?"transparent":"opaque"),r="height width modes events primary base fallback volume".split(" "),v=0;v<r.length;v++)delete y[r[v]];r=e.getCookies(),e.foreach(r,function(t,e){"undefined"==typeof y[t]&&(y[t]=e)}),r=window.location.href.split("/"),r.splice(r.length-1,1),r=r.join("/"),y.base=r+"/",i[m]=y,e.isMSIE()?(a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%" id="'+m+'" name="'+m+'" tabindex="0"><param name="movie" value="'+s.src+'"><param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="always"><param name="seamlesstabbing" value="true"><param name="wmode" value="'+g+'"><param name="bgcolor" value="#000000"></object>',t=t.getElementsByTagName("object")[0],t.style.outline="none"):(t=document.createElement("object"),t.setAttribute("type","application/x-shockwave-flash"),t.setAttribute("data",s.src),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("bgcolor","#000000"),t.setAttribute("id",m),t.setAttribute("name",m),t.className="jwswf",c(t,"allowfullscreen","true"),c(t,"allowscriptaccess","always"),c(t,"seamlesstabbing","true"),c(t,"wmode",g),a.parentNode.replaceChild(t,a)),u.config.aspectratio&&(t.style.position="absolute",t.style.left="0"),u.container=t,u.setPlayer(t,"flash")},this.supportsConfig=function(){if(f){if(!o)return!0;if("string"===e.typeOf(o.playlist))return!0;try{var t=o.playlist[0].sources;if("undefined"==typeof t)return!0;for(var n=0;n<t.length;n++)if(t[n].file&&r(t[n].file,t[n].type))return!0}catch(i){}}return!1},this.destroy=function(){}}).getVars=function(t){return i[t]};var r=t.embed.flashCanPlay=function(t,n){if(e.isYouTube(t,n)||e.isRtmp(t,n)||"hls"===n)return!0;var i=e.extensionmap[n?n:e.extension(t)];return i?!!i.flash:!1}}(jwplayer),function(t){var e,n=t.utils,i=n.extensionmap,r=t.events;t.embed.html5=function(i,a,s,o,l){function u(t,e,n){return function(){try{var r=document.querySelector("#"+i.id+" .jwmain");n&&r.appendChild(e),"function"==typeof t.resize&&(t.resize(r.clientWidth,r.clientHeight),setTimeout(function(){t.resize(r.clientWidth,r.clientHeight)},400)),e.left=r.style.left,e.top=r.style.top}catch(a){}}}var c=new r.eventdispatcher;n.extend(this,c),this.embed=function(){if(t.html5){o.setupPlugins(l,s,u),n.emptyElement(i);var e=t.utils.extend({},s);delete e.volume,e=new t.html5.player(e),l.setPlayer(e,"html5")}else this.loadEmbedder()},this.loadEmbedder=function(){e=e||new n.scriptloader(a.src),e.addEventListener(r.ERROR,this.loadError),e.addEventListener(r.COMPLETE,this.embed),e.load()},this.loadError=function(t){this.sendEvent(t.type,{message:"HTML5 player not found"})},this.supportsConfig=function(){if(t.vid.canPlayType)try{if("string"===n.typeOf(s.playlist))return!0;for(var e=s.playlist[0].sources,i=0;i<e.length;i++)if(t.embed.html5CanPlay(e[i].file,e[i].type,s.androidhls))return!0}catch(r){}return!1},this.destroy=function(){e&&(e.resetEventListeners(),e=null)}},t.embed.html5CanPlay=function(e,r,a){if(null!==navigator.userAgent.match(/BlackBerry/i)||n.isIE(9))return!1;if(n.isYouTube(e,r))return!0;var s=n.extension(e);if(r=r||i.extType(s),"hls"===r)if(a){if(a=n.isAndroidNative,a(2)||a(3)||a("4.0"))return!1;if(n.isAndroid())return!0}else if(n.isAndroid())return!1;if(n.isRtmp(e,r))return!1;if(e=i[r]||i[s],!e||e.flash&&!e.html5)return!1;var o;t:if(e=e.html5){try{o=!!t.vid.canPlayType(e);break t}catch(l){}o=!1}else o=!0;return o}}(jwplayer),function(t){var e=t.embed,n=t.embed.html5CanPlay,i=t.utils,r=t._,a=/\.(js|swf)$/;t.cast=t.cast||{},t.embed=i.extend(function(n){function r(){s="Adobe SiteCatalyst Error: Could not find Media Module"}var s,o=i.repo(),l=i.extend({},t.defaults),u=i.extend({},l,n.config),c=n.config,h=u.plugins,d=u.analytics,p=o+"jwpsrv.js",f=o+"sharing.js",m=o+"related.js",g=o+"gapro.js",l=t.key?t.key:l.key,y=new t.utils.key(l).edition(),h=h?h:{};switch("ads"==y&&u.advertising&&(a.test(u.advertising.client)?h[u.advertising.client]=u.advertising:h[o+u.advertising.client+".js"]=u.advertising),delete c.advertising,c.key=l,u.analytics&&a.test(u.analytics.client)&&(p=u.analytics.client),delete c.analytics,d&&!("ads"===y||"enterprise"===y)&&delete d.enabled,"free"!=y&&d&&!1===d.enabled||(h[p]=d?d:{}),delete h.sharing,delete h.related,y){case"ads":case"enterprise":if(c.sitecatalyst)try{window.s&&window.s.hasOwnProperty("Media")?new t.embed.sitecatalyst(n):r()}catch(v){r()}case"premium":u.related&&(a.test(u.related.client)&&(m=u.related.client),h[m]=u.related),u.ga&&(a.test(u.ga.client)&&(g=u.ga.client),h[g]=u.ga);case"pro":u.sharing&&(a.test(u.sharing.client)&&(f=u.sharing.client),h[f]=u.sharing),u.skin&&(c.skin=u.skin.replace(/^(beelden|bekle|five|glow|modieus|roundster|stormtrooper|vapor)$/i,i.repo()+"skins/$1.xml"))}return c.plugins=h,n.config=c,n=new e(n),s&&n.errorScreen(s),n},t.embed),t.embed.html5CanPlay=function(e,i){var a,s={file:e,type:i};return a=t.html5&&t.html5.chooseProvider?t.html5.chooseProvider(s)!==t.html5.VideoProvider:r.any(t.unregisteredProviders,function(t){return t.supports(s)}),a?!0:n.apply(this,arguments)}}(jwplayer),function(t){var e=jwplayer.utils;t.sitecatalyst=function(t){function n(t){d.debug&&e.log(t)}function i(t){return t=t.split("/"),t=t[t.length-1],t=t.split("?"),t[0]}function r(){if(!f){f=!0;var t=h.getPosition();n("stop: "+o+" : "+t),s.Media.stop(o,t)}}function a(){m||(r(),m=!0,n("close: "+o),s.Media.close(o),c=!0,u=0)}var o,l,u,c,h=t,d=e.extend({},h.config.sitecatalyst),p={onPlay:function(){if(!c){var t=h.getPosition();f=!1,n("play: "+o+" : "+t),s.Media.play(o,t)}},onPause:r,onBuffer:r,onIdle:a,onPlaylistItem:function(t){try{c=!0,a(),u=0;var n;if(d.mediaName)n=d.mediaName;else{var r=h.getPlaylistItem(t.index);n=r.title?r.title:r.file?i(r.file):r.sources&&r.sources.length?i(r.sources[0].file):""}o=n,l=d.playerName?d.playerName:h.id}catch(s){e.log(s)}},onTime:function(){if(c){var t=h.getDuration();if(-1==t)return;m=f=c=!1,n("open: "+o+" : "+t+" : "+l),s.Media.open(o,t,l),n("play: "+o+" : 0"),s.Media.play(o,0)}if(t=h.getPosition(),3<=Math.abs(t-u)){var e=u;n("seek: "+e+" to "+t),n("stop: "+o+" : "+e),s.Media.stop(o,e),n("play: "+o+" : "+t),s.Media.play(o,t)}u=t},onComplete:a},f=!0,m=!0;e.foreach(p,function(t){h[t](p[t])})}}(jwplayer.embed),function(t){function e(t,e){t[e]&&(t[e]=n.getAbsolutePath(t[e]))}var n=t.utils,i=t._,r=window.location.href;t.cast.setupCastConfig=function(i,a){var s=n.extend({},i.config);s.cast=n.extend({pageUrl:r},a);for(var o="base autostart controls fallback fullscreen width height mobilecontrols modes playlistlayout playlistposition playlistsize primary stretching sharing related ga skin logo listbar events".split(" "),l=o.length;l--;)delete s[o[l]];o=s.plugins,delete s.plugins;for(var u in o)if(o.hasOwnProperty(u)){var c=o[u];if(c.client&&(/[\.\/]/.test(c.client)&&e(c,"client"),-1<c.client.indexOf("vast"))){if(l=s,c=n.extend({},c),c.client="vast",delete c.companiondiv,c.schedule){var h=void 0;for(h in c.schedule)c.schedule.hasOwnProperty(h)&&e(c.schedule[h].ad||c.schedule[h],"tag")}e(c,"tag"),l.advertising=c}}return i.position&&(s.position=i.position),0<i.item&&(s.item=i.item),s.captionLabel=n.getCookies().captionLabel,s.playerVersion=t.version,s},t.cast.setupFlashCastConfig=function(e){var r=e.config;r.playlist=e.getPlaylist();var a;return(a=i.find(r.plugins,function(t,e){return 0<e.indexOf("vast.js")}))?(a.client="vast",a={advertising:a}):a={},r=i.pick(r,"id captionLabel cast key playlist repeat".split(" ")),r.cast.pageUrl=window.location.href,n.extend(r,{playerVersion:t.version,captionLabel:n.getCookies().captionLabel,volume:e.getVolume(),mute:e.getMute(),id:e.id,position:e.getPosition(),item:e.getPlaylistIndex()},a),r}}(window.jwplayer),function(t,e){function n(t,e){t[e]&&(t[e]=r.getAbsolutePath(t[e]))}var i=e.cast,r=e.utils,a=e.events,s=a.state,o={};i.NS="urn:x-cast:com.longtailvideo.jwplayer",i.debug=!1,i.availability=null,i.available=function(e){e=e||i.availability;var n=t.chrome,r="available";return n.cast&&n.cast.ReceiverAvailability&&(r=n.cast.ReceiverAvailability.AVAILABLE),e===r},i.controller=function(l,u){function c(t,e){i.log("send command",t,e);var n={command:t};void 0!==e&&(n.args=e),F.sendMessage(i.NS,n,M,function(t){i.log("error message",t),"Invalid namespace"===t.description&&v()})}function h(t){t=!!i.available(t.availability),R.available!==t&&(R.available=t,m(a.JWPLAYER_CAST_AVAILABLE))}function d(t){i.log("existing session",t),!F&&!q&&(q=t.session,q.addMessageListener(i.NS,p))}function p(t,n){var r=JSON.parse(n);if(!r)throw"Message not proper JSON";if(r.reconcile){q.removeMessageListener(i.NS,p);var s=r.diff,o=q;s.id&&r.appid&&r.pageUrl||(s.id=e().id,r.appid=N.appid,r.pageUrl=B,q=F=null),s.id===l.id&&r.appid===N.appid&&r.pageUrl===B&&(F||(l.jwInstreamState()&&l.jwInstreamDestroy(!0),S(o),u.sendEvent(a.JWPLAYER_PLAYER_STATE,{oldstate:s.oldstate,newstate:s.newstate})),k(r)),q=null}}function f(t){R.active=!!t,t=R;var e;e=F&&F.receiver?F.receiver.friendlyName:"",t.deviceName=e,m(a.JWPLAYER_CAST_SESSION,{})}function m(t){var e=r.extend({},R);u.sendEvent(t,e)}function g(e){var n=t.chrome;e.code!==n.cast.ErrorCode.CANCEL&&(i.log("Cast Session Error:",e,F),e.code===n.cast.ErrorCode.SESSION_ERROR&&v())}function y(e){var n=t.chrome;e.code!==n.cast.ErrorCode.CANCEL&&(i.log("Cast Session Error:",e,F),e.code===n.cast.ErrorCode.SESSION_ERROR&&v())}function v(){F?(P(),F.stop(w,_),x({item:0}),k({type:"state",diff:{buffer:0,position:0,duration:0}})):w()}function _(t){i.error("Cast Session Stop error:",t,F),w()}function S(n){if(i.log("Session started:",n),F)v(),U=n;else{F=n,F.addMessageListener(i.NS,C),F.addUpdateListener(b),l.jwPause(!0),l.jwSetFullscreen(!1),$=u.getVideo(),j=u.volume,I=u.mute,O=new i.provider(c),O.init(),u.setVideoProvider(O),l.jwPlay=function(t){!1===t?O.pause():O.play()},l.jwPause=function(t){l.jwPlay(!!t)},l.jwLoad=function(t){"number"===r.typeOf(t)&&u.setItem(t),O.load(t)},l.jwPlaylistItem=function(t){"number"===r.typeOf(t)&&u.setItem(t),O.playlistItem(t)},l.jwPlaylistNext=function(){l.jwPlaylistItem(u.item+1)},l.jwPlaylistPrev=function(){l.jwPlaylistItem(u.item-1)},l.jwSetVolume=function(t){r.exists(t)&&(t=0|Math.min(Math.max(0,t),100),T(t)&&(t=Math.max(0,Math.min(t/100,1)),F.setReceiverVolumeLevel(t,E,function(t){i.error("set volume error",t),E()})))},l.jwSetMute=function(t){r.exists(t)||(t=!L.mute),A(t)&&F.setReceiverMuted(!!t,E,function(t){i.error("set muted error",t),E()})},l.jwGetVolume=function(){return 0|L.volume},l.jwGetMute=function(){return!!L.mute},l.jwIsBeforePlay=function(){return!1};var o=l.jwSetCurrentCaptions;l.jwSetCurrentCaptions=function(t){o(t),O.sendCommand("caption",t)},l.jwSkipAd=function(t){D&&(D.skipAd(t),t=D.getAdModel(),t.complete=!0,u.sendEvent(a.JWPLAYER_CAST_AD_CHANGED,t))},l.jwClickAd=function(n){if(D&&300<D.timeSinceClick()&&(D.clickAd(n),u.state!==s.PAUSED)){var i={tag:n.tag};n.sequence&&(i.sequence=n.sequence),n.podcount&&(i.podcount=n.podcount),e(l.id).dispatchEvent(a.JWPLAYER_AD_CLICK,i),t.open(n.clickthrough)}},l.jwPlayAd=l.jwPauseAd=l.jwSetControls=l.jwForceState=l.jwReleaseState=l.jwSetFullscreen=l.jwDetachMedia=l.jwAttachMedia=M;var h=e(l.id).plugins;h.vast&&h.vast.jwPauseAd!==M&&(z={jwPlayAd:h.vast.jwPlayAd,jwPauseAd:h.vast.jwPauseAd},h.vast.jwPlayAd=h.vast.jwPauseAd=M),E(),f(!0),n!==q&&(O.setup(e.cast.setupCastConfig(u,N),u),e.cast.loader.sendDummyMedia(n))}}function b(t){i.log("Cast Session status",t),t?E():(O.sendEvent(a.JWPLAYER_PLAYER_STATE,{oldstate:u.state,newstate:s.BUFFERING}),w())}function w(){if(i.log("_sessionStopped"),F&&(P(),F=null),$){delete l.jwSkipAd,delete l.jwClickAd,l.initializeAPI();var t=e(l.id).plugins;t.vast&&r.extend(t.vast,z),u.volume=j,u.mute=I,u.setVideoProvider($),u.duration=0,O&&(O.destroy(),O=null),D&&(D.destroy(),D=null),u.state!==s.IDLE?r.isIPad()||r.isIPod()?(l.jwStop(!0),$.sendEvent(a.JWPLAYER_PLAYER_STATE,{oldstate:s.BUFFERING,newstate:s.IDLE})):(u.state=s.IDLE,l.jwPlay(!0),l.jwSeek(u.position)):$.sendEvent(a.JWPLAYER_PLAYER_STATE,{oldstate:s.BUFFERING,newstate:s.IDLE}),$=null}f(!1),null!==U&&(S(U),U=null)}function P(){F.removeUpdateListener(b),F.removeMessageListener(i.NS,C)}function C(t,e){var n=JSON.parse(e);if(!n)throw"Message not proper JSON";k(n)}function k(t){if("state"===t.type)D&&(t.diff.newstate||t.diff.position)&&(D.destroy(),D=null,u.setVideoProvider(O),u.sendEvent(a.JWPLAYER_CAST_AD_CHANGED,{done:!0})),O.updateModel(t.diff,t.type),x(t.diff);else if("ad"===t.type){null===D&&(D=new i.adprovider(i.NS,F),D.init(),u.setVideoProvider(D)),D.updateModel(t.diff,t.type);var e=D.getAdModel();t.diff.clickthrough&&(e.onClick=l.jwClickAd),t.diff.skipoffset&&(e.onSkipAd=l.jwSkipAd),u.sendEvent(a.JWPLAYER_CAST_AD_CHANGED,e),t.diff.complete&&D.resetAdModel()}else"connection"===t.type?!0===t.closed&&v():i.error("received unhandled message",t.type,t)}function x(t){void 0!==t.item&&u.item!==t.item&&(u.item=t.item,u.sendEvent(a.JWPLAYER_PLAYLIST_ITEM,{index:u.item}))}function E(){if(F&&F.receiver){var t=F.receiver.volume;if(t){var e=100*t.level|0;A(!!t.muted),T(e)}}}function T(t){var e=L.volume!==t;return e&&(L.volume=t,O.sendEvent(a.JWPLAYER_MEDIA_VOLUME,{volume:t})),e}function A(t){var e=L.mute!==t;return e&&(L.mute=t,O.sendEvent(a.JWPLAYER_MEDIA_MUTE,{mute:t})),e}function M(){}var j,I,N,F=null,R={available:!1,active:!1,deviceName:""},L={volume:null,mute:null},B=r.getAbsolutePath(t.location.href),O=null,D=null,$=null;j=u.volume,I=u.mute;var q=null,U=null,z=null;N=r.extend({},o,u.cast),n(N,"loadscreen"),n(N,"endscreen"),n(N,"logo"),!N.appid||t.cast&&t.cast.receiver||(i.loader.addEventListener("availability",h),i.loader.addEventListener("session",d),i.loader.initialize(N.appid)),this.startCasting=function(){F||l.jwInstreamState()||t.chrome.cast.requestSession(S,g)},this.stopCasting=v,this.openExtension=function(){l.jwInstreamState()||t.chrome.cast.requestSession(S,y)}},i.log=function(){if(i.debug){var t=Array.prototype.slice.call(arguments,0);console.log.apply(console,t)}},i.error=function(){var t=Array.prototype.slice.call(arguments,0);console.error.apply(console,t)}}(window,jwplayer),function(t){function e(t){y.log("existing session",t),!g&&!f&&(f=t.session,f.addMessageListener(y.NS,n))}function n(e,i){var r=JSON.parse(i),a=f;if(!r)throw"Message not proper JSON";r.reconcile&&(f.removeMessageListener(y.NS,n),r.receiverFriendlyName=f.receiver.friendlyName,r.pageUrl&&r.diff.id&&r.appid||(r.pageUrl=P,r.diff.id=t().id,r.appid=p,f=g=null),b[r.diff.id]&&p===r.appid&&r.pageUrl===P&&(d=r.diff.id,p=r.appid,c(d,"jwInstreamDestroy"),s(a),c(d,w.message,r),f=null))}function i(){g&&(g.removeUpdateListener(u),g.removeMessageListener(y.NS,o),g.stop(r.bind(this),l.bind(this)),g=null),c(d,w.cleanup)}function r(){"undefined"!=typeof m&&null!==m&&(s(m),m=null)}function a(t,e){g.sendMessage(y.NS,{command:t,args:e},v.noop,function(t){y.error("message send error",t)})}function s(e){var n=t(d);g?(i(),m=e):(g=e,g.addMessageListener(y.NS,o),g.addUpdateListener(u),n=t.cast.setupFlashCastConfig(n),f!==g&&(a("setup",n),t.cast.loader.sendDummyMedia(g)),c(d,w.connected,{receiverFriendlyName:e.receiver.friendlyName}))}function o(t,e){if(e){var n=JSON.parse(e);if(!n)throw"Message not proper JSON";c(d,w.message,n)}}function l(t){c(d,w.error,t||{})}function u(t){t?h():i()}function c(e,n,i){i?t(e).callInternal(n,i):t(e).callInternal(n)}function h(){if(g&&g.receiver){var e=g.receiver.volume;if(e){var n=100*e.level|0,e=!!e.muted;t(d).setVolume(n).setMute(e)}}}var d,p,f,m,g,y=t.cast,v=t.utils,_=t._,S=window.chrome||{},b={},w={},P=v.getAbsolutePath(window.location.href);y.NS="urn:x-cast:com.longtailvideo.jwplayer",y.flash={checkAvailability:function(t,n,i){w=i,p=n,b[t]=!0,y.loader.addEventListener("availability",function(e){"available"===e.availability&&c(t,w.available,e)}),y.loader.addEventListener("session",e),y.loader.initialize(n)},startCasting:function(t){d=t,S.cast.requestSession(s.bind(this),l.bind(this))},stopCasting:i,openExtension:function(t){d=t,S.cast.requestSession(s.bind(this),l.bind(this))},mute:function(t){g.setReceiverMuted(t,h,function(t){y.error("set muted error",t)})},volume:function(t){t=Math.max(0,Math.min(t/100,1)),g.setReceiverVolumeLevel(t,h,function(t){y.error("set volume error",t)})},messageReceiver:a,canCastItem:function(e){return _.any(e.levels,function(e){return t.embed.html5CanPlay(e.file,e.type)||"hls"===e.type})}}}(window.jwplayer),function(t,e){function n(t){var n=new e.cast.media.MediaInfo("");n.contentType="video/mp4",n=new e.cast.media.LoadRequest(n),n.autoplay=!1,t.loadMedia(n)}function i(){e&&e.cast&&e.cast.isAvailable&&!c.apiConfig?(c.apiConfig=new e.cast.ApiConfig(new e.cast.SessionRequest(f),o,l,e.cast.AutoJoinPolicy.ORIGIN_SCOPED),e.cast.initialize(c.apiConfig,s,a)):15>p++&&setTimeout(i,1e3)}function r(){u&&(u.resetEventListeners(),u=null)}function a(){c.apiConfig=null}function s(){}function o(t){m.sendEvent("session",{session:t}),t.sendMessage(c.NS,{whoami:1}),0===t.media.length&&n(t)}function l(t){c.availability=t,m.sendEvent("availability",{availability:t})}window.chrome=e;var u,c=t.cast,h=t.utils,d=t.events,p=0,f=null,m=h.extend({initialize:function(t){f=t,null!==c.availability?m.sendEvent("availability",{availability:c.availability}):e&&e.cast?i():u||(u=new h.scriptloader("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"),u.addEventListener(d.ERROR,r),u.addEventListener(d.COMPLETE,i),u.load())}},new d.eventdispatcher("cast.loader"));t.cast.loader=m,t.cast.loader.sendDummyMedia=n}(window.jwplayer,window.chrome||{}),function(t,e){var n=[],i=t.utils,r=t.events,a=t._,s=0,o=r.state,l="getBuffer getCaptionsList getControls getCurrentCaptions getCurrentQuality getCurrentAudioTrack getDuration getFullscreen getHeight getLockState getMute getPlaylistIndex getSafeRegion getPosition getQualityLevels getState getVolume getWidth isBeforeComplete isBeforePlay releaseState".split(" "),u="playlistNext stop forceState playlistPrev seek setCurrentCaptions setControls setCurrentQuality setVolume setCurrentAudioTrack".split(" "),c={onBufferChange:r.JWPLAYER_MEDIA_BUFFER,onBufferFull:r.JWPLAYER_MEDIA_BUFFER_FULL,onError:r.JWPLAYER_ERROR,onSetupError:r.JWPLAYER_SETUP_ERROR,onFullscreen:r.JWPLAYER_FULLSCREEN,onMeta:r.JWPLAYER_MEDIA_META,onMute:r.JWPLAYER_MEDIA_MUTE,onPlaylist:r.JWPLAYER_PLAYLIST_LOADED,onPlaylistItem:r.JWPLAYER_PLAYLIST_ITEM,onPlaylistComplete:r.JWPLAYER_PLAYLIST_COMPLETE,onReady:r.API_READY,onResize:r.JWPLAYER_RESIZE,onComplete:r.JWPLAYER_MEDIA_COMPLETE,onSeek:r.JWPLAYER_MEDIA_SEEK,onTime:r.JWPLAYER_MEDIA_TIME,onVolume:r.JWPLAYER_MEDIA_VOLUME,onBeforePlay:r.JWPLAYER_MEDIA_BEFOREPLAY,onBeforeComplete:r.JWPLAYER_MEDIA_BEFORECOMPLETE,onDisplayClick:r.JWPLAYER_DISPLAY_CLICK,onControls:r.JWPLAYER_CONTROLS,onQualityLevels:r.JWPLAYER_MEDIA_LEVELS,onQualityChange:r.JWPLAYER_MEDIA_LEVEL_CHANGED,onCaptionsList:r.JWPLAYER_CAPTIONS_LIST,onCaptionsChange:r.JWPLAYER_CAPTIONS_CHANGED,onAdError:r.JWPLAYER_AD_ERROR,onAdClick:r.JWPLAYER_AD_CLICK,onAdImpression:r.JWPLAYER_AD_IMPRESSION,onAdTime:r.JWPLAYER_AD_TIME,onAdComplete:r.JWPLAYER_AD_COMPLETE,onAdCompanions:r.JWPLAYER_AD_COMPANIONS,onAdSkipped:r.JWPLAYER_AD_SKIPPED,onAdPlay:r.JWPLAYER_AD_PLAY,onAdPause:r.JWPLAYER_AD_PAUSE,onAdMeta:r.JWPLAYER_AD_META,onCast:r.JWPLAYER_CAST_SESSION,onAudioTrackChange:r.JWPLAYER_AUDIO_TRACK_CHANGED,onAudioTracks:r.JWPLAYER_AUDIO_TRACKS},h={onBuffer:o.BUFFERING,onPause:o.PAUSED,onPlay:o.PLAYING,onIdle:o.IDLE};t.api=function(s){function d(t,e){i.foreach(t,function(t,n){_[t]=function(t){return e(n,t)}})}function p(t,e){var n="jw"+e.charAt(0).toUpperCase()+e.slice(1);_[e]=function(){var e=g.apply(this,[n].concat(Array.prototype.slice.call(arguments,0)));return t?_:e}}function f(t,e){try{t.jwAddEventListener(e,'function(dat) { jwplayer("'+_.id+'").dispatchEvent("'+e+'", dat); }')}catch(n){if("flash"===_.renderingMode){var r=document.createElement("a");r.href=y.data,r.protocol!==location.protocol&&i.log("Warning: Your site ["+location.protocol+"] and JWPlayer ["+r.protocol+"] are hosted using different protocols")}i.log("Could not add internal listener")}}function m(t,e){return S[t]||(S[t]=[],y&&w&&f(y,t)),S[t].push(e),_}function g(){if(w){if(y){var t=Array.prototype.slice.call(arguments,0),e=t.shift();if("function"==typeof y[e]){switch(t.length){case 6:return y[e](t[0],t[1],t[2],t[3],t[4],t[5]);case 5:return y[e](t[0],t[1],t[2],t[3],t[4]);case 4:return y[e](t[0],t[1],t[2],t[3]);case 3:return y[e](t[0],t[1],t[2]);case 2:return y[e](t[0],t[1]);case 1:return y[e](t[0])}return y[e]()}}return null}P.push(arguments)}var y,v,_=this,S={},b={},w=!1,P=[],C={},k={};return _.container=s,_.id=s.id,_.setup=function(e){if(t.embed){t.api.destroyPlayer(_.id);var n=new t.api(_.container);return t.api.addPlayer(n),n.config=e,n._embedder=new t.embed(n),n._embedder.embed(),n}return _},_.getContainer=function(){return _.container},_.addButton=function(t,e,n,r){try{k[r]=n,g("jwDockAddButton",t,e,'jwplayer("'+_.id+'").callback("'+r+'")',r);
}catch(a){i.log("Could not add dock button"+a.message)}},_.removeButton=function(t){g("jwDockRemoveButton",t)},_.callback=function(t){k[t]&&k[t]()},_.getMeta=function(){return _.getItemMeta()},_.getPlaylist=function(){var t=g("jwGetPlaylist");return"flash"===_.renderingMode&&i.deepReplaceKeyName(t,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),t},_.getPlaylistItem=function(t){return i.exists(t)||(t=_.getPlaylistIndex()),_.getPlaylist()[t]},_.getRenderingMode=function(){return _.renderingMode},_.setFullscreen=function(t){return i.exists(t)?g("jwSetFullscreen",t):g("jwSetFullscreen",!g("jwGetFullscreen")),_},_.setMute=function(t){return i.exists(t)?g("jwSetMute",t):g("jwSetMute",!g("jwGetMute")),_},_.lock=function(){return _},_.unlock=function(){return _},_.load=function(e){return g("jwInstreamDestroy"),t(_.id).plugins.googima&&g("jwDestroyGoogima"),g("jwLoad",e),_},_.playlistItem=function(t){return g("jwPlaylistItem",parseInt(t,10)),_},_.resize=function(t,e){if("flash"!==_.renderingMode)g("jwResize",t,e);else{var n=document.getElementById(_.id+"_wrapper"),r=document.getElementById(_.id+"_aspect");r&&(r.style.display="none"),n&&(n.style.display="block",n.style.width=i.styleDimension(t),n.style.height=i.styleDimension(e))}return _},_.play=function(t){if(t!==e)return g("jwPlay",t),_;t=_.getState();var n=v&&v.getState();return n&&g(n===o.IDLE||n===o.PLAYING||n===o.BUFFERING?"jwInstreamPause":"jwInstreamPlay"),g(t===o.PLAYING||t===o.BUFFERING?"jwPause":"jwPlay"),_},_.pause=function(t){return t===e?(t=_.getState(),g(t===o.PLAYING||t===o.BUFFERING?"jwPause":"jwPlay")):g("jwPause",t),_},_.createInstream=function(){return new t.api.instream(this,y)},_.setInstream=function(t){return v=t},_.loadInstream=function(t,e){return v=_.setInstream(_.createInstream()).init(e),v.loadItem(t),v},_.destroyPlayer=function(){w=!0,g("jwPlayerDestroy")},_.playAd=function(e){var n=t(_.id).plugins;n.vast?n.vast.jwPlayAd(e):g("jwPlayAd",e)},_.pauseAd=function(){var e=t(_.id).plugins;e.vast?e.vast.jwPauseAd():g("jwPauseAd")},d(h,function(t,e){return b[t]||(b[t]=[],m(r.JWPLAYER_PLAYER_STATE,function(e){var n=e.newstate;if(e=e.oldstate,n===t){var i=b[n];if(i)for(var r=0;r<i.length;r++){var a=i[r];"function"==typeof a&&a.call(this,{oldstate:e,newstate:n})}}})),b[t].push(e),_}),d(c,m),i.foreach(l,function(t,e){p(!1,e)}),i.foreach(u,function(t,e){p(!0,e)}),_.remove=function(){this._embedder&&this._embedder.destroy&&this._embedder.destroy(),P=[];var t=1<a.size(a.where(n,{id:_.id}));t||i.clearCss("#"+_.id);var e=document.getElementById(_.id+("flash"===_.renderingMode?"_wrapper":""));if(e){if("html5"===_.renderingMode)_.destroyPlayer();else if(i.isMSIE(8)){var r=document.getElementById(_.id);if(r&&r.parentNode){r.style.display="none";for(var s in r)"function"==typeof r[s]&&(r[s]=null);r.parentNode.removeChild(r)}}t||(t=document.createElement("div"),t.id=_.id,e.parentNode.replaceChild(t,e))}n=a.filter(n,function(t){return t.uniqueId!==_.uniqueId})},_.registerPlugin=function(e,n,i,r){t.plugins.registerPlugin(e,n,i,r)},_.setPlayer=function(t,e){y=t,_.renderingMode=e},_.detachMedia=function(){return"html5"===_.renderingMode?g("jwDetachMedia"):void 0},_.attachMedia=function(t){return"html5"===_.renderingMode?g("jwAttachMedia",t):void 0},_.getAudioTracks=function(){return g("jwGetAudioTracks")},_.removeEventListener=function(t,e){var n=S[t];if(n)for(var i=n.length;i--;)n[i]===e&&n.splice(i,1)},_.dispatchEvent=function(t,e){var n=S[t];if(n)for(var n=n.slice(0),a=i.translateEventResponse(t,e),s=0;s<n.length;s++){var o=n[s];if("function"==typeof o)try{t===r.JWPLAYER_PLAYLIST_LOADED&&i.deepReplaceKeyName(a.playlist,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),o.call(this,a)}catch(l){i.log("There was an error calling back an event handler",l)}}},_.dispatchInstreamEvent=function(t){v&&v.dispatchEvent(t,arguments)},_.callInternal=g,_.playerReady=function(t){for(w=!0,y||_.setPlayer(document.getElementById(t.id)),_.container=document.getElementById(_.id),i.foreach(S,function(t){f(y,t)}),m(r.JWPLAYER_PLAYLIST_ITEM,function(){C={}}),m(r.JWPLAYER_MEDIA_META,function(t){i.extend(C,t.metadata)}),m(r.JWPLAYER_VIEW_TAB_FOCUS,function(t){var e=_.getContainer();!0===t.hasFocus?i.addClass(e,"jw-tab-focus"):i.removeClass(e,"jw-tab-focus")}),_.dispatchEvent(r.API_READY);0<P.length;)g.apply(_,P.shift())},_.getItemMeta=function(){return C},_},t.playerReady=function(e){var n=t.api.playerById(e.id);n||(n=t.api.selectPlayer(e.id)),n.playerReady(e)},t.api.selectPlayer=function(e){var r;return i.exists(e)||(e=0),e.nodeType?r=e:"string"==typeof e&&(r=document.getElementById(e)),r?(e=t.api.playerById(r.id))?e:new t.api(r):"number"==typeof e?n[e]:null},t.api.playerById=function(t){for(var e=0;e<n.length;e++)if(n[e].id===t)return n[e];return null},t.api.addPlayer=function(t){for(var e=0;e<n.length;e++)if(n[e]===t)return t;return s++,t.uniqueId=s,n.push(t),t},t.api.destroyPlayer=function(t){t=a.where(n,{id:t}),a.each(t,a.partial(a.result,a,"remove"))}}(window.jwplayer),function(t){var e=t.events,n=t.utils,i=e.state;t.api.instream=function(t,r){function a(e,n){return u[e]||(u[e]=[],r.jwInstreamAddEventListener(e,'function(dat) { jwplayer("'+t.id+'").dispatchInstreamEvent("'+e+'", dat); }')),u[e].push(n),this}function s(t,n){return c[t]||(c[t]=[],a(e.JWPLAYER_PLAYER_STATE,function(e){var n=e.newstate,i=e.oldstate;if(n===t){var r=c[n];if(r)for(var a=0;a<r.length;a++){var s=r[a];"function"==typeof s&&s.call(this,{oldstate:i,newstate:n,type:e.type})}}})),c[t].push(n),this}var o,l,u={},c={},h=this;h.type="instream",h.init=function(){return t.callInternal("jwInitInstream"),h},h.loadItem=function(e,i){o=e,l=i||{},"array"===n.typeOf(e)?t.callInternal("jwLoadArrayInstream",o,l):t.callInternal("jwLoadItemInstream",o,l)},h.removeEvents=function(){u=c={}},h.removeEventListener=function(t,e){var n=u[t];if(n)for(var i=n.length;i--;)n[i]===e&&n.splice(i,1)},h.dispatchEvent=function(t,e){var i=u[t];if(i)for(var i=i.slice(0),r=n.translateEventResponse(t,e[1]),a=0;a<i.length;a++){var s=i[a];"function"==typeof s&&s.call(this,r)}},h.onError=function(t){return a(e.JWPLAYER_ERROR,t)},h.onMediaError=function(t){return a(e.JWPLAYER_MEDIA_ERROR,t)},h.onFullscreen=function(t){return a(e.JWPLAYER_FULLSCREEN,t)},h.onMeta=function(t){return a(e.JWPLAYER_MEDIA_META,t)},h.onMute=function(t){return a(e.JWPLAYER_MEDIA_MUTE,t)},h.onComplete=function(t){return a(e.JWPLAYER_MEDIA_COMPLETE,t)},h.onPlaylistComplete=function(t){return a(e.JWPLAYER_PLAYLIST_COMPLETE,t)},h.onPlaylistItem=function(t){return a(e.JWPLAYER_PLAYLIST_ITEM,t)},h.onTime=function(t){return a(e.JWPLAYER_MEDIA_TIME,t)},h.onBuffer=function(t){return s(i.BUFFERING,t)},h.onPause=function(t){return s(i.PAUSED,t)},h.onPlay=function(t){return s(i.PLAYING,t)},h.onIdle=function(t){return s(i.IDLE,t)},h.onClick=function(t){return a(e.JWPLAYER_INSTREAM_CLICK,t)},h.onInstreamDestroyed=function(t){return a(e.JWPLAYER_INSTREAM_DESTROYED,t)},h.onAdSkipped=function(t){return a(e.JWPLAYER_AD_SKIPPED,t)},h.play=function(t){r.jwInstreamPlay(t)},h.pause=function(t){r.jwInstreamPause(t)},h.hide=function(){t.callInternal("jwInstreamHide")},h.destroy=function(){h.removeEvents(),t.callInternal("jwInstreamDestroy")},h.setText=function(t){r.jwInstreamSetText(t?t:"")},h.getState=function(){return r.jwInstreamState()},h.setClick=function(t){r.jwInstreamClick&&r.jwInstreamClick(t)}}}(jwplayer),function(t){var e=t.api,n=e.selectPlayer,i=t._;e.selectPlayer=function(e){var i=n.apply(this,arguments);return i?i:{registerPlugin:function(e,n,i){"jwpsrv"!==e&&t.plugins.registerPlugin(e,n,i)}}},t.unregisteredProviders=[],e.registerProvider=function(e){t&&t.html5&&i.isFunction(t.html5.registerProvider)?t.html5.registerProvider(e):t.unregisteredProviders.push(e)}}(jwplayer)),define("jwplayer",function(t){return function(){var e;return e||t.jwplayer}}(this)),define("$app/ui/shared/with_video_player",["jwplayer"],function(t){function e(){this.defaultAttrs({videoPlayerContainerSelector:".js-video-player-container",videoPlayerSelector:".js-video-player-container .js-player",key:"FMI/v7DXhGXdQG6IsKbx51oEIvU4f2p5OA2XEvFWWwo=",fakeVideoUrlGuidForObfuscation:"ef64f2fef0d6c776a337050020423fc0"}),this.stopVideo=function(e){this.attr.videoPlayerName&&"stopPreviews"==e.data&&t(this.attr.videoPlayerName).pause(!0)},this.initializeVideoPlayer=function(e){var n=this.select("videoPlayerContainerSelector");if(n.data("url")&&""!==n.data("url")){this.attr.videoPlayerName=this.select("videoPlayerSelector").attr("id");var i=n.data("url"),r=n.data("guid"),a={width:e&&e.width?e.width:"100%",height:e&&e.height?e.height:"100%",primary:"flash",skin:"/skins/bekle.xml"};i=i.replace(this.attr.fakeVideoUrlGuidForObfuscation,r),n.data("smil-url")?(a.playlist=[{sources:[{file:n.data("smil-url")},{file:i}]}],a.rtmp={bufferlength:4}):n.data("playlist-url")?a.playlist=[{sources:[{file:n.data("playlist-url")},{file:i}],tracks:n.data("subtitle-urls")}]:a.file=i,t.key=this.attr.key,t(this.attr.videoPlayerName).setup(a)}},this.after("initialize",function(){window.addEventListener?window.addEventListener("message",this.stopVideo.bind(this)):window.attachEvent("message",this.stopVideo.bind(this))})}return e}),define("hbs!$app/templates/preview",["hbs","hbs/handlebars","./helpers/t"],function(t,e){var n=e.template({1:function(t,e,n,i){var r;return'  <div class="audio-preview-container">\n    <div class="audio-player js-audio-player">\n      <div class="player" data-url="'+this.escapeExpression((r=null!=(r=e.url||(null!=t?t.url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"url",hash:{},data:i}):r))+'"></div>\n      <a class="play-button media-control jp-play">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"play",{name:"t",hash:{},data:i}))+'</a>\n      <a class="pause-button media-control jp-pause">'+this.escapeExpression((e.t||t&&t.t||e.helperMissing).call(t,"pause",{name:"t",hash:{},data:i}))+'</a>\n      <div class="audio-progress">\n        <svg height="80" version="1.1" width="80" xmlns="http://www.w3.org/2000/svg">\n          <path class="circle-progress" d="M 40 3 a 37 37 0 0 1 0 0" fill="none" opacity="1" stroke-width="5" stroke="#aaa" style="opacity: 1;"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n'},3:function(t,e,n,i){var r,a;return'  <div class="image-preview-container">\n    <img class="preview" src="'+this.escapeExpression((a=null!=(a=e.url||(null!=t?t.url:t))?a:e.helperMissing,"function"==typeof a?a.call(t,{name:"url",hash:{},data:i}):a))+'" itemprop="image"'+(null!=(r=e["if"].call(t,null!=t?t.width:t,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?r:"")+"></img>\n  </div>\n"},4:function(t,e,n,i){var r;return' style="max-width: '+this.escapeExpression((r=null!=(r=e.width||(null!=t?t.width:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"width",hash:{},data:i}):r))+'px;"'},6:function(t,e,n,i){var r;return'  <div class="oembed-preview-container">\n    <iframe class="js-oembed-iframe" width="'+this.escapeExpression((r=null!=(r=e.width||(null!=t?t.width:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"width",hash:{},data:i}):r))+'" height="'+this.escapeExpression((r=null!=(r=e.height||(null!=t?t.height:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"height",hash:{},data:i}):r))+'" data-oembed-url="'+this.escapeExpression((r=null!=(r=e.url||(null!=t?t.url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"url",hash:{},data:i}):r))+'" allowfullscreen="true" frameborder="0"></iframe>\n  </div>\n'},8:function(t,e,n,i){var r;return'  <div class="video-preview-container js-video-player-container" data-url="'+this.escapeExpression((r=null!=(r=e.url||(null!=t?t.url:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"url",hash:{},data:i}):r))+'" data-width="'+this.escapeExpression((r=null!=(r=e.width||(null!=t?t.width:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"width",hash:{},data:i}):r))+'" data-height="'+this.escapeExpression((r=null!=(r=e.height||(null!=t?t.height:t))?r:e.helperMissing,"function"==typeof r?r.call(t,{name:"height",hash:{},data:i}):r))+'">\n    <div id="video-player" class="js-player"></div>\n  </div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,i){var r;return(null!=(r=e["if"].call(t,null!=t?t.audio_preview:t,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?r:"")+"\n"+(null!=(r=e["if"].call(t,null!=t?t.image_preview:t,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?r:"")+"\n"+(null!=(r=e["if"].call(t,null!=t?t.oembed_preview:t,{name:"if",hash:{},fn:this.program(6,i,0),inverse:this.noop,data:i}))?r:"")+"\n"+(null!=(r=e["if"].call(t,null!=t?t.video_preview:t,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?r:"")},useData:!0});return e.registerPartial("$app/templates/preview",n),n}),function(){define("$app/ui/shared/with_preview",["flight/lib/compose","hbs!$app/templates/preview","$app/ui/shared/with_audio_player","$app/ui/shared/with_video_player","$app/templates/helpers/t"],function(t,e,n,i){function r(){t.mixin(this,[n,i]),this.defaultAttrs({defaultImageWidth:1005,iframeSelector:".js-oembed-iframe",multiPreviewContainerSelector:".js-preview-container",previewArrowSelector:".js-preview-arrow",previewArrowVisibleSelector:".js-preview-arrow.showing",previewContentSelector:".js-preview-content",previewImageSelector:"img.preview",previewPickerSelector:".js-preview-picker",previewPickerItemSelector:".js-preview-picker-item"}),this.addOrientationChangeListeners=function(){this.attr.isMobile&&$.each(["portrait","landscape"],function(t,e){window.matchMedia("(orientation: "+e+")").addListener(function(t){t.matches&&this.showPreview()}.bind(this))}.bind(this))},this.getDimensions=function(){var t=this.$node.parent().width()/this.attr.activePreview.native_width,e={width:this.attr.activePreview.width,height:this.attr.activePreview.height};return 1>t&&this.attr.activePreview&&!this.attr.isFixedHeight&&(e.width=this.attr.activePreview.native_width*t,e.height=this.attr.activePreview.native_height*t),e},this.initializePreviewMediaPlayer=function(){this.attr.activePreview&&("audio"===this.attr.activePreview.type?this.initializePlayer():"video"===this.attr.activePreview.type&&this.initializeVideoPlayer({height:this.select("multiPreviewContainerSelector").height(),width:this.select("multiPreviewContainerSelector").width()}))},this.initializePreview=function(){this.attr.activePreviewId=this.select("multiPreviewContainerSelector").data("active-preview-id"),this.attr.productPermalink=this.select("multiPreviewContainerSelector").data("product-permalink"),this.attr.assetPreviews=this.select("multiPreviewContainerSelector").data("asset-previews"),this.setActivePreview(),this.attr.activePreview&&this.showPreview()},this.keyAction=function(t){!$(t.target).filter("input, [data-medium-element]").length&&this.attr.onProductPage&&(37===t.which&&this.attr.activePreviewIndex>0?(this.attr.activePreviewId=this.attr.assetPreviews[this.attr.activePreviewIndex-1].id,this.showPreview()):39===t.which&&this.attr.activePreviewIndex<this.attr.assetPreviews.length-1&&(this.attr.activePreviewId=this.attr.assetPreviews[this.attr.activePreviewIndex+1].id,this.showPreview()))},this.pauseVideo=function(){this.toggleVideo(!1)},this.playVideo=function(){this.toggleVideo(!0)},this.populateOembedUrl=function(){var t=this.select("previewContentSelector").find("iframe");t.data("oembed-url")&&!t.attr("src")&&t.attr("src",t.data("oembed-url"))},this.populatePreview=function(){if(!this.attr.activePreviewId)return void this.select("multiPreviewContainerSelector").css({background:"",height:""}).addClass("default-preview");this.select("multiPreviewContainerSelector").removeClass("default-preview"),$(".product.popped .preview-container").css({height:""});var t=this.getDimensions(),n={width:"auto",height:"auto"},i="",r=this.$node.width()>this.attr.defaultImageWidth?this.attr.activePreview.original_url:this.attr.activePreview.url;"image"===this.attr.activePreview.type&&this.attr.isImageAsBackground?(n=$.extend(n,{"background-repeat":"no-repeat","background-position":"top center","background-image":"url("+r+")","background-size":"cover"}),this.attr.isMobile&&$.extend(n,t),(this.attr.isFixedHeight||this.$node.parents(".gridster").length)&&$.extend(n,{width:"100%",height:"100%"})):(n.background="","image"===this.attr.activePreview.type&&(n.height=t.height),this.attr.isContainerBound&&(t={width:"100%",height:"100%"},$.extend(n,t)),i=e($.extend({},this.attr.activePreview,t))),this.select("previewContentSelector").html(i),this.select("multiPreviewContainerSelector").css(n),"image"!==this.attr.activePreview.type||this.attr.isOverlayPage||$(".product.popped .preview-container").css({height:this.attr.activePreview.height}),this.readyPreview()},this.populatePreviewFlipper=function(){if(!this.attr.assetPreviews||this.attr.assetPreviews.length<=1||this.select("previewArrowSelector").length<1)return void this.select("previewArrowSelector").removeClass("showing");var t=this.select("previewArrowSelector").filter(".previous"),e=this.select("previewArrowSelector").filter(".next");0===this.attr.activePreviewIndex?t.removeClass("showing").removeData("asset-preview-id"):t.addClass("showing").data("asset-preview-id",this.attr.assetPreviews[this.attr.activePreviewIndex-1].id),this.attr.activePreviewIndex>=this.attr.assetPreviews.length-1?e.removeClass("showing").removeData("asset-preview-id"):e.addClass("showing").data("asset-preview-id",this.attr.assetPreviews[this.attr.activePreviewIndex+1].id)},this.populatePreviewPicker=function(){var t=this.select("previewPickerSelector");t.addClass("empty").empty(),t.length&&($.each(this.attr.assetPreviews,function(t,e){var n=$("<li>",{"class":"js-preview-picker-item","data-asset-preview-id":e.id});e.id===this.attr.activePreviewId&&n.addClass("active"),this.select("previewPickerSelector").append(n)}.bind(this)),this.attr.assetPreviews.length>1&&(t.removeClass("empty").show(),this.select("multiPreviewContainerSelector").addClass("has-multiple-previews")))},this.readyPreview=function(){this.initializePreviewMediaPlayer(),this.populatePreviewPicker(),this.populatePreviewFlipper(),this.updateCurrentProductPageTabHeight(),this.populateOembedUrl()},this.selectPreview=function(t,e){t&&t.stopPropagation(),this.attr.activePreviewId=$(e.el).data("asset-preview-id"),this.showPreview()},this.setActivePreview=function(){delete this.attr.activePreviewIndex,delete this.attr.activePreview,this.attr.assetPreviews&&$.each(this.attr.assetPreviews,function(t,e){return e.id===this.attr.activePreviewId?(this.attr.activePreviewIndex=t,this.attr.activePreview=e,this.attr.activePreview[this.attr.activePreview.type+"_preview"]=!0,!1):void 0}.bind(this))},this.showPreview=function(t,e){if(e){if(e.updatedPermalink&&e.updatedPermalink!==this.attr.productPermalink)return;this.attr.activePreviewId=e.active_preview_id,this.attr.assetPreviews=e.asset_previews}this.select("multiPreviewContainerSelector").removeClass("uploading"),this.select("uploadURLInputSelector").val(""),this.setActivePreview(),this.populatePreview(),this.updateCurrentProductPageTabHeight()},this.toggleVideo=function(t){var e=this.select("iframeSelector")[0],n=null;e&&(e.src.match(/vimeo/)?n={method:t?"play":"pause"}:e.src.match(/youtube/)&&(n={event:"command",func:t?"playVideo":"pauseVideo",args:""}),n&&e.contentWindow.postMessage(JSON.stringify(n),"*"))},this.updateCurrentProductPageTabHeight=function(){this.trigger("uiUpdateCurrentProductPageTabHeight")},this.after("initialize",function(){this.attr.onProductPage=this.$node.parents("form#edit-link-form, body#product_page").length>0,this.attr.isFixedHeight=this.select("multiPreviewContainerSelector").hasClass("js-fixed-preview-height"),this.attr.isImageAsBackground=this.$node.hasClass("image-as-background"),this.attr.isOverlayPage=this.$node.parents("#overlay-page").length>0,this.attr.isContainerBound=this.$node.parents(".gridster").length>0||this.$node.parents("#download-page").length>0,this.on("click",{previewArrowVisibleSelector:this.selectPreview,previewPickerItemSelector:this.selectPreview}),this.on(document,"keydown",this.keyAction),this.on(document,"showPreview",this.showPreview),this.on(document,"uiNeedsToPauseVideo",this.pauseVideo),this.addOrientationChangeListeners(),this.initializePreview()})}return r})}(),define("$app/ui/product/product",["flight/lib/component","$app/ui/product/with_product_main","$app/ui/product/with_payment_form","$app/ui/product/with_facebook_login","$app/ui/product/with_payment_blurb","$app/ui/product/with_multi_buy","$app/ui/product/with_offer_code","$app/ui/product/with_price","$app/ui/product/with_receipt","$app/ui/product/with_subscription","$app/ui/product/with_quantity","$app/ui/product/with_variants","$app/ui/product/with_click_event_tracking","$app/ui/shared/with_audio_player","$app/ui/shared/with_video_player","$app/ui/shared/with_preview","$app/utils/with_url"],function(t,e,n,i,r,a,s,o,l,u,c,h,d,p,f,m,g){function y(){this.defaultAttrs({productSelector:".product",isShowingPaymentForm:!1,isCurrentUserSet:!1,isCustomerSurchargeSet:!1,slideAnimationSpeed:400,isProductDisabled:!1,hasViewIncremented:!1,isMobile:!1,isModal:!1,isEmbed:!1,isOutboundEmbed:!1,incrementViewCountOnInit:!1,onUserProfile:!1,onProductPage:!1,isDemo:!1,wasProductRecommended:!1}),this.switchToPaymentForm=function(t){t=t&&!this.attr.isMobile;var e=t?"animate":"css",n=this.getPaymentFormHeight(),i=function(){this.attr.isAnimatingPaymentForm=!1}.bind(this);t&&(this.attr.isAnimatingPaymentForm=!0),this.updateDefaultHeight(),this.select("productMainSelector")[e]({height:0},this.attr.slideAnimationSpeed),this.select("paymentFormSelector")[e]({height:n},this.attr.slideAnimationSpeed,null,i),this.attr.isShowingPaymentForm=!0,this.trigger("uiPaymentFormShown")},this.switchToProductMain=function(t){var e=t&&!this.attr.isMobile?"animate":"css",n=this.select("productMainSelector").height(),i=this.select("productMainSelector");i.css("height","auto");var r=i.height();this.attr.defaultProductMainHeight=r,this.updateDefaultHeight(),this.select("paymentFormSelector")[e]({height:0},this.attr.slideAnimationSpeed),this.select("productMainSelector").height(n),i[e]({height:r},{duration:this.attr.slideAnimationSpeed,complete:function(){i.css("height","auto").removeAttr("height")}}),this.attr.isShowingPaymentForm=!1,this.trigger("uiProductMainShown")},this.animatePaymentFormHeight=function(t,e){this.attr.isShowingPaymentForm&&this.switchToPaymentForm(e.animate)},this.setCustomerSurcharge=function(){this.attr.isCustomerSurchargeSet=!0,this.triggerPaymentFormIfWanted()},this.setOverlayOfferCode=function(){var t=this.attr.user&&this.attr.user.product&&this.attr.user.product.offer_code;if(this.attr.overlayOfferCode&&t&&t.is_valid){var e=$.extend({name:this.attr.overlayOfferCode,offer_code_amount:t.amount,permalink:this.attr.permalink,success:!0},t);this.trigger("uiNeedsToAddOfferCodeToBundle",e)}},this.setOverlayUrlParams=function(){this.attr.overlayUrlParams&&this.trigger("uiUpdateUrlParameters",this.attr.overlayUrlParams)},this.setCurrentUserInfo=function(t,e){this.attr.permalink===e.permalink&&(this.attr.user=e,this.setOfferCode(),this.setOverlayOfferCode(),this.setOverlayUrlParams(),this.attr.isCurrentUserSet||(this.setRemaining(),this.setTerritoryBlockedNotice(),this.setCreditCard(),this.setPreviewProcessing(),this.setLoginInfo(),this.setShippingInfo(),this.setVariants(),this.setReceipt(),this.setEmail(),this.setAlreadyBought(),this.attr.isCurrentUserSet=!0),this.attr.canGift&&this.getUrlParams().gift&&this.showGiftInputs(),this.triggerPaymentOptionUpdate(),this.triggerPaymentFormIfWanted())},this.triggerPaymentFormIfWanted=function(){!this.attr.wantThis&&!this.getUrlParams().wanted||this.attr.user.purchase.redirect_token||this.attr.isProductDisabled||!this.attr.isCustomerSurchargeSet||!this.attr.isCurrentUserSet||this.attr.onUserProfile||(this.showPaymentFormIfPossible(null,!1),this.attr.wantThis=!1)},this.triggerPaymentOptionUpdate=function(){this.attr.isRecurringBilling&&$.each(["monthy","quarterly","biannually","yearly"],function(t,e){(this.attr.overlayPaymentOption===e||this.getUrlParams()[e])&&this.updatePaymentOptionSelection(e)}.bind(this))},this.incrementViewCountIfNotDoneYet=function(){this.attr.hasViewIncremented||(this.trigger("uiNeedsToTrackViewEvent",{permalink:this.attr.permalink,wasProductRecommended:!!this.attr.wasProductRecommended,recommendedBy:this.attr.recommendedBy}),this.attr.hasViewIncremented=!0)},this.setPayButtonText=function(){var t=this.attr.isRentalModeActive?I18n.t("js.rent_prompt"):I18n.t("js.pay_prompt");this.select("payButtonSelector").text(t),this.select("payButtonSelector").data("default",t)},this.initializeProduct=function(){if(this.attr.onUserProfile||(this.setCardSaveRequired(this.productNeedsCardSaved()),this.trigger("uiSetPermalinkForSharing",{permalink:this.attr.permalink})),this.$node.data("product-info")){var t=this.$node.data("product-info");t.permalink=this.attr.permalink,this.setCurrentUserInfo({},t)}else this.trigger("uiNeedsToGetCurrentUserInfo",{permalink:this.attr.permalink,offerCodeName:this.attr.offerCodeName});this.attr.incrementViewCountOnInit&&this.incrementViewCountIfNotDoneYet()},this.productNeedsCardSaved=function(){return this.attr.isRecurringBilling||this.attr.isPreorder},this.teardownProduct=function(){this.teardown()},this.triggerECommerceView=function(){this.trigger("uiNeedsToTrackECommerceView",{externalId:this.attr.externalId,name:this.attr.name,vertical:this.attr.vertical,price:this.attr.priceCents,currency:this.attr.currency})},this.checkRetargeting=function(){this.attr.retargetingEnabled&&(this.trigger("uiNeedsToEnableRetargeting"),this.attr.onProductPage&&this.triggerECommerceView())},this.determineRecommendedValues=function(){this.attr.recommendedBy?this.attr.wasProductRecommended=!0:this.getUrlParams().recommended_by?(this.attr.wasProductRecommended=!0,this.attr.recommendedBy=this.getUrlParams().recommended_by.match(/[a-zA-Z]+/)[0]):this.attr.overlayRecommendedBy&&(this.attr.wasProductRecommended=!0,this.attr.recommendedBy=this.attr.overlayRecommendedBy)},this.setupGoogleAnalytics=function(){var t=this.select("productSelector").data("seller-google-analytics-id"),e=this.select("productSelector").data("seller-google-analytics-cross-domains");t&&(this.trigger("uiNeedsToStartTrackingForSellerGoogleAnalytics",{googleAnalyticsId:t,googleAnalyticsCrossDomains:e}),(this.attr.onProductPage||this.attr.onOverlayPage)&&this.trigger("uiNeedsToTrackActivityWithSellerGoogleAnalytics",{permalink:this.attr.permalink,action:"viewed"}))},this.after("initialize",function(){this.determineRecommendedValues(),this.attr.onOverlayPage=this.$node.parents("body#overlay-page").length>0,this.attr.user={product:{offer_code:{}},purchase:{}},this.attr.permalink=this.select("productSelector").data("unique-permalink"),this.attr.externalId=this.select("productSelector").data("external-id"),this.attr.name=this.select("productSelector").data("name"),this.attr.isPayWhatYouWant=1==this.select("priceRangeSelector").length,this.attr.offerCodeName=this.attr.overlayOfferCode||this.getOfferCodeNameFromUrl(),this.attr.offerCodeUsed=!!this.attr.offerCodeName,this.attr.shippingCents=0,this.attr.isSingleUnit=this.select("priceSelector").data("single-unit"),this.attr.hasVariants=!!this.select("productSelector").data("has-variants"),this.attr.hasOfferCodeField=this.select("offerCodeFieldSelector").length>0,this.attr.isPreorder=!!this.select("productSelector").data("is-preorder"),this.attr.isPhysical=!!this.select("productSelector").data("is-physical"),this.attr.isRecurringBilling=this.select("productSelector").data("subscription"),this.attr.shippingInfoRequired=this.select("productSelector").data("shipping-info-required"),this.attr.priceCents=parseInt(this.select("productSelector").data("price-cents")),this.attr.currency=this.select("productSelector").data("currency"),this.attr.price=this.attr.isSingleUnit?this.attr.priceCents:this.attr.priceCents/100,this.attr.purchaseType=this.select("productSelector").data("purchase-type"),this.attr.isRentalModeActive="rent_only"===this.attr.purchaseType,this.attr.exchangeRate=this.select("productSelector").data("exchange-rate"),this.attr.isProductDisabled=this.select("notForSaleNoticeSelector").is(":visible"),this.attr.zeroPlusEnabled=0==parseFloat(this.select("priceRangeSelector").data("min-price")),this.attr.isTaxedExclusively=!!this.select("productSelector").data("taxed-exclusively"),this.attr.sellerId=this.select("productSelector").data("seller-id"),this.attr.retargetingEnabled=this.select("productSelector").data("retargeting"),this.attr.vertical=this.select("productSelector").data("vertical"),this.attr.customFields=this.select("productSelector").data("custom-fields"),"buy_only"!==this.attr.purchaseType&&(this.attr.rentalPriceCents=parseInt(this.select("productSelector").data("rental-price-cents")),this.attr.rentalPrice=this.attr.isSingleUnit?this.attr.rentalPriceCents:this.attr.rentalPriceCents/100),this.attr.isRecurringBilling&&(this.attr.selectedPriceInfo=this.select("productSelector").data("selected-price-info")),this.setupGoogleAnalytics(),this.checkRetargeting(),this.on(document,"uiTeardownProductComponent",this.teardownProduct),this.on(document,"dataCurrentUserInfo",this.setCurrentUserInfo),this.on(document,"dataCustomerSurcharge",this.setCustomerSurcharge),this.on(document,"uiAnimatePaymentFormHeight",this.animatePaymentFormHeight),this.on(document,"uiCheckRetargeting",this.checkRetargeting),this.on(document,"uiTriggerECommerceView",this.triggerECommerceView),this.initializeProduct(),this.initializeAudioPlayer(),this.initializeVideoPlayer()})}return t(y,e,n,i,r,a,s,o,l,u,c,h,d,p,f,m,g)}),function(){define("$app/ui/shared/overlay",["flight/lib/component","$app/ui/product/product"],function(t,e){function n(){this.defaultAttrs({bundleToolTipSelector:".js-bundle-tool-tip",externalLinkSelector:"a:not(.js-logout-link):not(.js-preview-link)[href]",footerSelector:".js-footer",loginSelector:".js-login",productContainerSelector:".js-product-row",productDisplaySelector:".js-product-display",productListSelector:".js-bundled-product-list",productSelector:".js-product",bundleHeightSpacing:50,bundleWidthSpacing:50,isMinimized:!0,productParams:{},validDurationParams:["monthly","quarterly","biannually","yearly"],validOtherParams:["permalink","offerCodeName","locale","wanted","email","gift","recommended_by","url_parameters"]}),this.addTargetsToLinks=function(){this.select("externalLinkSelector").attr("target","_blank")},this.cancelCheckout=function(){this.attr.checkingOut=!1,$("body").removeClass("checking-out showing-bundle"),this.shrinkToBundle()},this.clickListener=function(t){if(!this.attr.checkingOut){for(var e=$(t.target||t.srcElement),n=["buy-form-main","buyer-bar-container","product-row"],i=0;i<n.length;i++){var r=n[i];if(e.hasClass(r)||e.parents("."+r).length>0)return}this.attr.completedPurchase?this.minimize():this.shrinkToBundle()}},this.completePurchase=function(t,e){this.attr.checkingOut=!1,this.attr.completedPurchase=!0,this.notifyGoogleAnalyticsOfPurchase(e)},this.getBundleWidth=function(){return parseInt(this.select("bundleToolTipSelector").outerWidth())+this.attr.bundleWidthSpacing},this.getBundleHeight=function(){var t=this.select("bundleToolTipSelector");return parseInt(t.outerHeight())+parseInt(t.css("margin-top")||0)+parseInt(t.css("margin-bottom")||0)+parseInt(t.css("top")||0)+this.attr.bundleHeightSpacing},this.getPersistentBundle=function(){this.trigger("uiNeedsToGetPersistentBundle")},this.getProduct=function(t){this.attr.productParams={};for(var e=0;e<this.attr.validParams.length;e++){var n=this.attr.validParams[e],i=t[n];i&&"false"!==i.toString().toLowerCase()&&(this.attr.productParams[n]=i)}this.setPaymentOption(),this.trigger(document,"uiNeedsAProduct",this.attr.productParams)},this.gotMessage=function(t){var e={};if(t.data)try{e=JSON.parse(t.data)}catch(n){}e.overlayMethod&&this[e.overlayMethod]&&this[e.overlayMethod](e.overlayArgs)},this.keyListener=function(t){27===t.keyCode&&(t.stopPropagation(),this.minimize())},this.maximize=function(){this.sendMessageToParent({parentMethod:"maximizeIframe"})},this.maximizeCallback=function(){this.refreshPreview(),this.attr.isMinimized=!1,$("body").removeClass("gumroad-minimized"),this.select("productContainerSelector").addClass("showing"),this.trigger("uiNeedsToShowProductCountInCircle"),setTimeout(function(){this.refreshPreview()}.bind(this),300)},this.minimize=function(t){var e={parentMethod:"minimizeIframe"};if(t&&t.minimizeDimensions)e.parentArgs=t.minimizeDimensions;else if(this.attr.checkingOut)return;$("body").addClass("gumroad-minimized"),
this.select("productContainerSelector").addClass("not-showing"),this.trigger("uiNeedsToPauseVideo"),setTimeout(function(){this.sendMessageToParent(e)}.bind(this),300)},this.minimizeCallback=function(){$("body").addClass("gumroad-minimized"),this.select("productContainerSelector").width(0)},this.notifyGoogleAnalyticsOfPurchase=function(t){this.trigger("uiNeedsToTrackActivityWithSellerGoogleAnalytics",{permalink:t.permalink,action:"purchased",value:(Number(t.non_formatted_price)*(this.attr.isSingleUnit?1:100)).toString()}),this.trigger("uiNeedsToTrackECommerceEventWithSellerGoogleAnalytics",{permalink:t.permalink,purchase_external_id:t.id,currency:t.currency_type&&t.currency_type.toUpperCase(),product_name:t.name,price:t.non_formatted_price,quantity:t.quantity,tax:t.non_formatted_seller_tax_amount})},this.prepareProduct=function(t,n){this.removeProduct(),this.select("productDisplaySelector").html(n.html),this.select("productSelector").addClass("relative popped"),e.attachTo(this.attr.productContainerSelector,{incrementViewCountOnInit:!0,isMobile:this.attr.isMobile,isMultiBuyEnabled:!this.attr.singleProductMode,onUserProfile:!this.attr.singleProductMode,overlayOfferCode:this.attr.productParams.offerCodeName,overlayPaymentOption:this.attr.paymentOption,overlayRecommendedBy:this.attr.productParams.recommended_by,overlayUrlParams:this.attr.productParams.url_parameters,permalink:this.attr.productParams.permalink,userInfoToAdd:this.attr.user,wantThis:this.attr.productParams.wanted}),this.trigger("uiCheckRetargeting"),this.showProduct()},this.productsInBundle=function(){var t=[];return this.select("productListSelector").find("li").each(function(e,n){t.push($(n).data("unique-permalink"))}),t},this.redirect=function(t,e){this.sendMessageToParent({parentMethod:"redirect",parentArgs:e.url})},this.refreshPreview=function(){this.trigger(document,"showPreview")},this.removeProduct=function(){e.teardownAll(),this.select("productDisplaySelector").empty()},this.resizeCheckoutArea=function(){this.attr.isMinimized&&this.shrinkToBundle()},this.sendMessageToParent=function(t){this.overlayParentDomain&&("object"==typeof t&&(t=JSON.stringify(t)),window.parent.postMessage(t,this.overlayParentDomain))},this.setIsSingleLink=function(){this.attr.isSingleLink=!0},this.setOverlayParentDomain=function(t){this.overlayParentDomain=t,this.sendMessageToParent({parentMethod:"handshake"})},this.setPaymentOption=function(){for(var t=0;t<this.attr.validDurationParams.length;t++){var e=this.attr.validDurationParams[t];this.attr.productParams[e]&&(this.attr.paymentOption=e)}},this.showPaymentFormIfWanted=function(){this.attr.productParams.wanted&&this.trigger("uiShowOverlayCreditCardForm")},this.showProduct=function(){this.trigger("uiTriggerECommerceView"),this.select("footerSelector").toggle(!this.select("productContainerSelector").data("custom-web-branding")),this.attr.productParams.wanted?this.trigger("uiShowPaymentForm"):this.maximize()},this.shrinkToBundle=function(){if(this.attr.isSingleLink)return void this.minimize();var t=null,e="100%";this.getBundleWidth();this.attr.checkingOut?this.select("loginSelector").css("height","100%"):(e=this.getBundleHeight()+"px",this.select("loginSelector").css("height",this.getBundleHeight()+"px")),this.productsInBundle().length>0&&(t={minimizeDimensions:{width:this.getBundleWidth()+"px",height:e}}),this.minimize(t)},this.startCheckout=function(){this.attr.checkingOut=!0,$("body").addClass("showing-bundle checking-out"),this.shrinkToBundle()},this.after("initialize",function(){this.attr.validParams=this.attr.validDurationParams.concat(this.attr.validOtherParams),this.attr.singleProductMode=$(".js-product-display").data("single-product-mode"),$("body").addClass("gumroad-minimized"),window.addEventListener?window.addEventListener("message",function(t){this.gotMessage(t)}.bind(this),!1):window.attachEvent&&window.attachEvent("onmessage",function(t){this.gotMessage(t)}.bind(this),!1),this.addTargetsToLinks(),this.trigger(document,"uiSetOverlayPageShareUrl",{url:this.select("productDisplaySelector").data("overlay-share-url")}),this.on(document,"dataGotAProduct",this.prepareProduct),this.on(document,"uiBundledProductPaymentFailed",this.completePurchase),this.on(document,"uiBundledProductPaymentCompleted",this.completePurchase),this.on(document,"uiCanShowPaymentForm",this.showPaymentFormIfWanted),this.on(document,"uiCannotShowPaymentForm",this.maximize),this.on(document,"uiNeedsToHideProductOverlay",this.shrinkToBundle),this.on(document,"uiNeedsToCancelBundleCheckout",this.cancelCheckout),this.on(document,"uiNeedsToStartBundleCheckout",this.startCheckout),this.on(document,"uiResizeCheckoutArea",this.resizeCheckoutArea),this.on(document,"uiNeedsToRedirectOverlayFromReceipt",this.redirect),this.on(document,"keydown",this.keyListener),this.on(document,"click",this.clickListener)})}return t(n)})}(),define("$app/data/account",["flight/lib/component"],function(t){function e(){this.createAccount=function(t,e){$.ajax({type:"POST",url:Routes.signup_path({format:"json"}),dataType:"json",data:e.serializedForm}).done(function(t){t.permalink=e.permalink,t.success?this.trigger("dataAccount",t):this.trigger("dataFailedToCreateAccount",t)}.bind(this))},this.addPurchaseToLibrary=function(t,e){$.ajax({type:"POST",url:Routes.add_purchase_to_library_path({format:"json"}),dataType:"json",data:e.serializedForm}).done(function(t){t.permalink=e.permalink,t.success?this.trigger("dataPurchaseAddedToLibrary",t):this.trigger("dataFailedToAddPurchaseToLibrary",t)}.bind(this))},this.loginWithFacebook=function(){FB.login(function(t){if(t.authResponse){var e={accessToken:t.authResponse.accessToken};this.trigger("dataFacebookLoginVerifying"),$.ajax({url:Routes.ajax_facebook_path(),type:"POST",dataType:"json",data:e}).done(function(t){t.success?this.trigger("dataFackbookLoginSucceeded"):this.trigger("dataFackbookLoginFailed")}.bind(this))}}.bind(this),{scope:"email,manage_pages"})},this.after("initialize",function(){this.on(document,"uiNeedsToCreateAccount",this.createAccount),this.on(document,"uiNeedsToAddPurchaseToLibrary",this.addPurchaseToLibrary),this.on(document,"uiNeedsToLoginWithFacebook",this.loginWithFacebook)})}return t(e)}),define("$app/data/shipping",["flight/lib/component"],function(t){function e(){this.verifyShippingAddress=function(t,e){$.ajax({type:"POST",url:Routes.verify_shipping_address_path(),data:e.shipping_data,timeout:2500,error:function(t,e,n){this.trigger("dataVerifyShippingAddressTimeout")}.bind(this)}).done(function(t){t.success?this.trigger("dataVerifyShippingAddressSuccessful",t):this.trigger("dataVerifyShippingAddressFail",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToVerifyShippingAddress",this.verifyShippingAddress)})}return t(e)}),define("$app/data/offer_code",["flight/lib/component"],function(t){function e(){this.getOfferCode=function(t,e){$.ajax({type:"GET",url:Routes.offer_code_link_path(e.permalink)+"?code="+e.offerCode,dataType:"json"}).done(function(t){t.permalink=e.permalink,this.trigger("dataOfferCode",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToGetOfferCode",this.getOfferCode)})}return t(e)}),define("$app/data/purchase",["flight/lib/component"],function(t){function e(){this.defaultAttrs({timeout:3e4}),this.makePayment=function(t,e){$.ajax({type:"POST",url:Routes.purchases_path(),data:e.serializedForm,timeout:this.attr.timeout,error:function(t,n,i){e.is_bundled?"timeout"===n&&e.payingWithPayPal?this.trigger("uiBundledProductPaymentTimeout",{permalink:e.permalink,name:e.name,sha:e.sha,price:e.formattedPrice}):this.trigger("uiBundledProductPaymentFailed",{permalink:e.permalink}):"timeout"===n&&e.payingWithPayPal?this.trigger("dataPurchaseTimeout",{permalink:e.permalink}):this.trigger("dataPurchaseFail",{permalink:e.permalink})}.bind(this)}).done(function(t){t.permalink=e.permalink,t.sha=e.sha,e.is_bundled?t.success?this.trigger("uiBundledProductPaymentCompleted",t):this.trigger("uiBundledProductPaymentFailed",t):t.success?this.trigger("dataPurchaseSuccessful",t):this.trigger("dataPurchaseFail",t)}.bind(this))},this.updatePurchase=function(t,e){$.ajax({url:Routes.purchase_path(e),type:"PUT",dataType:"json",data:e}).done(function(t){t.success?this.trigger("dataPurchaseUpdateSuccessful",t):this.trigger("dataPurchaseUpdateFail")}.bind(this))},this.executeRefund=function(t,e){$.ajax({type:"PUT",url:Routes.refund_purchase_path(e),dataType:"json"}).done(function(t){t.success?this.trigger("dataRefundComplete",t):this.trigger("dataRefundFailed")}.bind(this))},this.sendInvoice=function(t,e){$.ajax({url:Routes.send_invoice_purchase_path(e.id),type:"POST",dataType:"json",data:e}).done(function(t){this.trigger("dataInvoice",t)}.bind(this))},this.deleteImportedCustomer=function(t,e){$.ajax({url:Routes.destroy_imported_customer_path(e.id),type:"DELETE",dataType:"json",data:e}).done(function(t){t.success?this.trigger("dataDeletedImportedCustomerComplete",t):this.trigger("dataDeletedImportedCustomerFailed",t)}.bind(this))},this.deleteFreeCustomer=function(t,e){$.ajax({url:Routes.destroy_free_customer_path(e.id),type:"DELETE",dataType:"json",data:e}).done(function(t){t.success?this.trigger("dataDeletedFreeCustomerComplete",t):this.trigger("dataDeletedFreeCustomerFailed",t)}.bind(this))},this.markPurchaseAsShipped=function(t,e){$.ajax({url:Routes.mark_as_shipped_path(e.purchase_id),type:"POST",dataType:"json",data:e}).done(function(t){t.success?this.trigger("dataMarkedPurchaseAsShippedSuccessful",t):this.trigger("dataMarkedPurchaseAsShippedFail")}.bind(this))},this.changeCanContact=function(t,e){$.ajax({url:Routes.change_can_contact_purchase_path(e.id),type:"POST",dataType:"json"}).done(function(t){this.trigger("dataChangedCanContact",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToMakePayment",this.makePayment),this.on(document,"uiNeedsToUpdatePurchase",this.updatePurchase),this.on(document,"uiNeedsToMarkPurchaseAsShipped",this.markPurchaseAsShipped),this.on(document,"uiNeedsToRefund",this.executeRefund),this.on(document,"uiNeedsToDeleteImportedCustomer",this.deleteImportedCustomer),this.on(document,"uiNeedsToDeleteFreeCustomer",this.deleteFreeCustomer),this.on(document,"uiNeedsToSendInvoice",this.sendInvoice),this.on(document,"uiNeedsToChangeCanContact",this.changeCanContact)})}return t(e)}),define("$app/data/user_products",["flight/lib/component"],function(t){function e(){this.getMoreProducts=function(t,e){$.ajax({type:"GET",dataType:"html",url:Routes.user_products_paged_path(e.username),data:{page:e.page,tags:e.tags},error:function(){this.trigger("dataMoreUserProductsFailed",{page:e.page})}.bind(this)}).done(function(t){this.trigger("dataMoreUserProducts",{html:t,page:e.page})}.bind(this))},this.getProduct=function(t,e){$.ajax({type:"GET",dataType:"html",url:Routes.display_path(e.permalink,e)}).done(function(t){this.trigger(e.customTrigger?e.customTrigger:"dataGotAProduct",{html:t,permalink:e.permalink})}.bind(this))},this.savePageLayout=function(t,e){$.ajax({type:"PUT",dataType:"json",url:Routes.user_save_page_layout_path(),data:e})},this.after("initialize",function(){this.on("uiNeedsMoreUserProducts",this.getMoreProducts),this.on("uiNeedsToSavePageLayout",this.savePageLayout),this.on("uiNeedsAProduct",this.getProduct)})}return t(e)}),define("$app/data/user_info",["flight/lib/component"],function(t){function e(){this.getCurrentUserInfo=function(t,e){$.ajax({type:"GET",url:Routes.user_info_link_path(e.permalink)+(e.offerCodeName?"?code="+e.offerCodeName:""),dataType:"json"}).done(function(t){t.permalink=e.permalink,this.trigger("dataCurrentUserInfo",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsToGetCurrentUserInfo",this.getCurrentUserInfo)})}return t(e)}),define("$app/data/customer_surcharge",["flight/lib/component"],function(t){function e(){this.getCustomerSurcharge=function(t,e){$.ajax({url:Routes.customer_surcharge_path(e.externalId,e.sellerId,0|e.isTaxExclusive,Math.round(e.priceCents),e.quantity),data:{postal_code:e.postalCode,country:e.country,physical:e.isPhysical},type:"GET"}).done(function(t){e.isPartOfBundle?(t.permalink=e.permalink,this.trigger("dataCustomerSurchargeForBundle",t)):this.trigger(e.productNode,"dataCustomerSurcharge",t)}.bind(this))},this.after("initialize",function(){this.on(document,"uiNeedsProductCustomerSurcharge",this.getCustomerSurcharge)})}return t(e)}),define("$app/data/google_analytics",["flight/lib/component"],function(t){function e(){this.defaultAttrs({eventToDescription:{viewed:"viewed product",iwantthis:'clicked "I want this!" button',purchased:"purchased a product"}}),this.trackProductEvent=function(t,e){if("undefined"!=typeof ga){var n=0;"undefined"!=typeof e.value&&(n=parseInt(e.value)),ga("sellerTracker.send","event","product-"+e.permalink,e.action,this.attr.eventToDescription[e.action],n)}},this.trackVirtualPageView=function(t,e){if("undefined"!=typeof ga){var n=window.location.pathname+window.location.search,i=this.attr.eventToDescription[e.action];"viewed"!=e.action&&(n+="?"+e.action),ga("sellerTracker.send","pageview",{page:n,title:i})}},this.trackECommerceForSeller=function(t,e){if("undefined"!=typeof ga){var n={id:e.purchase_external_id,name:e.product_name,sku:e.permalink,price:e.price,quantity:e.quantity},i={id:e.purchase_external_id,affiliation:"Gumroad",revenue:e.price,tax:e.tax,currency:e.currency};ga("sellerTracker.ecommerce:addTransaction",i),ga("sellerTracker.ecommerce:addItem",n),ga("sellerTracker.ecommerce:send")}},this.startTrackingForSeller=function(t,e){"undefined"!=typeof ga&&(e.googleAnalyticsCrossDomains?(ga("create",e.googleAnalyticsId,"gumroad.com",{name:"sellerTracker",allowLinker:!0}),ga("sellerTracker.require","linker"),ga("sellerTracker.linker:autoLink",$.map(e.googleAnalyticsCrossDomains.split(","),function(t){return t.trim()}))):ga("create",e.googleAnalyticsId,"gumroad.com",{name:"sellerTracker"}),ga("sellerTracker.require","ecommerce"))},this.after("initialize",function(){this.on(document,"uiNeedsToTrackActivityWithSellerGoogleAnalytics",this.trackProductEvent),this.on(document,"uiNeedsToTrackActivityWithSellerGoogleAnalytics",this.trackVirtualPageView),this.on(document,"uiNeedsToStartTrackingForSellerGoogleAnalytics",this.startTrackingForSeller),this.on(document,"uiNeedsToTrackECommerceEventWithSellerGoogleAnalytics",this.trackECommerceForSeller)})}return t(e)}),function(){define("$app/pages/overlay",["$app/utils/base_page","$app/ui/shared/bundle_button","$app/ui/shared/login","$app/ui/shared/overlay","$app/data/account","$app/data/shipping","$app/data/offer_code","$app/data/purchase","$app/data/user_products","$app/data/user_info","$app/data/customer_surcharge","$app/data/google_analytics"],function(t,e,n,i,r,a,s,o,l,u,c,h){function d(){t.initialize(),$(".js-product-display").data("single-product-mode")||e.attachTo(".js-bundle-button",{onMultiOverlay:!0}),n.attachTo(".js-login"),i.attachTo(document),r.attachTo(document),a.attachTo(document),s.attachTo(document),o.attachTo(document),l.attachTo(document),u.attachTo(document),c.attachTo(document),h.attachTo(document)}return d})}(),function(){require(["$app/pages/overlay"],function(t){t()})}(),define("boot/overlay",function(){});